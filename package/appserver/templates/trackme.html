<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>TrackMe - Data tracking system</title>
    <link rel="shortcut icon" href="/en-US/static/@E0748683B67CEA4FEB581C608314742274902FE131518C73E0D443740659785A.7/img/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="{{SPLUNKWEB_URL_PREFIX}}/static/css/build/pages/dashboard-simple-bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="/en-GB/static/@581EEFD6E287467907C4438C65BD080F23305CD11D6F0A43A0E938B762AA7EEB.2/build/css/bootstrap-enterprise.css">
    <link rel="stylesheet" type="text/css" href="/en-GB/static/@87344edfcdb4.2-1638288942/app/trackme/common.css">
    <link rel="stylesheet" type="text/css" href="/en-GB/static/@87344edfcdb4.2-1638288942/app/trackme/checkbox_table.css" />

    <meta name="referrer" content="never" />
    <meta name="referrer" content="no-referrer" />

    <script>
        window._splunk_metrics_events = {
            push : function() {},
            active: false,
        }
    </script>
    <style>
        
        /* Bootstrap btns */
        .btn-primary {
        color: #fff;
        background-color: #007bff;
        border-color: #007bff;
        }

        .btn-primary:hover {
        color: #fff;
        background-color: #0069d9;
        border-color: #0062cc;
        }

        .btn-primary:focus, .btn-primary.focus {
        color: #fff;
        background-color: #0069d9;
        border-color: #0062cc;
        box-shadow: 0 0 0 0.2rem rgba(38, 143, 255, 0.5);
        }

        .btn-primary.disabled, .btn-primary:disabled {
        color: #fff;
        background-color: #007bff;
        border-color: #007bff;
        }

        .btn-primary:not(:disabled):not(.disabled):active, .btn-primary:not(:disabled):not(.disabled).active,
        .show > .btn-primary.dropdown-toggle {
        color: #fff;
        background-color: #0062cc;
        border-color: #005cbf;
        }

        .btn-primary:not(:disabled):not(.disabled):active:focus, .btn-primary:not(:disabled):not(.disabled).active:focus,
        .show > .btn-primary.dropdown-toggle:focus {
        box-shadow: 0 0 0 0.2rem rgba(38, 143, 255, 0.5);
        }

        .btn-danger {
        color: #fff;
        background-color: #dc3545;
        border-color: #dc3545;
        }

        .btn-danger:hover {
        color: #fff;
        background-color: #c82333;
        border-color: #bd2130;
        }

        .btn-danger:focus, .btn-danger.focus {
        color: #fff;
        background-color: #c82333;
        border-color: #bd2130;
        box-shadow: 0 0 0 0.2rem rgba(225, 83, 97, 0.5);
        }

        .btn-danger.disabled, .btn-danger:disabled {
        color: #fff;
        background-color: #dc3545;
        border-color: #dc3545;
        }

        .btn-danger:not(:disabled):not(.disabled):active, .btn-danger:not(:disabled):not(.disabled).active,
        .show > .btn-danger.dropdown-toggle {
        color: #fff;
        background-color: #bd2130;
        border-color: #b21f2d;
        }

        .btn-danger:not(:disabled):not(.disabled):active:focus, .btn-danger:not(:disabled):not(.disabled).active:focus,
        .show > .btn-danger.dropdown-toggle:focus {
        box-shadow: 0 0 0 0.2rem rgba(225, 83, 97, 0.5);
        }

        .btn-info {
        color: #fff;
        background-color: #17a2b8;
        border-color: #17a2b8;
        }

        .btn-info:hover {
        color: #fff;
        background-color: #138496;
        border-color: #117a8b;
        }

        .btn-info:focus, .btn-info.focus {
        color: #fff;
        background-color: #138496;
        border-color: #117a8b;
        box-shadow: 0 0 0 0.2rem rgba(58, 176, 195, 0.5);
        }

        .btn-info.disabled, .btn-info:disabled {
        color: #fff;
        background-color: #17a2b8;
        border-color: #17a2b8;
        }

        .btn-info:not(:disabled):not(.disabled):active, .btn-info:not(:disabled):not(.disabled).active,
        .show > .btn-info.dropdown-toggle {
        color: #fff;
        background-color: #117a8b;
        border-color: #10707f;
        }

        .btn-info:not(:disabled):not(.disabled):active:focus, .btn-info:not(:disabled):not(.disabled).active:focus,
        .show > .btn-info.dropdown-toggle:focus {
        box-shadow: 0 0 0 0.2rem rgba(58, 176, 195, 0.5);
        }

        .btn-warning {
        color: #212529;
        background-color: #ffc107;
        border-color: #ffc107;
        }

        .btn-warning:hover {
        color: #212529;
        background-color: #e0a800;
        border-color: #d39e00;
        }

        .btn-warning:focus, .btn-warning.focus {
        color: #212529;
        background-color: #e0a800;
        border-color: #d39e00;
        box-shadow: 0 0 0 0.2rem rgba(222, 170, 12, 0.5);
        }

        .btn-warning.disabled, .btn-warning:disabled {
        color: #212529;
        background-color: #ffc107;
        border-color: #ffc107;
        }

        .btn-warning:not(:disabled):not(.disabled):active, .btn-warning:not(:disabled):not(.disabled).active,
        .show > .btn-warning.dropdown-toggle {
        color: #212529;
        background-color: #d39e00;
        border-color: #c69500;
        }

        .btn-warning:not(:disabled):not(.disabled):active:focus, .btn-warning:not(:disabled):not(.disabled).active:focus,
        .show > .btn-warning.dropdown-toggle:focus {
        box-shadow: 0 0 0 0.2rem rgba(222, 170, 12, 0.5);
        }

        .btn-success {
        color: #fff;
        background-color: #28a745;
        border-color: #28a745;
        }

        .btn-success:hover {
        color: #fff;
        background-color: #218838;
        border-color: #1e7e34;
        }

        .btn-success:focus, .btn-success.focus {
        color: #fff;
        background-color: #218838;
        border-color: #1e7e34;
        box-shadow: 0 0 0 0.2rem rgba(72, 180, 97, 0.5);
        }

        .btn-success.disabled, .btn-success:disabled {
        color: #fff;
        background-color: #28a745;
        border-color: #28a745;
        }

        .btn-success:not(:disabled):not(.disabled):active, .btn-success:not(:disabled):not(.disabled).active,
        .show > .btn-success.dropdown-toggle {
        color: #fff;
        background-color: #1e7e34;
        border-color: #1c7430;
        }

        .btn-success:not(:disabled):not(.disabled):active:focus, .btn-success:not(:disabled):not(.disabled).active:focus,
        .show > .btn-success.dropdown-toggle:focus {
        box-shadow: 0 0 0 0.2rem rgba(72, 180, 97, 0.5);
        }

        .btn-light {
        color: #212529;
        background-color: #f8f9fa;
        border-color: #f8f9fa;
        }

        .btn-light:hover {
        color: #212529;
        background-color: #e2e6ea;
        border-color: #dae0e5;
        }

        .btn-light:focus, .btn-light.focus {
        color: #212529;
        background-color: #e2e6ea;
        border-color: #dae0e5;
        box-shadow: 0 0 0 0.2rem rgba(216, 217, 219, 0.5);
        }

        .btn-light.disabled, .btn-light:disabled {
        color: #212529;
        background-color: #f8f9fa;
        border-color: #f8f9fa;
        }

        .btn-light:not(:disabled):not(.disabled):active, .btn-light:not(:disabled):not(.disabled).active,
        .show > .btn-light.dropdown-toggle {
        color: #212529;
        background-color: #dae0e5;
        border-color: #d3d9df;
        }

        .btn-light:not(:disabled):not(.disabled):active:focus, .btn-light:not(:disabled):not(.disabled).active:focus,
        .show > .btn-light.dropdown-toggle:focus {
        box-shadow: 0 0 0 0.2rem rgba(216, 217, 219, 0.5);
        }

        .btn-dark {
        color: #fff;
        background-color: #343a40;
        border-color: #343a40;
        }

        .btn-dark:hover {
        color: #fff;
        background-color: #23272b;
        border-color: #1d2124;
        }

        .btn-dark:focus, .btn-dark.focus {
        color: #fff;
        background-color: #23272b;
        border-color: #1d2124;
        box-shadow: 0 0 0 0.2rem rgba(82, 88, 93, 0.5);
        }

        .btn-dark.disabled, .btn-dark:disabled {
        color: #fff;
        background-color: #343a40;
        border-color: #343a40;
        }

        .btn-dark:not(:disabled):not(.disabled):active, .btn-dark:not(:disabled):not(.disabled).active,
        .show > .btn-dark.dropdown-toggle {
        color: #fff;
        background-color: #1d2124;
        border-color: #171a1d;
        }

        .btn-dark:not(:disabled):not(.disabled):active:focus, .btn-dark:not(:disabled):not(.disabled).active:focus,
        .show > .btn-dark.dropdown-toggle:focus {
        box-shadow: 0 0 0 0.2rem rgba(82, 88, 93, 0.5);
        }

        .btn-outline-primary {
        color: #007bff;
        border-color: #007bff;
        }

        .btn-outline-primary:hover {
        color: #fff;
        background-color: #007bff;
        border-color: #007bff;
        }

        .btn-outline-primary:focus, .btn-outline-primary.focus {
        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.5);
        }

        .btn-outline-primary.disabled, .btn-outline-primary:disabled {
        color: #007bff;
        background-color: transparent;
        }

        .btn-outline-primary:not(:disabled):not(.disabled):active, .btn-outline-primary:not(:disabled):not(.disabled).active,
        .show > .btn-outline-primary.dropdown-toggle {
        color: #fff;
        background-color: #007bff;
        border-color: #007bff;
        }

        .btn-outline-primary:not(:disabled):not(.disabled):active:focus, .btn-outline-primary:not(:disabled):not(.disabled).active:focus,
        .show > .btn-outline-primary.dropdown-toggle:focus {
        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.5);
        }

        .btn-outline-secondary {
        color: #6c757d;
        border-color: #6c757d;
        }

        .btn-outline-secondary:hover {
        color: #fff;
        background-color: #6c757d;
        border-color: #6c757d;
        }

        .btn-outline-secondary:focus, .btn-outline-secondary.focus {
        box-shadow: 0 0 0 0.2rem rgba(108, 117, 125, 0.5);
        }

        .btn-outline-secondary.disabled, .btn-outline-secondary:disabled {
        color: #6c757d;
        background-color: transparent;
        }

        .btn-outline-secondary:not(:disabled):not(.disabled):active, .btn-outline-secondary:not(:disabled):not(.disabled).active,
        .show > .btn-outline-secondary.dropdown-toggle {
        color: #fff;
        background-color: #6c757d;
        border-color: #6c757d;
        }

        .btn-outline-secondary:not(:disabled):not(.disabled):active:focus, .btn-outline-secondary:not(:disabled):not(.disabled).active:focus,
        .show > .btn-outline-secondary.dropdown-toggle:focus {
        box-shadow: 0 0 0 0.2rem rgba(108, 117, 125, 0.5);
        }

        .btn-outline-success {
        color: #28a745;
        border-color: #28a745;
        }

        .btn-outline-success:hover {
        color: #fff;
        background-color: #28a745;
        border-color: #28a745;
        }

        .btn-outline-success:focus, .btn-outline-success.focus {
        box-shadow: 0 0 0 0.2rem rgba(40, 167, 69, 0.5);
        }

        .btn-outline-success.disabled, .btn-outline-success:disabled {
        color: #28a745;
        background-color: transparent;
        }

        .btn-outline-success:not(:disabled):not(.disabled):active, .btn-outline-success:not(:disabled):not(.disabled).active,
        .show > .btn-outline-success.dropdown-toggle {
        color: #fff;
        background-color: #28a745;
        border-color: #28a745;
        }

        .btn-outline-success:not(:disabled):not(.disabled):active:focus, .btn-outline-success:not(:disabled):not(.disabled).active:focus,
        .show > .btn-outline-success.dropdown-toggle:focus {
        box-shadow: 0 0 0 0.2rem rgba(40, 167, 69, 0.5);
        }

        .btn-outline-info {
        color: #17a2b8;
        border-color: #17a2b8;
        }

        .btn-outline-info:hover {
        color: #fff;
        background-color: #17a2b8;
        border-color: #17a2b8;
        }

        .btn-outline-info:focus, .btn-outline-info.focus {
        box-shadow: 0 0 0 0.2rem rgba(23, 162, 184, 0.5);
        }

        .btn-outline-info.disabled, .btn-outline-info:disabled {
        color: #17a2b8;
        background-color: transparent;
        }

        .btn-outline-info:not(:disabled):not(.disabled):active, .btn-outline-info:not(:disabled):not(.disabled).active,
        .show > .btn-outline-info.dropdown-toggle {
        color: #fff;
        background-color: #17a2b8;
        border-color: #17a2b8;
        }

        .btn-outline-info:not(:disabled):not(.disabled):active:focus, .btn-outline-info:not(:disabled):not(.disabled).active:focus,
        .show > .btn-outline-info.dropdown-toggle:focus {
        box-shadow: 0 0 0 0.2rem rgba(23, 162, 184, 0.5);
        }

        .btn-outline-warning {
        color: #ffc107;
        border-color: #ffc107;
        }

        .btn-outline-warning:hover {
        color: #212529;
        background-color: #ffc107;
        border-color: #ffc107;
        }

        .btn-outline-warning:focus, .btn-outline-warning.focus {
        box-shadow: 0 0 0 0.2rem rgba(255, 193, 7, 0.5);
        }

        .btn-outline-warning.disabled, .btn-outline-warning:disabled {
        color: #ffc107;
        background-color: transparent;
        }

        .btn-outline-warning:not(:disabled):not(.disabled):active, .btn-outline-warning:not(:disabled):not(.disabled).active,
        .show > .btn-outline-warning.dropdown-toggle {
        color: #212529;
        background-color: #ffc107;
        border-color: #ffc107;
        }

        .btn-outline-warning:not(:disabled):not(.disabled):active:focus, .btn-outline-warning:not(:disabled):not(.disabled).active:focus,
        .show > .btn-outline-warning.dropdown-toggle:focus {
        box-shadow: 0 0 0 0.2rem rgba(255, 193, 7, 0.5);
        }

        .btn-outline-danger {
        color: #dc3545;
        border-color: #dc3545;
        }

        .btn-outline-danger:hover {
        color: #fff;
        background-color: #dc3545;
        border-color: #dc3545;
        }

        .btn-outline-danger:focus, .btn-outline-danger.focus {
        box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.5);
        }

        .btn-outline-danger.disabled, .btn-outline-danger:disabled {
        color: #dc3545;
        background-color: transparent;
        }

        .btn-outline-danger:not(:disabled):not(.disabled):active, .btn-outline-danger:not(:disabled):not(.disabled).active,
        .show > .btn-outline-danger.dropdown-toggle {
        color: #fff;
        background-color: #dc3545;
        border-color: #dc3545;
        }

        .btn-outline-danger:not(:disabled):not(.disabled):active:focus, .btn-outline-danger:not(:disabled):not(.disabled).active:focus,
        .show > .btn-outline-danger.dropdown-toggle:focus {
        box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.5);
        }

        .btn-outline-light {
        color: #f8f9fa;
        border-color: #f8f9fa;
        }

        .btn-outline-light:hover {
        color: #212529;
        background-color: #f8f9fa;
        border-color: #f8f9fa;
        }

        .btn-outline-light:focus, .btn-outline-light.focus {
        box-shadow: 0 0 0 0.2rem rgba(248, 249, 250, 0.5);
        }

        .btn-outline-light.disabled, .btn-outline-light:disabled {
        color: #f8f9fa;
        background-color: transparent;
        }

        .btn-outline-light:not(:disabled):not(.disabled):active, .btn-outline-light:not(:disabled):not(.disabled).active,
        .show > .btn-outline-light.dropdown-toggle {
        color: #212529;
        background-color: #f8f9fa;
        border-color: #f8f9fa;
        }

        .btn-outline-light:not(:disabled):not(.disabled):active:focus, .btn-outline-light:not(:disabled):not(.disabled).active:focus,
        .show > .btn-outline-light.dropdown-toggle:focus {
        box-shadow: 0 0 0 0.2rem rgba(248, 249, 250, 0.5);
        }

        .btn-outline-dark {
        color: #343a40;
        border-color: #343a40;
        }

        .btn-outline-dark:hover {
        color: #fff;
        background-color: #343a40;
        border-color: #343a40;
        }

        .btn-outline-dark:focus, .btn-outline-dark.focus {
        box-shadow: 0 0 0 0.2rem rgba(52, 58, 64, 0.5);
        }

        .btn-outline-dark.disabled, .btn-outline-dark:disabled {
        color: #343a40;
        background-color: transparent;
        }

        .btn-outline-dark:not(:disabled):not(.disabled):active, .btn-outline-dark:not(:disabled):not(.disabled).active,
        .show > .btn-outline-dark.dropdown-toggle {
        color: #fff;
        background-color: #343a40;
        border-color: #343a40;
        }

        .btn-outline-dark:not(:disabled):not(.disabled):active:focus, .btn-outline-dark:not(:disabled):not(.disabled).active:focus,
        .show > .btn-outline-dark.dropdown-toggle:focus {
        box-shadow: 0 0 0 0.2rem rgba(52, 58, 64, 0.5);
        }

        .btn-link {
        font-weight: 400;
        color: #007bff;
        text-decoration: none;
        }

        .btn-link:hover {
        color: #0056b3;
        text-decoration: underline;
        }

        .btn-link:focus, .btn-link.focus {
        text-decoration: underline;
        }

        .btn-link:disabled, .btn-link.disabled {
        color: #6c757d;
        pointer-events: none;
        }

        .btn-lg, .btn-group-lg > .btn {
        padding: 0.5rem 1rem;
        font-size: 1.25rem;
        line-height: 1.5;
        border-radius: 0.3rem;
        }

        .btn-sm, .btn-group-sm > .btn {
        padding: 0.25rem 0.5rem;
        font-size: 0.875rem;
        line-height: 1.5;
        border-radius: 0.2rem;
        }

        .btn-block {
        display: block;
        width: 100%;
        }

        .btn-block + .btn-block {
        margin-top: 0.5rem;
        }

        /* Prevents green disabled button */
        .btn-primary[disabled] {
            background-color: #007bff !important;
            opacity: .40;
        }

        /* Manage disabled red */
        .btn-danger[disabled] {
            background-color: #dc3545 !important;
            opacity: .40;
        }        

        /* Manage modal hidden properly */
        .modal {
            display: none;
            border-radius: 6px !important;
            padding: 0 !important;
        }

        /* modal body margin */
        .modal-body {
            margin-top: 15px;
        }

        .modal-header .close {
           margin-top: -12px;
        }

        /* Increase modal width */
        .custom-modal-50 {
            width: 50%;
            margin-left: -25%;
        }
        .custom-modal-60 {
            width: 60%;
            margin-left: -30%;
        }
        .custom-modal-80 {
            width: 80%;
            margin-left: -40%;
        }

        .modal-big {
          height: 800px;
          max-height: 400%;
          width: 80%;
          margin-left: -40%;
        }

        .modal-guts {

          /* For Splunk 7.0.x */
          /* margin-top: 30px; */

          /* other stuff we already covered */

          /* cover the modal */
          position: absolute;

          width: 90%;
          min-height: 50px;
          max-height: 650px;
          height: 100%;

          /* spacing as needed */
          padding: 20px 50px 20px 20px;

          /* let it scroll */
          overflow: auto;

        }

        /* fix some issues with long modals within Splunk 7.0.x */
        .modal-body {
            max-height: 700px !important;
        }

        .modal-header-success {
            color:#fff;
            padding:9px 15px;
            border-bottom:1px solid #eee;
            background-color: #5cb85c;
            -webkit-border-top-left-radius: 5px;
            -webkit-border-top-right-radius: 5px;
            -moz-border-radius-topleft: 5px;
            -moz-border-radius-topright: 5px;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
        }
        .modal-header-warning {
            color:#fff;
            padding:9px 15px;
            border-bottom:1px solid #eee;
            background-color: #f0ad4e;
            -webkit-border-top-left-radius: 5px;
            -webkit-border-top-right-radius: 5px;
            -moz-border-radius-topleft: 5px;
            -moz-border-radius-topright: 5px;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
        }
        .modal-header-danger {
            color:#fff;
            padding:9px 15px;
            border-bottom:1px solid #eee;
            background-color: #d9534f;
            -webkit-border-top-left-radius: 5px;
            -webkit-border-top-right-radius: 5px;
            -moz-border-radius-topleft: 5px;
            -moz-border-radius-topright: 5px;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
        }
        .modal-header-info {
            color:#fff;
            padding:9px 15px;
            border-bottom:1px solid #eee;
            background-color: #5bc0de;
            -webkit-border-top-left-radius: 5px;
            -webkit-border-top-right-radius: 5px;
            -moz-border-radius-topleft: 5px;
            -moz-border-radius-topright: 5px;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
        }
        .modal-header-primary {
            color:#fff !important;
            padding:9px 15px !important;
            border-bottom:1px solid #eee !important;
            background-color: #428bca !important;
            -webkit-border-top-left-radius: 5px !important;
            -webkit-border-top-right-radius: 5px !important;
            -moz-border-radius-topleft: 5px !important;
            -moz-border-radius-topright: 5px !important;
            border-top-left-radius: 5px !important;
            border-top-right-radius: 5px !important;
        }

        /* Fix link input object align */
        .input-linklist {
          display: inline !important;
        }

        /* Fix link input object align for Splunk 6.5 */
        .input-link {
          display: inline !important;
        }

        /* reduce size of the token input panel */
        .input-link label{
          display: none !important;
        }

        .splunk-choice-input-message{
          display: none !important;
        }

        /* Increase the default max-width for links */
        .btn-pill {
          max-width: 600px !important;
        }

        .custom-btn {
            float: left;
            margin-top:15px;
        }

        /*Notification alerts*/

        [class^="boxnotify"] {
          position: fixed;
          bottom: 1em;
          left: 1em;
          z-index: 999999;
        }

        [class^="boxnotify"] p {
          background-color: rgba(0, 0, 0, .7);
          width: 600px;
          border-radius: 5px;
          padding: .7em;
          margin: .5em;
          color: white;
          font-size: 1.6em;
          display: none;
        }

        span.title_yellow {
            background: #ffd700;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_orange {
            background: #ffb347;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_blue {
            background: #89cff0;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_green {
            background: #77dd77;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_red {
            background: #ff6961;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_grey {
            background: #808080;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_low_priority {
            background: #cce5ff;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_medium_priority {
            background: #7fbfff;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_high_priority {
            background: #3298ff;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        .status_message_orange {
            background-color: #ffd394;
            margin: 30px 0;
            padding: 10px;
            border-radius: 3px 3px 3px 3px;
            margin-bottom: 80px;
        }

        .status_message_blue {
            background-color: #cfebf9;
            margin: 30px 0;
            padding: 10px;
            border-radius: 3px 3px 3px 3px;
            margin-bottom: 80px;
        }

        .status_message_green {
            background-color: #b6edb6;
            margin: 30px 0;
            padding: 10px;
            border-radius: 3px 3px 3px 3px;
            margin-bottom: 80px;
        }

        .status_message_red {
            background-color: #FFBABA;
            margin: 30px 0;
            padding: 10px;
            border-radius: 3px 3px 3px 3px;
            margin-bottom: 80px;
        }

        .generic_message_blue {
            background-color: #cfebf9;
            margin: 30px 0;
            padding: 10px;
            border-radius: 3px 3px 3px 3px;
        }

        .imgheader {
           margin-top: 10px;
           margin-bottom: 40px;
        }

        .imgheader img {
            float: left;
            width: 48px;
            height: 48px;
        }

        .imgheader h1 {
            color: lightslategrey;
            text-align: left;
            position: relative;
            top: 9px;
            left: 10px;
        }

        .imgheader h3 {
            position: relative;
            top: 14px;
            left: -10px;
        }

        .imgheader {
           margin-top: 10px;
           margin-bottom: 40px;
        }

        .imgheader36 img {
            float: left;
            width: 36px;
            height: 36px;
        }

        .imgheader36 h1 {
            color: lightslategrey;
            text-align: left;
            position: relative;
            top: 9px;
            left: 10px;
        }

        .imgheader36 h3 {
            position: relative;
            top: 8px;
            left: -10px;
        }

        .imgminiheader img {
            position: relative;
            top: -4px;
        }

        /* Table icons */

        .ico_good,
        .ico_warn,
        .ico_error,
        .ico_ack,
        .ico_unknown {
            display:inline-block;
            text-align: center;
            width: 30px;
            height: 30px;
            line-height: 30px;
            position:relative;
        }

        .ico_good {
            color: white;
            background-color: #39ba23;
            border-radius: 50%;
            font-size: 24px;
        }
        .ico_good .icon-check {
            color: #ffffff !important;
        }
        .ico_warn {
            color: #ffa500;
            font-size: 39px;
        }
        .ico_error {
            color: white;
            background-color: #d54642;
            border-radius: 10%;
            font-size: 25px;
        }
        .ico_unknown  {
            color: white;
            background-color: rgb(26, 150, 240);
            border-radius: 50%;
            font-size: 24px;
        }
        .ico_ack {
            color: #d54642;
            font-size: 39px;
        }

        .ico_small.ico_good,
        .ico_small.ico_warn,
        .ico_small.ico_ack,
        .ico_small.ico_error,
        .ico_small.ico_unknown {
            width: 18px;
            height: 18px;
            line-height: 18px;
        }
        .ico_small.ico_good {
            font-size: 15px;
        }
        .ico_small.ico_warn {
            font-size: 26px;
            width: 20px;
        }
        .ico_small.ico_ack {
            font-size: 35px;
            width: 20px;
        }
        .ico_small.ico_error {
            font-size: 15px;
        }
        .ico_small.ico_unknown  {
            font-size: 15px;
        }

        .tooltip-inner {
            max-width: 1600px;
            text-align: left;
            font-size: 14px;
            font-weight: normal;
        }

        /* Timeline viz */
        .ccat-green {
             fill: #77dd77 !important;
             stroke: #77dd77 !important;
        }
  
        .ccat-red {
             fill: #ff6961 !important;
             stroke: #ff6961 !important;
        }

        .ccat-blue {
             fill: #89cff0 !important;
             stroke: #89cff0 !important;
        }

        .ccat-orange {
             fill: #ffb347 !important;
             stroke: #ffb347 !important;
        }

        .ccat-yellow {
             fill: #ffd700 !important;
             stroke: #ffd700 !important;
        }
           
        .ccat-grey {
             fill: #808080 !important;
             stroke: #808080 !important;
        }

        </style>
</head>
<body class="simplexml preload locale-en" data-splunk-version="" data-splunk-product="enterprise">
<!--
BEGIN LAYOUT
This section contains the layout for the dashboard. Splunk uses proprietary
styles in <div> tags, similar to Bootstrap's grid system.
-->
<header>
    <a class="navSkip" href="#navSkip" tabindex="1">Screen reader users, click here to skip the navigation bar</a>
    <div class="header splunk-header">
        <div id="placeholder-splunk-bar">
            <a href="{{SPLUNKWEB_URL_PREFIX}}/app/launcher/home" class="brand" title="splunk &gt; listen to your data">splunk<strong>&gt;</strong></a>
        </div>
        <div id="placeholder-app-bar"></div>
    </div>
    <a id="navSkip"></a>
</header>
<div class="dashboard-body container-fluid main-section-body" data-role="main">
    <div class="dashboard-header clearfix">
        <h2>TrackMe - Data tracking system</h2>
         <p>Monitoring your Splunk data availability made easy</p>
    </div>

    <div style="display: none;" class="fieldset">
    </div>

    <!--
    Object tags
    -->

    <!-- Modal window define for identity card association -->
    <div class="modal fade custom-modal-80" id="modal_data_host_tags" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                <div class="dashboard-element html" id="body_data_host_tags">
                    <div class="panel-body html">

                        <div class="modal-header modal-header-info">
                            <h1 style="font-size: 18px; color: white;">Enrichment tags: $tk_data_host$</h1>
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                        </div>
                    </div>
                </div>
                <div class="modal-body">
                    <div id="rowGetTagsDataHost" class="dashboard-row dashboard-row1">
                        <div id="panelGetTagsDataHost" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div class="imgheader36">
                                        <img style="float: left; margin: 0px 15px 15px 0px;" src="../../static/app/trackme/icons/tags.png"/></span>
                                        <h3>Object tags:</h3>
                                        <br />
                                    </div>
                                </div>

                                <div class="panel-element-row">
                                    <div id="elementGetTagsDataHost" class="dashboard-element table" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_back_data_host_tags" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window define for identity card association -->
    <div class="modal fade custom-modal-80" id="modal_metric_host_tags" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                <div class="dashboard-element html" id="body_metric_host_tags">
                    <div class="panel-body html">

                        <div class="modal-header modal-header-info">
                            <h1 style="font-size: 18px; color: white;">Enrichment tags: $tk_metric_host$</h1>
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                        </div>
                    </div>
                </div>
                <div class="modal-body">
                    <div id="rowGetTagsMetricHost" class="dashboard-row dashboard-row1">
                        <div id="panelGetTagsMetricHost" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div class="imgheader36">
                                        <img style="float: left; margin: 0px 15px 15px 0px;" src="../../static/app/trackme/icons/tags.png"/></span>
                                        <h3>Object tags:</h3>
                                        <br />
                                    </div>
                                </div>

                                <div class="panel-element-row">
                                    <div id="elementGetTagsMetricHost" class="dashboard-element table" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_back_metric_host_tags" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window for metrics search and report -->
    <div class="modal fade custom-modal-80" id="metric_hosts_search_and_reports" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-info">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Metric store - Search & Reports </h1>
                </div>

                <div class="modal-body">

                    <div id="rowMetricHostSearchAndReport" class="dashboard-row dashboard-row1" data-original-id="rowMetricHostSearchAndReport">
                        <div id="panelMetricHostSearchAndReport" class="dashboard-cell" style="width: 100%;" data-original-id="panelMetricHostSearchAndReport">
                            <div class="dashboard-panel clearfix">
                                
                                <div class="panel-element-row">
                                    <div style="margin-right: 15px; text-align: center;">
                                        <a class="btn btn-primary" style="margin-right: 20px;" id="btn_search_metric_host_live_report" target="_blank" href="search_metric_source_live_report_url" role="button">Metrics live report</a>
                                        <a class="btn btn-primary" style="margin-right: 20px;" id="btn_search_metric_host" target="_blank" href="search_metric_source_url" role="button">Metrics mcatalog report</a>
                                        <a class="btn btn-primary" style="margin-right: 20px;" id="btn_msearch_metric_host" target="_blank" href="search_data_source_url" role="button">Search (msearch)</a>
                                        <a class="btn btn-primary" style="margin-right: 20px;" id="btn_mpreview_metric_host" target="_blank" href="search_data_source_url" role="button">Search (mpreview)</a>                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;" class="modal-footer">
                        <div style="margin-right: 15px; float: left;">
                            <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                        </div>
                        <div style="margin-right: 15px; float: right;">
                            <button id="btn_metric_host_search_and_report_back" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back </button>
                        </div>
                    </div>

                </div>

            </div>

        </div>
    </div>

    <!--
    Smart Status
    -->

    <!-- Modal window for Smart Status Data Source -->
    <div class="modal fade custom-modal-80" id="smart_status_data_source" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-info">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Smart Status </h1>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h3>The Smart Status performs advanced investigations and correlations dynamically depending on the state of the data source and the conditions:</h3>
                            </div>

                        </div>

                    </div>

                    <div id="rowSmartStatusDataSource" class="dashboard-row dashboard-row1" data-original-id="rowSmartStatusDataSource">
                        <div id="panelSmartStatusDataSource" class="dashboard-cell" style="width: 100%;" data-original-id="panelSmartStatusDataSource">
                            <div class="dashboard-panel clearfix">
                                
                                <div class="panel-element-row">
                                    <div id="eventSmartStatusDataSource" class="dashboard-element event" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;" class="modal-footer">
                        <div style="margin-right: 15px; float: left;">
                            <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                        </div>
                        <div style="margin-right: 15px; float: right;">
                            <button id="btn_smart_status_data_source_back" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back </button>
                        </div>
                        <div style="margin-right: 15px; float: right;">
                            <a class="btn btn-primary" id="btn_smart_status_data_source_history" target="_blank" href="search_data_source_smart_status" role="button">Search alert actions history</a>
                        </div>
                    </div>

                </div>

            </div>

        </div>
    </div>

    <!-- Modal window for Smart Status Data Host -->
    <div class="modal fade custom-modal-80" id="smart_status_data_host" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-info">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Smart Status </h1>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h3>The Smart Status performs advanced investigations and correlations dynamically depending on the state of the data host and the conditions:</h3>
                            </div>

                        </div>

                    </div>

                    <div id="rowSmartStatusDatatHost" class="dashboard-row dashboard-row1" data-original-id="rowSmartStatusDataHost">
                        <div id="panelSmartStatusDataHost" class="dashboard-cell" style="width: 100%;" data-original-id="panelSmartStatusDataHost">
                            <div class="dashboard-panel clearfix">
                                
                                <div class="panel-element-row">
                                    <div id="eventSmartStatusDataHost" class="dashboard-element event" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;" class="modal-footer">
                        <div style="margin-right: 15px; float: left;">
                            <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                        </div>
                        <div style="margin-right: 15px; float: right;">
                            <button id="btn_smart_status_data_host_back" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back </button>
                        </div>
                        <div style="margin-right: 15px; float: right;">
                            <a class="btn btn-primary" id="btn_smart_status_data_host_history" target="_blank" href="search_data_host_smart_status" role="button">Search alert actions history</a>
                        </div>
                    </div>

                </div>

            </div>

        </div>
    </div>

    <!-- Modal window for Smart Status Metric Host -->
    <div class="modal fade custom-modal-80" id="smart_status_metric_host" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-info">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Smart Status </h1>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h3>The Smart Status performs advanced investigations and correlations dynamically depending on the state of the Metric Host and the conditions:</h3>
                            </div>

                        </div>

                    </div>

                    <div id="rowSmartStatusDatatHost" class="dashboard-row dashboard-row1" data-original-id="rowSmartStatusMetricHost">
                        <div id="panelSmartStatusMetricHost" class="dashboard-cell" style="width: 100%;" data-original-id="panelSmartStatusMetricHost">
                            <div class="dashboard-panel clearfix">
                                
                                <div class="panel-element-row">
                                    <div id="eventSmartStatusMetricHost" class="dashboard-element event" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;" class="modal-footer">
                        <div style="margin-right: 15px; float: left;">
                            <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                        </div>
                        <div style="margin-right: 15px; float: right;">
                            <button id="btn_smart_status_metric_host_back" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back </button>
                        </div>
                        <div style="margin-right: 15px; float: right;">
                            <a class="btn btn-primary" id="btn_smart_status_metric_host_history" target="_blank" href="search_metric_host_smart_status" role="button">Search alert actions history</a>
                        </div>
                    </div>

                </div>

            </div>

        </div>
    </div>

    <!--
    tags
    -->

    <!-- Modal window for tags policies -->
    <div class="modal fade custom-modal-80" id="manage_tags_policies" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-info">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Tags policies </h1>
                </div>

                <div class="modal-body">

                    <div class="boxnotify" id="boxnotify-manage-tags-policies">
                    </div>

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h3>Tags policies:</h3>
                                <lu>
                                    <li>Tags can be automatically defined by creating tags policies, if defined tags policies are automatically applied by the data source trackers</li>
                                    <li>Tags policies use regular expression rules to match the data source naming convention (field data_name), and apply one or more tags automatically</li>
                                    <li>If there are any tags that were manually applied on a data source, tags will be merged automatically</li>
                                    <li>After you create new tags policies, run the data source tracker to apply immediately, or wait for scheduled executions</li>
                                </lu>

                            </div>

                        </div>

                    </div>

                    <div id="rowTagsPolicies" class="dashboard-row dashboard-row1">
                        <div id="panelTagsPolicies" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div id="tableTagsPolicies" class="dashboard-element table" style="width: 100%">
                                            <label>Tags policies currently defined:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="rowTagsPoliciesEmpty" class="dashboard-row dashboard-row" data-rejects="$show_tags_policies$">
                        <div id="panelTagsPoliciesEmpty" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div style="text-align: center; margin-top: 50px;" class="modal-body">
                                        <h3 style="color: lightslategray;">There are no tags policies currently defined.</h3>
                                        <br /><br />
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div style="margin-top: 20px;" class="modal-footer">
                        <div style="margin-right: 15px; float: left;">
                            <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                        </div>
                        <div class="btn_data_sampling_custom_rules_delete" style="margin-right: 15px; float: right;">
                            <button type="submit" id="btn_modal_tags_policies_delete" class="btn btn-default btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                        </div>
                        <div style="margin-right: 15px; float: right;">
                            <button id="btn_tags_policies_create" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Create policy </button>
                        </div>
                    </div>

                </div>

            </div>

        </div>
    </div>

    <div class="modal fade custom-modal-80" id="tags_policies_create_policy" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Tags policies: create new policy </h1>
                </div>
                <div class="modal-body">
                    <b>Use this interface to create and manage tags policies:</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-add_tags_policies">
                    </div>

                    <div id="rowTagsPoliciesNewAdd1a" class="dashboard-row dashboard-row3">

                        <div id="rowTagsPoliciesNewAdd1b" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">

                                    <div class="input input-text" id="modal_input_tags_policies_policy_id" style="margin-bottom: 10px; max-width: 300px;">
                                        <label>Enter a unique name for this policy:</label>
                                    </div>

                                    <form style="margin: 0 0 0px;">
                                        <fieldset>
                                            <legend style="margin-bottom: 5px;">Regular expression rule:</legend>
                                            <p>                                                
                                                <label>Example: <code>^network_amer:.*</code> </br />would match all data sources related to an index starting by network_* such as: <code>network_amer:pan:traffic</code><br /></label>
                                                <textarea
                                                        id = "modal_input_tags_policies_regex"
                                                        rows = "3"
                                                        cols = "80" style="width: 1100px;"
                                                        onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">Enter a valid regular expression to match data source names.</textarea>
                                            </p>

                                        </fieldset>
                                    </form>

                                    <form style="margin: 0 0 0px;">
                                        <fieldset>
                                            <legend style="margin-bottom: 5px;">List of tags:</legend>
                                            <p>                                                
                                                <label>Example: <code>network,PII,AMER</code> </br />would apply these tags to every data source was matched by the regular expression policy<br /></label>
                                                <textarea
                                                        id = "modal_input_tags_policies_values"
                                                        rows = "3"
                                                        cols = "80" style="width: 1100px;"
                                                        onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">Enter a list of tags to applied separeted by commas to specify multiple tags and click on "Run policy simulation".</textarea>
                                            </p>

                                        </fieldset>
                                    </form>

                                    <div style="margin-top: 15x;">
                                        <div style="margin-right: 15px; float: left;">
                                            <button type="submit" id="btn_modal_tags_policies_simulate" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Run policy simulation</button>
                                        </div>
                                        <div style="margin-right: 15px; float: left;">
                                            <button type="submit" id="btn_modal_tags_policies_add" class="btn btn-default btn-danger"><span class="glyphicon glyphicon-remove"></span> Add this new policy</button>
                                        </div>
                                    </div>

                                </div>

                                <br />
                                <br />

                            </div>

                        </div>

                    </div>

                    <div id="rowTagsPoliciesNewAdd1c" class="dashboard-row dashboard-row1" data-depends="$start_simulation_tags_policies$">
                        <div id="panelTagsPoliciesNewAdd1c" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div id="tableTagsPoliciesSimulate" class="dashboard-element table" style="width: 100%;">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_tags_policies_add_back" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                </div>

            </div>
        </div>
    </div>

    <!-- Tags policy confirm add -->
    <div class="modal fade" id="tags_policies_create_policy_confirm" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span>Tags policies</h1>
                </div>
                <div class="modal-body">
                    <p><b>Confirm tag policy addition action?</b><br />
                    </p>

                    <p>
                        <label>Optional: enter a note of this update. <br />
                            This note will be logged and made available for notification.</label>
                        <textarea
                                id = "input_add_tags_policy_sampling_comment"
                                rows = "6"
                                cols = "160" style="width: 500px;"
                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                    </p>

                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_add_tags_policy_confirm" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Tags policy confirm delete -->
    <div class="modal fade" id="tags_policies_delete_policy_confirm" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span>Tags policies</h1>
                </div>
                <div class="modal-body">
                    <p><b>Confirm tag policy deletion action?</b><br />
                    </p>

                    <p>
                        <label>Optional: enter a note of this update. <br />
                            This note will be logged and made available for notification.</label>
                        <textarea
                                id = "input_delete_tags_policy_sampling_comment"
                                rows = "6"
                                cols = "160" style="width: 500px;"
                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                    </p>

                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_delete_tags_policy_confirm" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for tags -->
    <div id="main_manage_tags" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade custom-modal-50" id="manage_tags" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_manage_tags">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-info">
                                    <h1 style="font-size: 18px; color: white;">Tags for data source: $tk_data_name$</h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div style="margin-top:10px; margin-left: 20px;">

                                    <div class="imgheader">
                                        <img style="float: left; margin: 0px 15px 15px 0px;" src="../../static/app/trackme/icons/identity_card.png"/></span>
                                        <h3>Tags:</h3>
                                        <br />
                                    </div>

                                    <div class="generic_message_blue" style="max-width: 95%;">
                                      <h2 style="font-weight: bold;">$tk_tags$</h2>
                                    </div>

                                </div>

                            </div>
                        </div>
                    <div class="modal-footer">
                        <div style="float: left;" class="custom-btn">
                            <button type="submit" style="margin-right: 15px;" id="btn_back_manage_tags" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                        </div>
                        <div style="float: right;" class="custom-btn">
                            <button type="submit" style="margin-right: 15px;" id="btn_close_manage_tags" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                        </div>
                        <div style="float: right;" class="custom-btn">
                            <button type="submit" style="margin-right: 15px;" id="btn_modify_manage_tags" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: manual tags</button>
                        </div>
                        <div style="float: right;" class="btn_modify_tags_policies custom-btn">
                            <button type="submit" style="margin-right: 15px;" class="btn btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: tags policies</button>
                        </div>
                    </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for tags -->
    <div id="main_manage_tags" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade custom-modal-50" id="update_tags" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_update_tags">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-info">
                                    <h1 style="font-size: 18px; color: white;">Update tags</h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div class="boxnotify" id="boxnotify-manage_tags">
                                </div>
            
                                <div style="margin-top:10px; margin-left: 20px;">

                                    <div id="rowUpdateTags1a" class="dashboard-row dashboard-row3">
                                        <div id="panelUpdateTags1" class="dashboard-cell" style="width: 100%;">
                
                                            <div class="dashboard-panel clearfix">
                                                <div class="panel-element-row">
                                                    <div class="fieldset">
                                                        <div style="margin-bottom: 20px;">
                                                            <h3>
                                                            This interface allows to manually define tags per data source, to define tags based on policies, use the tags policies instead.
                                                            <br />
                                                            When both policies and manual tags are applied, the tags are automatically merged.
                                                            </h3>
                                                        </div>
                                                        <div class="input input-text" id="modal_input_tags_new" style="margin-bottom: 10px;">
                                                            <label>Enter a new tag to be added to this data source:</label>
                                                        </div>
                                                        <div style="margin-bottom: 10px;">
                                                            <button id="btn_modal_tags_add" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Add this tag</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                
                                        </div>
                
                                    </div>
                
                                    <div id="rowUpdateTags2" class="dashboard-row dashboard-row3" data-depends="$show_tags_multiselect$">
                                        <div id="panelUpdateTags2" class="dashboard-cell" style="width: 100%;">
                                            <div class="dashboard-panel clearfix">
                                                <div class="panel-element-row">
                                                    <div class="fieldset">
                                                        <div class="input input-dropdown" id="modal_input_tags_update" style="margin-bottom: 10px;">
                                                            <label>List of current tags for this data source, unselect a tag to remove it and click on the save button:</label>
                                                        </div>
                                                        <div style="margin-bottom: 10px;">
                                                            <button id="btn_modal_tags_save" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Save tags</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="rowUpdateTags3" class="dashboard-row dashboard-row3" data-depends="$show_tags_multiselect$">
                                        <div id="panelUpdateTags2" class="dashboard-cell" style="width: 100%;">
                                            <div class="dashboard-panel clearfix">
                                                <div class="panel-element-row">
                                                    <div class="fieldset">
                                                        <p>To remove all current tags, click on the following button:</p>
                                                        <div style="margin-bottom: 10px;">
                                                            <button id="btn_modal_tags_clear" type="submit" class="btn btn-default btn-danger"><span class="glyphicon glyphicon-remove"></span> Clear all tags</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>                                    

                                </div>

                            </div>

                            <div class="modal-footer">
                                <button type="submit" id="btn_back_update_tags" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                                <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                            </div>        

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--
    identity card
    -->

    <!-- Modal drilldown context for identity card -->
    <div id="main_manage_identity_card" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade custom-modal-50" id="manage_identity_card" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_manage_identity_card">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-info">
                                    <h1 style="font-size: 18px; color: white;">Identity card for data source: $tk_data_name$</h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div class="modal-body">

                                    <div id="rowIdentityCard1" class="dashboard-row dashboard-row1">
                                        <div id="panelIdentityCard1" class="dashboard-cell" style="width: 100%;">
                                            <div class="dashboard-panel clearfix">
                                                <div class="panel-element-row">

                                                    <div class="imgheader">
                                                        <img style="float: left; margin: 0px 15px 15px 0px;" src="../../static/app/trackme/icons/identity_card.png"/></span>
                                                        <h3>Identity card note:</h3>
                                                        <br />
                                                    </div>
                
                                                    <div class="generic_message_blue" style="max-width: 95%;">
                                                        <h2 style="font-weight: bold;">$tk_doc_note$</h2>
                                                    </div>  
                
                                                    <div style="margin-bottom: 20px;">
                                                        <h3>Link to documentation: </h3><a target="_blank" href="$tk_doc_link$">$tk_doc_link$</a>
                                                    </div>
                
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="rowIdentityCard2" class="dashboard-row dashboard-row1">
                                        <div id="panelIdentityCard2" class="dashboard-cell" style="width: 100%;">
                                            <div class="dashboard-panel clearfix">
                                                <div class="panel-element-row">

                                                    <div>
                                                        <hr>
                                                        <p><i>$tk_msg_doc_identity_card_is_global$ <a target="_blank" href="https://trackme.readthedocs.io/en/latest/userguide.html#data-identity-card">https://trackme.readthedocs.io/en/latest/userguide.html#data-identity-card</a></i></p>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>

                            </div>
                        </div>
                    <div class="modal-footer">
                        <button type="submit" id="btn_delete_manage_identity_card" class="btn btn-default btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Delete card</button>
                        <button type="submit" id="btn_modify_manage_identity_card" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Update card</button>
                        <button type="submit" id="btn_back_manage_identity_card" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                        <button type="submit" id="btn_close_manage_identity_card" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                    </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window define for identity card -->
    <div class="modal fade custom-modal-60" id="define_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h1>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <form>
                                <fieldset>
                                    <legend>Define a link and a note to document this data source</legend>
                                    <p><b>You can create wildcard matching ID cards to match multiple entities based on your naming convention using the trackme SPL command.</b><br/><i>Open a new tab to: <a target="_blank" href="https://trackme.readthedocs.io/en/latest/userguide.html#data-identity-wildcard-matching">https://trackme.readthedocs.io/en/latest/userguide.html#data-identity-wildcard-matching</a></i></p>
                                    <p>
                                        <label>Optional: enter the documentation link, this will be made available in the source identity card:</label>
                                        <input type = "text"
                                               id = "input_doc_link"
                                               value = "link to documentation"
                                               style="width: 900px;"
                                               onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;"/>
                                    </p>

                                    <p>
                                        <label>Optional: enter a documentation note:</label>
                                        <textarea
                                                id = "input_doc_note"
                                                rows = "10"
                                                cols = "160" style="width: 900px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">documentation note</textarea>
                                    </p>

                                </fieldset>
                            </form>

                            <div style="float: left;">

                                <div class="btn_define_identity_card custom-btn" style="margin-right: 15px;">
                                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Create or update this record </button>
                                </div>

                                <div class="btn_associate_identity_card custom-btn" style="margin-right: 15px;">
                                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Or associate with an existing record </button>
                                </div>

                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_define_identity_card_back" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window define for identity card association -->
    <div class="modal fade custom-modal-80" id="associate_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h1>
                </div>
                <div class="modal-body">
                    <b>Associate with an existing identity card:</b>
                    <br /><br />

                    <div id="rowAssociateIdentityCard" class="dashboard-row dashboard-row3">
                        <div id="panelAssociateIdentityCard" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">

                                        <div class="input input-text" id="FilterIdentityCardTable" style="margin-bottom: 10px;">
                                            <label>Filter:</label>
                                        </div>

                                        <div id="elementIdentityCardTable" class="dashboard-element table" style="width: 100%">
                                            <label>Click on a table entry to associate with an existing identity card:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_associate_identity_card_back" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window association confirmation for identity card -->
    <div class="modal fade" id="confirm_associate_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h1>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Please confirm the association of the identity card records?</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_associate_identity_card_confirm_valid" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Confirm association </button>
                    <button type="submit" id="btn_associate_identity_card_confirm_back" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window deletion for identity card -->
    <div class="modal fade" id="delete_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h1>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Please confirm the deletion of the identity card records?</h4>
                                <p>If this record is the last associated with the identity card, this identity card will be permanently removed.</p>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_delete_identity_card_confirm" class="btn btn-default btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Delete this record </button>
                    <button type="submit" id="btn_delete_identity_card_back" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window confirmation of association for identity card -->
    <div class="modal fade" id="associate_achieved_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-success">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h1>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>The identity card record was successfully associated with this source.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window confirmation of deletion for identity card -->
    <div class="modal fade" id="update_achieved_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-success">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h1>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>The identity card record was successfully created or updated.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window confirmation of deletion for identity card -->
    <div class="modal fade" id="delete_achieved_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-success">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h1>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>The identity card record was successfully deleted.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window for ack -->
    <div class="modal fade custom-modal-80" id="confirm_ack" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Acknowledge active alert </h1>
                </div>

                <div class="modal-body">

                    <div id="rowAckGet" class="dashboard-row dashboard-row3">
                        <div id="panelAckGet" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div>
                                        <h4>Do you want to acknowledge this alert?</h4>

                                        <p>When an active alert is acknowledged, it remains visible in the user interface and monitored, therefore no more
                                        alerts will be generated based on the builtin alerting for that source.
                                        <br /><br />
                                        An acknowledgment is valid for a period of time, and will be disabled automatically once its expiration time has been reached.
                                        <br />
                                        If an active acknowledgment is acknowledged again, its expiration is extended for a new cycle.
                                        <br /><br />
                                        An acknowledgment is automatically disabled when the source flips again to a green state.
                                        <br /><br />
                                        <b>Click on Confirm Ack to acknowledge this alert (if Ack is inactive), or click on the table entry if the Ack is active and you wish to disable it now.</b>
                                        </p>

                                    </div>

                                    <div class="fieldset">

                                        <div id="elementAckGet" class="dashboard-element table" style="width: 100%">
                                            <label>Current Ack status:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                        <br />
                                        <br />

                                        <div class="input input-dropdown" id="input_ack_duration">
                                            <label>Ack duration:</label>
                                        </div>

                                        <br />
                                        <br />

                                        <div>
                                            <p>
                                                <label>Optional: enter a note of this acknowledgment. <br />
                                                    This note will be logged and made available for notification.</label>
                                                <textarea
                                                        id = "input_ack_comment"
                                                        rows = "6"
                                                        cols = "160" style="width: 500px;"
                                                        onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                            </p>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <div style="margin-right: 15px; float: right;">
                        <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                    </div>
                    <div class="btn_ack_confirm_valid" style="margin-right: 15px; float: right;">
                        <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Confirm Ack </button>
                    </div>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window for Data Sampling -->
    <div class="modal fade custom-modal-80" id="data_sampling_manage" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-info">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Data sampling &amp; events format recognition </h1>
                </div>

                <div class="modal-body">

                    <div class="boxnotify" id="boxnotify-manage_data_sampling">
                    </div>

                    <div>

                        <div style="margin-bottom: 10px;">
                            <div>
                                <h3 style="color: steelblue;">The data sampling and events format recognition tracks the raw events format behaviour based on the following workflow:</h3>
                                <lu>
                                    <li>On a regular basis, a sample of the latest data source raw events is taken and investigated by the Data sampling and format detection tracker</li>
                                    <li>Events format recognition is performed against builtin regular expression rules to identify a unique event pattern, which can be extended with custom rules to hande unknown or custom formats</li>
                                    <li>Depending on the conditions, such as a change detected in the format of the raw events, a status is determined and taken into account by the data sources trackers</li>
                                </lu>
                            </div>
                        </div>

                        <div style="margin-bottom: 20px;">
                            <img src="../../static/app/trackme/mindmaps/data_sampling_main.png" alt="data_sampling_main.png">
                        </div>

                        <div style="margin-bottom: 10px;">
                            <span><a target="_blank" href="https://trackme.readthedocs.io/en/latest/userguide.html#data-sampling-and-event-formats-recognition">Link to documentation</a></span> / <span><a target="_blank" href="trackMe_audit_data_sampling">Link to data sampling audit dashboard</a></span>
                        </div>
                        
                        <div style="margin-bottom: 10px;">
                            <div>
                                <h3 style="color: steelblue;">Acting on a data sampling and events format recognition anomaly detection:</h3>
                                <lu>
                                    <li>If during the discovery multiple events formats are detected, the feature is automatically disabled to avoid generating false positive alerts</li>
                                    <li>If a certain format was previously identified and during the next iteration a format change is detected, an anomaly state will be raised</li>
                                    <li>Once an anomaly was raised, the anomaly status is frozen and will not be cleared until a manual action is performed by running the "Clear state and run sampling" action</li>
                                    <li>When the clear state action is performed, previously identified information for that data source are cleared, and the data sampling inspection starts over</li>
                                </lu>
                            </div>
                        </div>

                    </div>

                    <div id="rowDataSamplingSummary" class="dashboard-row dashboard-row1">
                        <div id="panelDataSamplingSummary" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div id="tableDataSamplingSummary" class="dashboard-element table" style="width: 100%;">
                                            <label>Data sampling summary for this data source:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 20px;" class="modal-footer">
                        <div class="btn_data_sampling_back" style="margin-right: 15px; float: left;">
                            <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                        </div>
                        <div style="margin-right: 15px; float: right;">
                            <button id="btn_data_sampling_disable" type="submit" class="btn btn-default btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Disable</button>
                        </div>
                        <div style="margin-right: 15px; float: right;">
                            <button id="btn_data_sampling_clear_now" type="submit" class="btn btn-default btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Clear state & run sampling</button>
                        </div>
                        <div style="margin-right: 15px; float: right;">
                            <button id="btn_data_sampling_edit_records_nr" type="submit" class="btn btn-default btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Update records/sample</button>
                        </div>
                        <div style="margin-right: 15px; float: right;">
                            <button id="btn_run_data_sampling" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Run sampling engine now</button>
                        </div>
                        <div style="margin-right: 15px; float: right;">
                            <button type="submit" id="btn_data_sampling_custom_rules_view" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage custom rules </button>
                        </div>
                        <div class="btn_data_sampling_builtin_rules" style="margin-right: 15px; float: right;">
                            <button type="submit" class="btn btn-default btn-info" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> View builtin rules </button>
                        </div>
                        <div style="margin-right: 15px; float: right;">
                            <a class="btn btn-info" id="btn_data_sampling_latest_sample" target="_blank" href="search" role="button">View latest sample events</a>
                        </div>
                    </div>

                </div>

            </div>

        </div>
    </div>

    <!-- Modal window for Data Sampling -->
    <div class="modal fade custom-modal-80" id="data_sampling_show_builtin_rules" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-info">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Data sampling &amp; events format recognition </h1>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h3>Events format recognition builtin regex rules:</h3>
                                <lu>
                                    <li>Builtin rules are applied <b>after</b> custom rules (if any)</li>
                                    <li>Builtin rules are regular expressions used to identify the type of events based on a structure (json, xml...), an expected timestamp format or a unique pattern</li>
                                    <li>These rules cover most common valuable use cases and can be easily extended by the addition of custom rules</li>
                                    <li>Shall none of the rules be matching the events formats, events will be tagged as "raw_not_identified" and the data sampling feature will be disabled automatically for that data source</li>
                                </lu>

                            </div>

                        </div>

                    </div>

                    <div id="rowDataSamplingSummary" class="dashboard-row dashboard-row1">
                        <div id="panelDataSamplingSummary" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div id="tableDataSamplingShowBuiltinRules" class="dashboard-element table" style="width: 100%">
                                            <label>Data sampling event recognition builtin rules:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 20px;" class="modal-footer">
                        <div class="btn_data_sampling_builtin_rules_back" style="margin-right: 15px; float: right;">
                            <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                        </div>
                    </div>

                </div>

            </div>

        </div>
    </div>

    <!-- Modal window for Data Sampling -->
    <div class="modal fade custom-modal-80" id="data_sampling_show_custom_rules" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-info">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Data sampling &amp; events format recognition </h1>
                </div>

                <div class="modal-body">

                    <div class="boxnotify" id="boxnotify-view_data_sampling_custom_rule">
                    </div>

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h3>Events format recognition custom regex rules:</h3>
                                <lu>
                                    <li>Custom rules, if any, are applied <b>before</b> builtin rules</li>
                                    <li>Rules are regular expressions used to identify the type of event based on a structure (json, xml...), a timestamp format or a unique pattern</li>
                                    <li>You can create as many custom rules as you need and these rules will be processed automatically during the execution of the data sampling engine</li>
                                </lu>

                            </div>

                        </div>

                    </div>

                    <div id="rowDataSamplingSummaryCustomRules" class="dashboard-row dashboard-row1">
                        <div id="panelDataSamplingSummaryCustomRules" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div id="tableDataSamplingShowCustomRules" class="dashboard-element table" style="width: 100%">
                                            <label>Data sampling event recognition custom rules:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="rowDataSamplingSummaryCustomRulesEmpty" class="dashboard-row dashboard-row" data-rejects="$show_table_data_sampling_custom_rules$">
                        <div id="panelDataSamplingSummaryCustomRulesEmpty" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div style="text-align: center; margin-top: 50px;" class="modal-body">
                                        <h3 style="color: lightslategray;">There are no custom rules currently defined.</h3>
                                        <br /><br />
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div style="margin-top: 20px;" class="modal-footer">
                        <div class="btn_data_sampling_custom_rules_back" style="margin-right: 15px; float: left;">
                            <button type="submit" id="btn_data_sampling_custom_rules_back" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                        </div>
                        <div class="btn_data_sampling_custom_rules_delete" style="margin-right: 15px; float: right;">
                            <button type="submit" id="btn_modal_data_sampling_custom_rule_delete" class="btn btn-default btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                        </div>
                        <div style="margin-right: 15px; float: right;">
                            <button id="btn_data_sampling_custom_rules" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Create custom rules </button>
                        </div>
                    </div>

                </div>

            </div>

        </div>
    </div>

    <div class="modal fade custom-modal-80" id="data_sampling_create_custom_rules" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Data sampling &amp; events format recognition: create custom rules </h1>
                </div>
                <div class="modal-body">
                    <b>Use this interface to create and manage custom rules for events format recognition:</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-add_data_sampling_custom_rule">
                    </div>

                    <div id="rowDataSamplingRulesAdd1a" class="dashboard-row dashboard-row1">
                        <div id="panelDataSamplingRulesAdd1a" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="fieldset">
                                    <div class="input input-text" id="modal_input_data_sampling_custom_rule_name" style="margin-bottom: 10px; max-width: 300px; width: 300px; margin-right: 30px;">
                                        <label>Enter the unique identifier of the events format recognition custom rule:</label>
                                    </div>
                                    <div class="input input-dropdown" id="modal_input_data_sampling_custom_rule_type" style="margin-bottom: 10px; width: 300px; margin-right: 30px;">
                                        <label>Choose a rule behaviour mode: (inclusive rule must match / exclusive rule must not match)</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="rowDataSamplingRulesAdd1b" class="dashboard-row dashboard-row1">
                        <div id="panelDataSamplingRulesAdd1b" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <form>
                                        <fieldset>
                                            <legend>Regular expression rule:</legend>
                                            <p>                                                
                                                <label>Example: <code>^\w{3}\s*\d{1,2}\s*\d{1,2}\:\d{1,2}\:\d{1,2}</code> </br />would match events in the following format: <code>Mar  1 00:01:51.047: %LINK-3-UPDOWN: Interface FastEthernet0/0, changed state to up</code><br /></label>
                                                <textarea
                                                        id = "modal_input_data_sampling_custom_rule_regex"
                                                        rows = "2"
                                                        cols = "80" style="width: 1100px;"
                                                        onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">Enter a valid regular expression and click on the button "Run model simulation".</textarea>
                                            </p>
                                        </fieldset>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="rowDataSamplingRulesAdd1c" class="dashboard-row dashboard-row1">
                        <div id="panelDataSamplingRulesAdd1c" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="fieldset">
                                    <div class="input input-text" id="modal_input_data_sampling_custom_sourcetype_scope" style="margin-top: -25px; margin-bottom: 20px; max-width: 500px; width: 500px; margin-right: 30px;">
                                        <label>Sourcetype scope: comma separated list of sourcetypes restricting application of this rule (wilcards and spaces not accepted)</label>
                                    </div>
                                    <div class="input input-dropdown" id="modal_input_data_sampling_dropdown" style="margin-top: -25px; margin-bottom: 20px; margin-right: 30px;">
                                        <label>Data source for show sample events action:</label>
                                    </div>
                                    <div class="input input-dropdown" id="modal_input_data_sampling_custom_st_value" style="margin-top: -25px; margin-bottom: 20px; margin-right: 30px;">
                                        <label>Sourcetype name: (for simulation only)</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="rowDataSamplingRulesAdd1d" class="dashboard-row dashboard-row1">
                        <div id="panelDataSamplingRulesAdd1d" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div style="margin-top: 15x;">
                                        <div style="margin-right: 15px; float: left;">
                                            <button type="submit" id="btn_modal_data_sampling_custom_rule_show_sample" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Show sample events</button>
                                        </div>
                                        <div style="margin-right: 15px; float: left;">
                                            <button type="submit" id="btn_modal_data_sampling_custom_rule_simulate" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Run model simulation</button>
                                        </div>
                                        <div style="margin-right: 15px; float: left;">
                                            <button type="submit" id="btn_modal_data_sampling_custom_rule_simulate_show_details" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Open simulation results in search</button>
                                        </div>
                                        <div style="margin-right: 15px; float: left;">
                                            <button type="submit" id="btn_data_sampling_custom_rule_add" class="btn btn-default btn-danger"><span class="glyphicon glyphicon-remove"></span> Add this new custom rule</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="rowDataSamplingRulesAdd1e" class="dashboard-row dashboard-row1" data-depends="$start_simulation_data_sampling_custom_rule$">
                        <div id="panelDataSamplingRulesAdd1e" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div id="tableDataSamplingSimulateCustomRule" class="dashboard-element table" style="width: 100%;">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="rowDataSamplingRulesAdd1f" class="dashboard-row dashboard-row1" data-depends="$start_simulation_data_sampling_custom_rule_show_events$">
                        <div id="panelDataSamplingRulesAdd1f" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div id="tableDataSamplingSimulateCustomRuleLatestEvent" class="dashboard-element table" style="width: 100%;">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_data_sampling_custom_rule_add_new_back" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                </div>

            </div>
        </div>
    </div>

    <!-- Modal window confirmation of association for identity card -->
    <div class="modal fade" id="ack_achieved" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-success">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Acknowledge active alert </h1>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Alert acknowledgment was successfully created.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <div class="modal fade" id="ack_disable_achieved" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-success">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Acknowledge active alert </h1>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Alert acknowledgment was successfully disabled.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <div class="modal fade" id="ack_disable_already" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-info">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Acknowledge active alert </h1>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Alert acknowledgment is already inactive.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window for ack -->
    <div class="modal fade" id="disable_ack" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Acknowledge active alert </h1>
                </div>

                <div class="modal-body">

                    <div id="rowAckDelete" class="dashboard-row dashboard-row3">
                        <div id="panelAckDelete" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div>
                                        <h4>Do you want to disable this acknowledge ?</h4>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <div style="margin-right: 15px; float: right;">
                        <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                    </div>
                    <div class="btn_ack_disable_valid" style="margin-right: 15px; float: right;">
                        <button type="submit" class="btn btn-default btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Disable Ack </button>
                    </div>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window for logical group association -->
    <div class="modal fade custom-modal-80" id="logical_group" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Logical group </h1>
                </div>
                <div class="modal-body">
                    <b>Entities logical group management</b>
                    <br /><br />

                    <div id="rowAddLogicalGroup" class="dashboard-row dashboard-row" data-depends="$show_add_logical_group$">
                        <div id="panelAddLogicalGroup" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">This entity is not currently associated to a logical group, choose one of the following options:</h3>

                                        <div style="margin-top: 20px;">
                                            <div style="float: left; margin-right: 20px;">
                                                <button type="submit" id="btn_add_logical_group_new" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Create a new group </button>
                                            </div>
                                            <div style="float: left; margin-right: 20px;">
                                                <button type="submit" id="btn_add_logical_group_member" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add to an existing group </button>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowTableLogicalGroup" class="dashboard-row dashboard-row3" data-depends="$show_table_logical_group$">
                        <div id="panelTableLogicalGroup" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">This entity is currently associated with the following logical group, if you wish to remove this
                                            membership, click on the table entry below:</h3>
                                    </div>

                                    <div class="fieldset">

                                        <div id="elementLogicalGroupTable" class="dashboard-element table" style="width: 100%">
                                            <label></label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_associate_logical_group_back" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window for logical group association -->
    <div class="modal fade custom-modal-80" id="logical_group_add_member" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Logical group </h1>
                </div>
                <div class="modal-body">
                    <b>Entities logical group management</b>
                    <br /><br />

                    <div id="rowTableLogicalGroupAddMember" class="dashboard-row dashboard-row3">
                        <div id="panelTableLogicalGroupAddMember" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">Click on a logical group in the table below to make this entity part of the group.
                                        Optionally use the filter input to search in existing groups.</h3>
                                    </div>

                                    <div class="fieldset">

                                        <div class="input input-text" id="FilterLogicalGroupTable" style="margin-bottom: 10px;">
                                            <label>Filter:</label>
                                        </div>

                                        <div id="elementLogicalGroupTableAddMember" class="dashboard-element table" style="width: 100%">
                                            <label></label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_associate_logical_group_add_member_back" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window for logical group association -->
    <div class="modal fade custom-modal-50" id="logical_group_add_group" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Logical group </h1>
                </div>
                <div class="modal-body">
                    <b>Entities logical group management</b>
                    <br /><br />

                    <div id="rowTableLogicalGroupAddGroup" class="dashboard-row dashboard-row3">
                        <div id="panelTableLogicalGroupAddGroup" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">Create a new logical group, once created the current entity will automatically be a member of it.
                                            You can then add as many members as you need to form the logical group entity.
                                        </h3>
                                    </div>

                                    <div class="fieldset">
                                        <div class="input input-text" id="InputLogicalGroupName" style="margin-bottom: 10px;">
                                            <label>Enter the logical group name:</label>
                                        </div>
                                    </div>
                                    <div class="fieldset">
                                        <div class="input input-dropdown" id="InputLogicalGroupNamePercent" style="margin-bottom: 10px;">
                                            <label>Minimal percent of members in green state:</label>
                                        </div>
                                        <div style="margin-top: 10px;">
                                            <p>A logical group of 2 members with a minimal 50% green state means one member actively generating data will not trigger alerts.</p>
                                        </div>
                                    </div>

                                    <div class="modal-body" style="margin-top: 20px;">
                                        <button type="submit" id="btn_associate_logical_group_add_group" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Create new logical group </button>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer" style="margin-top: 20px;">
                    <button type="submit" id="btn_associate_logical_group_add_group_back" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window Logical group removal -->
    <div class="modal fade" id="confirm_remove_from_logical_group" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Logical group </h1>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Do you want to remove this entity from the logical group?</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_remove_from_logical_group_confirm_valid" class="btn btn-default btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove association </button>
                    <button type="submit" id="btn_remove_from_logical_group_confirm_back" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back </button>
                </div>

            </div>

        </div>
    </div>

    <div class="modal fade" id="logical_group_removal_achieved" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-success">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Logical group </h1>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Logical group membership was successfully removed.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window Logical group removal -->
    <div class="modal fade" id="confirm_add_member_logical_group" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Logical group </h1>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Do you want to add the entity in the logical group?</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_add_logical_group_member_confirm_valid" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Confirm membership </button>
                    <button type="submit" id="btn_add_logical_group_member_confirm_back" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back </button>
                </div>

            </div>

        </div>
    </div>

    <div class="modal fade" id="logical_group_add_member_achieved" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-success">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Logical group </h1>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Logical group membership was successfully achieved.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <div class="modal fade" id="logical_group_add_achieved" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-success">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Logical group </h1>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Logical group has been successfully created, and entity associated.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal drilldown context for Alerts -->
    <div id="main_modal_manage" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade custom-modal-80" id="modal_manage" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-primary">                                    
                                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                    <h1 style="color: white;">Actions for data source: $tk_data_name$</h1>                                                                     
                                </div>

                                <div class="modal-body">

                                    <div style="line-height: 1.1; margin-left: 20px;">
                                        <div style="float:left;width:33%;">
                                            <p><b>data_index:</b> $tk_data_index$</p>
                                            <p><b>data_sourcetype:</b> $tk_data_sourcetype$</p>
                                            <p><b>lag event / lag ingestion: ([D+]HH:MM:SS)</b> $tk_data_lag_summary$</p>
                                            <p><b>data_last_time_seen:</b> $tk_data_last_time_seen_human$</p>
                                        </div>
                                        <div style="float:left;width:33%;">
                                            <p><b>data_last_ingest:</b> $tk_data_last_ingest_human$</p>
                                            <p><b>data_max_lag_allowed:</b> $tk_data_max_lag_allowed$</p>
                                            <p><b>data_monitored_state:</b> <span class="$tk_data_monitored_state_class$">$tk_data_monitored_state$</span></p>
                                            <p><b>data_monitoring_level:</b> $tk_data_monitoring_level$</p>
                                        </div>
                                        <div style="float:left;width:33%;">
                                            <p><b>latest_flip_time:</b> $tk_latest_flip_time_human$</p>
                                            <p><b>latest_flip_state:</b> $tk_latest_flip_state$</p>
                                            <p><b>state:</b> <span class="$tk_data_source_state_class$">$tk_data_source_state$</span></p>
                                            <p><b>priority:</b> <span class="$tk_priority_class$">$tk_priority$</span></p>
                                        </div>
                                    </div>

                                    <div style="margin-left: 10px;">
                                        <div class="imgheader">
                                            <img style="float: left; margin: 0px 15px 15px 0px;" src="../../static/app/trackme/icons/identity_card.png"/>
                                            <h3><span><a id="doc_link_data_source" data-toggle="modal" data-target="#$tk_doc_modal_target$">$tk_doc_link_main$</a>
                                                 / 
                                                <a id="tags_data_source" data-toggle="modal" data-target="#$tk_tags_modal_target$">$tk_tags_link_main$</a>
                                                </span>
                                            </h3>
                                        </div>
                                    </div>

                                </div>

                            </div>
                        </div>

                        <br />
                        <hr style="margin-top: -10px;">
                        
                        <div class="boxnotify" id="boxnotify-data-source">
                        </div>

                        <div id="rowLinkMain" class="dashboard-row dashboard-row1" style="margin-left: 15px; margin-top: -20px;">
                            <div id="panelLinktMain" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="input input-linklist" id="inputLinkDataSource">
                                            <label>&nbsp;</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowSingleLag" class="dashboard-row dashboard-row1" data-depends="$show_data_source_overview$">
                            <div id="panelSingleLag2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementSingleLagPerc95" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                        <div id="elementSingleLagAvg" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                        <div id="elementSingleEventLag" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                        <div id="elementSingleSLApct" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartLag" class="dashboard-row dashboard-row1" data-depends="$show_data_source_overview$">
                            <div id="panelChartLag2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div style="margin-left: 30px;" class="fieldset">
                                        <div class="input input-dropdown" id="inputDataSourceOverviewChartSeries">
                                            <label></label>
                                        </div>
                                    </div>
                                    <div class="panel-element-row">
                                        <div id="elementChartLag" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartOutlier" class="dashboard-row dashboard-row1" data-depends="$show_data_source_outlier$">
                            <div id="panelChartOutlier2" class="dashboard-cell" style="width: 100%; max-height: 350px;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementOutlier" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowTableOutlier" class="dashboard-row dashboard-row1" data-depends="$show_data_source_outlier$">
                            <div id="panelTableOutlier2" class="dashboard-cell" style="width: 100%; max-height: 90px;">
                                <div class="dashboard-panel clearfix">

                                    <div class="panel-element-row">
                                        <div id="elementOutlierTable" class="dashboard-element table" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowOutlierConfig" class="dashboard-row dashboard-row1" data-depends="$show_data_source_outlier_configuration$">
                            <div id="panelOutlierConfig" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">

                                    <div style="margin-left: 30px;" class="fieldset">
                                        <div class="input input-dropdown" id="inputDataSourceConfigOutlierEnableOutlier">
                                            <label>Enable Outlier Detection:</label>
                                        </div>
                                        <div class="input input-dropdown" id="inputDataSourceConfigOutlierAlertOnUpper">
                                            <label>Enable alert on upper Outlier:</label>
                                        </div>
                                        <div class="input input-dropdown" id="inputDataSourceConfigOutlierOutlierMinEventCountMode">
                                            <label>OutlierMinEventCount mode:</label>
                                        </div>
                                        <div style="max-width: 165px;" class="input input-text" id="inputDataSourceConfigOutlierOutlierMinEventCount">
                                            <label>OutlierMinEventCount:</label>
                                        </div>
                                        <div style="max-width: 165px;" class="input input-text" id="inputDataSourceConfigOutlierOutlierLowerThresholdMultiplier">
                                            <label>Lower threshold multiplier:</label>
                                        </div>
                                        <div style="max-width: 165px;" class="input input-text" id="inputDataSourceConfigOutlierOutlierUpperThresholdMultiplier">
                                            <label>Upper threshold multiplier:</label>
                                        </div>
                                    </div>

                                    <div style="margin-left: 42px; margin-right: 42px;">
                                        <button type="submit" id="btn_outlier_config_data_source_save" role="button" style="margin-right: 15px;" class="btn btn-primary btn-default pull-right"><span class="glyphicon glyphicon-remove"></span>Save Outliers settings</button>
                                        <button type="submit" id="btn_outlier_config_data_source_simulate" role="button" style="margin-right: 15px;" class="btn btn-primary btn-default pull-right"><span class="glyphicon glyphicon-remove"></span>Simulate Outliers settings</button>
                                    </div>

                                    <div class="boxnotify" id="boxnotify-data-source-outliers-update">
                                    </div>

                                </div>
                            </div>
                        </div>

                        <div id="rowOutlierConfigChartSimulation" class="dashboard-row dashboard-row1" data-depends="$show_data_source_outlier_configuration$, $start_outliers_simulation_data_source$">
                            <div id="panelOutlierConfigChartSimulation" class="dashboard-cell" style="width: 100%; max-height: 350px;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementOutlierSimulation" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowSingleParsingQuality" class="dashboard-row dashboard-row1" data-depends="$show_data_quality$,$show_data_quality_no_results$">
                            <div id="panelSingleParsingQuality" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementSearchDataSourceParsingQualitySingle" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowDataSampling" class="dashboard-row dashboard-row2" data-depends="$show_data_sampling$">
                            <div id="panelDataSampling" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">

                                    <div class="panel-element-row">
                                        <div class="dashboard-element html" id="body_data_source_data_sampling" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="$tk_data_sampling_status_message_class$">
                                                    <h2 style="font-weight: bold;">$tk_data_sampling_status_message$</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="panel-element-row">
                                        <div class="dashboard-element html" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="btn_data_sampling_manage" style="margin-left: 42px; margin-right: 42px;">
                                                    <button id="btn_data_sampling_manage" type="submit" role="button" style="margin-right: 15px;" class="btn btn-outline-primary pull-right"><span class="glyphicon glyphicon-remove"></span>Manage data sampling</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>

                        <div id="rowChartParsingQuality" class="dashboard-row dashboard-row1" data-depends="$show_data_quality$,$show_data_quality_no_results$">
                            <div id="panelChartParsingQuality" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="panel-head">
                                            <h3>CAUTION: Indexing time parsing errors happen on the sourcetype level, if this sourcetype is indexing to more than one index, these errors may not apply to this index / sourcetype combination</h3>
                                        </div>
                                        <div id="elementSearchDataSourceParsingQualityChart" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartParsingQualityNoResults" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_data_quality$" data-rejects="$show_data_quality_no_results$">
                            <div id="panelChartParsingQualityNoResults" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div class="dashboard-element html" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="status_message_green">
                                                    <h2 style="font-weight: bold;">No indexing parsing errors detected within the period</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowSingleByMetricsLag" class="dashboard-row dashboard-row1" data-depends="$show_data_source_lagging_metrics$">
                            <div id="panelSingleLag2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementSingleLagByMetricsPerc95" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                        <div id="elementSingleLagByMetricsAvg" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                        <div id="elementSingleEventByMetricsLag" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowLaggingMetricsDataSource" class="dashboard-row dashboard-row1" data-depends="$show_data_source_lagging_metrics$">
                            <div id="panelLaggingMetricsDataSourceChart" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div style="margin-left: 30px;" class="fieldset">
                                        <div class="input input-dropdown" id="inputDataSourceOverviewMetricsChartSeries">
                                            <label></label>
                                        </div>
                                    </div>
                                    <div class="panel-element-row">
                                        <div id="chartLaggingMetricDataSourceOverTime" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditFlipDataSource" class="dashboard-row dashboard-row1" data-original-id="rowAuditFlipDataSourceTop" data-depends="$show_flipping_status$,$show_flipping_status_no_results$">
                            <div id="panelAuditFlipDataSourceChart" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="chartAuditFlipDataSourceOverTime" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-head">
                                                <h3>Flip over time</h3>
                                            </div>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditFlipDataSourceTable" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_flipping_status$,$show_flipping_status_no_results$">
                            <div id="panelAuditFlipDataSourceTable" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div id="elementMainTableAuditFlipDataSource" class="dashboard-element table" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditFlipDataSourceNoResults" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_flipping_status$" data-rejects="$show_flipping_status_no_results$">
                            <div id="panelAuditFlipDataSourceNoResults" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div class="dashboard-element html" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="status_message_green">
                                                    <h2 style="font-weight: bold;">No flipping status detected within the period</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowStatusMessageDataSource" class="dashboard-row dashboard-row2" data-depends="$show_data_source_status_message$">
                            <div id="panelStatusMessageDataSource" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">

                                    <div class="panel-element-row">
                                        <div class="dashboard-element html" id="body_data_source_status_message" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="$tk_data_source_status_message_class$">
                                                    <h2 style="font-weight: bold;">$tk_status_message$</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="row_data_source_timeline" style="margin-top: -80px; max-height: 200px !important" class="dashboard-row dashboard-row2">
                                        <div id="panel_data_source_timeline" class="dashboard-cell" style="width: 100%;">
                                            <div class="dashboard-panel clearfix">
                                                
                                                <div class="panel-element-row">
                                                    <div id="TimelineDataSource" class="dashboard-element viz" style="width: 100%">
                                                        <div class="panel-head">
                                                            <h3>Last 7 days timeline</h3>
                                                        </div>
                                                        <div class="panel-body"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>

                        <div id="rowAuditChangesDataSource" class="dashboard-row dashboard-row1" data-original-id="rowAuditChangesDataSourceTop" data-depends="$show_data_source_audit_changes$,$show_data_source_audit_changes_no_results$">
                            <div id="panelAuditChangesDataSourceChart" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="chartAuditChangesDataSourceOverTime" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-head">
                                                <h3>Changes over time</h3>
                                            </div>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditChangesDataSourceTable" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_data_source_audit_changes$,$show_data_source_audit_changes_no_results$">
                            <div id="panelAuditChangesDataSourceTable" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div id="elementMainTableAuditChangesDataSource" class="dashboard-element table" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditChangesDataSourceNoResults" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_data_source_audit_changes$" data-rejects="$show_data_source_audit_changes_no_results$">
                            <div id="panelAuditChangesDataSourceNoResults" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div class="dashboard-element html" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="status_message_green">
                                                    <h2 style="font-weight: bold;">No audit changes detected within the period</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowLinkLag" class="dashboard-row dashboard-row1" style="margin-left: 15px;" data-rejects="$show_data_source_status_message$,$show_data_source_outlier_configuration$">
                            <div id="panelLinktLag2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="input input-linklist" id="inputLinkTime">
                                            <label>&nbsp;</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowLinkInputsOutlierConfigurationDataSource" class="dashboard-row dashboard-row1" style="margin-left: 15px;" data-depends="$show_data_source_outlier_configuration$">
                            <div id="panelLinkInputsOutlierConfigurationDataSource1" class="dashboard-cell" style="width: 50%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="fieldset">

                                        <div class="input input-linklist" id="LinkTimeOutlierConfigurationDataSource">
                                            <label>Select the time period for outliers detection, this period will be saved and used to restrict the calculations</label>
                                        </div>

                                    </div>

                                </div>
                            </div>
                            <div id="panelLinkInputsOutlierConfigurationDataSource2" class="dashboard-cell" style="width: 50%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="fieldset">

                                        <div class="input input-linklist" id="LinkTimeOutlierConfigurationDataSourceSpan">
                                            <label>Select the span for outliers rendering, this value will be saved and used for rendering purposes</label>
                                        </div>

                                    </div>

                                </div>
                            </div>
                        </div>

                        <div class="modal-footer">
                            <div style="margin-right: 15px; float: left;">
                                <button type="submit" id="btn_refresh_data_source" role="button" class="btn btn-primary btn-default pull-left"><span class="glyphicon glyphicon-remove"></span>Refresh</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <a class="btn btn-primary" id="btn_search_data_source" target="_blank" href="search_data_source_url" role="button">Search</a>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_modify_data_source" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Modify</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_delete_data_source" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_disable_monitoring" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Disable</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_enable_monitoring" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Enable</button>
                            </div>
                            <div class="btn_ack" style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_ack_data_source" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Acknowledge alert</button>
                            </div>
                            <div class="btn_smart_status_data_source" style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_smart_status_data_source" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Smart Status</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Alerts -->
    <div id="main_modal_manage_host" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade custom-modal-80" id="modal_manage_host" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_host">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-primary">
                                    <h1 style="font-size: 18px; color: white;">Actions for data host: $tk_data_host$</h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <div style="line-height: 1.1; margin-left: 20px;">
                                        <div style="float:left;width:33%;">
                                            <p><b>lag event / lag ingestion: ([D+]HH:MM:SS)</b> $tk_data_lag_summary$</p>
                                            <p><b>data_last_time_seen:</b> $tk_data_last_time_seen_human$</p>
                                            <p><b>data_last_ingest:</b> $tk_data_last_ingest_human$</p>
                                        </div>
                                        <div style="float:left;width:33%;">
                                            <p><b>data_max_lag_allowed:</b> $tk_data_max_lag_allowed$</p>
                                            <p><b>data_monitored_state:</b> <span class="$tk_data_monitored_state_class$">$tk_data_monitored_state$</span></p>
                                            <p><b>data_host_state:</b> <span class="$tk_data_host_state_class$">$tk_data_host_state$</span></p>
                                        </div>
                                        <div style="float:left;width:33%;">
                                            <p><b>latest_flip_time:</b> $tk_latest_flip_time_human$</p>
                                            <p><b>latest_flip_state:</b> $tk_latest_flip_state$</p>
                                            <p><b>priority:</b> <span class="$tk_priority_class$">$tk_priority$</span></p>
                                        </div>
                                    </div>
                                    <div style="margin-left: 10px; margin-bottom: 10px;">
                                        <div class="imgheader36">
                                            <img style="float: left; margin: 0px 15px 15px 0px;" src="../../static/app/trackme/icons/tags.png"/>
                                            <h3><a id="link_data_host_tags" data-toggle="modal" data-target="#modal_data_host_tags">Show object tags</a></h3>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <br />
                        <hr>

                        <div class="boxnotify" id="boxnotify-data-host">
                        </div>

                        <div id="rowLinkMainHost" class="dashboard-row dashboard-row1" style="margin-left: 15px; margin-top: -20px;">
                            <div id="panelLinktMainHost" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="input input-linklist" id="inputLinkDataHost">
                                            <label>&nbsp;</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowSingleLagHost" class="dashboard-row dashboard-row1" data-depends="$show_data_host_overview$">
                            <div id="panelSingleLagHost2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementSingleLagHostPerc95" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                        <div id="elementSingleLagHostAvg" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                        <div id="elementSingleLagHostEventLag" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                        <div id="elementSingleSLAHostpct" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartLagHost" class="dashboard-row dashboard-row1" data-depends="$show_data_host_overview$">
                            <div id="panelChartLagHost2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementChartHostIndexes" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="panelChartLagHost3" class="dashboard-cell" style="width: 100%;" data-depends="$show_data_host_overview$">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementChartHostSourcetypes" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartLagHostOverTime" class="dashboard-row dashboard-row1" data-depends="$show_data_host_overview$">
                            <div id="panelChartLagHostOverTime2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementChartLagHostOverTime" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartOutlierDataHost" class="dashboard-row dashboard-row1" data-depends="$show_data_host_outlier$">
                            <div id="panelChartOutlierDataHost2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementOutlierDataHost" class="dashboard-element chart" style="width: 100%; max-height: 350px;">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowTableOutlierDataHost" class="dashboard-row dashboard-row1" data-depends="$show_data_host_outlier$">
                            <div id="panelTableOutlierDataHost2" class="dashboard-cell" style="width: 100%; max-height: 90px;">
                                <div class="dashboard-panel clearfix">

                                    <div class="panel-element-row">
                                        <div id="elementOutlierTableDataHost" class="dashboard-element table" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowOutlierConfigDataHost" class="dashboard-row dashboard-row1" data-depends="$show_data_host_outlier_configuration$">
                            <div id="panelOutlierConfigDataHost" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">

                                    <div style="margin-left: 30px;" class="fieldset">
                                        <div class="input input-dropdown" id="inputDataHostConfigOutlierEnableOutlier">
                                            <label>Enable Outlier Detection:</label>
                                        </div>
                                        <div class="input input-dropdown" id="inputDataHostConfigOutlierAlertOnUpper">
                                            <label>Enable alert on upper Outlier:</label>
                                        </div>
                                        <div class="input input-dropdown" id="inputDataHostConfigOutlierOutlierMinEventCountMode">
                                            <label>OutlierMinEventCount mode:</label>
                                        </div>
                                        <div style="max-width: 165px;" class="input input-text" id="inputDataHostConfigOutlierOutlierMinEventCount">
                                            <label>OutlierMinEventCount:</label>
                                        </div>
                                        <div style="max-width: 165px;" class="input input-text" id="inputDataHostConfigOutlierOutlierLowerThresholdMultiplier">
                                            <label>Lower threshold multiplier:</label>
                                        </div>
                                        <div style="max-width: 165px;" class="input input-text" id="inputDataHostConfigOutlierOutlierUpperThresholdMultiplier">
                                            <label>Upper threshold multiplier:</label>
                                        </div>
                                    </div>

                                    <div style="margin-left: 42px; margin-right: 42px;">
                                        <button type="submit" id="btn_outlier_config_data_host_save" role="button" style="margin-right: 15px;" class="btn btn-primary btn-default pull-right"><span class="glyphicon glyphicon-remove"></span>Save Outliers settings</button>
                                        <button type="submit" id="btn_outlier_config_data_host_simulate" role="button" style="margin-right: 15px;" class="btn btn-primary btn-default pull-right"><span class="glyphicon glyphicon-remove"></span>Simulate Outliers settings</button>
                                    </div>

                                    <div class="boxnotify" id="boxnotify-data-host-outliers-update">
                                    </div>

                                </div>
                            </div>
                        </div>

                        <div id="rowOutlierConfigChartSimulationDataHost" class="dashboard-row dashboard-row1" data-depends="$show_data_host_outlier_configuration$, $start_outliers_simulation_data_host$">
                            <div id="panelOutlierConfigChartSimulationDataHost" class="dashboard-cell" style="width: 100%; max-height: 350px;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementOutlierSimulationDataHost" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowSingleParsingQualityDataHost" class="dashboard-row dashboard-row1" data-depends="$show_data_host_quality$,$show_data_host_quality_no_results$">
                            <div id="panelSingleParsingQualityDataHost" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementSearchDataHostParsingQualitySingle" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartParsingQualityDataHost" class="dashboard-row dashboard-row1" data-depends="$show_data_host_quality$,$show_data_host_quality_no_results$">
                            <div id="panelChartParsingQualityDataHost" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="panel-head">
                                        </div>
                                        <div id="elementSearchDataHostParsingQualityChart" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartParsingQualityDataHostNoResults" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_data_host_quality$" data-rejects="$show_data_host_quality_no_results$">
                            <div id="panelChartParsingQualityDataHostNoResults" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div class="dashboard-element html" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="status_message_green">
                                                    <h2 style="font-weight: bold;">No indexing parsing errors detected within the period</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowSingleLagByMetricsHost" class="dashboard-row dashboard-row1" data-depends="$show_data_host_lagging_metrics$">
                            <div id="panelSingleLagByMetricsHost2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementSingleLagByMetricsHostPerc95" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                        <div id="elementSingleLagByMetricsHostAvg" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                        <div id="elementSingleLagByMetricsHostEventLag" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowLaggingMetricsDataHost" class="dashboard-row dashboard-row1" data-depends="$show_data_host_lagging_metrics$">
                            <div id="panelLaggingMetricsDataHostChart" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="chartLaggingMetricDataHostOverTime" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditFlipDataHost" class="dashboard-row dashboard-row1" data-original-id="rowAuditFlipDataHostTop" data-depends="$show_data_host_flipping_status$,$show_data_host_flipping_status_no_results$">
                            <div id="panelAuditFlipDataHostChart" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="chartAuditFlipDataHostOverTime" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-head">
                                                <h3>Flip over time</h3>
                                            </div>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditFlipDataHostTable" class="dashboard-row dashboard-rowDataHostsTable" data-depends="$show_data_host_flipping_status$,$show_data_host_flipping_status_no_results$">
                            <div id="panelAuditFlipDataHostTable" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div id="elementMainTableAuditFlipDataHost" class="dashboard-element table" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditFlipDataHostNoResults" class="dashboard-row dashboard-rowDataHostsTable" data-depends="$show_data_host_flipping_status$" data-rejects="$show_data_host_flipping_status_no_results$">
                            <div id="panelAuditFlipDataHostNoResults" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div class="dashboard-element html" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="status_message_green">
                                                    <h2 style="font-weight: bold;">No flipping status detected within the period</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowStatusMessageDataHost" class="dashboard-row dashboard-row2" data-depends="$show_data_host_status_message$">
                            <div id="panelStatusMessageDataHost" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">

                                    <div class="panel-element-row">
                                        <div class="dashboard-element html" id="body_data_host_status_message" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="$tk_data_host_status_message_class$">
                                                    <h2 style="font-weight: bold;">$tk_status_message$</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="row_data_host_timeline" style="margin-top: -80px; max-height: 200px !important" class="dashboard-row dashboard-row2">
                                        <div id="panel_data_host_timeline" class="dashboard-cell" style="width: 100%;">
                                            <div class="dashboard-panel clearfix">
                                                
                                                <div class="panel-element-row">
                                                    <div id="TimelineDataHost" class="dashboard-element viz" style="width: 100%">
                                                        <div class="panel-head">
                                                            <h3>Last 7 days timeline</h3>
                                                        </div>
                                                        <div class="panel-body"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>

                        <div id="rowAuditChangesDataHost" class="dashboard-row dashboard-row1" data-original-id="rowAuditChangesDataHostTop" data-depends="$show_data_host_audit_changes$,$show_data_host_audit_changes_no_results$">
                            <div id="panelAuditChangesDataHostChart" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="chartAuditChangesDataHostOverTime" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-head">
                                                <h3>Changes over time</h3>
                                            </div>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditChangesDataHostTable" class="dashboard-row dashboard-rowDataHostsTable" data-depends="$show_data_host_audit_changes$,$show_data_host_audit_changes_no_results$">
                            <div id="panelAuditChangesDataHostTable" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div id="elementMainTableAuditChangesDataHost" class="dashboard-element table" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditChangesDataHostNoResults" class="dashboard-row dashboard-rowDataHostsTable" data-depends="$show_data_host_audit_changes$" data-rejects="$show_data_host_audit_changes_no_results$">
                            <div id="panelAuditChangesDataHostNoResults" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div class="dashboard-element html" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="status_message_green">
                                                    <h2 style="font-weight: bold;">No audit changes detected within the period</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowLinkLagHost" class="dashboard-row dashboard-row1" style="margin-left: 15px;" data-rejects="$show_data_host_status_message$,$show_data_host_outlier_configuration$">
                            <div id="panelLinktLagHost2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="input input-linklist" id="inputLinkTimeHost">
                                            <label>&nbsp;</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowLinkInputsOutlierConfigurationDataHost" class="dashboard-row dashboard-row1" style="margin-left: 15px;" data-depends="$show_data_host_outlier_configuration$">
                            <div id="panelLinkInputsOutlierConfigurationDataHost1" class="dashboard-cell" style="width: 50%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="fieldset">

                                        <div class="input input-linklist" id="LinkTimeOutlierConfigurationDataHost">
                                            <label>Select the time period for outliers detection, this period will be saved and used to restrict the calculations</label>
                                        </div>

                                    </div>

                                </div>
                            </div>
                            <div id="panelLinkInputsOutlierConfigurationDataHost2" class="dashboard-cell" style="width: 50%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="fieldset">

                                        <div class="input input-linklist" id="LinkTimeOutlierConfigurationDataHostSpan">
                                            <label>Select the span for outliers rendering, this value will be saved and used for rendering purposes</label>
                                        </div>

                                    </div>

                                </div>
                            </div>
                        </div>

                        <div class="modal-footer">
                            <div style="margin-right: 15px; float: left;">
                                <button type="submit" id="btn_refresh_data_host" role="button" class="btn btn-primary btn-default pull-left"><span class="glyphicon glyphicon-remove"></span>Refresh</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <a class="btn btn-primary" id="btn_search_data_host" target="_blank" href="search_data_source_url" role="button">Search</a>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_modify_data_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Modify</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_reset_data_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Reset</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_delete_data_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_disable_monitoring_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Disable</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_enable_monitoring_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Enable</button>
                            </div>
                            <div class="btn_ack" style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_ack_data_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Acknowledge alert</button>
                            </div>
                            <div class="btn_smart_status_data_host" style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_smart_status_data_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Smart Status</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Alerts -->
    <div id="main_modal_manage_metric_host" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade custom-modal-80" id="modal_manage_metric_host" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_metric_host">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-primary">
                                    <h1 style="font-size: 18px; color: white;">Actions for metric host: $tk_metric_host$</h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <div style="line-height: 1.1; margin-left: 20px;">
                                        <div style="float:left;width:25%;">
                                            <p><b>metric_last_lag_seen:</b> $tk_metric_last_lag_seen$</p>
                                            <p><b>metric_last_time_seen:</b> $tk_metric_last_time_seen_human$</p>
                                        </div>
                                        <div style="float:left;width:25%;">
                                            <p><b>metric_monitored_state:</b> <span class="$tk_metric_monitored_state_class$">$tk_metric_monitored_state$</span></p>
                                            <p><b>metric_host_state:</b> <span class="$tk_metric_host_state_class$">$tk_metric_host_state$</span></p>
                                        </div>
                                        <div style="float:left;width:25%;">
                                            <p><b>latest_flip_time:</b> $tk_latest_flip_time_human$</p>
                                            <p><b>latest_flip_state:</b> $tk_latest_flip_state$</p>
                                        </div>
                                        <div style="float:left;width:25%;">
                                            <p><b>priority:</b> <span class="$tk_priority_class$">$tk_priority$</span></p>
                                        </div>
                                    </div>
                                    <div style="margin-left: 10px; margin-bottom: 10px;">
                                        <div class="imgheader36">
                                            <img style="float: left; margin: 0px 15px 15px 0px;" src="../../static/app/trackme/icons/tags.png"/>
                                            <h3><a id="link_metric_host_tags" data-toggle="modal" data-target="#modal_metric_host_tags">Show object tags</a></h3>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <br />
                        <hr>

                        <div class="boxnotify" id="boxnotify-metric-host">
                        </div>

                        <div id="rowLinkMainMetricHost" class="dashboard-row dashboard-row1" style="margin-left: 15px; margin-top: -20px;">
                            <div id="panelLinktMainMetricHost" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="input input-linklist" id="inputLinkMetricHost">
                                            <label>&nbsp;</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowHostMetricChart" class="dashboard-row dashboard-row1" data-depends="$show_metric_host_overview$">
                            <div id="panelHostMetricChart" class="dashboard-cell" style="width: 100%;" data-depends="$show_metric_host_overview$">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementHostChartMetricHost" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="panelHostMetricSLApct" class="dashboard-cell" style="width: 100%;" data-depends="$show_metric_host_overview$">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementSingleSLAMetricHostpct" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowHostMetricTable" class="dashboard-row dashboard-row3" data-depends="$show_metric_host_overview$">
                            <div id="panelHostMetricTable" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="fieldset">
                                            <div id="elementHostTableMetricHost" class="dashboard-element table" style="width: 100%">
                                                <label>Metrics availability table:</label>
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditFlipMetricHost" class="dashboard-row dashboard-row1" data-original-id="rowAuditFlipMetricHostTop" data-depends="$show_metric_host_flipping_status$,$show_metric_host_flipping_status_no_results$">
                            <div id="panelAuditFlipMetricHostChart" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="chartAuditFlipMetricHostOverTime" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-head">
                                                <h3>Flip over time</h3>
                                            </div>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditFlipMetricHostTable" class="dashboard-row dashboard-rowMetricHostsTable" data-depends="$show_metric_host_flipping_status$,$show_metric_host_flipping_status_no_results$">
                            <div id="panelAuditFlipMetricHostTable" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div id="elementMainTableAuditFlipMetricHost" class="dashboard-element table" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditFlipMetricHostNoResults" class="dashboard-row dashboard-rowMetricHostsTable" data-depends="$show_metric_host_flipping_status$" data-rejects="$show_metric_host_flipping_status_no_results$">
                            <div id="panelAuditFlipMetricHostNoResults" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div class="dashboard-element html" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="status_message_green">
                                                    <h2 style="font-weight: bold;">No flipping status detected within the period</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowStatusMessageMetricHost" class="dashboard-row dashboard-row2" data-depends="$show_metric_host_status_message$">
                            <div id="panelStatusMessageMetricHost" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">

                                    <div class="panel-element-row">
                                        <div class="dashboard-element html" id="body_metric_host_status_message" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="$tk_metric_host_status_message_class$">
                                                    <h2 style="font-weight: bold;">$tk_status_message$</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="row_metric_host_timeline" style="margin-top: -80px; max-height: 200px !important" class="dashboard-row dashboard-row2">
                                        <div id="panel_metric_host_timeline" class="dashboard-cell" style="width: 100%;">
                                            <div class="dashboard-panel clearfix">
                                                
                                                <div class="panel-element-row">
                                                    <div id="TimelineMetricHost" class="dashboard-element viz" style="width: 100%">
                                                        <div class="panel-head">
                                                            <h3>Last 7 days timeline</h3>
                                                        </div>
                                                        <div class="panel-body"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>

                        <div id="rowAuditChangesMetricHost" class="dashboard-row dashboard-row1" data-original-id="rowAuditChangesMetricHostTop" data-depends="$show_metric_host_audit_changes$,$show_metric_host_audit_changes_no_results$">
                            <div id="panelAuditChangesMetricHostChart" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="chartAuditChangesMetricHostOverTime" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-head">
                                                <h3>Changes over time</h3>
                                            </div>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditChangesMetricHostTable" class="dashboard-row dashboard-rowMetricHostsTable" data-depends="$show_metric_host_audit_changes$,$show_metric_host_audit_changes_no_results$">
                            <div id="panelAuditChangesMetricHostTable" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div id="elementMainTableAuditChangesMetricHost" class="dashboard-element table" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditChangesMetricHostNoResults" class="dashboard-row dashboard-rowMetricHostsTable" data-depends="$show_metric_host_audit_changes$" data-rejects="$show_metric_host_audit_changes_no_results$">
                            <div id="panelAuditChangesMetricHostNoResults" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div class="dashboard-element html" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="status_message_green">
                                                    <h2 style="font-weight: bold;">No audit changes detected within the period</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowLinkTimeMetricHost" class="dashboard-row dashboard-row1" style="margin-left: 15px;" data-rejects="$show_metric_host_overview$,$show_metric_host_status_message$">
                            <div id="panelLinkTimeMetricHost" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="input input-linklist" id="inputLinkTimeMetricHost">
                                            <label>&nbsp;</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <hr width="100%" size="8" align="center">
                        </div>

                        <div class="modal-footer">
                            <div style="margin-right: 15px; float: left;">
                                <button type="submit" id="btn_refresh_metric_host" role="button" class="btn btn-primary btn-default pull-left"><span class="glyphicon glyphicon-remove"></span>Refresh</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_search_metric_reports" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Search & reports</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_modify_metric_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Modify</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_reset_metric_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Reset</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_delete_metric_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_disable_monitoring_metric_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Disable</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_enable_monitoring_metric_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Enable</button>
                            </div>
                            <div class="btn_ack" style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_ack_metric_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Acknowledge alert</button>
                            </div>
                            <div class="btn_smart_status_metric_host" style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_smart_status_metric_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Smart Status</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Indexers Queues -->
    <div id="main_modal_queues" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade modal-big" id="modal_queues" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_queues">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-info">
                                    <h1 style="font-size: 18px; color: white;">Ops: Queues center</h1>
                                    <button type="button" id="btn_ops_index_queue_close" class="close" data-dismiss="modal">&times;</button>
                                </div>
                            </div>
                        </div>
                        <div class="modal-guts">
                            <div id="rowQueuesInfo" class="dashboard-row dashboard-row1">
                                <div id="panelQueuesInfo" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        
                                        <div class="panel-element-row">
                                            <div id="rowInfoQueues" class="dashboard-element html" style="width: 100%">
                                                <div class="panel-body html">
                                                        <h1>Splunk indexing queues:</h1>
                                                        <lu>
                                                            <li>Update the macro <a target="_blank" href="/en-GB/manager/trackme/admin/macros/trackme_idx_filter?action=edit">trackme_idx_filter</a> to match indexers and other instances such as heavy forwarders that should be included</li>
                                                            <li>Use the break down dropdown to select a break down option for detailed queue charts rendering</li>
                                                            <li>For more information about Splunk queues: <a target="_blank" href="https://wiki.splunk.com/Community:HowIndexingWorks">https://wiki.splunk.com/Community:HowIndexingWorks</a></li>
                                                            <li>Conf slides, How Splunkd works: <a target="_blank" href="https://conf.splunk.com/files/2017/slides/how-splunkd-works.pdf">https://conf.splunk.com/files/2017/slides/how-splunkd-works.pdf</a></li>
                                                            <li>Conf slides, How to Troubleshoot Blocked Ingestion Pipeline Queues with Indexers and Forwarders: <a target="_blank" href="https://conf.splunk.com/files/2019/slides/FN1570.pdf">https://conf.splunk.com/files/2019/slides/FN1570.pdf</a></li>                                                            
                                                        </lu>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div id="rowLinkQueues" class="dashboard-row dashboard-row1" style="margin-left: 15px;">
                                <div id="panelLinkQueues" class="dashboard-cell" style="width: 50%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div class="input input-multiselect" id="inputHostQueues">
                                                <label>Host(s):</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="panelLinkQueues2" class="dashboard-cell" style="width: 50%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div class="input input-linklist" id="inputLinkQueuesTime">
                                                <label>&nbsp;</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowChartQueuesAll" class="dashboard-row dashboard-row1">
                                <div id="panelChartQueues1" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div id="elementChartQueueAll" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-head">
                                                    <h3>All queues - Blocking queues (more than 0% means queues filling)</h3>
                                                </div>
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowQueuesBreakBy" class="dashboard-row dashboard-row1" style="margin-left: 15px;">
                                <div id="panelQueuesBreakBy" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div class="input input-dropdown" id="inputHostQueuesBreak">
                                                <label>Break by:</label>
                                            </div>                                            
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowChartQueuesTreillis" class="dashboard-row dashboard-row1">
                                <div id="panelChartQueues1" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div id="elementChartQueuesTreillis" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-head">
                                                    <h3>Queues details</h3>
                                                </div>
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Parsing issues -->
    <div id="main_modal_parsing_issues" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade modal-big" id="modal_parsing_issues" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_parsing_issues">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-info">
                                    <h1 style="font-size: 18px; color: white;">Ops: Parsing issues</h1>
                                    <button type="button" id="btn_ops_parsing_issues_close" class="close" data-dismiss="modal">&times;</button>
                                </div>
                            </div>
                        </div>

                        <div class="modal-guts">

                            <div class="panel-element-row">
                                <div id="rowLinkParsingInfo" class="dashboard-element html" style="width: 100%">
                                    <div class="panel-body html">
                                            <h1>Splunk indexing time parsing issues:</h1>
                                            <lu>
                                                <li>Update the macro <a target="_blank" href="/en-GB/manager/trackme/admin/macros/trackme_idx_filter?action=edit">trackme_idx_filter</a> to match indexers and other instances such as heavy forwarders that should be included</li>
                                                <li>Target the best ingestion practices with the splunk&gt; magic 8 to be configured in your <a target="_blank" href="http://docs.splunk.com/Documentation/Splunk/latest/Admin/propsconf">props.conf</a>, see: <a target="_blank" href="https://trackme.readthedocs.io/en/latest/userguide.html#splunk-8-magic-props-configuration">TrackMe documentation page</a></li>
                                            </lu>
                                            <br />
                                    </div>
                                </div>
                            </div>
                            <div id="rowLinkParsingIssues" class="dashboard-row dashboard-row1" style="margin-left: 15px;">
                                <div id="panelLinkParsingIssues" class="dashboard-cell" style="width: 50%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div class="input input-multiselect" id="inputHostParsing">
                                                <label>Host(s):</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="panelLinkParsingIssues2" class="dashboard-cell" style="width: 50%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div class="input input-linklist" id="inputLinkParsingIssuesTime">
                                                <label>&nbsp;</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowSingleParsingIssues" class="dashboard-row dashboard-row1">
                                <div id="panelSingleParsingIssues" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div id="elementSingleParsingIssues" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowChartParsingIssues" class="dashboard-row dashboard-row1">
                                <div id="panelChartParsingIssues" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div id="elementChartParsingIssues" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowParsingButtons" class="dashboard-row dashboard-row1">
                                <div id="panelParsingButtons" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">                                        
                                        <div class="panel-element-row">
                                            <div id="element1" class="dashboard-element html" style="width: 100%">
                                                <div class="panel-body html">
                                                    <button type="submit" id="btn_search_parsing_issues_linebreaking" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Search line breaking issues</button>
                                                    <button type="submit" id="btn_search_parsing_issues_aggregator" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Search aggregator mining issues</button>
                                                    <button type="submit" id="btn_search_parsing_issues_dateparser" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Search date parser issues</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowLineBreakingProcessorInfo" class="dashboard-row dashboard-row1" data-original-id="rowLineBreakingProcessorInfo">
                                <div id="panelLineBreakingProcessorInfo" class="dashboard-cell" style="width: 100%;" data-original-id="panelLineBreakingProcessorInfo">
                                    <div class="dashboard-panel clearfix">
                                        
                                        <div class="panel-element-row">
                                            <div id="elementInfoLineBreakingProcessor" class="dashboard-element html" style="width: 100%">
                                                <div class="panel-body html">
                                                        <h1>LineBreakingProcessor</h1>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowLineBreakingProcessorTop" class="dashboard-row dashboard-row2" data-original-id="rowLineBreakingProcessorTop">
                                <div id="panelLineBreakingProcessorTopSource" class="dashboard-cell" style="width: 33.33%;" data-original-id="panelLineBreakingProcessorTopSource">
                                    <div class="dashboard-panel clearfix">
                                        <h2 class="panel-title">LineBreakingProcessor issues - top source</h2>
                                        
                                        <div class="panel-element-row">
                                            <div id="chartLineBreakingProcessorTopSource" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="panelLineBreakingProcessorTopHost" class="dashboard-cell" style="width: 33.33%;" data-original-id="panelLineBreakingProcessorTopHost">
                                    <div class="dashboard-panel clearfix">
                                        <h2 class="panel-title">LineBreakingProcessor - top host</h2>
                                        
                                        <div class="panel-element-row">
                                            <div id="chartLineBreakingProcessorTopHost" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="panel1" class="dashboard-cell" style="width: 33.33%;">
                                    <div class="dashboard-panel clearfix">
                                        <h2 class="panel-title">LineBreakingProcessor issues - top sourcetype</h2>
                                        
                                        <div class="panel-element-row">
                                            <div id="chartLineBreakingProcessorTopSourcetype" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowLineBreakingProcessorTopTable" class="dashboard-row dashboard-row3">
                                <div id="panelLineBreakingProcessorTopTableSource" class="dashboard-cell" style="width: 33.33%;">
                                    <div class="dashboard-panel clearfix">
                                        
                                        <div class="panel-element-row">
                                            <div id="tableLineBreakingProcessorTopSource" class="dashboard-element table" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="panelLineBreakingProcessorTopTableHost" class="dashboard-cell" style="width: 33.33%;">
                                    <div class="dashboard-panel clearfix">
                                        
                                        <div class="panel-element-row">
                                            <div id="tableLineBreakingProcessorTopHost" class="dashboard-element table" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="panelLineBreakingProcessorTopTableSourcetype" class="dashboard-cell" style="width: 33.33%;">
                                    <div class="dashboard-panel clearfix">
                                        
                                        <div class="panel-element-row">
                                            <div id="tableLineBreakingProcessorTopSourcetype" class="dashboard-element table" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowLineBreakingProcessorEvent" class="dashboard-row dashboard-row3" data-original-id="rowLineBreakingProcessorEvent">
                                <div id="panelLineBreakingProcessorEvent" class="dashboard-cell" style="width: 100%;" data-original-id="panelLineBreakingProcessorEvent">
                                    <div class="dashboard-panel clearfix">
                                        
                                        <div class="panel-element-row">
                                            <div id="EventLineBreakingProcessorEvent" class="dashboard-element event" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowAggregatorMiningProcessorInfo" class="dashboard-row dashboard-row3" data-original-id="rowAggregatorMiningProcessorInfo">
                                <div id="panelAggregatorMiningProcessorInfo" class="dashboard-cell" style="width: 100%;" data-original-id="panelAggregatorMiningProcessorInfo">
                                    <div class="dashboard-panel clearfix">
                                        
                                        <div class="panel-element-row">
                                            <div id="elementAggregatorMiningProcessor" class="dashboard-element html" style="width: 100%">
                                                <div class="panel-body html">
                                                        <h1>AggregatorMiningProcessor</h1>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowAggregatorMiningProcessorTop" class="dashboard-row dashboard-row4" data-original-id="rowAggregatorMiningProcessorTop">
                                <div id="panelAggregatorMiningProcessorTopSource" class="dashboard-cell" style="width: 33.33%;" data-original-id="panelAggregatorMiningProcessorTopSource">
                                    <div class="dashboard-panel clearfix">
                                        <h2 class="panel-title">AggregatorMiningProcessor issues - top source</h2>
                                        
                                        <div class="panel-element-row">
                                            <div id="chartAggregatorMiningProcessorTopSource" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="panelAggregatorMiningProcessorTopHost" class="dashboard-cell" style="width: 33.33%;" data-original-id="panelAggregatorMiningProcessorTopHost">
                                    <div class="dashboard-panel clearfix">
                                        <h2 class="panel-title">AggregatorMiningProcessor - top host</h2>
                                        
                                        <div class="panel-element-row">
                                            <div id="chartAggregatorMiningProcessorTopHost" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="panelAggregatorMiningProcessorTopSourcetype" class="dashboard-cell" style="width: 33.33%;" data-original-id="panelAggregatorMiningProcessorTopSourcetype">
                                    <div class="dashboard-panel clearfix">
                                        <h2 class="panel-title">AggregatorMiningProcessor issues - top sourcetype</h2>
                                        
                                        <div class="panel-element-row">
                                            <div id="chartAggregatorMiningProcessorTopSourcetype" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowAggregatorMiningProcessorTopTable" class="dashboard-row dashboard-row3">
                                <div id="panelAggregatorMiningProcessorTopTableSource" class="dashboard-cell" style="width: 33.33%;">
                                    <div class="dashboard-panel clearfix">
                                        
                                        <div class="panel-element-row">
                                            <div id="tableAggregatorMiningProcessorTopSource" class="dashboard-element table" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="panelAggregatorMiningProcessorTopTableHost" class="dashboard-cell" style="width: 33.33%;">
                                    <div class="dashboard-panel clearfix">
                                        
                                        <div class="panel-element-row">
                                            <div id="tableAggregatorMiningProcessorTopHost" class="dashboard-element table" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="panelAggregatorMiningProcessorTopTableSourcetype" class="dashboard-cell" style="width: 33.33%;">
                                    <div class="dashboard-panel clearfix">
                                        
                                        <div class="panel-element-row">
                                            <div id="tableAggregatorMiningProcessorTopSourcetype" class="dashboard-element table" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>                            
                            <div id="rowAggregatorMiningProcessorEvent" class="dashboard-row dashboard-row6" data-original-id="rowAggregatorMiningProcessorEvent">
                                <div id="panelAggregatorMiningProcessorEvent" class="dashboard-cell" style="width: 100%;" data-original-id="panelAggregatorMiningProcessorEvent">
                                    <div class="dashboard-panel clearfix">
                                        
                                        <div class="panel-element-row">
                                            <div id="EventAggregatorMiningProcessorEvent" class="dashboard-element event" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowDateParserVerboseInfo" class="dashboard-row dashboard-row5" data-original-id="rowDateParserVerboseInfo">
                                <div id="panelDateParserVerboseInfo" class="dashboard-cell" style="width: 100%;" data-original-id="panelDateParserVerboseInfo">
                                    <div class="dashboard-panel clearfix">
                                        
                                        <div class="panel-element-row">
                                            <div id="elementDateParserVerbose" class="dashboard-element html" style="width: 100%">
                                                <div class="panel-body html">
                                                        <h1>DateParserVerbose</h1>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowDateParserVerboseTop" class="dashboard-row dashboard-row6" data-original-id="rowDateParserVerboseTop">
                                <div id="panelDateParserVerboseTopSource" class="dashboard-cell" style="width: 33.33%;" data-original-id="panelDateParserVerboseTopSource">
                                    <div class="dashboard-panel clearfix">
                                        <h2 class="panel-title">Datetime parsing issues - top source</h2>
                                        
                                        <div class="panel-element-row">
                                            <div id="chartDateParserVerboseTopSource" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="panelDateParserVerboseTopHost" class="dashboard-cell" style="width: 33.33%;" data-original-id="panelDateParserVerboseTopHost">
                                    <div class="dashboard-panel clearfix">
                                        <h2 class="panel-title">Datetime parsing issues - top host</h2>
                                        
                                        <div class="panel-element-row">
                                            <div id="chartDateParserVerboseTopHost" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="panelDateParserVerboseTopSourcetype" class="dashboard-cell" style="width: 33.33%;" data-original-id="panelDateParserVerboseTopSourcetype">
                                    <div class="dashboard-panel clearfix">
                                        <h2 class="panel-title">Datetime parsing issues - top sourcetype</h2>
                                        
                                        <div class="panel-element-row">
                                            <div id="chartDateParserVerboseTopSourcetype" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowDateParserVerboseTopTable" class="dashboard-row dashboard-row3">
                                <div id="panelDateParserVerboseTopTableSource" class="dashboard-cell" style="width: 33.33%;">
                                    <div class="dashboard-panel clearfix">
                                        
                                        <div class="panel-element-row">
                                            <div id="tableDateParserVerboseTopSource" class="dashboard-element table" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="panelDateParserVerboseTopTableHost" class="dashboard-cell" style="width: 33.33%;">
                                    <div class="dashboard-panel clearfix">
                                        
                                        <div class="panel-element-row">
                                            <div id="tableDateParserVerboseTopHost" class="dashboard-element table" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="panelDateParserVerboseTopTableSourcetype" class="dashboard-cell" style="width: 33.33%;">
                                    <div class="dashboard-panel clearfix">
                                        
                                        <div class="panel-element-row">
                                            <div id="tableDateParserVerboseTopSourcetype" class="dashboard-element table" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowDateParserVerboseEvent" class="dashboard-row dashboard-row9" data-original-id="rowDateParserVerboseEvent">
                                <div id="panelDateParserVerboseEvent" class="dashboard-cell" style="width: 100%;" data-original-id="panelDateParserVerboseEvent">
                                    <div class="dashboard-panel clearfix">
                                        
                                        <div class="panel-element-row">
                                            <div id="EventDateParserVerboseEvent" class="dashboard-element event" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer" style="margin-top: 700px;">
                            <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Generic deletion -->
    <div class="modal custom-modal-50 fade" id="modal_entry_deletion" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span>KVstore entry deletion</h1>
                </div>
                <div class="modal-body">
                    <p><b>Confirm deletion of this entry?</b><br /><br />
                        You may want to delete a data source entry if the data source has been discontinued, or if the target index or sourcetype was changed.
                        <br /><br />

                        <b>Two options are available:</b>
                        <lu>
                            <li><b>Delete temporary:</b> removes the entity and its settings, shall the data source or host be active in the past 7 days, it will be re-created automatically by the trackers</li>
                            <li><b>Delete permanently:</b> removes the entity and its settings, in addition it prevents the data source or host from being re-created automatically by the trackers</li>
                            <br />
                        </lu>

                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_entry_deletion_temporary" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Delete temporary</button>
                    <button type="submit" id="btn_modal_entry_deletion" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Delete permanently</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Error or failure during KVstore collection update -->
    <div class="modal fade" id="modal_update_collection_failure_return" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span>Oops!</h1>
                </div>
                <div class="modal-body">
                    <p>Sorry but it looks like an error occurred while attempting to perform the KVstore collection update.<br /><br />
                        <b>You might not have the permission to write to the collection</b>, or an unexpected failure was encountered.<br /><br />
                        <b>The server returned the following error message:</b>
                    </p>
                    <div class="modal-error-message" style="margin: 10px 0; padding: 10px; border-radius: 3px 3px 3px 3px; color: #D8000C; background-color: #FFBABA;">
                        <p>error return message</p>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- elastic source simulation -->
    <div class="modal fade" id="modal_generic_search_error" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span>Oops!</h1>
                </div>
                <div class="modal-body">
                    <p>Sorry but the simulation of the search has failed due to a syntax error or another failure.<br /><br />
                        <b>Verify your syntax and try again.</b><br /><br />
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" id="btn_modal_generic_search_error_back" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                </div>
            </div>
        </div>
    </div>

    <!-- elastic source creation is successful -->
    <div class="modal fade" id="modal_elastic_source_alert_creation_success" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-success">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span>New tracker successfully created.</h1>
                </div>
                <div class="modal-body">
                    <p>Congratulations, the new elastic source tracker was successfully created.<br /><br />
                        <b>The following new tracker was created:</b>
                    </p>
                    <div class="modal-error-message" style="margin: 10px 0; padding: 10px; border-radius: 3px 3px 3px 3px; color: #059; background-color: #BEF;">
                        <p>success return message</p>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" id="modal_elastic_source_alert_creation_success_run_tracker" class="btn btn-default btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Run this Elastic dedicated tracker now</button>
                    <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Error or failure during elastic source creation -->
    <div class="modal fade" id="modal_elastic_source_alert_creation_error" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span>Oops!</h1>
                </div>
                <div class="modal-body">
                    <p>Sorry but it looks like an error occurred while attempting to perform the creation of the new elastic source tracker.<br /><br />
                        <b>You might not have the permission to perform this operation</b>, or an unexpected failure was encountered.<br /><br />
                        <b>The server returned the following error message:</b>
                    </p>
                    <div class="modal-error-message" style="margin: 10px 0; padding: 10px; border-radius: 3px 3px 3px 3px; color: #D8000C; background-color: #FFBABA;">
                        <p>error return message</p>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- alert creation is successful -->
    <div class="modal fade" id="modal_alert_creation_success" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-success">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span>New alert successfully created.</h1>
                </div>
                <div class="modal-body">
                    <p>Congratulations, the new alert tracker was successfully created.<br /><br />
                        <b>The following new tracker was created:</b>
                    </p>
                    <div class="modal-error-message" style="margin: 10px 0; padding: 10px; border-radius: 3px 3px 3px 3px; color: #059; background-color: #BEF;">
                        <p>success return message</p>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Error or failure during alert creation -->
    <div class="modal fade" id="modal_alert_creation_error" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span>Oops!</h1>
                </div>
                <div class="modal-body">
                    <p>Sorry but it looks like an error occurred while attempting to perform the creation of the new alert tracker.<br /><br />
                        <b>You might not have the permission to perform this operation</b>, or an unexpected failure was encountered.<br /><br />
                        <b>The server returned the following error message:</b>
                    </p>
                    <div class="modal-error-message" style="margin: 10px 0; padding: 10px; border-radius: 3px 3px 3px 3px; color: #D8000C; background-color: #FFBABA;">
                        <p>error return message</p>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window for lag value modification -->

    <!-- data source monitoring -->

    <div class="modal fade custom-modal-50" id="modal_modify_main" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Modify data source monitoring</h1>
                </div>
                <div class="modal-body">
                    <p>You can modify different parameters regarding the monitoring of this data source:</p>

                    <b>monitoring_wdays: modify the week days rules for monitoring</b>
                    <br />

                    <lu>
                        <li>all_days: monitor the data source every days of the week</li>
                        <li>monday-to-friday: monitor the data source only during working days from Monday to Friday</li>
                        <li>monday-to-saturday: monitor the data source only during working days from Monday to Saturday</li>
                        <li>Or enter the manual mode where you can select each days of the week to be monitored</li>
                    </lu>

                    <br />

                    <b>monitoring_level:</b>
                    <br />

                    <lu>
                        <li>sourcetype: monitor data source availability on a per sourcetype basis</li>
                        <li>index: monitor data source availability on a per index basis, ignoring the sourcetype value</li>
                    </lu>

                    <br />

                    <b>maximal lag value:</b>
                    <br />

                    <lu>
                        <li>the maximal value in seconds of unavailability of the data source before it is declared in red state</li>
                    </lu>

                    <br />

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_modify_cancel" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button id="btn_modal_modify_wdays" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Modify monitoring wdays</button>
                    <button id="btn_modal_modify_level" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Modify monitoring level</button>
                    <button id="btn_modal_modify_lag" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Modify monitoring lagging</button>
                </div>
            </div>
        </div>
    </div>

    <!-- data host monitoring -->

    <div class="modal fade custom-modal-50" id="modal_modify_main_host" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Modify data host monitoring</h1>
                </div>
                <div class="modal-body">
                    <p>You can modify different parameters regarding the monitoring of this data host:</p>

                    <b>monitoring_wdays: modify the week days rules for monitoring</b>
                    <br />

                    <lu>
                        <li>all_days: monitor the data source every days of the week</li>
                        <li>monday-to-friday: monitor the data source only during working days from Monday to Friday</li>
                        <li>monday-to-saturday: monitor the data source only during working days from Monday to Saturday</li>
                        <li>Or enter the manual mode where you can select each days of the week to be monitored</li>
                    </lu>

                    <br />

                    <b>maximal lag value:</b>
                    <br />

                    <lu>
                        <li>the maximal value in seconds of unavailability of the data host before it is declared in red state</li>
                    </lu>

                    <br />

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_modify_host_cancel" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button id="btn_modal_modify_wdays_host" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Modify monitoring wdays</button>
                    <button id="btn_modal_modify_lag_host" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Modify monitoring lagging</button>
                </div>
            </div>
        </div>
    </div>

    <!--
    Custom lagging
    -->

    <div class="modal fade custom-modal-80" id="modify_custom_lagging" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Lagging classes definition </h1>
                </div>
                <div class="modal-body">
                    <b>Lagging classes are applied automatically during the trackers execution, use this interface to define a default lagging value with a policy based on different conditions:</b>
                    <lu>
                        <li>Based on the index</li>
                        <li>Based on the sourcetype</li>
                        <li>Based on the priority level defined for the entity</li>
                    </lu>
                    <br />

                    <b>Conflict resolution and behaviour:</b>
                    <lu>
                        <li><b>For data sources:</b> lagging classes are applied in the following order: index, sourcetype, priority (first match takes precedence)</li>
                        <li><b>For data hosts:</b> The highest lagging value takes precedence, if multiple sourcetypes, the host global max lag cannot be lower than the highest value between all sourcetypes</li>
                        <li><b>For all:</b> A given entity can override every lagging classes and apply a wanted value if data_override_lagging_class is set to true via the Override lagging classes dropdown</li>
                    </lu>

                    <div class="boxnotify" id="boxnotify-modify_custom_lagging">
                    </div>

                    <div id="rowCustomLagging1a" class="dashboard-row dashboard-row3">
                        <div id="panelCustomLagging1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-dropdown" id="modal_input_custom_lagging_type" style="margin-bottom: 10px;">
                                            <label>Applies to:</label>
                                        </div>

                                        <div class="input input-text" id="modal_input_custom_lagging_name" style="margin-bottom: 10px;">
                                            <label>Name:</label>
                                        </div>

                                        <div class="input input-text" id="modal_input_custom_lagging_value" style="margin-bottom: 10px;">
                                            <label>Lagging value:</label>
                                        </div>

                                        <div class="input input-dropdown" id="modal_input_custom_lagging_object" style="margin-bottom: 10px;">
                                            <label>object: (data sources/hosts)</label>
                                        </div>

                                        <div style="margin-top: 10px; margin-bottom: 10px;">
                                            <button id="btn_modal_custom_lagging_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this lagging class</button>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowCustomLagging1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="SingleCustomLagging" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowCustomLaggingTable1" class="dashboard-row dashboard-row3">
                        <div id="panelCustomLaggingTable1" class="dashboard-cell" style="margin-top: -25px; width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_custom_lagging_search" style="margin-bottom: 10px;">
                                            <label>Search for lagging class:</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="rowCustomLaggingTable2" class="dashboard-row dashboard-row3">
                        <div id="panelCustomLaggingTable2" class="dashboard-cell" style="margin-top: -25px; width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div id="tableCustomLagging" class="dashboard-element table" style="width: 100%">
                                            <label>Select entries and use the remove selected button:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_lagging_data_source_policy_delete_level1" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                </div>
            </div>
        </div>
    </div>

    <!--
    Elastic sources
    -->

    <div class="modal fade custom-modal-80" id="modify_elastic_sources_main" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-info">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> TrackMe Elastic sources - Manage and create</h1>
                </div>
                <div class="modal-body">
                    <b>Elastic sources are custom flexible data sources entities, which can be searches based on regular raw events searches, tstats searches, from command based searches and metric indexes using the mstats command:</b>
                    <br /><br />

                    <lu>
                        <li>Consult the <a target="_blank" href="https://trackme.readthedocs.io/en/latest/userguide.html#elastic-sources">Elastic Sources documentation</a> for more information and detailed examples</li>
                        <li>Elastic sources should be used when the default concept of trackMe (statement by index/sourcetype) does not comply with your requirements, or does not provide the level of flexibility requested</li>                        
                        <li>Elastic sources can be based on a shared or dedicated tracker, the shared elastic tracker loads the content of the lookup trackme_elastic_sources, and performs all the searches in a single execution</li>
                        <li>A dedicated elastic tracker is a scheduled report created in the UI to manage, automatically integrated with TrackMe workflow</li>
                        <li>For large volume sources or advanced use cases such as mapping additional lookups, the usage of a dedicated elastic tracker is recommended (the search can be cutomised after its creation)</li>
                        <li>The shared elastic tracker should be reserved for high performing searches, ideally tstats based searches relying on indexed fields</li>
                        <li>Dedicated elastic trackers information are as well stored in the trackme_elastic_sources_dedicated lookup for mapping purposes in the UI</li>
                    </lu>

                    <br />

                    <style type="text/css">
                    .tg  {border-collapse:collapse;border-spacing:0;}
                    .tg td{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
                      overflow:hidden;padding:10px 5px;word-break:normal;}
                    .tg th{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
                      font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}
                    .tg .tg-p1nr{border-color:inherit;font-size:12px;text-align:left;vertical-align:top}
                    .tg .tg-f4iu{border-color:inherit;font-size:13px;text-align:center;vertical-align:top}
                    </style>
                    <table class="tg">
                        <thead>
                        <tr>
                            <th class="tg-f4iu"><span style="font-weight:bold">FIELD</span></th>
                            <th class="tg-f4iu"><span style="font-weight:bold">DEFINITION</span></th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td class="tg-p1nr"><span style="font-weight:bold">data_name</span></td>
                            <td class="tg-p1nr">This is the main identifier for a data source, and needs to be unique within the entire collection</td>
                        </tr>
                        <tr>
                            <td class="tg-p1nr"><span style="font-weight:bold">search_mode</span></td>
                            <td class="tg-p1nr">The type of search, valid options are: <strong>tstats</strong> / <strong>raw</strong> / <strong>from</strong> / <strong>mstats</strong></td>
                        </tr>
                        <tr>
                            <td class="tg-p1nr"><span style="font-weight:bold">search_constraint</span></td>
                            <td class="tg-p1nr">The constraint of the search:<br>- <strong>tstats</strong>: this represents the where part of a tstats search, as: <span><code>index=my_index source=my_source</code></span><br>- <strong>raw</strong>: Any filter that is before stats calculation, as: <span><code>index=my_index tag=authentication app=my_application</code></span><br>- <strong>from (datamodel)</strong>: a search using from is in 2 parts with a pipe separation, where the 1st segment is the object and the 2nd a search constraint, as: <span><code>datamodel:"Authentication" | search user="*" action="success" app="my_application"</code></span> <br>- <strong>from (lookup)</strong>: A lookup can be monitored with the from command, it requires the lookup to have a time field concept, and a field _time in epoch time format needs to be created using an eval function with strftime/strptime, such as: <span><code>lookup:"my_lookup" | eval _time=strptime(lastUpdated, "%d/%m/%Y %H:%M:%S")</code></span> <br>- <strong>mstats</strong>: Allows monitoring metric indexes according to your constraints including dimensions, as: <span><code>index="k8s_metrics" metric_name="k8s.*" cluster_name="production"</code></span> <br />Filters can include a time range which will override the default 4 hours time range of the wrapper tracker, as: <span><code>earliest="-15m" latest="+15m"</code></span>
                            
                                <br />- <strong>rest</strong>: these are special remote searches performed against the <a target="_blank" href="https://docs.splunk.com/Documentation/Splunk/latest/RESTTUT/RESTsearches">Splunk API</a> using the SPL <a target="_blank" href="https://docs.splunk.com/Documentation/Splunk/latest/SearchReference/Rest">rest command.</a> This allows tracking data that is not available to the search head(s) hosting TrackMe.
                                <br />Syntax examples for rest searches, the first part before the pipe needs to contain the rest target:
                                <br />
                                <span><code>splunk_server="my_search_head" | index=my_index source=my_source</code></span>
                                <br />
                                <span><code>splunk_server_group="dmc_searchheadclustergroup_shc1" | lookup:asset_cmdb_lookup | eval _time=strptime(lastUpdated, "%d/%m/%Y %H:%M:%S")</code></span>

                            </td>
                        </tr>
                        <tr>
                            <td class="tg-p1nr"><span style="font-weight:bold">elastic _data_index</span></td>
                            <td class="tg-p1nr">Optional, this value will be used in the UI but has no impacts on the search, default to the data_name if unset</td>
                        </tr>
                        <tr>
                            <td class="tg-p1nr"><span style="font-weight:bold">elastic_data_sourcetype</span></td>
                            <td class="tg-p1nr"><span style="font-weight:400;font-style:normal">Optional, this value will be used in the UI but has no impacts on the search, default to the data_name if unset</span></td>
                        </tr>
                        </tbody>
                    </table>
                </div>

                <div class="modal-footer">
                    <button id="btn_modal_elastic_sources_manage" type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage existing shared elastic sources</button>
                    <button id="btn_modal_elastic_sources_dedicated_manage" type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage existing dedicated elastic sources</button>                    
                    <button id="btn_modal_elastic_sources_add" type="submit" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Create a new elastic source</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade custom-modal-80" id="add_elastic_sources" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Elastic sources definition </h1>
                </div>
                <div class="modal-body">
                    <b>Use this interface to create and manage elastic sources:</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-add_elastic_source">
                    </div>

                    <div id="rowElasticSourcesAdd1a" class="dashboard-row dashboard-row3">

                        <div id="rowElasticSourcesAdd1b" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">

                                    <div class="input input-text" id="modal_input_elastic_source_data_name" style="margin-bottom: 10px; max-width: 300px;">
                                        <label>Enter the unique identifier of the elastic source:</label>
                                    </div>

                                    <div class="input input-dropdown" id="modal_input_elastic_source_search_type" style="margin-bottom: 10px;">
                                        <label>Choose the type of search:</label>
                                    </div>

                                    <form>
                                        <fieldset>
                                            <legend>Fill the search constraint according to the type of search:</legend>
                                            <p>
                                                <label>Enter the constraint for the search:</label>
                                                <textarea
                                                        id = "modal_input_elastic_source_search_constraint"
                                                        rows = "3"
                                                        cols = "80" style="width: 1100px;"
                                                        onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">Enter the Splunk search constraint chain according to the type of search selected</textarea>
                                            </p>

                                        </fieldset>
                                    </form>

                                    <div class="fieldset">

                                        <div class="input input-text" id="modal_input_elastic_source_elastic_data_index" style="margin-bottom: 10px; max-width: 300px;">
                                            <label>Optional: index value visible in the UI (white|blacklist applies)</label>
                                        </div>

                                        <div class="input input-text" id="modal_input_elastic_source_elastic_data_sourcetype" style="margin-bottom: 10px; max-width: 300px;">
                                            <label>Optional: sourcetype visible in the UI (white|blacklist applies)</label>
                                        </div>

                                        <div class="input input-text" id="modal_input_elastic_source_earliest" style="margin-bottom: 10px; max-width: 300px;">
                                            <label>Earliest, for dedicated trackers only (shared tracker uses -4h)</label>
                                        </div>

                                        <div class="input input-text" id="modal_input_elastic_source_latest" style="margin-bottom: 10px; max-width: 300px;">
                                            <label>Latest, for dedicated trackers only (shared tracker uses +4h)</label>
                                        </div>

                                    </div>

                                    <div style="margin-top: 15x;">
                                        <h4 style="color: red;">Caution: allowlist indexes and blocklists apply to elastic trackers, make sure to configure these accordingly or use valid index and sourcetype values</h4>
                                        <br />
                                        <button type="submit" id="btn_modal_elastic_source_add_simulate" style="margin-right: 15px;" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Simulate the search</button>
                                        <button type="submit" id="btn_modal_elastic_source_add_new" style="margin-right: 15px;" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Add to the shared tracker</button>
                                        <button type="submit" id="btn_modal_elastic_source_dedicated_add_new" style="margin-right: 15px;" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Add as a new dedicated tracker</button>
                                    </div>

                                </div>

                                <br />
                                <br />

                            </div>

                        </div>

                    </div>

                    <div id="rowElasticSourcesAdd1c" class="dashboard-row dashboard-row1" data-depends="$start_simulation_elastic_sources$">
                        <div id="panelElasticSourcesAdd1c" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div id="tableElasticSourcesTest" class="dashboard-element table" style="width: 100%; max-height: 140px;">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_elastic_sources_add_new_back" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window confirmation of association for identity card -->
    <div class="modal fade" id="add_elastic_source_processed" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-success">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span>New elastic source successfully added.</h1>
                </div>
                <div class="modal-body">
                    <p>Congratulations, the new elastic source was successfully added to the shared tracker collection.<br /><br />
                        <b>The following new configuration was created:</b>
                    </p>
                    <div class="modal-error-message" style="margin: 10px 0; padding: 10px; border-radius: 3px 3px 3px 3px; color: #059; background-color: #BEF;">
                        <p>success return message</p>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" id="add_elastic_source_processed_run_tracker" class="btn btn-default btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Run Elastic Shared tracker now</button>
                    <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>

        </div>
    </div>

    <div class="modal fade custom-modal-80" id="modify_elastic_sources" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Shared Elastic sources definition </h1>
                </div>
                <div class="modal-body">
                    <b>Use this interface to create and manage shared elastic sources:</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modify_elastic_sources">
                    </div>

                    <div id="rowElasticSources1a" class="dashboard-row dashboard-row3">

                        <div id="rowElasticSources1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="SingleElasticSources" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowElasticSourcesTable1" class="dashboard-row dashboard-row3">
                        <div id="panelElasticSourcesTable1" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_elastic_sources_search" style="margin-bottom: 10px;">
                                            <label>Search for elastic source:</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="rowElasticSourcesTable2" class="dashboard-row dashboard-row3">
                        <div id="panelElasticSourcesTable2" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div id="tableElasticSources" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_elastic_sources_add_back" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" id="btn_modal_elastic_sources_add_delete" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade custom-modal-80" id="modify_elastic_sources_dedicated" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Dedicated Elastic sources definition </h1>
                </div>
                <div class="modal-body">
                    <b>Use this interface to create and manage dedicated elastic sources:</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modify_elastic_sources_dedicated">
                    </div>

                    <div id="rowElasticSourcesDedicated1a" class="dashboard-row dashboard-row3">

                        <div id="rowElasticSourcesDedicated1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="SingleElasticSourcesDedicated" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowElasticSourcesDedicatedTable1" class="dashboard-row dashboard-row3">
                        <div id="panelElasticSourcesDedicatedTable1" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_elastic_sources_dedicated_search" style="margin-bottom: 10px;">
                                            <label>Search for elastic source:</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="rowElasticSourcesDedicatedTable2" class="dashboard-row dashboard-row3">
                        <div id="panelElasticSourcesDedicatedTable2" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div id="tableElasticSourcesDedicated" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_elastic_sources_dedicated_add_back" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" id="btn_modal_elastic_sources_dedicated_add_delete" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                </div>
            </div>
        </div>
    </div>

    <!-- shared elastic sources deletion -->
    <div id="delete_elastic_source" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="delete_elastic_source_main" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_delete_elastic_source">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Actions for shared Elastic Source: </h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <p><b>Confirm modification ?</b><br />
                                    </p>
                                    <p>
                                        <label>Optional: enter a note of this update. <br />
                                            This note will be logged and made available for notification.</label>
                                        <textarea
                                                id = "elastic_source_shared_delete_comment"
                                                rows = "6"
                                                cols = "160" style="width: 500px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_elastic_source_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_elastic_source_confirm" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- dedicated elastic sources deletion -->
    <div id="delete_elastic_source_dedicated" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="delete_elastic_source_main_dedicated" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_delete_elastic_source_dedicated">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Actions for dedicated Elastic Source: </h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <p><b>Confirm modification ?</b><br />
                                    </p>
                                    <p>
                                        <label>Optional: enter a note of this update. <br />
                                            This note will be logged and made available for notification.</label>
                                        <textarea
                                                id = "elastic_source_dedicated_delete_comment"
                                                rows = "6"
                                                cols = "160" style="width: 500px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_elastic_source_dedicated_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_elastic_source_dedicated_confirm" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Custom lagging -->
    <div id="main_manage_custom_lagging" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="manage_custom_lagging" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_manage_custom_lagging">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Actions for lagging classes: </h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <p><b>Confirm modification ?</b><br />
                                    </p>
                                    <p>
                                        <label>Optional: enter a note of this update. <br />
                                            This note will be logged and made available for notification.</label>
                                        <textarea
                                                id = "data_source_lagging_policy_delete_comment"
                                                rows = "6"
                                                cols = "160" style="width: 500px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_custom_lagging_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_lagging_data_source_policy_delete_level2" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for metric SLA policy -->
    <div id="main_manage_metric_sla_policy" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="manage_metric_sla_policy" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_manage_metric_sla_policy">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Actions for metric category: </h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <p><b>Confirm modification ?</b><br />
                                    </p>
                                    <p>
                                        <label>Optional: enter a note of this update. <br />
                                            This note will be logged and made available for notification.</label>
                                        <textarea
                                                id = "metric_host_sla_policy_delete_comment"
                                                rows = "6"
                                                cols = "160" style="width: 500px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_metric_sla_policy_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_metric_sla_policy_level2" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--

    Whitelist management

    -->

    <!-- whitelist data_source -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_source_whitelist" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Modify index allowlisting</h1>
                </div>
                <div class="modal-body">
                    <b>If no indexes are in allowlist, TrackMe will use all available indexes, otherwise only the indexes in allowlist will be taken in charge</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_source_whitelist">
                    </div>

                    <div id="rowWhiteListDataSource1a" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListDataSource1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">

                                        <div class="input input-linklist" id="inputLinkTimeWhiteListDataSource">
                                            <label>&nbsp;</label>
                                        </div>

                                        <div class="input input-dropdown" id="modal_input_data_source_whitelist" style="margin-top: 10px; margin-bottom: 10px;">
                                            <label>index name:</label>
                                        </div>

                                        <div class="input input-dropdown" id="modal_textinput_data_source_whitelist" style="margin-bottom: 10px;">
                                            <label>or manual index name expression: (supports wildcards)</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_source_whitelist_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this index</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowWhiteListDataSource1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleWhiteListDataSource" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowWhiteListDataSourceEmpty" class="dashboard-row dashboard-row" data-rejects="$show_table_data_source_whitelist$">
                        <div id="panelWhiteListDataSourceEmpty" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">All indexes are currently allowed in the data discovery, or your search did generate any results.</h3>
                                        <br /><br />
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowWhiteListDataSource2a" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListDataSource2a" class="dashboard-cell" style="margin-top: -25px; width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_whitelist_search" style="margin-bottom: 10px;">
                                            <label>Search for index name:</label>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowWhiteListDataSource2b" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListDataSource2b" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">

                                        <div id="tableWhiteListDataSource" class="dashboard-element table" style="width: 100%">
                                            <label>Select entries and use the remove selected button:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_source_whitelist_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" id="btn_modal_data_source_whitelist_add_delete" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                </div>
            </div>
        </div>
    </div>

    <!-- whitelist data_host -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_host_whitelist" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Modify index allowlisting</h1>
                </div>
                <div class="modal-body">
                    <b>If no indexes are in allowlist, TrackMe will use all available indexes, otherwise only the indexes in allowlist will be taken in charge</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_host_whitelist">
                    </div>

                    <div id="rowWhiteListDataHost1a" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListDataHost1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">

                                        <div class="input input-linklist" id="inputLinkTimeWhiteListDataHost">
                                            <label>&nbsp;</label>
                                        </div>

                                        <div class="input input-dropdown" id="modal_input_data_host_whitelist" style="margin-top: 10px; margin-bottom: 10px;">
                                            <label>index name:</label>
                                        </div>

                                        <div class="input input-dropdown" id="modal_textinput_data_host_whitelist" style="margin-bottom: 10px;">
                                            <label>or manual index name expression: (supports wildcards)</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_host_whitelist_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this index</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowWhiteListDataHost1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleWhiteListDataHost" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowWhiteListDataHostEmpty" class="dashboard-row dashboard-row" data-rejects="$show_table_data_host_whitelist$">
                        <div id="panelWhiteListDataHostEmpty" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">All indexes are currently allowed in the data discovery, or your search did not return any results.</h3>
                                        <br /><br />
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowWhiteListDataHost2a" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListDataHost2a" class="dashboard-cell" style="margin-top: -25px; width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_whitelist_search" style="margin-bottom: 10px;">
                                            <label>Search for index name:</label>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowWhiteListDataHost2b" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListDataHost2b" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div id="tableWhiteListDataHost" class="dashboard-element table" style="width: 100%">
                                            <label>Select entries and use the remove selected button:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_host_whitelist_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" id="btn_modal_data_host_whitelist_add_delete" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                </div>
            </div>
        </div>
    </div>

    <!-- whitelist metric_host -->
    <div class="modal fade custom-modal-50" id="modal_modify_metric_host_whitelist" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Modify index allowlisting</h1>
                </div>
                <div class="modal-body">
                    <b>If no indexes are in allowlist, TrackMe will use all available indexes, otherwise only the indexes in allowlist will be taken in charge</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_metric_host_whitelist">
                    </div>

                    <div id="rowWhiteListMetricHost1a" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListMetricHost1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">

                                        <div class="input input-linklist" id="inputLinkTimeWhiteListMetricHost">
                                            <label>&nbsp;</label>
                                        </div>

                                        <div class="input input-dropdown" id="modal_input_metric_host_whitelist" style="margin-top: 10px; margin-bottom: 10px;">
                                            <label>index name:</label>
                                        </div>

                                        <div class="input input-dropdown" id="modal_textinput_metric_host_whitelist" style="margin-bottom: 10px;">
                                            <label>or manual index name expression: (supports wildcards)</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_metric_host_whitelist_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this index</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowWhiteListMetricHost1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleWhiteListMetricHost" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowWhiteListMetricHostEmpty" class="dashboard-row dashboard-row" data-rejects="$show_table_metric_host_whitelist$">
                        <div id="panelWhiteListMetricHostEmpty" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">All indexes are currently allowed in the data discovery, or your search did return any results.</h3>
                                        <br /><br />
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowWhiteListMetricHost2a" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListMetricHost2a" class="dashboard-cell" style="margin-top: -25px; width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_metric_host_whitelist_search" style="margin-bottom: 10px;">
                                            <label>Search for index name:</label>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowWhiteListMetricHost2b" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListMetricHost2b" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div id="tableWhiteListMetricHost" class="dashboard-element table" style="width: 100%">
                                            <label>Select entries and use the remove selected button:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_metric_host_whitelist_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" id="btn_modal_metric_host_whitelist_add_delete" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                </div>
            </div>
        </div>
    </div>

    <!--

    Blacklist management

    -->

    <!-- blacklist host -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_source_blacklist_host" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Modify host blocklisting</h1>
                </div>
                <div class="modal-body">
                    <b>Hosts that have been blocklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_source_blacklist_host">
                    </div>

                    <b>Blocklist entries support the following types:</b>
                    <br /><br />

                    <lu>
                        <li>explicit names, example: <code>dev001</code></li>
                        <li>wildcards, example: <code>dev-*</code></li>
                        <li>regular expressions, example: <code>(?i)dev-.*</code></li>
                    </lu>

                    <br />

                    <div id="rowBlackListDataSourceHost1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceHost1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_host" style="margin-bottom: 10px;">
                                            <label>host name or expression:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_source_blacklist_host_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this entry</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListDataSourceHost1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListDataSourceHost" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListDataSourceHost2a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceHost2a" class="dashboard-cell" style="margin-top: -25px; width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_host_search" style="margin-bottom: 10px;">
                                            <label>Search for host name:</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="rowBlackListDataSourceHost2b" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceHost2b" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div id="tableBlackListDataSourceHost" class="dashboard-element table" style="width: 100%">
                                            <label>Select entries and use the remove selected button:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_source_blacklist_host_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" id="btn_modal_data_source_blacklist_host_add_delete" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist index -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_source_blacklist_index" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Modify index blocklisting</h1>
                </div>
                <div class="modal-body">
                    <b>Indexes that have been blocklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_source_blacklist_index">
                    </div>

                    <b>Blocklist entries support the following types:</b>
                    <br /><br />

                    <lu>
                        <li>explicit names, example: <code>dev001</code></li>
                        <li>wildcards, example: <code>dev-*</code></li>
                        <li>regular expressions, example: <code>(?i)dev-.*</code></li>
                    </lu>

                    <br />

                    <div id="rowBlackListDataSourceIndex1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceIndex1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_index" style="margin-bottom: 10px;">
                                            <label>index name or expression:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_source_blacklist_index_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this entry</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListDataSourceIndex1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListDataSourceIndex" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListDataSourceIndex2a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceIndex2a" class="dashboard-cell" style="margin-top: -25px; width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_index_search" style="margin-bottom: 10px;">
                                            <label>Search for index name:</label>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowBlackListDataSourceIndex2b" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceIndex2b" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div id="tableBlackListDataSourceIndex" class="dashboard-element table" style="width: 100%">
                                            <label>Select entries and use the remove selected button:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_source_blacklist_index_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" id="btn_modal_data_source_blacklist_index_add_delete" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist sourcetype -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_source_blacklist_sourcetype" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Modify sourcetype blocklisting</h1>
                </div>
                <div class="modal-body">
                    <b>Sourcetypes that have been blocklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_source_blacklist_sourcetype">
                    </div>

                    <b>Blocklist entries support the following types:</b>
                    <br /><br />

                    <lu>
                        <li>explicit names, example: <code>dev001</code></li>
                        <li>wildcards, example: <code>dev-*</code></li>
                        <li>regular expressions, example: <code>(?i)dev-.*</code></li>
                    </lu>

                    <br />

                    <div id="rowBlackListDataSourceSourcetype1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceSourcetype1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_sourcetype" style="margin-bottom: 10px;">
                                            <label>sourcetype name or expression:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_source_blacklist_sourcetype_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this entry</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListDataSourceSourcetype1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListDataSourceSourcetype" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListDataSourceSourcetype2a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceSourcetype2a" class="dashboard-cell" style="margin-top: -25px; width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_sourcetype_search" style="margin-bottom: 10px;">
                                            <label>Search for sourcetype name:</label>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowBlackListDataSourceSourcetype2b" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceSourcetype2b" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div id="tableBlackListDataSourceSourcetype" class="dashboard-element table" style="width: 100%">
                                            <label>Select entries and use the remove selected button:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_source_blacklist_sourcetype_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" id="btn_modal_data_source_blacklist_sourcetype_add_delete" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist sourcetype -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_source_blacklist_data_name" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Modify data_name blocklisting</h1>
                </div>
                <div class="modal-body">
                    <b>Data names that have been blocklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_source_blacklist_data_name">
                    </div>

                    <b>Blocklist entries support the following types:</b>
                    <br /><br />

                    <lu>
                        <li>explicit names, example: <code>dev001</code></li>
                        <li>wildcards, example: <code>dev-*</code></li>
                        <li>regular expressions, example: <code>(?i)dev-.*</code></li>
                    </lu>

                    <br />

                    <div id="rowBlackListDataSourceDataName1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceDataName1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_data_name" style="margin-bottom: 10px;">
                                            <label>data name or expression:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_source_blacklist_data_name_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this entry</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListDataSourceDataName1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListDataSourceDataName" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListDataSourceDataName2a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceDataName2a" class="dashboard-cell" style="margin-top: -25px; width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_data_name_search" style="margin-bottom: 10px;">
                                            <label>Search for data name:</label>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowBlackListDataSourceDataName2b" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceDataName2b" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div id="tableBlackListDataSourceDataName" class="dashboard-element table" style="width: 100%">
                                            <label>Select entries and use the remove selected button:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_source_blacklist_data_name_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" id="btn_modal_data_source_blacklist_data_name_add_delete" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                </div>
            </div>
        </div>
    </div>

    <!--
    blacklist data host
    -->

    <!-- blacklist host -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_host_blacklist_host" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Modify host blocklisting</h1>
                </div>
                <div class="modal-body">
                    <b>Hosts that have been blocklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_host_blacklist_host">
                    </div>

                    <b>Blocklist entries support the following types:</b>
                    <br /><br />

                    <lu>
                        <li>explicit names, example: <code>dev001</code></li>
                        <li>wildcards, example: <code>dev-*</code></li>
                        <li>regular expressions, example: <code>(?i)dev-.*</code></li>
                    </lu>

                    <br />

                    <div id="rowBlackListDataHostHost1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostHost1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_blacklist_host" style="margin-bottom: 10px;">
                                            <label>host name or expression:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_host_blacklist_host_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this entry</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListDataHostHost1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListDataHostHost" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListDataHostHost2a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostHost2a" class="dashboard-cell" style="margin-top: -25px; width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_blacklist_host_search" style="margin-bottom: 10px;">
                                            <label>Search for host name:</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="rowBlackListDataHostHost2b" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostHost2b" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div id="tableBlackListDataHostHost" class="dashboard-element table" style="width: 100%">
                                            <label>Select entries and use the remove selected button:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_host_blacklist_host_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" id="btn_modal_data_host_blacklist_host_add_delete" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Added message -->
    <div class="modal fade" id="modal_blacklist_added" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-success">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span>Black list host updated</h1>
                </div>
                <div class="modal-body">
                    <p><b>The host was successfully added to the blacklist host collection. the host will be permanently excluded from the data sources discovery.</b><br /><br />
                        <br /><br />
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- data source monitoring -->

    <!-- Modal window for data source unified -->
    <div class="modal fade custom-modal-80" id="modal_modify_data_source_unified" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Data source unified update </h1>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <b>Lag monitoring policy:</b>

                            <div style="margin-left: 15px;">
                                <lu>
                                    <li>The maximal allowed lagging value defines the maximal value in seconds before a data source / host would be considered as red</li>
                                    <li>Override lagging classes allows bypassing any lagging classes configuration that would apply to this data source or host</li>
                                    <li>If a lagging class matches index(es) or sourcetype(es) for this data source or host and the option is unchecked, it will bypass this value unless override is true</li>
                                </lu>
                            </div>

                            <br />

                            <div id="rowDataSourceModifyMain" class="dashboard-row dashboard-row1">
                                <div id="panel1" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">          
                                        <div class="fieldset">
                                            <div style="margin-right: 28px;" class="input input-text" id="modal_input_lag">
                                                <label>Maximal allowed lagging value:</label>
                                            </div>
                                            <div class="input input-dropdown" id="modal_input_lag_override_class">
                                                <label>Override lagging classes:</label>
                                            </div>
                                            <div class="input input-dropdown" id="modal_input_lag_alert_over">
                                                <label>Alert over KPIs:</label>
                                            </div>
                                        </div>                                        
                                    </div>
                                </div>
                            </div>

                            <button id="btn_modal_modify_lag_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply manual lagging rule</button>
                            <button id="btn_modal_modify_lag_auto_main" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Or choose an auto lagging</button>

                            <div class="boxnotify" id="boxnotify-unified-data-source">
                            </div>

                        </div>

                        <hr>

                        <div style="margin-bottom: 10px; width: 50%; float:left">

                            <b>Priority:</b>

                            <p>Define the priority of the data source for granular level of SLA alerting:</p>

                            <p>
                                <span class="title_low_priority">low</span>
                                <span class="title_medium_priority">medium</span>
                                <span class="title_high_priority">high</span>
                            </p>

                            <div id="rowDataSourceModifyMain2" class="dashboard-row dashboard-row1">
                                <div id="panel1" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">          
                                        <div class="fieldset">
                                            <div class="input input-text" id="modal_input_priority">
                                                <label></label>
                                            </div>
                                        </div>                                        
                                    </div>
                                </div>
                            </div>

                            <div>
                                <button id="btn_modal_modify_priority_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply priority</button>
                            </div>

                        </div>

                        <div style="margin-bottom: 10px; width: 50%; float:right">

                            <b>Week days monitoring:</b>

                            <p>Monitor source on a all days basis, apply a builtin rule, or explicitly select week days:</p>

                            <div id="rowDataSourceModifyMain3" class="dashboard-row dashboard-row1">
                                <div id="panel1" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">          
                                        <div class="fieldset">
                                            <div class="input input-text" id="modal_input_wdays">
                                                <label></label>
                                            </div>
                                        </div>                                        
                                    </div>
                                </div>
                            </div>

                            <div>
                                <button id="btn_modal_modify_monitoring_wdays_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply wdays builtin rule</button>
                                <button id="btn_modal_modify_wdays_no" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Or select days of the week</button>
                            </div>

                        </div>

                        <hr>

                        <div style="margin-top: 190px; margin-bottom: 10px; width: 50%;">

                            <hr>

                            <b>Monitoring level:</b>

                            <p>Monitor based on index/sourcetype (default), or based on the latest data available in the index:</p>

                            <div id="rowDataSourceModifyMain4" class="dashboard-row dashboard-row1">
                                <div id="panel1" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">          
                                        <div class="fieldset">
                                            <div class="input input-text" id="modal_input_level">
                                                <label></label>
                                            </div>
                                        </div>                                        
                                    </div>
                                </div>
                            </div>

                            <button id="btn_modal_modify_monitoring_level_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply monitoring level rule</button>

                        </div>

                        <div style="margin-top: -196px; margin-bottom: 10px; width: 50%; float: right;">

                            <hr>

                            <b>Hosts disctinct count:</b>

                            <p>Enter the minimal hosts dcount value for the data source (turns red if condition is not met):</p>

                            <div id="rowDataSourceModifyMain5" class="dashboard-row dashboard-row1">
                                <div id="panel1" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">          
                                        <div class="fieldset">
                                            <div class="input input-text" id="modal_input_dcount_host">
                                                <label></label>
                                            </div>
                                        </div>                                        
                                    </div>
                                </div>
                            </div>

                            <button id="btn_modal_modify_dcount_host_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply host dcount rule</button>

                        </div>


                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_close_data_source_unified" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window for data source unified autolag -->
    <div class="modal fade custom-modal-80" id="modal_modify_data_source_autolag" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Data source unified update </h1>
                </div>

                <div class="modal-body">

                    <div style="margin-bottom: 30px;">
                        <h3>The following calculations reppresent different options that could be used to define an appropriate value for the max lagging value allowed. </br>Note that these calculations are performed against the lag at ingestion time only.</h3>
                    </div>

                    <div id="rowSingleLagAutoLagging" class="dashboard-row dashboard-row1">
                        <div id="panelSingleLagAutoLagging" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div id="elementDataSourceAutoLaggingDataSourceSingleLagPerc95" class="dashboard-element chart" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                    <div id="elementDataSourceAutoLaggingDataSourceSingleLagAvg" class="dashboard-element chart" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                    <div id="elementDataSourceAutoLaggingDataSourceSingleLagPerc95Last30d" class="dashboard-element chart" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                    <div id="elementDataSourceAutoLaggingDataSourceSingleLagAvgLast30d" class="dashboard-element chart" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div>

                        <div style="margin-bottom: 10px;">

                            <h4>Choose one option to be applied:</h4>

                            <button id="btn_modal_modify_lag_auto_perc95" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply auto percentile lag (7d)</button>
                            <button id="btn_modal_modify_lag_auto_perc95_30d" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Or Apply auto percentile lag (30d)</button>
                            <button id="btn_modal_modify_lag_auto_average" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Or Apply auto average lag (7d)</button>
                            <button id="btn_modal_modify_lag_auto_average_30d" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Or Apply auto average lag (30d)</button>

                            <div class="boxnotify" id="boxnotify-unified-data-source-autolag">
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_close_data_source_unified_autolag" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>

            </div>

        </div>
    </div>

    <!-- data host monitoring -->

    <!-- Modal window for data source unified -->
    <div class="modal fade custom-modal-80" id="modal_modify_data_host_unified" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Data host unified update </h1>
                </div>

                <div class="modal-body">

                    <b>Lag monitoring policy:</b>

                    <div style="margin-left: 15px;">
                        <lu>
                            <li>The maximal allowed lagging value defines the threshold in seconds for green/red assignment (depending on Alerts over KPIs). Ideally defined by policies, this value can as well be defined per host.</li>
                            <li>Override lagging classes allows bypassing any lagging classes configuration, for data hosts and if defined to true, this applies to all sourcetypes for the host.</li>
                            <li>Alerting policy defines the global behaviour when multiple sourcetypes are monitored for a same host, alerting can be based on the overall host indexing or by considering each sourcetype individually.</li>
                            <li>To define a manual lagging value for this host, enter the value in seconds and set lagging class override to true (otherwise this value will not be saved), optionally define Alert over KPIs and Alerting policy.</li>
                            <li>Alert over KPIs and Alerting policy can be configured independantly from the max lagging value/lagging class override.</li>
                        </lu>
                    </div>

                    <br />

                    <div id="rowDataHostModifyMain" class="dashboard-row dashboard-row1">
                        <div id="panel1" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">          
                                <div class="fieldset">
                                    <div style="margin-right: 28px;" class="input input-text" id="modal_input_lag_host">
                                        <label>Maximal allowed lagging value:</label>
                                    </div>
                                    <div class="input input-dropdown" id="modal_input_lag_override_class_host">
                                        <label>Override lagging classes:</label>
                                    </div>
                                    <div class="input input-dropdown" id="modal_input_lag_alert_over_host">
                                        <label>Alert over KPIs:</label>
                                    </div>
                                    <div class="input input-dropdown" id="modal_input_host_alerting_policy">
                                        <label>Alerting policy:</label>
                                    </div>
                                </div>                                        
                            </div>
                        </div>
                    </div>

                    <button id="btn_modal_modify_lag_confirm_host" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply manual lagging rule</button>
                    <button id="btn_modal_modify_lag_auto_main_host" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Or choose an auto lagging</button>

                    <div class="boxnotify" id="boxnotify-unified-data-host">
                    </div>

                    <hr>

                    <div style="margin-bottom: 10px; width: 50%; float:left">

                        <b>Priority:</b>

                        <p>Define the priority of the data host for granular level of SLA alerting:</p>

                        <p>
                            <span class="title_low_priority">low</span>
                            <span class="title_medium_priority">medium</span>
                            <span class="title_high_priority">high</span>
                        </p>

                        <div id="rowDataHostModifyMain2" class="dashboard-row dashboard-row1">
                            <div id="panel1" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">          
                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_host_priority">
                                            <label></label>
                                        </div>
                                    </div>                                        
                                </div>
                            </div>
                        </div>

                        <div>
                            <button id="btn_modal_modify_priority_host_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply priority</button>
                        </div>

                    </div>

                    <div style="margin-bottom: 10px; width: 50%; float:right">

                        <b>Associate to a Logical group:</b>

                        <p>Logical groups are groups of entities that will be considered as an ensemble for monitoring purposes.
                            <br />
                            A typical use case is a couple of active / passive appliances, where only the active member generates data.
                            <br /><br />
                            When associated in a Logical group, the entity status relies on the minimal green percentage configured during the group creation versus
                            the current green percentage of the group. (percentages of members green)
                        </p>

                        <div style="margin-bottom: 20px;" class="btn_logical_group">
                            <button type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Manage in a Logical group </button>
                        </div>

                    </div>

                    <div style="margin-top: 240px; margin-bottom: 10px;">

                        <hr>
                        
                        <b>Week days monitoring:</b>

                        <p>Monitor source on a all days basis, apply a builtin rule, or explicitly select week days:</p>

                        <div id="rowDataSourceModifyMain3" class="dashboard-row dashboard-row1">
                            <div id="panel1" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">          
                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_wdays_host">
                                            <label></label>
                                        </div>
                                    </div>                                        
                                </div>
                            </div>
                        </div>

                        <div>
                            <button id="btn_modal_modify_monitoring_wdays_host_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply wdays builtin rule</button>
                            <button id="btn_modal_modify_wdays_host_no" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Or select days of the week</button>
                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_close_data_host_unified" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>

        </div>
    </div>

    <!-- Modal window for data source unified autolag -->
    <div class="modal fade custom-modal-80" id="modal_modify_data_host_autolag" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Data host unified update </h1>
                </div>
                
                <div class="modal-body">

                    <div style="margin-bottom: 30px;">
                        <h3>The following calculations reppresent different options that could be used to define an appropriate value for the max lagging value allowed. </br>Note that these calculations are performed against the lag at ingestion time only.</h3>
                    </div>

                    <div id="rowSingleLagAutoLaggingHost" class="dashboard-row dashboard-row1">
                        <div id="panelSingleLagAutoLaggingHost" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div id="elementDataHostAutoLaggingDataHostSingleLagPerc95" class="dashboard-element chart" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                    <div id="elementDataHostAutoLaggingDataHostSingleLagAvg" class="dashboard-element chart" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                    <div id="elementDataHostAutoLaggingDataHostSingleLagPerc95Last30d" class="dashboard-element chart" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                    <div id="elementDataHostAutoLaggingDataHostSingleLagAvgLast30d" class="dashboard-element chart" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div>

                        <div style="margin-bottom: 10px;">

                            <h4>Choose one option to be applied:</h4>

		                    <button id="btn_modal_modify_lag_auto_perc95_host" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply auto percentile lag (7d)</button>
		                    <button id="btn_modal_modify_lag_auto_perc95_30d_host" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Or Apply auto percentile lag (30d)</button>
		                    <button id="btn_modal_modify_lag_auto_average_host" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Or Apply auto average lag (7d)</button>
		                    <button id="btn_modal_modify_lag_auto_average_30d_host" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Or Apply auto average lag (30d)</button>

                            <div class="boxnotify" id="boxnotify-unified-data-host-autolag">
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_close_data_host_unified_autolag" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>

            </div>

        </div>
    </div>

    <!-- metric host monitoring -->

    <!-- Modal window for data source unified -->
    <div class="modal fade custom-modal-80" id="modal_modify_metric_host_unified" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Metric host unified update </h1>
                </div>

                <div class="modal-body">

                    <div style="margin-bottom: 10px; width: 50%; float: left;">

                        <b>Metric host priority:</b>

                        <div class="boxnotify" id="boxnotify-unified-metric-host">
                        </div>

                        <p>Define the priority of the metric host for granular level of SLA alerting:</p>

                        <p>
                            <span class="title_low_priority">low</span>
                            <span class="title_medium_priority">medium</span>
                            <span class="title_high_priority">high</span>
                        </p>

                        <div class="fieldset">
                            <div class="input input-text" id="modal_input_metric_host_priority">
                                <label></label>
                            </div>
                        </div>

                        <div>
                            <button id="btn_modal_modify_priority_metric_host_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply priority</button>
                        </div>

                    </div>

                    <div style="margin-bottom: 10px; width: 50%; float: right;">

                        <b>Associate to a Logical group:</b>

                        <p>Logical groups are groups of entities that will be considered as an ensemble for monitoring purposes.
                            <br />
                            A typical use case is a couple of active / passive appliances, where only the active member generates data.
                            <br /><br />
                            When associated in a Logical group, the entity status relies on the minimal green percentage configured during the group creation versus
                            the current green percentage of the group. (percentages of members green)
                        </p>

                        <div style="margin-bottom: 20px;" class="btn_logical_group">
                            <button type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Manage in a Logical group </button>
                        </div>

                    </div>

                </div>

                <div style="margin-top: 260px;" class="modal-footer">
                    <button type="submit" id="btn_close_metric_host_unified" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>

        </div>
    </div>

    <!-- Modal window for monitoring level modification -->
    <div class="modal fade" id="modal_modify_monitoring_wdays_no" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Monitoring week days update </h1>
                </div>
                <div class="modal-body">
                    <p>
                        Select the days of the week where will be applied the monitoring rules.
                        <br /><br />
                        If the data source is not available during a week day that is not selected, no alert will be given.
                        <br /><br />
                    </p>

                    <div class="fieldset">
                        <div class="input input-checkboxgroup" id="modal_input_wdays_no">
                            <label></label>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button id="btn_modal_modify_monitoring_wdays_no_cancel" type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button id="btn_modal_modify_monitoring_wdays_no_confirm" type="submit" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- data host monitoring -->

    <!-- Modal window for monitoring level modification -->
    <div class="modal fade" id="modal_modify_monitoring_wdays_host_no" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Monitoring week days update </h1>
                </div>
                <div class="modal-body">
                    <p>
                        Select the days of the week where will be applied the monitoring rules.
                        <br /><br />
                        If the data source is not available during a week day that is not selected, no alert will be given.
                        <br /><br />
                    </p>

                    <div class="fieldset">
                        <div class="input input-checkboxgroup" id="modal_input_wdays_host_no">
                            <label></label>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button id="btn_modal_modify_monitoring_wdays_host_no_cancel" type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button id="btn_modal_modify_monitoring_wdays_host_no_confirm" type="submit" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!--

    Metrics SLA policies editor

    -->

    <div class="modal fade custom-modal-60" id="modal_metric_sla_policies" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Metrics SLA policies editor </h1>
                </div>
                <div class="modal-body">
                    <b>Use this interface to manage SLA policies for metric categories:</b>
                    <lu>
                        <li>A metric category is extracted automatically from the first segment of the metric path (ex: cpu for cpu.cpu_idle)</li>
                        <li>If a metric category is not listed in the policies, a default value is applied automatically</li>
                        <li>Each metric category is taken in consideration individually based on these rules</li>
                    </lu>
                    <br />

                    <div class="boxnotify" id="boxnotify-btn_modify_metric_sla_policies">
                    </div>

                    <div id="rowMetricsPolicies1a" class="dashboard-row dashboard-row3">
                        <div id="panelMetricsPolicies1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">

                                         <div class="input input-dropdown" id="inputMetricPolicySLA_category" style="margin-bottom: 10px;">
                                        <label>metric_category:</label>
                                        </div>

                                        <div class="input input-text" id="inputMetricPolicySLA_value" style="margin-bottom: 10px;">
                                        <label>metric_max_lag_allowed:</label>
                                        </div>

                                        <br /><br />

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_metric_policy_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this metric SLA policy</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowMetricPolicy1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="SingleMetricPolicies" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowMetricPolicyTable" class="dashboard-row dashboard-row3">
                        <div id="panelMetricPolicyTable" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div id="tableMetricPolicies" class="dashboard-element table" style="width: 100%">
                                            <label>Select entries and use the remove selected button:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_delete_metric_sla_policy_level1" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                </div>
            </div>
        </div>
    </div>

    <!--

    whitelist

    -->

    <!-- whitelist data_source -->

    <!-- Modal drilldown context for WhiteList -->
    <div id="main_modal_manage_data_source_whitelist" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_source_whitelist" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_source_whitelist">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Actions for index in allowlist: </h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <p><b>Confirm modification ?</b><br />
                                    </p>
                                    <p>
                                        <label>Optional: enter a note of this update. <br />
                                            This note will be logged and made available for notification.</label>
                                        <textarea
                                                id = "data_source_whitelist_index_delete_comment"
                                                rows = "6"
                                                cols = "160" style="width: 500px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                    </p>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_source_whitelist_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_source_whitelist" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- whitelist metric_host -->

    <!-- Modal drilldown context for WhiteList -->
    <div id="main_modal_manage_metric_host_whitelist" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_metric_host_whitelist" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_metric_host_whitelist">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Actions for index in allowlist: </h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <p><b>Confirm modification ?</b><br />
                                    </p>
                                    <p>
                                        <label>Optional: enter a note of this update. <br />
                                            This note will be logged and made available for notification.</label>
                                        <textarea
                                                id = "metric_host_whitelist_index_delete_comment"
                                                rows = "6"
                                                cols = "160" style="width: 500px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                    </p>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_metric_host_whitelist_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_metric_host_whitelist" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- whitelist data_host -->

    <!-- whitelist data_source -->

    <!-- Modal drilldown context for WhiteList -->
    <div id="main_modal_manage_data_host_whitelist" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_host_whitelist" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_host_whitelist">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Actions for index in allowlist: </h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <p><b>Confirm modification ?</b><br />
                                    </p>
                                    <p>
                                        <label>Optional: enter a note of this update. <br />
                                            This note will be logged and made available for notification.</label>
                                        <textarea
                                                id = "data_host_whitelist_index_delete_comment"
                                                rows = "6"
                                                cols = "160" style="width: 500px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                    </p>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_host_whitelist_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_host_whitelist" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--

    blacklist

    -->

    <!-- blacklist -->

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_data_source_blacklist_host" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_source_blacklist_host" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_source_blacklist_host">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Actions for host in blocklist: </h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <p><b>Confirm modification ?</b><br />
                                    </p>
                                    <p>
                                        <label>Optional: enter a note of this update. <br />
                                            This note will be logged and made available for notification.</label>
                                        <textarea
                                                id = "data_source_blocklist_host_delete_comment"
                                                rows = "6"
                                                cols = "160" style="width: 500px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                    </p>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_source_blacklist_host_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_source_blacklist_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist -->

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_data_source_blacklist_index" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_source_blacklist_index" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_source_blacklist_index">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Actions for host in blocklist: </h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <p><b>Confirm modification ?</b><br />
                                    </p>
                                    <p>
                                        <label>Optional: enter a note of this update. <br />
                                            This note will be logged and made available for notification.</label>
                                        <textarea
                                                id = "data_source_blocklist_index_delete_comment"
                                                rows = "6"
                                                cols = "160" style="width: 500px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                    </p>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_source_blacklist_index_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_source_blacklist_index" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_data_source_blacklist_sourcetype" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_source_blacklist_sourcetype" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_source_blacklist_sourcetype">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Actions for host in blocklist: </h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <p><b>Confirm modification ?</b><br />
                                    </p>
                                    <p>
                                        <label>Optional: enter a note of this update. <br />
                                            This note will be logged and made available for notification.</label>
                                        <textarea
                                                id = "data_source_blocklist_sourcetype_delete_comment"
                                                rows = "6"
                                                cols = "160" style="width: 500px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                    </p>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_source_blacklist_sourcetype_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_source_blacklist_sourcetype" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_data_source_blacklist_data_name" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_source_blacklist_data_name" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_source_blacklist_data_name">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Actions for data_name in blocklist: </h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <p><b>Confirm modification ?</b><br />
                                    </p>
                                    <p>
                                        <label>Optional: enter a note of this update. <br />
                                            This note will be logged and made available for notification.</label>
                                        <textarea
                                                id = "data_source_blocklist_data_name_delete_comment"
                                                rows = "6"
                                                cols = "160" style="width: 500px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                    </p>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_source_blacklist_data_name_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_source_blacklist_data_name" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist -->

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_data_host_blacklist_host" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_host_blacklist_host" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_host_blacklist_host">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Actions for host in blocklist: </h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <p><b>Confirm modification ?</b><br />
                                    </p>
                                    <p>
                                        <label>Optional: enter a note of this update. <br />
                                            This note will be logged and made available for notification.</label>
                                        <textarea
                                                id = "data_host_blocklist_host_delete_comment"
                                                rows = "6"
                                                cols = "160" style="width: 500px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                    </p>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_host_blacklist_host_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_host_blacklist_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_metric_host_blacklist_host" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_metric_host_blacklist_host" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_metric_host_blacklist_host">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Actions for host in blocklist: </h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <p><b>Confirm modification ?</b><br />
                                    </p>
                                    <p>
                                        <label>Optional: enter a note of this update. <br />
                                            This note will be logged and made available for notification.</label>
                                        <textarea
                                                id = "metric_host_blocklist_host_delete_comment"
                                                rows = "6"
                                                cols = "160" style="width: 500px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                    </p>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_metric_host_blacklist_host_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_metric_host_blacklist_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- RUN TRACKERS -->

    <!-- data_sources -->

    <div id="main_modal_run_data_source_trackers" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal custom-modal-50 fade" id="modal_run_data_source_trackers" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="dashboard-element html">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-info">
                                    <h1 style="color: white;">Trackers: data sources</h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <br />

                                <div class="modal-body" style="margin-top: 20px;">
                                    <span class="title_blue">Main tracker reports:</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <lu>
                                        <li>Use "Run: short term tracker now" button to run the regular data sources tracker for short term period (-24h / +4h)</li>
                                        <li>Use "Run: long term tracker now" button to run the regular data sources tracker for long term period (-7d / +4h)</li>
                                        <li>Use "Run: Elastic shared tracker now" button to run the tracker report for shared Elastic sources (-4h / +4h)</li>
                                    </lu>
                                </div>

                                <div class="modal-body" style="margin-top: 20px;">
                                    <span class="title_blue">Data sampling &amp; events format recognition</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <lu>
                                        <li>Use "Run: data sampling now" button to run the data sampling and format recognition tracker (-24h / +4h)</li>
                                    </lu>
                                </div>

                                <br />

                            </div>
                        </div>
                        <div class="modal-footer">
                            <div class="custom-btn">
                                <button type="submit" id="btn_run_tracker" style="margin-right: 15px;" class="btn btn-outline-secondary"><span class="glyphicon glyphicon-remove"></span> Run: short term tracker now</button>
                            </div>
                            <div class="custom-btn">
                                <button type="submit" id="btn_run_tracker_longterm" style="margin-right: 15px;" class="btn btn-outline-secondary"><span class="glyphicon glyphicon-remove"></span> Run: long term tracker now</button>
                            </div>
                            <div class="custom-btn">
                                <button type="submit" id="btn_run_tracker_shared_elastic" style="margin-right: 15px;" class="btn btn-outline-secondary"><span class="glyphicon glyphicon-remove"></span> Run: Elastic shared tracker now</button>
                            </div>
                            <div class="custom-btn">
                                <button type="submit" id="btn_run_tracker_data_sampling" style="margin-right: 15px;" class="btn btn-outline-secondary"><span class="glyphicon glyphicon-remove"></span> Run: Data Sampling now</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- data_hosts -->

    <div id="main_modal_run_data_host_trackers" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal custom-modal-50 fade" id="modal_run_data_host_trackers" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="dashboard-element html">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-info">
                                    <h1 style="color: white;">Trackers: data hosts</h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <br />

                                <div class="modal-body" style="margin-top: 20px;">
                                    <span class="title_blue">Main tracker reports:</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <br />
                                    <lu>
                                        <li>Use "Run: short term tracker now" button to run the regular data hosts tracker for short term period (-24h / +4h)</li>
                                        <li>Use "Run: long term tracker now" button to run the regular data hosts tracker for long term period (-7d / +4h)</li>
                                    </lu>
                                </div>

                                <br />

                            </div>
                        </div>
                        <div class="modal-footer">
                            <div class="custom-btn">
                                <button type="submit" id="btn_run_tracker_host" style="margin-right: 15px;" class="btn btn-outline-secondary"><span class="glyphicon glyphicon-remove"></span> Run: short term tracker now</button>
                            </div>
                            <div class="custom-btn">
                                <button type="submit" id="btn_run_tracker_host_longterm" style="margin-right: 15px;" class="btn btn-outline-secondary"><span class="glyphicon glyphicon-remove"></span> Run: long term tracker now</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- whitelist & blacklist -->

    <!-- Modal main -->
    <div id="main_modal_manage_data_source_blacklists" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal custom-modal-50 fade" id="modal_manage_data_source_blacklists" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_source_blacklists">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Manage allowlists & blocklists for data sources</h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div class="modal-body" style="margin-bottom: 10px;">
                                    <span class="title_green">Allowlist</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <b>Allowlist of indexes at data discovery and search time:</b>
                                    <br />
                                    <lu>
                                        <li>By default, trackMe searches for entities in all available indexes</li>
                                        <li>You can restrict at any time the list of indexes allowed by editing the content of the allowlist collections</li>
                                        <li>Indexes allowlisting is applied at discovery and search time, but can require the collection to be reset or previously discovered entities to be removed manually</li>
                                    </lu>
                                </div>

                                <br />

                                <div class="modal-body" style="margin-bottom: 10px;">
                                    <span class="title_red">Blocklist</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <b>Blocklists: use these features to blacklist hosts, indexes, sourcetypes or data names at data discovery and search time.</b>
                                    <br />
                                    <lu>
                                        <li>Hosts that have been blocklisted are excluded from the data discovery</li>
                                        <li>Indexes that have been blocklisted are excluded from the data discovery, and from alerting results at search time</li>
                                        <li>Sourcetypes that have been blocklisted are excluded from the data discovery, and from alerting results at search time</li>
                                        <li>Data names are the entities identifiers created by TrackMe, blocklisting will prevent their creation during discovery and at search time</li>
                                    </lu>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <div class="btn_modify_data_source_whitelist custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: allowlist indexes</button>
                            </div>
                            <div class="btn_modify_data_source_blacklist_host custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blocklist hosts</button>
                            </div>
                            <div class="btn_modify_data_source_blacklist_index custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blocklist indexes</button>
                            </div>
                            <div class="btn_modify_data_source_blacklist_sourcetype custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blocklist sourcetypes</button>
                            </div>
                            <div class="btn_modify_data_source_blacklist_data_name custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blocklist data_name</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal main -->
    <div id="main_modal_manage_data_host_blacklists" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal custom-modal-50 fade" id="modal_manage_data_host_blacklists" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_host_blacklists">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Manage allowlists & blocklists for data hosts</h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div class="modal-body" style="margin-bottom: 10px;">
                                    <span class="title_green">Allowlist</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <b>Allowlist of indexes at data discovery and search time:</b>
                                    <br />
                                    <lu>
                                        <li>By default, trackMe searches for entities in all available indexes</li>
                                        <li>You can restrict at any time the list of indexes allowed by editing the content of the allowlist collections</li>
                                        <li>Indexes allowlisting is applied at discovery and search time, but can require the collection to be reset or previously discovered entities to be removed manually</li>
                                    </lu>
                                </div>

                                <br />

                                <div class="modal-body" style="margin-bottom: 10px;">
                                    <span class="title_red">Blocklist</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <b>Use these features to blocklist hosts, indexes or sourcetypes at data discovery and search time.</b>
                                    <br />
                                    <lu>
                                        <li>Hosts that have been blocklisted are excluded from the data discovery, and from alerting results at search time</li>
                                        <li>Indexes that have been blocklisted are excluded from the data discovery, and from alerting results at search time</li>
                                        <li>Sourcetypes that have been blocklisted are excluded from the data discovery, and from alerting results at search time</li>
                                        <li>🛑 When adding indexes and sourcetypes in blocklist, existing entities need to purged or reset, or the whole collection should be reset to reflect the changes</li>
                                    </lu>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <div class="btn_modify_data_host_whitelist custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: allowlist indexes</button>
                            </div>
                            <div class="btn_modify_data_host_blacklist_host custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blocklist hosts</button>
                            </div>
                            <div class="btn_modify_data_host_blacklist_index custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blocklist indexes</button>
                            </div>
                            <div class="btn_modify_data_host_blacklist_sourcetype custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blocklist sourcetypes</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal main -->
    <div id="main_modal_manage_metric_host_blacklists" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal custom-modal-50 fade" id="modal_manage_metric_host_blacklists" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_metric_host_blacklists">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Manage allowlists & blocklists for metric hosts</h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div class="modal-body" style="margin-bottom: 10px;">
                                    <span class="title_green">Allowlist</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <b>Allowlist of indexes at data discovery and search time:</b>
                                    <br />
                                    <lu>
                                        <li>By default, trackMe searches for entities in all available indexes</li>
                                        <li>You can restrict at any time the list of indexes allowed by editing the content of the allowlist collections</li>
                                        <li>Indexes allowlisting is applied at discovery and search time, but can require the collection to be reset or previously discovered entities to be removed manually</li>
                                    </lu>
                                </div>

                                <br />

                                <div class="modal-body" style="margin-bottom: 10px;">
                                    <span class="title_red">Blocklist</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <b>Blocklist: use this feature to globally exclude one of more type of metrics at data discovery and search time.</b>
                                    <br />
                                    <lu>
                                        <li>So called metric category represents the first part of the metric name, and is extracted while discovering the metrics available</li>
                                        <li>For example, metric_category=cpu would exclude any metric_name=cpu.*</li>
                                        <li>You can add or remove metric categories in blacklist at any time</li>
                                    </lu>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <div class="btn_modify_metric_host_whitelist custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: allowlist indexes</button>
                            </div>
                            <div class="btn_modify_metric_host_blacklist_host custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blocklist hosts</button>
                            </div>
                            <div class="btn_modify_metric_host_blacklist_index custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blocklist indexes</button>
                            </div>
                            <div class="btn_modify_metric_host_blacklist_metric_category custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blocklist metric_category</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_data_host_blacklist_index" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_host_blacklist_index" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_host_blacklist_index">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Actions for host in blocklist: </h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <p><b>Confirm modification ?</b><br />
                                    </p>
                                    <p>
                                        <label>Optional: enter a note of this update. <br />
                                            This note will be logged and made available for notification.</label>
                                        <textarea
                                                id = "data_host_blocklist_index_delete_comment"
                                                rows = "6"
                                                cols = "160" style="width: 500px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                    </p>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_host_blacklist_index_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_host_blacklist_index" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_metric_host_blacklist_index" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_metric_host_blacklist_index" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_metric_host_blacklist_index">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Actions for host in blocklist: </h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <p><b>Confirm modification ?</b><br />
                                    </p>
                                    <p>
                                        <label>Optional: enter a note of this update. <br />
                                            This note will be logged and made available for notification.</label>
                                        <textarea
                                                id = "metric_host_blocklist_index_delete_comment"
                                                rows = "6"
                                                cols = "160" style="width: 500px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                    </p>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_metric_host_blacklist_index_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_metric_host_blacklist_index" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_data_host_blacklist_sourcetype" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_host_blacklist_sourcetype" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_host_blacklist_sourcetype">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Actions for host in blocklist: </h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <p><b>Confirm modification ?</b><br />
                                    </p>
                                    <p>
                                        <label>Optional: enter a note of this update. <br />
                                            This note will be logged and made available for notification.</label>
                                        <textarea
                                                id = "data_host_blocklist_sourcetype_delete_comment"
                                                rows = "6"
                                                cols = "160" style="width: 500px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                    </p>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_host_blacklist_sourcetype_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_host_blacklist_sourcetype" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_metric_host_blacklist_metric_category" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_metric_host_blacklist_metric_category" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_metric_host_blacklist_metric_category">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-danger">
                                    <h1 style="color: white;">Actions for metric categories in blocklist: </h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <p><b>Confirm modification ?</b><br />
                                    </p>
                                    <p>
                                        <label>Optional: enter a note of this update. <br />
                                            This note will be logged and made available for notification.</label>
                                        <textarea
                                                id = "metric_host_blocklist_metric_category_delete_comment"
                                                rows = "6"
                                                cols = "160" style="width: 500px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                    </p>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_metric_host_blacklist_metric_category_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_metric_host_blacklist_metric_category" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist index -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_host_blacklist_index" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Modify index blocklisting</h1>
                </div>
                <div class="modal-body">
                    <b>Indexes that have been blocklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_host_blacklist_index">
                    </div>

                    <b>Blocklist entries support the following types:</b>
                    <br /><br />

                    <lu>
                        <li>explicit names, example: <code>dev001</code></li>
                        <li>wildcards, example: <code>dev-*</code></li>
                        <li>regular expressions, example: <code>(?i)dev-.*</code></li>
                    </lu>

                    <br />

                    <div id="rowBlackListDataHostIndex1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostIndex1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_blacklist_index" style="margin-bottom: 10px;">
                                            <label>index name or expression:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_host_blacklist_index_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this entry</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListDataHostIndex1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListDataHostIndex" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListDataHostIndex2a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostIndex2a" class="dashboard-cell" style="margin-top: -25px; width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_blacklist_index_search" style="margin-bottom: 10px;">
                                            <label>Search for index name:</label>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowBlackListDataHostIndex2b" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostIndex2b" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div id="tableBlackListDataHostIndex" class="dashboard-element table" style="width: 100%">
                                            <label>Select entries and use the remove selected button:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_host_blacklist_index_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" id="btn_modal_data_host_blacklist_index_add_delete" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist index -->
    <div class="modal fade custom-modal-50" id="modal_modify_metric_host_blacklist_index" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Modify index blocklisting</h1>
                </div>
                <div class="modal-body">
                    <b>Indexes that have been blocklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_metric_host_blacklist_index">
                    </div>

                    <b>Blocklist entries support the following types:</b>
                    <br /><br />

                    <lu>
                        <li>explicit names, example: <code>dev001</code></li>
                        <li>wildcards, example: <code>dev-*</code></li>
                        <li>regular expressions, example: <code>(?i)dev-.*</code></li>
                    </lu>

                    <br />

                    <div id="rowBlackListMetricHostIndex1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListMetricHostIndex1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_metric_host_blacklist_index" style="margin-bottom: 10px;">
                                            <label>index name or expression:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_metric_host_blacklist_index_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this entry</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListMetricHostIndex1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListMetricHostIndex" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListMetricHostIndex2a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListMetricHostIndex2a" class="dashboard-cell" style="margin-top: -25px; width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_metric_host_blacklist_index_search" style="margin-bottom: 10px;">
                                            <label>Search for index name:</label>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowBlackListMetricHostIndex2b" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListMetricHostIndex2b" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div id="tableBlackListMetricHostIndex" class="dashboard-element table" style="width: 100%">
                                            <label>Select entries and use the remove selected button:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_metric_host_blacklist_index_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" id="btn_modal_metric_host_blacklist_index_add_delete" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist sourcetype -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_host_blacklist_sourcetype" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Modify sourcetype blocklisting</h1>
                </div>
                <div class="modal-body">
                    <b>Sourcetypes that have been blocklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_host_blacklist_sourcetype">
                    </div>

                    <b>Blocklist entries support the following types:</b>
                    <br /><br />

                    <lu>
                        <li>explicit names, example: <code>dev001</code></li>
                        <li>wildcards, example: <code>dev-*</code></li>
                        <li>regular expressions, example: <code>(?i)dev-.*</code></li>
                    </lu>

                    <br />

                    <div id="rowBlackListDataHostSourcetype1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostSourcetype1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_blacklist_sourcetype" style="margin-bottom: 10px;">
                                            <label>sourcetype name or expression:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_host_blacklist_sourcetype_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this entry</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListDataHostSourcetype1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListDataHostSourcetype" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListDataHostSourcetype2a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostSourcetype2a" class="dashboard-cell" style="margin-top: -25px; width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_blacklist_sourcetype_search" style="margin-bottom: 10px;">
                                            <label>Search for sourcetype name:</label>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowBlackListDataHostSourcetype2b" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostSourcetype2b" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div id="tableBlackListDataHostSourcetype" class="dashboard-element table" style="width: 100%">
                                            <label>Select entries and use the remove selected button:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_host_blacklist_sourcetype_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" id="btn_modal_data_host_blacklist_sourcetype_add_delete" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist host -->
    <div class="modal fade custom-modal-50" id="modal_modify_metric_host_blacklist_host" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Modify host blocklisting</h1>
                </div>
                <div class="modal-body">
                    <b>Hosts that have been blocklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_metric_host_blacklist_host">
                    </div>

                    <b>Blocklist entries support the following types:</b>
                    <br /><br />

                    <lu>
                        <li>explicit names, example: <code>dev001</code></li>
                        <li>wildcards, example: <code>dev-*</code></li>
                        <li>regular expressions, example: <code>(?i)dev-.*</code></li>
                    </lu>

                    <br />

                    <div id="rowBlackListMetricHostHost1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListMetricHostHost1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_metric_host_blacklist_host" style="margin-bottom: 10px;">
                                            <label>host name or expression:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_metric_host_blacklist_host_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this entry</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListMetricHostHost1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListMetricHostHost" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListMetricHostHost2a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListMetricHostHost2a" class="dashboard-cell" style="margin-top: -25px; width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_metric_host_blacklist_host_search" style="margin-bottom: 10px;">
                                            <label>Search for host name:</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="rowBlackListMetricHostHost2b" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListMetricHostHost2b" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div id="tableBlackListMetricHostHost" class="dashboard-element table" style="width: 100%">
                                            <label>Select entries and use the remove selected button:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_metric_host_blacklist_host_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" id="btn_modal_metric_host_blacklist_host_add_delete" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist metric_category -->
    <div class="modal fade custom-modal-50" id="modal_modify_metric_host_blacklist_metric_category" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Modify metric category blocklisting</h1>
                </div>
                <div class="modal-body">
                    <b>metric_category that have been blocklisted are excluded from the metric discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_metric_host_blacklist_metric_category">
                    </div>

                    <lu>
                        <li>TrackMe - metric hosts availability tracker</li>
                    </lu>

                    <br />

                    <div id="rowBlackListMetricHostMetricCategory1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListMetricHostMetricCategory1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">

                                        <div class="input input-linklist" id="inputLinkTimeBlackListMetricHost">
                                            <label>&nbsp;</label>
                                        </div>

                                        <div class="input input-dropdown" id="modal_input_metric_host_blacklist_metric_category" style="margin-bottom: 10px;">
                                            <label>metric category:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_metric_host_blacklist_metric_category_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this metric category</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListMetricHostMetricCategory1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListMetricHostMetricCategory" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListMetricHostMetricCategory2a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListMetricHostMetricCategory2a" class="dashboard-cell" style="margin-top: -25px; width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_metric_host_blacklist_metric_category_search" style="margin-bottom: 10px;">
                                            <label>Search for metric category:</label>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowBlackListMetricHostMetricCategory2b" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListMetricHostMetricCategory2b" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div id="tableBlackListMetricHostMetricCategory" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_metric_host_blacklist_metric_category_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" id="btn_modal_metric_host_blacklist_metric_category_add_delete" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ALERT SUMMARY -->
    <div id="main_modal_manage_alerts" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade custom-modal-80" id="modal_manage_alerts" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_alerts">
                            <div class="panel-body html">
                                <div class="modal-header modal-header-primary">
                                    <h1 style="color: white;">Actions for alert: <span>$tk_alert_title$</span></h1>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <div style="line-height: 1.1; margin-left: 20px;">
                                        <div style="float:left;width:50%;">
                                            <p><b>Cron Schedule:</b> $tk_alert_cron_schedule$</p>
                                            <p><b>Schedule window:</b> $tk_alert_schedule_window$</p>
                                            <p><b>Suppress fields:</b> $tk_alert_suppress_fields$</p>
                                            <p><b>Suppress period:</b> $tk_alert_suppress_period$</p>
                                        </div>
                                        <div style="float:left;width:50%;">
                                            <p><b>Disabled:</b> $tk_alert_disabled$</p>
                                            <p><b>Next scheduled time:</b> $tk_alert_next_scheduled_time$</p>
                                            <p><b>Alert actions:</b> $tk_alert_actions$</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <br />
                        <hr style="margin-top: -10px;">

                        <div id="rowLinkAlert1" class="dashboard-row dashboard-row1" style="margin-left: 15px; margin-top: -20px;">
                            <div id="panelLinktAlert1" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="input input-linklist" id="inputLinkAlerts">
                                            <label>&nbsp;</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="panelAlert2" class="dashboard-row dashboard-row1" data-depends="$show_alerts_activity$">
                            <div id="panelChartLag2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="chartAlertTriggeredPerAlert" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-head">
                                                <h3>triggered over time</h3>
                                            </div>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="panelAlert2bis" class="dashboard-row dashboard-row1" data-depends="$show_alerts_activity$">
                            <div id="panelChartLag2bis" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="chartAlertActionsPerAlert" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-head">
                                                <h3>alert actions over time</h3>
                                            </div>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="panelAlert3" class="dashboard-row dashboard-row1" data-depends="$show_alerts_auto_ack$">
                            <div id="panelChartLag3" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="input input-dropdown" id="modal_input_alert_actions_ack" style="margin-left: 30px; margin-top: 10px; margin-bottom: 10px;">
                                            <label>object:</label>
                                        </div>
                                        <div id="eventAlertActionsAckPerAlert" class="dashboard-element event" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="panelAlert4" class="dashboard-row dashboard-row1" data-depends="$show_alerts_smart_status$">
                            <div id="panelChartLag4" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="input input-dropdown" id="modal_input_alert_actions_smart_status" style="margin-left: 30px; margin-top: 10px; margin-bottom: 10px;">
                                            <label>object:</label>
                                        </div>                                        
                                        <div id="eventAlertActionsSmartStatusPerAlert" class="dashboard-element event" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="panelAlert5" class="dashboard-row dashboard-row1" data-depends="$show_alerts_free_style$">
                            <div id="panelChartLag5" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="input input-dropdown" id="modal_input_alert_actions_free_style" style="margin-left: 30px; margin-top: 10px; margin-bottom: 10px;">
                                            <label>object:</label>
                                        </div>                                        
                                        <div id="eventAlertActionsFreeStylePerAlert" class="dashboard-element event" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>                        

                        <div id="rowLinkAlertTimeRange" class="dashboard-row dashboard-row1" style="margin-left: 15px;">
                            <div id="panelLinktAlertTimeRange" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="input input-linklist" id="inputLinktAlertsTimeRange">
                                            <label>&nbsp;</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="modal-footer">
                            <button type="submit" id="btn_refresh_alert_tracking" role="button" class="btn btn-primary btn-default pull-left"><span class="glyphicon glyphicon-remove"></span>Refresh</button>
                            <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Close</button>
                            <a class="btn btn-primary" id="btn_url_modal_manage_alert" target="_blank" href="alert_url" role="button">Review and edit alert</a>
                            <a class="btn btn-primary" id="btn_url_modal_history_alert" target="_blank" href="alert_url" role="button">Search alert history</a>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade custom-modal-60" id="add_custom_alert" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span> Alert tracking definition </h1>
                </div>
                <div class="modal-body">
                    <b>Use this interface to create a custom alert in assisted mode:</b>
                    <br /><br />
                    <div class="boxnotify" id="boxnotify-add_custom_alert">
                    </div>
                    <div id="rowCustomAlertAdd1a" class="dashboard-row dashboard-row3">
                        <div id="rowCustomAlertAdd1b" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="input input-text" id="modal_input_custom_alert_name" style="margin-bottom: 20px; max-width: 900px;">
                                        <label>Enter the unique identifier of the new alert:</label>
                                    </div>
                                    <div class="input input-linklist" id="modal_input_custom_alert_object_type" style="margin-top: 20px;">
                                        <label>Choose the type of object to be tracked:</label>
                                    </div>
                                    <div class="fieldset">
                                        <div class="input input-multiselect" id="modal_input_custom_priority_levels" style="margin-top: 20px;">
                                            <label>Trigger if priority is:</label>
                                        </div>
                                        <div class="input input-multiselect" id="modal_input_custom_state_levels" style="margin-top: 20px;">
                                            <label>trigger if the state is:</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="rowCustomAlertAddDataSource1" class="dashboard-row dashboard-row3" data-depends="$create_alert_data_source$">
                        <div id="rowCustomAlertAddDataSource2" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-multiselect" id="modal_input_custom_alert_data_source_filter" style="max-width: 300px;">
                                            <label>Filter data_name:</label>
                                        </div>
                                        <div class="input input-multiselect" id="modal_input_custom_tags">
                                            <label>Include entities with tags:</label>
                                        </div>
                                        <div class="input input-dropdown" id="modal_input_custom_alert_trigger_on_outliers">
                                            <label>Trigger on Outliers?</label>
                                        </div>
                                        <div class="input input-dropdown" id="modal_input_custom_alert_trigger_on_data_sampling">
                                            <label>Trigger on Data Sampling?</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="rowCustomAlertAddDataHost1" class="dashboard-row dashboard-row3" data-depends="$create_alert_data_host$">
                        <div id="rowCustomAlertAddDataHost2" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-multiselect" id="modal_input_custom_alert_data_host_filter" style="max-width: 300px;">
                                            <label>Filter data_host:</label>
                                        </div>
                                        <div class="input input-dropdown" id="modal_input_custom_alert_trigger_on_outliers_data_host">
                                            <label>Trigger on Outliers?</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="rowCustomAlertAddDataMetric1" class="dashboard-row dashboard-row3" data-depends="$create_alert_metric_host$">
                        <div id="rowCustomAlertAddDataMetric2" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-multiselect" id="modal_input_custom_alert_metric_host_filter" style="max-width: 300px;">
                                            <label>Filter metric_host:</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="rowCustomAlertCommon" class="dashboard-row dashboard-row3">
                        <div id="rowCustomAlertCommon" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_custom_alert_cron" style="max-width: 150px;">
                                            <label>Cron schedule:</label>
                                        </div>
                                        <div class="input input-text" id="modal_input_custom_alert_suppress_fields" style="max-width: 300px;">
                                            <label>Suppression fields:</label>
                                        </div>
                                        <div class="input input-text" id="modal_input_custom_alert_suppress_period" style="max-width: 150px;">
                                            <label>Suppression period:</label>
                                        </div>
                                        <div class="input input-text" id="modal_input_custom_alert_time_filtering" style="max-width: 300px;">
                                            <label>Day time filtering:</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="rowCustomAlertTrackMeActions" class="dashboard-row dashboard-row3">
                        <div id="rowCustomAlertTrackMeActions" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div>
                                        <h3>TrackMe alert actions:</h3>
                                        <lu>
                                            <li>Auto Acknowledment: automatically acknowledge entities triggering, the ack duration is configurable within the alert action</li>
                                            <li>Smart Status: automatically call the Smart Status REST endpoint, results are indexed in the trackme summary index for investigations purposes</li>
                                            <li>For more details: <a target="_blank" href="https://trackme.readthedocs.io/en/latest/userguide.html#alerts-tracking-trackme-alert-actions">TrackMe alert actions documentation</a></li>
                                        </lu>
                                    </div>
                                </div>
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-drilldown" id="modal_input_custom_alert_auto_ack">
                                            <label>Auto Acknowledment:</label>
                                        </div>
                                        <div class="input input-text" id="modal_input_custom_alert_smart_status">
                                            <label>Smart Status:</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="rowCustomAlertAddBtns" class="dashboard-row dashboard-row3">
                        <div id="rowCustomAlertAddBtns" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div>
                                        <h3>Other Alert actions and options will be made available in the Splunk alert editor once the it has been created.</h3>
                                    </div>
                                    <div style="margin-top: 15x;">
                                        <button type="submit" id="btn_modal_custom_alert_add_new" style="margin-right: 15px;" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Add this new alert</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Generic invalid selection -->
    <div class="modal fade" id="modal_entry_update_invalid" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span>KVstore entry selection is invalid</h1>
                </div>
                <div class="modal-body">
                    <p>The selection you have made or the modification you have requested is invalid.<br /><br />
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" id="btn_modal_entry_update_invalid" class="btn btn-primary btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Data sampling update number of records per sample -->
    <div class="modal fade" id="modal_update_records_nr_data_sampling" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span>Data sampling &amp; events format recognition</h1>
                </div>
                <div class="modal-body">

                    <b>Number of records per sample:</b><br />

                    <p>Enter the maximal number of events to be extracted per data source during the data sampling operation: (default: 50)</p>

                    <div id="rowDataSampling" class="dashboard-row dashboard-row1">
                        <div id="panel1" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">          
                                <div class="fieldset">
                                    <div class="input input-text" id="modal_input_data_sampling_records_nr">
                                        <label></label>
                                    </div>
                                </div>                                        
                            </div>
                        </div>
                    </div>

                    <p><b>Confirm update?</b><br />
                    </p>

                    <p>
                        <label>Optional: enter a note of this update. <br />
                            This note will be logged and made available for notification.</label>
                        <textarea
                                id = "input_update_records_nr_data_sampling_comment"
                                rows = "6"
                                cols = "160" style="width: 500px;"
                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                    </p>

                </div>

                <div class="modal-footer">
                    <button type="submit" id="btn_update_records_nr_confirm_back" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_update_records_nr_confirm" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Data sampling clear state -->
    <div class="modal fade" id="modal_clear_state_data_sampling" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span>Data sampling &amp; events format recognition</h1>
                </div>
                <div class="modal-body">
                    <p><b>Confirm clear state action?</b><br />
                    </p>

                    <p>
                        <label>Optional: enter a note of this update. <br />
                            This note will be logged and made available for notification.</label>
                        <textarea
                                id = "input_clear_state_data_sampling_comment"
                                rows = "6"
                                cols = "160" style="width: 500px;"
                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                    </p>

                </div>

                <div class="modal-footer">
                    <button type="submit" id="btn_modal_clear_state_confirm_back" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_clear_state_confirm" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Data sampling disable -->
    <div class="modal fade" id="modal_disable_data_sampling" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span>Data sampling &amp; events format recognition</h1>
                </div>
                <div class="modal-body">
                    <p><b>Confirm disable action?</b><br />
                    </p>

                    <p>
                        <label>Optional: enter a note of this update. <br />
                            This note will be logged and made available for notification.</label>
                        <textarea
                                id = "input_disable_data_sampling_comment"
                                rows = "6"
                                cols = "160" style="width: 500px;"
                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                    </p>

                </div>

                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_sampling_disable_confirm_back" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_data_sampling_disable_confirm" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Data sampling remove custom rule -->
    <div class="modal fade" id="modal_remove_custom_rule_data_sampling" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span>Data sampling &amp; events format recognition</h1>
                </div>
                <div class="modal-body">
                    <p><b>Confirm custom rule deletion action?</b><br />
                    </p>

                    <p>
                        <label>Optional: enter a note of this update. <br />
                            This note will be logged and made available for notification.</label>
                        <textarea
                                id = "input_remove_custom_rule_data_sampling_comment"
                                rows = "6"
                                cols = "160" style="width: 500px;"
                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                    </p>

                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_remove_custom_rule_confirm" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Data sampling add custom rule -->
    <div class="modal fade" id="modal_add_custom_rule_data_sampling" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span>Data sampling &amp; events format recognition</h1>
                </div>
                <div class="modal-body">
                    <p><b>Confirm custom rule addition action?</b><br />
                    </p>

                    <p>
                        <label>Optional: enter a note of this update. <br />
                            This note will be logged and made available for notification.</label>
                        <textarea
                                id = "input_add_custom_rule_data_sampling_comment"
                                rows = "6"
                                cols = "160" style="width: 500px;"
                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                    </p>

                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_add_custom_rule_confirm" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Generic modification -->
    <div class="modal fade" id="modal_entry_modification" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header modal-header-danger">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 style="color: white;"><span class="glyphicon glyphicon-lock"></span>KVstore entry update</h1>
                </div>
                <div class="modal-body">
                    <p><b>Confirm modification for this entry?</b><br />
                    </p>

                    <p>
                        <label>Optional: enter a note of this update. <br />
                            This note will be logged and made available for notification.</label>
                        <textarea
                                id = "input_update_comment"
                                rows = "6"
                                cols = "160" style="width: 500px;"
                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                    </p>

                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_entry_modification" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <div id="row1" class="dashboard-row dashboard-row1">
        <div id="panel1" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="fieldset">
                    <div class="input input-linklist" id="link1">
                        <label>&nbsp;</label>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div id="rowDonutsDataSource" class="dashboard-row dashboard-rowSingleFormsDataSource" data-depends="$show_data_source_tracker$">
        <div id="DonutDataSource1" class="dashboard-row dashboard-row1" data-original-id="SingleFormsDataSource">
            <div id="DonutDataSourcePanel1" class="dashboard-cell" style="width: 50%;" data-original-id="DonutDataSourcePanel1">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="DonutDataSourceCountByPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                            <div style="text-align: center;">
                                <h3 style="font-size: 14px;">Monitored data sources count by priority</h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="DonutDataSourcePanel2" class="dashboard-cell" style="width: 50%;" data-original-id="DonutDataSourcePanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="DonutDataSourceCountByStateAndPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                            <div style="text-align: center;">
                                <h3 style="font-size: 14px;">Monitored data sources count by state and priority</h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowSingleFormsDataSource" class="dashboard-row dashboard-rowSingleFormsDataSource" data-depends="$show_data_source_tracker$">
        <div id="SingleFormsDataSource" class="dashboard-row dashboard-row1" data-original-id="SingleFormsDataSource">
            <div id="SingleFormsDataSourcePanel1" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataSourcePanel1">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataSource" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsDataSourcePanel2" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataSourcePanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataSourceAlerts" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsDataSourcePanelHighPriority" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataSourcePanelHighPriority">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataSourceAlertsHighPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsDataSourcePanel3" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataSourcePanel3">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataSourceDisabled" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowDonutsDataHost" class="dashboard-row dashboard-rowSingleFormsDataHost" data-depends="$show_data_host_tracker$">
        <div id="DonutDataHost1" class="dashboard-row dashboard-row1" data-original-id="SingleFormsDataHost">
            <div id="DonutDataHostPanel1" class="dashboard-cell" style="width: 50%;" data-original-id="DonutDataHostPanel1">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="DonutDataHostCountByStateAndPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                            <div style="text-align: center;">
                                <h3 style="font-size: 14px;">Monitored data hosts count by priority</h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="DonutDataHostPanel2" class="dashboard-cell" style="width: 50%;" data-original-id="DonutDataHostPanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="DonutDataHostCountByPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                            <div style="text-align: center;">
                                <h3 style="font-size: 14px;">Monitored data hosts count by state and priority</h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowSingleFormsDataHost" class="dashboard-row dashboard-rowSingleFormsDataHost" data-depends="$show_data_host_tracker$">
        <div id="SingleFormsDataHost" class="dashboard-row dashboard-row1" data-original-id="SingleFormsDataHost">
            <div id="SingleFormsDataHostPanel1" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataHostPanel1">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataHost" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsDataHostPanel2" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataHostPanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataHostAlerts" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsDataHostPanelHighPriority" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataHostPanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataHostAlertsHighPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsDataHostPanel3" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataHostPanel3">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataHostDisabled" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowDonutsMetricHost" class="dashboard-row dashboard-rowSingleFormsMetricHost" data-depends="$show_metric_host_tracker$">
        <div id="DonutMetricHost1" class="dashboard-row dashboard-row1" data-original-id="SingleFormsMetricHost">
            <div id="DonutMetricHostPanel1" class="dashboard-cell" style="width: 50%;" data-original-id="DonutMetricHostPanel1">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="DonutMetricHostCountByStateAndPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                            <div style="text-align: center;">
                                <h3 style="font-size: 14px;">Monitored metric hosts count by priority</h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="DonutMetricHostPanel2" class="dashboard-cell" style="width: 50%;" data-original-id="DonutMetricHostPanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="DonutMetricHostCountByPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                            <div style="text-align: center;">
                                <h3 style="font-size: 14px;">Monitored metric hosts count by state and priority</h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowSingleFormsMetricHost" class="dashboard-row dashboard-rowSingleFormsDataHost" data-depends="$show_metric_host_tracker$">
        <div id="SingleForms<Metric>Host" class="dashboard-row dashboard-row1" data-original-id="SingleFormsMetricHost">
            <div id="SingleFormsMetricHostPanel1" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsMetricHostPanel1">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalMetricHost" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsMetricHostPanel2" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsMetricHostPanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalMetricHostAlerts" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsMetricHostPanelHighPriority" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsMetricHostPanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalMetricHostAlertsHighPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsMetricHostPanel3" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsMetricHostPanel3">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalMetricHostDisabled" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row2a" class="dashboard-row dashboard-row2" data-depends="$show_data_source_tracker$">
        <div id="panel2a" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Click on any entry of the table to open interactive actions for this entity, use inputs to filter out the selection: (restricted to the first thousand results, use the key world filter input for large scale selections)</h2>
                <div class="fieldset">
                    <div class="input input-dropdown" id="inputDataNameFilterMode">
                        <label>Keyword filter mode:</label>
                    </div>
                    <div style="margin-right: 28px;" class="input input-text" id="inputDataNameFilter">
                        <label>Keyword filter name:</label>
                    </div>
                    <div class="input input-multiselect" id="inputTags">
                        <label>Tags:</label>
                    </div>
                    <div class="input input-multiselect" id="inputDataName">
                        <label>Name (use keyword filter):</label>
                    </div>
                    <div class="input input-multiselect" id="inputDataIndex">
                        <label>Index:</label>
                    </div>
                    <div class="input input-multiselect" id="inputDataSourcetype">
                        <label>Sourcetype(s):</label>
                    </div>
                    <div class="input input-multiselect" id="inputDataSourceState">
                        <label>Filter state:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataMonitoredState">
                        <label>Filter monitored_state:</label>
                    </div>
                    <div class="input input-multiselect" id="inputDataPriority">
                        <label>Filter priority:</label>
                    </div>
                    <div class="input input-dropdown" id="refreshForm">
                        <label>Auto refresh:</label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row2b" class="dashboard-row dashboard-row2" data-depends="$show_data_host_tracker$">
        <div id="panel2b" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Click on any entry of the table to open interactive actions for this entity, use inputs to filter out the selection: (restricted to the first thousand results, use the key world filter input for large scale selections)</h2>
                <div class="fieldset">
                    <div class="input input-multiselect" id="inputDataHostIndexes">
                        <label>Index(es):</label>
                    </div>
                    <div class="input input-multiselect" id="inputDataHostSourcetypes">
                        <label>Sourcetype(s):</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataHostFilterMode">
                        <label>Keyword filter mode:</label>
                    </div>
                    <div style="margin-right: 28px;" class="input input-text" id="inputDataHostFilter">
                        <label>Keyword filter hosts:</label>
                    </div>
                    <div class="input input-multiselect" id="inputDataHost">
                        <label>Host(s) (use keyword filter):</label>
                    </div>
                    <div class="input input-multiselect" id="inputDataHostState">
                        <label>Filter state:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataHostMonitoredState">
                        <label>Filter monitored_state:</label>
                    </div>
                    <div class="input input-multiselect" id="inputDataHostPriority">
                        <label>Filter priority:</label>
                    </div>
                    <div class="input input-dropdown" id="refreshHostForm">
                        <label>Auto refresh:</label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row2c" class="dashboard-row dashboard-row2" data-depends="$show_metric_host_tracker$">
        <div id="panel2c" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Click on any entry of the table to open interactive actions for this entity, use inputs to filter out the selection: (restricted to the first thousand results, use the key world filter input for large scale selections):</h2>
                <div class="fieldset">
                    <div class="input input-multiselect" id="inputMetricHostIndexes">
                        <label>Index(es):</label>
                    </div>
                    <div class="input input-multiselect" id="inputMetricHostCategories">
                        <label>Metric categorie(s):</label>
                    </div>
                    <div class="input input-dropdown" id="inputMetricHostFilterMode">
                        <label>Keyword filter mode:</label>
                    </div>
                    <div style="margin-right: 28px;" class="input input-dropdown" id="inputMetricHostFilter">
                        <label>Keyword filter hosts:</label>
                    </div>
                    <div class="input input-multiselect" id="inputMetricHost">
                        <label>Host(s) (use keyword filter):</label>
                    </div>
                    <div class="input input-multiselect" id="inputMetricHostState">
                        <label>Filter state:</label>
                    </div>
                    <div class="input input-dropdown" id="inputMetricHostMonitoredState">
                        <label>Filter monitored_state:</label>
                    </div>
                    <div class="input input-multiselect" id="inputMetricHostPriority">
                        <label>Filter priority:</label>
                    </div>
                    <div class="input input-dropdown" id="refreshMetricHostForm">
                        <label>Auto refresh:</label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowDataSourcesBtns" class="dashboard-row dashboard-rowDataSourcesBtns" data-depends="$show_data_source_tracker$">
        <div id="panelDataSourcesBtns" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementBtns" class="dashboard-element html" style="width: 100%">
                        <div class="panel-body html">
                            <div>
                                <div class="btn_modify_elastic_sources_main custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-outline-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: elastic sources</button>
                                </div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_modify_data_source_blacklist_main" style="margin-right: 15px;" class="btn btn-outline-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: allowlists &amp; blocklists</button>
                                </div>
                                <div class="btn_modify_custom_lagging custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-outline-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: define lagging classes</button>
                                </div>
                                <div class="btn_modify_tags_policies custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-outline-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: tags policies</button>
                                </div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_modify_data_sampling_rules" style="margin-right: 15px;" class="btn btn-outline-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: data sampling</button>
                                </div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_run_trackers" style="margin-right: 15px;" class="btn btn-outline-secondary"><span class="glyphicon glyphicon-remove"></span> Run: Trackers reports</button>
                                </div>
                            </div>
                            <div style="float: left;">
                                <div class="btn_ops_index_queue custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-outline-info" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ops: Queues center</button>
                                </div>
                                <div class="btn_ops_parsing_issues custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-outline-info" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ops: Parsing issues</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div id="rowDataMetricHostsBtns" class="dashboard-row dashboard-rowMetricHostsBtns" data-depends="$show_metric_host_tracker$">
        <div id="panelMetricHostsBtns" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementBtnsMetricHosts" class="dashboard-element html" style="width: 100%">
                        <div class="panel-body html">
                            <div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_modify_metric_host_blacklist_main" style="margin-right: 15px;" class="btn btn-outline-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: allowlists &amp; blocklists</button>
                                </div>
                                <div class="btn_modify_metric_sla_policies custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-outline-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: metric SLA policies</button>
                                </div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_run_tracker_metric_host" style="margin-right: 15px;" class="btn btn-outline-secondary"><span class="glyphicon glyphicon-remove"></span> Run: metric tracker now</button>
                                </div>
                            </div>
                            <div style="float: left;">
                                <div class="btn_ops_index_queue custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-outline-info" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ops: Queues center</button>
                                </div>
                                <div class="btn_ops_parsing_issues custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-outline-info" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ops: Parsing issues</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div id="rowDataSourcesTable" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_data_source_tracker$">
        <div id="panelDataSourcesTable" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementMainTable" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowDataHostsBtns" class="dashboard-row dashboard-rowDataSourcesBtns" data-depends="$show_data_host_tracker$">
        <div id="panelDataHostsBtns" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementBtnsHosts" class="dashboard-element html" style="width: 100%">
                        <div class="panel-body html">
                            <div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_modify_data_host_blacklist_main" style="margin-right: 15px;" class="btn btn-default btn-outline-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: allowlists &amp; blocklists</button>
                                </div>
                                <div class="btn_modify_custom_lagging custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-outline-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: define lagging classes</button>
                                </div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_run_data_host_trackers" style="margin-right: 15px;" class="btn btn-outline-secondary"><span class="glyphicon glyphicon-remove"></span> Run: Trackers reports</button>
                                </div>
                            </div>
                            <div style="float: left;">
                                <div class="btn_ops_index_queue custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-outline-info" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ops: Queues center</button>
                                </div>
                                <div class="btn_ops_parsing_issues custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-outline-info" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ops: Parsing issues</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div id="rowDataHostsTable" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_data_host_tracker$">
        <div id="panelDataHostsTable" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementMainTableHost" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowMetricHostsTable" class="dashboard-row dashboard-rowMetricSourcesTable" data-depends="$show_metric_host_tracker$">
        <div id="panelMetricHostsTable" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementMainTableMetricHost" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAuditChangesTop" class="dashboard-row dashboard-row1" data-original-id="rowAuditChangesTop" data-depends="$show_audit_changes$">
        <div id="panelAuditChangesTop1" class="dashboard-cell" style="width: 33.33%;">
            <div class="dashboard-panel clearfix">

                <div class="panel-element-row">
                    <div id="chartAuditChangesTopAction" class="dashboard-element chart" style="width: 100%">
                        <div class="panel-head">
                            <h3>TOP Actions</h3>
                        </div>
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
        <div id="panelAuditChangesTop2" class="dashboard-cell" style="width: 33.33%;">
            <div class="dashboard-panel clearfix">

                <div class="panel-element-row">
                    <div id="chartAuditChangesTopUser" class="dashboard-element chart" style="width: 100%">
                        <div class="panel-head">
                            <h3>TOP Users</h3>
                        </div>
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
        <div id="panelAuditChangesTop3" class="dashboard-cell" style="width: 33.33%;">
            <div class="dashboard-panel clearfix">

                <div class="panel-element-row">
                    <div id="chartAuditChangesTopChangeType" class="dashboard-element chart" style="width: 100%">
                        <div class="panel-head">
                            <h3>TOP Change Types</h3>
                        </div>
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAuditFlipTop" class="dashboard-row dashboard-row1" data-original-id="rowAuditFlipTop" data-depends="$show_audit_flip$">
        <div id="panelAuditFlipChart1" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">
                    <div id="chartAuditFlipTopObject" class="dashboard-element chart" style="width: 100%">
                        <div class="panel-head">
                            <h3>TOP Object</h3>
                        </div>
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
        <div id="panelAuditFlipChart2" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">
                    <div id="chartAuditFlipOverTime" class="dashboard-element chart" style="width: 100%">
                        <div class="panel-head">
                            <h3>Flip over time</h3>
                        </div>
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAuditFlipFilters" class="dashboard-row dashboard-AuditChangesFilters" data-depends="$show_audit_flip$">
        <div id="panelAuditFlipFilters" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Search for alert state flipping:</h2>
                <div class="fieldset">
                    <div style="margin-right: 28px;" class="input input-timerangepicker" id="input_timerange_audit_flip">
                        <label>time period:</label>
                    </div>
                    <div style="margin-right: 28px;" class="input input-text" id="inputAuditFlipObjectFilter">
                        <label>Keyword filter object:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditFlipObjectCategory">
                        <label>object_category:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditFlipObject">
                        <label>object(s) (use keyword filter):</label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAuditFlipTable" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_audit_flip$">
        <div id="panelAuditFlipTable" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementMainTableAuditFlip" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAuditChangesFilters" class="dashboard-row dashboard-AuditChangesFilters" data-depends="$show_audit_changes$">
        <div id="panelAuditChangesFilters" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Search for audit changes:</h2>
                <div class="fieldset">
                    <div style="margin-right: 28px;" class="input input-timerangepicker" id="input_timerange_audit_changes">
                        <label>time period:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditChangesAction">
                        <label>action:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditChangesUser">
                        <label>user:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditChangesObjectCategory">
                        <label>object_category:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditChangesChangeType">
                        <label>change_type:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditChangesObject">
                        <label>object:</label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAuditChangesTable" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_audit_changes$">
        <div id="panelAuditChangesTable" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementMainTableAuditChanges" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowSingleAlerts" class="dashboard-row dashboard-rowSingleAlerts" data-depends="$show_alerts$">
        <div id="SingleFormsAlerts" class="dashboard-row dashboard-row1">
            <div id="SingleFormsAlertsPanel1" class="dashboard-cell" style="width: 50%;">
                <div class="dashboard-panel clearfix">
                    <div class="panel-element-row">
                        <div id="singleFormEnabledAlerts" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsAlertsPanel2" class="dashboard-cell" style="width: 50%;">
                <div class="dashboard-panel clearfix">
                    <div class="panel-element-row">
                        <div id="singleFormTriggeredAlerts" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div> 
        </div>
    </div>

    <div id="rowAlertTriggered" class="dashboard-row dashboard-row1" data-depends="$show_alerts$" data-rejects="$show_no_alerts$">
        <div id="panelAlertTriggered1" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">
                    <div id="DonutAlertTriggered" class="dashboard-element chart" style="width: 100%">
                        <div class="panel-head">
                            <h3>triggering per alert (past 24h)</h3>
                        </div>
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
        <div id="panelAlertTriggered2" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">
                    <div id="chartAlertTriggered" class="dashboard-element chart" style="width: 100%">
                        <div class="panel-head">
                            <h3>triggered over time (past 24h)</h3>
                        </div>
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAlertTriggeredNoAlerts" class="dashboard-row dashboard-row1" data-depends="$show_alerts$ $show_no_alerts$">
        <div id="panelAlertTriggeredNoAlerts1" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">
                    <div id="DonutAlertTriggeredNoAlerts" class="dashboard-element chart" style="width: 100%">
                        <div class="panel-head">
                            <h3>There are no active alerts for the past 24h</h3>
                        </div>
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAlertsBtn" class="dashboard-row dashboard-rowAlertsBtn" data-depends="$show_alerts$">
        <div id="panelAlertsBtn" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">
                    <div id="elementBtnsAlerts" class="dashboard-element html" style="width: 100%">
                        <div class="panel-body html">
                            <div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_refresh_alerts" style="margin-right: 15px;" class="btn btn-default btn-outline-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Refresh</button>
                                    <button type="submit" id="btn_create_alert" style="margin-right: 15px;" class="btn btn-default btn-outline-secondary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Create a new alert</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAlerts" class="dashboard-row dashboard-rowAlerts" data-depends="$show_alerts$">
        <div id="panelAlerts" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Click on a table row to access object contextual actions</h2>
                <div class="panel-element-row">
                    <div id="element_alerts_main_table" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

</div>
</div>

<!--
END LAYOUT
-->

<script src="{{SPLUNKWEB_URL_PREFIX}}/config?autoload=1" crossorigin="use-credentials"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/js/i18n.js"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/i18ncatalog?autoload=1"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/build/simplexml/index.js"></script>
<script type="text/javascript">
// <![CDATA[
// <![CDATA[
//
// LIBRARY REQUIREMENTS
//
// In the require function, we include the necessary libraries and modules for
// the HTML dashboard. Then, we pass variable names for these libraries and
// modules as function parameters, in order.
//
// When you add libraries or modules, remember to retain this mapping order
// between the library or module and its function parameter. You can do this by
// adding to the end of these lists, as shown in the commented examples below.
require([
        "splunkjs/mvc",
        "splunkjs/mvc/utils",
        "splunkjs/mvc/tokenutils",
        "underscore",
        "jquery",
        "splunkjs/mvc/simplexml",
        "splunkjs/mvc/layoutview",
        "splunkjs/mvc/simplexml/dashboardview",
        "splunkjs/mvc/simplexml/dashboard/panelref",
        "splunkjs/mvc/simplexml/element/chart",
        "splunkjs/mvc/simplexml/element/event",
        "splunkjs/mvc/simplexml/element/html",
        "splunkjs/mvc/simplexml/element/list",
        "splunkjs/mvc/simplexml/element/map",
        "splunkjs/mvc/simplexml/element/single",
        "splunkjs/mvc/simplexml/element/table",
        "splunkjs/mvc/simplexml/element/visualization",
        "splunkjs/mvc/simpleform/formutils",
        "splunkjs/mvc/simplexml/eventhandler",
        "splunkjs/mvc/simplexml/searcheventhandler",
        "splunkjs/mvc/simpleform/input/dropdown",
        "splunkjs/mvc/simpleform/input/radiogroup",
        "splunkjs/mvc/simpleform/input/linklist",
        "splunkjs/mvc/simpleform/input/multiselect",
        "splunkjs/mvc/simpleform/input/checkboxgroup",
        "splunkjs/mvc/simpleform/input/text",
        "splunkjs/mvc/simpleform/input/timerange",
        "splunkjs/mvc/simpleform/input/submit",
        "splunkjs/mvc/searchmanager",
        "splunkjs/mvc/savedsearchmanager",
        "splunkjs/mvc/postprocessmanager",
        "splunkjs/mvc/simplexml/urltokenmodel"
        // Add comma-separated libraries and modules manually here, for example:
        // ..."splunkjs/mvc/simplexml/urltokenmodel",
        // "splunkjs/mvc/tokenforwarder"
    ],
    function(
        mvc,
        utils,
        TokenUtils,
        _,
        $,
        DashboardController,
        LayoutView,
        Dashboard,
        PanelRef,
        ChartElement,
        EventElement,
        HtmlElement,
        ListElement,
        MapElement,
        SingleElement,
        TableElement,
        VisualizationElement,
        FormUtils,
        EventHandler,
        SearchEventHandler,
        DropdownInput,
        RadioGroupInput,
        LinkListInput,
        MultiSelectInput,
        CheckboxGroupInput,
        TextInput,
        TimeRangeInput,
        SubmitButton,
        SearchManager,
        SavedSearchManager,
        PostProcessManager,
        UrlTokenModel

        // Add comma-separated parameter names here, for example:
        // ...UrlTokenModel,
        // TokenForwarder
    ) {

        var pageLoading = true;

        // Run initial spinner, gets removed once the main search from data sources is done
        $("body").append('<div id="loadingGrayInitial" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">TrackMe is loading, please wait...</p></div><div id="spinner"></div></div>')

        require(["jquery",
                "/static/app/trackme/spin.js"
            ],
            function($,
                Spinner
            ) {
                new Spinner({
                    lines: 12, length: 18,
                    position: "relative", color: "#003b59"
                }).spin(document.getElementById('spinner'));
            })

        //
        // FUNCTIONS
        //

        // Returns true if numeric
        function isNumeric(n) {
            return !isNaN(parseFloat(n)) && isFinite(n) && n > 0;
        }

        // Escape double quotes
        function escapeDoubleQuotes(str) {
            return str.replace(/\\([\s\S])|(")/g,"\\$1$2"); // thanks @slevithan!
        }

        // generate a unique ID
        function uuid() {
          return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
            var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
          });
        }

        // Audit record
        function auditRecord(action, change_type, object, object_category, object_attrs, result, comment) {

            // Audit changes
            var tokens = mvc.Components.get("default");
            var currentUser = Splunk.util.getConfigValue("USERNAME");
            tokens.set("currentUser", currentUser);
            var auditendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_audit_changes/"

            var time = (new Date).getTime();
            var audit_record = {
                "time": time,
                "action": action,
                "user": currentUser,
                "change_type": change_type,
                "object": object,
                "object_category": object_category,
                "object_attrs": object_attrs,
                "result": result,
                "comment": comment
            };
            $.ajax({
                url: auditendpoint_URl,
                type: "POST",
                async: true,
                contentType: "application/json",
                data: JSON.stringify(audit_record),
                success: function(returneddata) {
                    // Run the search again to update the table
                }
            });

        }

        //
        // TOKENS
        //

        // Create token namespaces
        var urlTokenModel = new UrlTokenModel();
        mvc.Components.registerInstance('url', urlTokenModel);
        var defaultTokenModel = mvc.Components.getInstance('default', {
            create: true
        });
        var submittedTokenModel = mvc.Components.getInstance('submitted', {
            create: true
        });

        urlTokenModel.on('url:navigate', function() {
            defaultTokenModel.set(urlTokenModel.toJSON());
            if (!_.isEmpty(urlTokenModel.toJSON()) && !_.all(urlTokenModel.toJSON(), _.isUndefined)) {
                submitTokens();
            } else {
                submittedTokenModel.clear();
            }
        });

        // Initialize tokens
        defaultTokenModel.set(urlTokenModel.toJSON());

        function submitTokens() {
            // Copy the contents of the defaultTokenModel to the submittedTokenModel and urlTokenModel
            FormUtils.submitForm({
                replaceState: pageLoading
            });
        }

        function setToken(name, value) {
            defaultTokenModel.set(name, value);
            submittedTokenModel.set(name, value);
        }

        function unsetToken(name) {
            defaultTokenModel.unset(name);
            submittedTokenModel.unset(name);
        }

        //
        // VARIOUS
        //


        //
        // SEARCH MANAGERS
        //

        //
        // ALERT SUMMARY
        //

        var search_alerts_main_table = new SearchManager({
            "id": "search_alerts_main_table",
            "sample_ratio": 1,
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "search": "| rest splunk_server=local /servicesNS/nobody/trackme/saved/searches | search eai:acl.app=\"trackme\" alert.track=1 title!=\"TrackMe - Audit change notification tracker\" | fields title, cron_schedule, schedule_window, alert.suppress.fields, alert.suppress.period, disabled, next_scheduled_time, id, actions | rex field=id \"saved/searches/(?<id>.*)\" | sort limit=0 title | eval \" \" = \"icon|\" + if(disabled==\"0\",\"ico_good ico_small|icon-check|Up\", \"ico_error ico_small|icon-close|Down\")",
            "latest_time": "now",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_alerts$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        search_alerts_main_table.on("search:done", function () {
            // function here
            $("#loadingGrayInitial").remove()
        })

        var searchPopulateAlertActionsAck = new SearchManager({
            "id": "searchPopulateAlertActionsAck",
            "sample_ratio": 1,
            "earliest_time": "$showAlertsTime.earliest$",
            "cancelOnUnload": true,
            "search": "(index=\"_internal\" OR index=\"cim_modactions\") sourcetype=\"modular_alerts:trackme_auto_ack\" search_name=\"$tk_alert_title$\" response_data=* | rex \"\\\"object\\\":\\\s\\\"(?<object>[^\\\"]*)\" | stats count by object | sort limit=10000 object",
            "latest_time": "$showAlertsTime.latest$",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_alerts_auto_ack$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateAlertActionsSmartStatus = new SearchManager({
            "id": "searchPopulateAlertActionsSmartStatus",
            "sample_ratio": 1,
            "earliest_time": "$showAlertsTime.earliest$",
            "cancelOnUnload": true,
            "search": "(index=\"_internal\" OR index=\"cim_modactions\") sourcetype=\"modular_alerts:trackme_smart_status\" search_name=\"$tk_alert_title$\" object_name=* | rex \"object_name=(?<object>[^\\\"]*)\" | stats count by object | sort limit=10000 object",
            "latest_time": "$showAlertsTime.latest$",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_alerts_smart_status$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateAlertActionsFreeStyle = new SearchManager({
            "id": "searchPopulateAlertActionsFreeStyle",
            "sample_ratio": 1,
            "earliest_time": "$showAlertsTime.earliest$",
            "cancelOnUnload": true,
            "search": "(index=\"_internal\" OR index=\"cim_modactions\") sourcetype=\"modular_alerts:trackme_free_style_rest_call\" search_name=\"$tk_alert_title$\" | rex \"\\\"(?:data_name|data_host|metric_host)\\\":\\\s\\\"(?<object>[^\\\"]*)\" | stats count by object | sort limit=10000 object",
            "latest_time": "$showAlertsTime.latest$",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_alerts_free_style$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleEnabledAlerts = new PostProcessManager({
            "tokenDependencies": {},
            "search": "where disabled=0 | stats c",
            "managerid": "search_alerts_main_table",
            "id": "searchSingleEnabledAlerts"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });        

        var searchDonutAlertsTriggered = new SearchManager({
            "id": "searchDonutAlertsTriggered",
            "sample_ratio": 1,
            "earliest_time": "-24h",
            "cancelOnUnload": true,
            "search": "index=_audit action=\"alert_fired\" ss_app=\"trackme\" ss_name!=\"TrackMe - Audit change notification tracker\" | stats count by ss_name",
            "latest_time": "now",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_alerts$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchDonutAlertsTriggered",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "set",
                        "token": "show_no_alerts",
                        "value": "True"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "unset",
                        "token": "show_no_alerts"
                    }]
                }
            ]
        });

        var searchAlertTriggeredOverTime = new SearchManager({
            "id": "searchAlertTriggeredOverTime",
            "sample_ratio": 1,
            "earliest_time": "-24h",
            "cancelOnUnload": true,
            "search": "index=_audit action=\"alert_fired\" ss_app=\"trackme\" ss_name!=\"TrackMe - Audit change notification tracker\" | timechart minspan=5m bins=1000 count by ss_name",
            "latest_time": "now",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_alerts$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAlertTriggeredOverTimePerAlert = new SearchManager({
            "id": "searchAlertTriggeredOverTimePerAlert",
            "sample_ratio": 1,
            "earliest_time": "$showAlertsTime.earliest$",
            "cancelOnUnload": true,
            "search": "index=_audit action=\"alert_fired\" ss_app=\"trackme\" ss_name=\"$tk_alert_title$\" | timechart span=$showAlertsTime.span$ count by ss_name",
            "latest_time": "$showAlertsTime.latest$",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_alerts$",
                "depends": "$show_alerts_activity$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAlertActionsTriggeredOverTimePerAlert = new SearchManager({
            "id": "searchAlertActionsTriggeredOverTimePerAlert",
            "sample_ratio": 1,
            "earliest_time": "$showAlertsTime.earliest$",
            "cancelOnUnload": true,
            "search": "( (index=\"_internal\" OR index=\"cim_modactions\") sourcetype=\"modular_alerts:trackme_auto_ack\" search_name=\"$tk_alert_title$\" response_data ) OR ( (index=\"_internal\" OR index=\"cim_modactions\") sourcetype=\"modular_alerts:trackme_free_style_rest_call\" search_name=\"$tk_alert_title$\" \"TrackMe REST call was successfull\" ) OR ( (index=\"_internal\" OR index=\"cim_modactions\") sourcetype=\"modular_alerts:trackme_smart_status\" search_name=\"$tk_alert_title$\" \"Smart Status result successfully\" ) | timechart span=$showAlertsTime.span$ count by sourcetype",
            "latest_time": "$showAlertsTime.latest$",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_alerts$",
                "depends": "$show_alerts_activity$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAlertActionsAckEventsOverTimePerAlert = new SearchManager({
            "id": "searchAlertActionsAckEventsOverTimePerAlert",
            "sample_ratio": 1,
            "earliest_time": "$showAlertsTime.earliest$",
            "cancelOnUnload": true,
            "search": "(index=\"_internal\" OR index=\"cim_modactions\") sourcetype=\"modular_alerts:trackme_auto_ack\" search_name=\"$tk_alert_title$\" response_data=* | rex \"response_data=(?<json>\\\{[^\\\}]*\\\})\" | rename json as _raw | spath | search $tk_input_alert_actions_ack$",
            "latest_time": "$showAlertsTime.latest$",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_alerts$",
                "depends": "$show_alerts_auto_ack$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAlertActionsSmartStatusdEventsOverTimePerAlert = new SearchManager({
            "id": "searchAlertActionsSmartStatusdEventsOverTimePerAlert",
            "sample_ratio": 1,
            "earliest_time": "$showAlertsTime.earliest$",
            "cancelOnUnload": true,
            "search": "`trackme_idx` (sourcetype=trackme_smart_status) | rex \"\\\"_raw\\\":\\\s(?<json>\{[^\\\}]*\})\" | rename json as _raw | eval object=coalesce('raw.data_name', 'raw.data_host', 'raw.metric_host') | search $tk_input_alert_actions_smart_status$ | search [ search (index=\"_internal\" OR index=\"cim_modactions\") sourcetype=\"modular_alerts:trackme_smart_status\" search_name=\"$tk_alert_title$\" object_name=* | rex \"object_name=(?<object>[^\\\"]*)\" | search $tk_input_alert_actions_smart_status$ | stats count by object | sort limit=10000 object | fields object ] | `trackme_smart_status_emoji`",
            "latest_time": "$showAlertsTime.latest$",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_alerts$",
                "depends": "$show_alerts_smart_status$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAlertActionsFreeStyleEventsOverTimePerAlert = new SearchManager({
            "id": "searchAlertActionsFreeStyleEventsOverTimePerAlert",
            "sample_ratio": 1,
            "earliest_time": "$showAlertsTime.earliest$",
            "cancelOnUnload": true,
            "search": "`trackme_idx` (sourcetype=trackme_alert_action) | rex \"\\\"(?:data_name|data_host|metric_host)\\\":\\\s\\\"(?<object>[^\\\"]*)\" | search $tk_input_alert_actions_free_style$ | search [ search (index=\"_internal\" OR index=\"cim_modactions\") sourcetype=\"modular_alerts:trackme_free_style_rest_call\" search_name=\"$tk_alert_title$\" | rex \"\\\"(?:data_name|data_host|metric_host)\\\":\\\s\\\"(?<object>[^\\\"]*)\" | search $tk_input_alert_actions_free_style$ | stats count by object | sort limit=10000 object | fields object ]",
            "latest_time": "$showAlertsTime.latest$",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_alerts$",
                "depends": "$show_alerts_free_style$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_alerts_triggered_history = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats sum(count) as count | append [ | makeresults | eval count=0 | fields - _time ] | head 1",
            "managerid": "searchDonutAlertsTriggered",
            "id": "search_alerts_triggered_history"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }); 

        var search_alerts_get_tags = new SearchManager({
            "id": "search_alerts_get_tags",
            "sample_ratio": 1,
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "search": "| inputlookup trackme_data_source_monitoring | eval tags=if(match(tags, \"click on Update tags\"), \"\", tags) | makemv delim=\",\" tags | mvexpand tags | where tags!=\"\" | stats values(tags) as tags | mvexpand tags | dedup tags | sort limit=1000 tags",
            "latest_time": "now",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_alerts$",
                "depends": "$start_get_tags_for_custom_alert$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // data sampling dropdown
        var searchPopulateDataSampling = new SearchManager({
            "id": "searchPopulateDataSampling",
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_sampling | eval key=_key | fields key, data_name | sort 0 data_name",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$",
                "depends": "$start_search_input_data_sampling_dropdown$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // whitelist

        // whitelist data_source

        var searchPopulateIndexesForWhiteListDataSource = new SearchManager({
            "id": "searchPopulateIndexesForWhiteListDataSource",
            "earliest_time": "$modalTimeWhiteListDataSource.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTimeWhiteListDataSource.latest$",
            "search": "| `trackme_tstats` count where index=* by index | lookup trackme_data_source_monitoring_whitelist_index data_index as index OUTPUT data_index as FOUND | where isnull(FOUND) | sort limit=0 index | fields index",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$",
                "depends": "$start_modify_data_source_whitelist$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist metric_category

        var searchPopulateMetricCategoriesForBlackListMetricHost = new SearchManager({
            "id": "searchPopulateMetricCategoriesForBlackListMetricHost",
            "earliest_time": "$modalTimeBlackListMetricHost.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTimeBlackListMetricHost.latest$",
            "search": "| mcatalog values(metric_name) as metrics where index=* `trackme_mstats_main_filter` | rename metrics as metric_name | mvexpand metric_name | rex field=metric_name \"(?<metric_category>[^\.]*)\.{0,1}\"  | stats count by metric_category | fields metric_category | lookup trackme_metric_host_monitoring_blacklist_metric_category metric_category | where isnull(metric_blacklist_state) | sort limit=0 metric_category",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$",
                "depends": "$start_modify_metric_host_blacklist_metric_category$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // whitelist data_host

        var searchPopulateIndexesForWhiteListDataHost = new SearchManager({
            "id": "searchPopulateIndexesForWhiteListDataHost",
            "earliest_time": "$modalTimeWhiteListDataHost.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTimeWhiteListDataHost.latest$",
            "search": "| `trackme_tstats` count where (index=* OR index=_internal) by index | lookup trackme_data_host_monitoring_whitelist_index data_index as index OUTPUT data_index as FOUND | where isnull(FOUND) | sort limit=0 index | fields index",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$",
                "depends": "$start_modify_data_host_whitelist$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // whitelist metric_host

        var searchPopulateIndexesForWhiteListMetricHost = new SearchManager({
            "id": "searchPopulateIndexesForWhiteListMetricHost",
            "earliest_time": "$modalTimeWhiteListMetricHost.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTimeWhiteListMetricHost.latest$",
            "search": "| mcatalog values(metric_name) as metrics where (index=* OR index=_*) by index | rename metrics as metric_name | stats values(index) as index | mvexpand index | lookup trackme_metric_host_monitoring_whitelist_index metric_index as index OUTPUT metric_index as FOUND | where isnull(FOUND) | sort limit=0 index | fields index",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$",
                "depends": "$start_modify_metric_host_whitelist$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // data sources monitoring

        var searchDataSourcesMain = new SearchManager({
            "id": "searchDataSourcesMain",
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "refreshType": "delay",
            "refresh": "$refresh$",
            "latest_time": "+5m",
            "search": "| inputlookup trackme_data_source_monitoring\n| eval keyid=_key\n| `apply_data_source_blacklists`\n| search `trackme_get_idx_whitelist_searchtime(trackme_data_source_monitoring_whitelist_index, data_index)`\n| `trackme_eval_data_source_state`\n| `trackme_default_priority`\n| `trackme_date_format(data_last_time_seen)`\n| `trackme_date_format(data_last_time_seen_idx)`\n| `trackme_date_format(data_last_ingest)`\n| fillnull value=\"red\" data_source_state\n| sort 0 data_source\n| `trackme_eval_icons`\n| search $inputDataNameFilterMode$ ($inputDataNameFilter$)\n| search `trackme_get_idx_whitelist_searchtime(trackme_data_source_monitoring_whitelist_index, data_index)`\n| `apply_data_source_blacklists`\n| rex field=tags mode=sed \"s/,/ \\\/ /g\"\n| fillnull value=\"No tags defined, click on Update tags to define one or more tags to be associated with this data source.\" tags",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        searchDataSourcesMain.on("search:done", function () {
            // function here
            $("#loadingGrayInitial").remove()
        })

        var searchDataSourcesPostTable = new PostProcessManager({
            "tokenDependencies": {},
            "search": "makemv delim=\" / \" tags | search $inputDataName$ $inputDataIndex$ $inputDataSourcetype$ $inputTags$ $data_source_state$ $data_monitored_state$ $inputDataPriority$\n| fillnull data_last_lag_seen, data_last_ingestion_lag_seen\n| eval data_last_lag_seen=round(data_last_lag_seen, 0) | eval data_last_ingestion_lag_seen=round(data_last_ingestion_lag_seen, 0) | fillnull value=\"N/A\" data_last_lag_seen, data_last_ingestion_lag_seen\n| eval \"lag (event / ingestion)\" = if(data_last_lag_seen>60, tostring(data_last_lag_seen, \"duration\"), data_last_lag_seen . \" sec\") . \" / \" . if(data_last_ingestion_lag_seen>60, tostring(data_last_ingestion_lag_seen, \"duration\"), data_last_ingestion_lag_seen . \" sec\")\n| rename \"data_last_time_seen (translated)\" as \"last time\", \"data_last_ingest (translated)\" as \"last ingest\", \"data_last_time_seen_idx (translated)\" as \"last time idx\"\n| eval data_tracker_runtime=now()\n| `trackme_date_format(\"latest_flip_time\")`\n| fillnull value=\"N/A\" latest_flip_state, latest_flip_time, \"latest_flip_time (translated)\"\n| `trackme_get_identity_card(data_name)`\n| `trackme_lookup_elastic_sources`\n| `trackme_ack_lookup_main(data_name)`\n| `trackme_lookup_data_sampling`\n| nomv tags\n| sort limit=10000 data_name",
            "managerid": "searchDataSourcesMain",
            "id": "searchDataSourcesPostTable"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchDataSourcesMainStats = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputDataName$ $inputDataIndex$ $inputDataSourcetype$ | stats count as total, count(eval(data_monitored_state=\"disabled\")) as total_disabled, count(eval(data_source_state!=\"green\" AND data_source_state!=\"info\" AND data_monitored_state=\"enabled\")) as total_in_alert, count(eval(data_source_state=\"red\" AND priority=\"high\" AND data_monitored_state=\"enabled\")) as total_high_priority_red, count(eval(data_monitored_state=\"enabled\" AND priority=\"low\")) as low_enabled, count(eval(data_monitored_state=\"enabled\" AND priority=\"medium\")) as medium_enabled, count(eval(data_monitored_state=\"enabled\" AND priority=\"high\")) as high_enabled, count(eval(data_source_state=\"blue\" AND data_monitored_state=\"enabled\")) as \"blue\", count(eval(data_source_state=\"orange\" AND data_monitored_state=\"enabled\")) as \"orange\", count(eval(data_source_state=\"green\" AND data_monitored_state=\"enabled\")) as \"green\", count(eval(data_source_state=\"red\" AND data_monitored_state=\"enabled\" AND priority=\"high\")) as \"red - high priority\", count(eval(data_source_state=\"red\" AND data_monitored_state=\"enabled\" AND priority!=\"high\")) as \"red - other priority\"",
            "managerid": "searchDataSourcesMain",
            "id": "searchDataSourcesMainStats"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateDataSources = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputDataIndex$ $inputDataSourcetype$ | stats values(data_name) as data_name | mvexpand data_name | dedup data_name | sort limit=1000 data_name",
            "managerid": "searchDataSourcesMain",
            "id": "searchPopulateDataSources"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateDataSourcesTags = new PostProcessManager({
            "tokenDependencies": {},
            "search": "eval tags=if(match(tags, \"click on Update tags\"), \"\", tags) | makemv delim=\" / \" tags | search $inputDataIndex$ $inputDataSourcetype$ | mvexpand tags | stats values(tags) as tags | mvexpand tags | dedup tags | sort limit=1000 tags",
            "managerid": "searchDataSourcesMain",
            "id": "searchPopulateDataSourcesTags"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateDataSourcesIndexes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputDataName$ $inputDataSourcetype$ | stats values(data_index) as data_index | mvexpand data_index | dedup data_index | sort limit=1000 data_index",
            "managerid": "searchDataSourcesMain",
            "id": "searchPopulateDataSourcesIndexes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateDataSourcesSourcetypes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputDataName$ $inputDataIndex$ | stats values(data_sourcetype) as data_sourcetype | mvexpand data_sourcetype | dedup data_sourcetype | sort limit=1000 data_sourcetype",
            "managerid": "searchDataSourcesMain",
            "id": "searchPopulateDataSourcesSourcetypes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // tags
        var searchShowTags = new SearchManager({
            "id": "searchShowTags",
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_source_monitoring where data_name=\"$tk_data_name$\" | fields tags | makemv delim=\",\" tags | mvexpand tags | dedup tags | sort tags",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchShowTags",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_tags_multiselect"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_tags_multiselect",
                        "value": "True"
                    }]
                }
            ]
        });

        // Smart Status

        var searchSmartStatusDataSource = new SearchManager({
            "id": "searchSmartStatusDataSource",
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| trackme url=/services/trackme/v1/smart_status/ds_smart_status mode=get body=\"{'data_name': '$tk_data_name$'}\" | `trackme_smart_status_emoji`",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_smart_status_data_source$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSmartStatusDataHost = new SearchManager({
            "id": "searchSmartStatusDataHost",
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| trackme url=/services/trackme/v1/smart_status/dh_smart_status mode=get body=\"{'data_host': '$tk_data_host$'}\" | `trackme_smart_status_emoji`",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_smart_status_data_host$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSmartStatusMetricHost = new SearchManager({
            "id": "searchSmartStatusMetricHost",
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| trackme url=/services/trackme/v1/smart_status/mh_smart_status mode=get body=\"{'metric_host': '$tk_metric_host$'}\" | `trackme_smart_status_emoji`",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_smart_status_metric_host$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchShowTagsPolicies = new SearchManager({
            "id": "searchShowTagsPolicies",
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_tags_policies | eval keyid=_key | eval select=keyid, mtime=strftime(mtime, \"%c\") | fields tags_policy_id, tags_policy_regex, tags_policy_value, mtime, select",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_tags_policies$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchShowTagsPolicies",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_tags_policies"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_tags_policies",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchTagsPoliciesSimulate = new SearchManager({
            "id": "searchTagsPoliciesSimulate",
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| `trackme_tags_policies_run_simulation(\"$tk_tags_policies_policy_id$\", \"$tk_tags_policies_tags$\", \"$tk_tags_policies_regex$\")`",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_simulation_tags_policies$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Audit Flip
        var searchMainAuditFlip = new SearchManager({
            "id": "searchMainAuditFlip",
            "earliest_time": "$timerange_audit_flip.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$timerange_audit_flip.latest$",
            "search": "`trackme_idx` source=\"flip_state_change_tracking\" $audit_flip_object_category$ $audit_flip_object$ $inputAuditFlipObjectFilter$ | eval separator = \"-->\" | dedup _time object object_category object_previous_state object_state | table _time object object_category object_previous_state separator object_state result | rename separator as \" \" | `trackme_eval_icons_flip`",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_audit_flip$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        searchMainAuditFlip.on("search:done", function () {
            // function here
            $("#loadingGrayInitial").remove()
        })

        var searchMainAuditFlipTable = new PostProcessManager({
            "tokenDependencies": {},
            "search": "sort limit=10000 - _time",
            "managerid": "searchMainAuditFlip",
            "id": "searchMainAuditFlipTable"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchMainAuditFlipPopulate = new SearchManager({
            "id": "searchMainAuditFlipPopulate",
            "earliest_time": "$timerange_audit_flip.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$timerange_audit_flip.latest$",
            "search": "`trackme_idx` source=\"flip_state_change_tracking\" | stats count by object_category, object",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_audit_flip$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditFlipObjectCategory = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count by object_category | sort limit=0 object_category",
            "managerid": "searchMainAuditFlipPopulate",
            "id": "searchAuditFlipObjectCategory"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditFlipObject = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $audit_flip_object_category$ $inputAuditFlipObjectFilter$ | stats count by object | sort limit=1000 object",
            "managerid": "searchMainAuditFlipPopulate",
            "id": "searchAuditFlipObject"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditFlipTopObject = new PostProcessManager({
            "tokenDependencies": {},
            "search": "top object",
            "managerid": "searchMainAuditFlip",
            "id": "searchAuditFlipTopObject"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditFlipOverTime = new PostProcessManager({
            "tokenDependencies": {},
            "search": "timechart limit=40 useother=t minspan=1h bins=1000 count by object",
            "managerid": "searchMainAuditFlip",
            "id": "searchAuditFlipOverTime"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Audit Changes Data Source
        var searchDataSourceMainAuditChanges = new SearchManager({
            "id": "searchDataSourceMainAuditChanges",
            "earliest_time": "$modalTime.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTime.latest$",
            "search": "| inputlookup trackme_audit_changes where (object=\"$tk_data_name$\" AND object_category=\"data_source\") | sort limit=0 - time | eval _time=time/1000 | fields - time | addinfo | where _time>=info_min_time AND (_time<=info_max_time OR info_max_time=\"+Infinity\") | `trackme_eval_icons_audit_changes` | rename action_icon as \" \" | fields _time user action \" \" change_type comment",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_audit_changes$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchDataSourceMainAuditChanges",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_data_source_audit_changes_no_results"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_data_source_audit_changes_no_results",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchMainDataSourceAuditChangesTable = new PostProcessManager({
            "tokenDependencies": {},
            "search": "sort - limit=10000 _time",
            "managerid": "searchDataSourceMainAuditChanges",
            "id": "searchMainDataSourceAuditChangesTable"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditDataSourceAuditChangesOverTime = new PostProcessManager({
            "tokenDependencies": {},
            "search": "timechart limit=40 useother=t minspan=1h bins=1000 count by action",
            "managerid": "searchDataSourceMainAuditChanges",
            "id": "searchAuditDataSourceAuditChangesOverTime"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Lagging performance metrics
        var searchLaggingMetricDataSource = new SearchManager({
            "id": "searchLaggingMetricDataSource",
            "earliest_time": "$modalTime.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTime.latest$",
            "search": "| mstats max(trackme.eventcount_4h) as eventcount_4h, max(trackme.hostcount_4h) as hostcount_4h, max(trackme.lag_event_sec) as lag_event_sec, max(trackme.lag_ingestion_sec) as lag_ingestion_sec where `trackme_metrics_idx` object_category=\"data_source\" object=\"$tk_data_name$\" by object span=5m | timechart span=$modalTime.span$ avg(eventcount_4h) as eventcount_4h, avg(hostcount_4h) as hostcount_4h, avg(lag_event_sec) as lag_event_sec, avg(lag_ingestion_sec) as lag_ingestion_sec | fields _time, $tk_input_data_source_overview_metrics_chart_series$",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_lagging_metrics$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchLaggingMetricDataHost = new SearchManager({
            "id": "searchLaggingMetricDataHost",
            "earliest_time": "$modalTimeHost.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTimeHost.latest$",
            "search": "| mstats max(trackme.eventcount_4h) as eventcount_4h, max(trackme.lag_event_sec) as lag_event_sec, max(trackme.lag_ingestion_sec) as lag_ingestion_sec where `trackme_metrics_idx` object_category=\"data_host\" object=\"$tk_data_host$\" by object span=5m | timechart span=$modalTimeHost.span$ avg(eventcount_4h) as eventcount_4h, avg(lag_event_sec) as lag_event_sec, avg(lag_ingestion_sec) as lag_ingestion_sec",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_lagging_metrics$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Audit Changes Data Host
        var searchDataHostMainAuditChanges = new SearchManager({
            "id": "searchDataHostMainAuditChanges",
            "earliest_time": "$modalTime.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTime.latest$",
            "search": "| inputlookup trackme_audit_changes where (object=\"$tk_data_host$\" AND object_category=\"data_host\") | sort limit=0 - time | eval _time=time/1000 | fields - time | addinfo | where _time>=info_min_time AND (_time<=info_max_time OR info_max_time=\"+Infinity\") | `trackme_eval_icons_audit_changes` | rename action_icon as \" \" | fields _time user action \" \" change_type comment",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_audit_changes$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchDataHostMainAuditChanges",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_data_host_audit_changes_no_results"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_data_host_audit_changes_no_results",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchMainDataHostAuditChangesTable = new PostProcessManager({
            "tokenDependencies": {},
            "search": "sort - limit=10000 _time",
            "managerid": "searchDataHostMainAuditChanges",
            "id": "searchMainDataHostAuditChangesTable"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditDataHostAuditChangesOverTime = new PostProcessManager({
            "tokenDependencies": {},
            "search": "timechart limit=40 useother=t minspan=1h bins=1000 count by action",
            "managerid": "searchDataHostMainAuditChanges",
            "id": "searchAuditDataHostAuditChangesOverTime"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Audit Changes Metric Host
        var searchMetricHostMainAuditChanges = new SearchManager({
            "id": "searchMetricHostMainAuditChanges",
            "earliest_time": "$modalTime.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTime.latest$",
            "search": "| inputlookup trackme_audit_changes where (object=\"$tk_metric_host$\" AND object_category=\"metric_host\") | sort limit=0 - time | eval _time=time/1000 | fields - time | addinfo | where _time>=info_min_time AND (_time<=info_max_time OR info_max_time=\"+Infinity\") | `trackme_eval_icons_audit_changes` | rename action_icon as \" \" | fields _time user action \" \" change_type comment",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_audit_changes$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchMetricHostMainAuditChanges",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_metric_host_audit_changes_no_results"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_metric_host_audit_changes_no_results",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchMainMetricHostAuditChangesTable = new PostProcessManager({
            "tokenDependencies": {},
            "search": "sort - limit=10000 _time",
            "managerid": "searchMetricHostMainAuditChanges",
            "id": "searchMainMetricHostAuditChangesTable"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditMetricHostAuditChangesOverTime = new PostProcessManager({
            "tokenDependencies": {},
            "search": "timechart limit=40 useother=t minspan=1h bins=1000 count by action",
            "managerid": "searchMetricHostMainAuditChanges",
            "id": "searchAuditMetricHostAuditChangesOverTime"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Audit Flip
        var searchDataSourceMainAuditFlip = new SearchManager({
            "id": "searchDataSourceMainAuditFlip",
            "earliest_time": "$modalTime.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTime.latest$",
            "search": "`trackme_idx` source=\"flip_state_change_tracking\" object_category=\"data_source\" object=\"$tk_data_name$\" | eval separator = \"-->\" | dedup _time object object_category object_previous_state object_state | table _time object object_category object_previous_state separator object_state result",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_flipping_status$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchDataSourceMainAuditFlip",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_flipping_status_no_results"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_flipping_status_no_results",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchMainDataSourceAuditFlipTable = new PostProcessManager({
            "tokenDependencies": {},
            "search": "rename separator as \" \" | `trackme_eval_icons_flip` | fields _time	object object_category object_previous_state \" \" object_state | sort - limit=10000 _time",
            "managerid": "searchDataSourceMainAuditFlip",
            "id": "searchMainDataSourceAuditFlipTable"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditDataSourceFlipOverTime = new PostProcessManager({
            "tokenDependencies": {},
            "search": "timechart limit=40 useother=t minspan=1h bins=1000 count by object_state",
            "managerid": "searchDataSourceMainAuditFlip",
            "id": "searchAuditDataSourceFlipOverTime"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchDataSourceTimeline = new SearchManager({
            "id": "searchDataSourceTimeline",
            "earliest_time": "-7d@d",
            "latest_time": "now",
            "sample_ratio": null,
            "search": "`trackme_idx` object_category=\"data_source\" object=\"$tk_data_name$\" source=\"current_state_tracking:data_source\" | sort limit=0 _time | table _time, object, current_state | streamstats first(_time) as previous_time current=f by object | eventstats count as total | streamstats count as record_count | eval duration=_time-previous_time | eval previous_time=strftime(previous_time, \"%c\") | search current_state=* | fields _time, object, current_state, duration",
            "status_buckets": 0,
            "cancelOnUnload": true,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_status_message$"
            },
            "runWhenTimeIsUndefined": false
        }, {tokens: true, tokenNamespace: "submitted"});

        var searchDataHostTimeline = new SearchManager({
            "id": "searchDataHostTimeline",
            "earliest_time": "-7d@d",
            "latest_time": "now",
            "sample_ratio": null,
            "search": "`trackme_idx` object_category=\"data_host\" object=\"$tk_data_host$\" source=\"current_state_tracking:data_host\" | sort limit=0 _time | table _time, object, current_state | streamstats first(_time) as previous_time current=f by object | eventstats count as total | streamstats count as record_count | eval duration=_time-previous_time | eval previous_time=strftime(previous_time, \"%c\") | search current_state=* | fields _time, object, current_state, duration",
            "status_buckets": 0,
            "cancelOnUnload": true,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_status_message$"
            },
            "runWhenTimeIsUndefined": false
        }, {tokens: true, tokenNamespace: "submitted"});

        var searchMetricHostTimeline = new SearchManager({
            "id": "searchMetricHostTimeline",
            "earliest_time": "-7d@d",
            "latest_time": "now",
            "sample_ratio": null,
            "search": "`trackme_idx` object_category=\"metric_host\" object=\"$tk_metric_host$\" source=\"current_state_tracking:metric_host\" | sort limit=0 _time | table _time, object, current_state | streamstats first(_time) as previous_time current=f by object | eventstats count as total | streamstats count as record_count | eval duration=_time-previous_time | eval previous_time=strftime(previous_time, \"%c\") | search current_state=* | fields _time, object, current_state, duration",
            "status_buckets": 0,
            "cancelOnUnload": true,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_status_message$"
            },
            "runWhenTimeIsUndefined": false
        }, {tokens: true, tokenNamespace: "submitted"});

        var searchDataHostMainAuditFlip = new SearchManager({
            "id": "searchDataHostMainAuditFlip",
            "earliest_time": "$modalTimeHost.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTimeHost.latest$",
            "search": "`trackme_idx` source=\"flip_state_change_tracking\" object_category=\"data_host\" object=\"$tk_data_host$\" | eval separator = \"-->\" | dedup _time object object_category object_previous_state object_state | table _time object object_category object_previous_state separator object_state result",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_flipping_status$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchDataHostMainAuditFlip",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_data_host_flipping_status_no_results"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_data_host_flipping_status_no_results",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchMainDataHostAuditFlipTable = new PostProcessManager({
            "tokenDependencies": {},
            "search": "rename separator as \" \" | `trackme_eval_icons_flip` | fields _time	object object_category object_previous_state \" \" object_state | sort - limit=10000 _time",
            "managerid": "searchDataHostMainAuditFlip",
            "id": "searchMainDataHostAuditFlipTable"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditDataHostFlipOverTime = new PostProcessManager({
            "tokenDependencies": {},
            "search": "timechart limit=40 useother=t minspan=1h bins=1000 count by object_state",
            "managerid": "searchDataHostMainAuditFlip",
            "id": "searchAuditDataHostFlipOverTime"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchMetricHostMainAuditFlip = new SearchManager({
            "id": "searchMetricHostMainAuditFlip",
            "earliest_time": "$modalTimeMetricHost.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTimeMetricHost.latest$",
            "search": "`trackme_idx` source=\"flip_state_change_tracking\" object_category=\"metric_host\" object=\"$tk_metric_host$\" | eval separator = \"-->\" | dedup _time object object_category object_previous_state object_state | table _time object object_category object_previous_state separator object_state result",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_flipping_status$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchMetricHostMainAuditFlip",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_metric_host_flipping_status_no_results"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_metric_host_flipping_status_no_results",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchMainMetricHostAuditFlipTable = new PostProcessManager({
            "tokenDependencies": {},
            "search": "rename separator as \" \" | `trackme_eval_icons_flip` | fields _time	object object_category object_previous_state \" \" object_state | sort - limit=10000 _time",
            "managerid": "searchMetricHostMainAuditFlip",
            "id": "searchMainMetricHostAuditFlipTable"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditmetricHostFlipOverTime = new PostProcessManager({
            "tokenDependencies": {},
            "search": "timechart limit=40 useother=t minspan=1h bins=1000 count by object_state",
            "managerid": "searchMetricHostMainAuditFlip",
            "id": "searchAuditmetricHostFlipOverTime"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Audit Changes
        var searchMainAuditChanges = new SearchManager({
            "id": "searchMainAuditChanges",
            "earliest_time": "$timerange_audit_changes.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$timerange_audit_changes.latest$",
            "search": "| inputlookup trackme_audit_changes | sort limit=0 - time | eval _time=time/1000 | fields - time | addinfo | where _time>=info_min_time AND (_time<=info_max_time OR info_max_time=\"+Infinity\") | search $audit_changes_action$ $audit_changes_object_category$ $audit_changes_change_type$ $audit_changes_user$ $audit_changes_object$ | `trackme_eval_icons_audit_changes` | rename action_icon as \" \" | fields _time user action \" \" change_type object_category object object_attrs comment",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        searchMainAuditChanges.on("search:done", function () {
            // function here
            $("#loadingGrayInitial").remove()
        })

        var searchMainAuditChangesPopulate = new SearchManager({
            "id": "searchMainAuditChangesPopulate",
            "earliest_time": "$timerange_audit_changes.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$timerange_audit_changes.latest$",
            "search": "| inputlookup trackme_audit_changes | sort limit=0 - time | eval _time=time/1000 | addinfo | where _time>=info_min_time AND (_time<=info_max_time OR info_max_time=\"+Infinity\")",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesAction = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count by action | sort limit=0 action",
            "managerid": "searchMainAuditChangesPopulate",
            "id": "searchAuditChangesAction"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesUser = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $audit_changes_action$ | stats count by user | sort limit=0 user",
            "managerid": "searchMainAuditChangesPopulate",
            "id": "searchAuditChangesUser"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesObjectCategory = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $audit_changes_action$ $audit_changes_user$ | stats count by object_category | sort limit=0 object_category",
            "managerid": "searchMainAuditChangesPopulate",
            "id": "searchAuditChangesObjectCategory"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesChangeType = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $audit_changes_action$ $audit_changes_user$ $audit_changes_object_category$ | stats count by change_type | sort limit=0 change_type",
            "managerid": "searchMainAuditChangesPopulate",
            "id": "searchAuditChangesChangeType"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesObject = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $audit_changes_action$ $audit_changes_user$ $audit_changes_object_category$ $audit_changes_change_type$ | stats count by object | sort limit=0 object",
            "managerid": "searchMainAuditChangesPopulate",
            "id": "searchAuditChangesObject"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesTopAction = new PostProcessManager({
            "tokenDependencies": {},
            "search": "top action",
            "managerid": "searchMainAuditChanges",
            "id": "searchAuditChangesTopAction"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesTopUser = new PostProcessManager({
            "tokenDependencies": {},
            "search": "top user",
            "managerid": "searchMainAuditChanges",
            "id": "searchAuditChangesTopUser"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesTopChangeType = new PostProcessManager({
            "tokenDependencies": {},
            "search": "top change_type",
            "managerid": "searchMainAuditChanges",
            "id": "searchAuditChangesTopChangeType"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // metric hosts monitoring
        var searchMetricHostsMain = new SearchManager({
            "id": "searchMetricHostsMain",
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "refreshType": "delay",
            "refresh": "$refresh$",
            "latest_time": "now",
            "search": "| savedsearch \"TrackMe - metric hosts collection based table report\"\n| `trackme_date_format(\"metric_last_time_seen\")`\n| rename \"metric_last_time_seen (translated)\" as \"last time\"\n| `trackme_eval_metric_host_state`\n| `trackme_metric_host_group_lookup`\n|`trackme_eval_icons_metric_host`\n|`trackme_date_format(\"latest_flip_time\")`\n| fillnull value=\"N/A\" latest_flip_state, latest_flip_time, \"latest_flip_time (translated)\"\n| search $inputMetricHostFilterMode$ (metric_host=$inputMetricHostFilter$ OR object_group_name=$inputMetricHostFilter$)\n|`trackme_ack_lookup_main(metric_host)`\n|`trackme_metric_host_extract_mvstsummary`",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        searchMetricHostsMain.on("search:done", function () {
            // function here
            $("#loadingGrayInitial").remove()
        })

        var searchMainTableMetricHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputMetricHostIndexes$ $inputMetricHostCategories$ $inputMetricHost$ $inputMetricHostPriority$ $metric_host_state$ $metric_monitored_state$ | sort limit=10000 metric_host",
            "managerid": "searchMetricHostsMain",
            "id": "searchMainTableMetricHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchMetricHostsMainStats = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputMetricHostIndexes$ $inputMetricHostCategories$ $inputMetricHost$ | stats count as total, count(eval(metric_monitored_state=\"disabled\")) as total_disabled, count(eval(metric_host_state!=\"green\" AND metric_host_state!=\"blue\" AND metric_monitored_state=\"enabled\")) as total_in_alert, count(eval(metric_host_state=\"red\" AND priority=\"high\" AND metric_monitored_state=\"enabled\")) as total_high_priority_red, count(eval(metric_monitored_state=\"enabled\" AND priority=\"low\")) as low_enabled, count(eval(metric_monitored_state=\"enabled\" AND priority=\"medium\")) as medium_enabled, count(eval(metric_monitored_state=\"enabled\" AND priority=\"high\")) as high_enabled, count(eval(metric_host_state=\"blue\" AND metric_monitored_state=\"enabled\")) as \"blue\", count(eval(metric_host_state=\"orange\" AND metric_monitored_state=\"enabled\")) as \"orange\", count(eval(metric_host_state=\"green\" AND metric_monitored_state=\"enabled\")) as \"green\", count(eval(metric_host_state=\"red\" AND metric_monitored_state=\"enabled\" AND priority=\"high\")) as \"red - high priority\", count(eval(metric_host_state=\"red\" AND metric_monitored_state=\"enabled\" AND priority!=\"high\")) as \"red - other priority\"",
            "managerid": "searchMetricHostsMain",
            "id": "searchMetricHostsMainStats"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateMetricHostsIndexes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputMetricHostCategories$ $inputMetricHost$ | stats values(metric_index) as metric_index | mvexpand metric_index | dedup metric_index | sort limit=0 metric_index",
            "managerid": "searchMetricHostsMain",
            "id": "searchPopulateMetricHostsIndexes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateMetricHosts = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputMetricHostIndexes$ $inputMetricHostCategories$ | stats count by metric_host | sort limit=1000 metric_host",
            "managerid": "searchMetricHostsMain",
            "id": "searchPopulateMetricHosts"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateMetricHostsCategories = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputMetricHostIndexes$ $inputMetricHost$ | stats values(metric_category) as metric_category | mvexpand metric_category | dedup metric_category | search NOT [ | inputlookup trackme_metric_lagging_definition | table metric_category ] | sort limit=1000 metric_category",
            "managerid": "searchMetricHostsMain",
            "id": "searchPopulateMetricHostsCategories"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchHostTableMetricHost = new SearchManager({
            "id": "searchHostTableMetricHost",
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "refreshType": "delay",
            "refresh": "$refresh$",
            "latest_time": "now",
            "search": "| savedsearch \"trackMe - metric per host table report\" host=\"$tk_metric_host$\"",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$",
                "depends": "$tk_metric_host$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchHostChartMetricHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "top metric_host_state",
            "managerid": "searchHostTableMetricHost",
            "id": "searchHostChartMetricHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleSLAMetricHostpct = new SearchManager({
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "search": "`trackme_get_sla_pct_per_entity(metric_host,$tk_metric_host$)`",
            "id": "searchSingleSLAMetricHostpct",
            "sample_ratio": 1,
            "status_buckets": 0,
            "earliest_time": "-90d@d",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // hosts monitoring

        var searchDataHostsMain = new SearchManager({
            "id": "searchDataHostsMain",
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "refreshType": "delay",
            "refresh": "$refresh$",
            "latest_time": "+5m",
            "search": "| inputlookup trackme_host_monitoring\n| eval keyid=_key\n| sort limit=0 - data_last_time_seen\n| dedup data_host\n| eval data_index_raw=data_index, data_sourcetype_raw=data_sourcetype, data_host_st_summary_raw=data_host_st_summary\n| makemv delim=\",\" data_index\n| makemv delim=\",\" data_sourcetype\n| makemv delim=\",\" data_host_st_summary\n| `apply_data_host_blacklists`\n| search `trackme_get_idx_whitelist_searchtime(trackme_data_host_monitoring_whitelist_index, data_index)`\n| `trackme_eval_data_host_state`\n| `trackme_default_priority`\n| `trackme_default_data_host_alert_global_policy`\n| `trackme_data_host_group_lookup`\n| `trackme_date_format(data_last_time_seen)`\n| `trackme_date_format(data_last_time_seen_idx)`\n| `trackme_date_format(data_last_ingest)`\n| `trackme_eval_icons_host`\n| rename \"data_last_ingest (translated)\" as \"last ingest\", \"data_last_time_seen (translated)\" as \"last time\"\n| `trackme_date_format(\"latest_flip_time\")`\n| fillnull value=\"N/A\" latest_flip_state, latest_flip_time, \"latest_flip_time (translated)\"\n| `trackme_data_host_extract_mvstsummary`\n| sort limit=0 data_host\n| search $inputDataHostFilterMode$ (data_host=$inputDataHostFilter$ OR object_group_name=$inputDataHostFilter$)\n|`trackme_ack_lookup_main(data_host)`",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        searchDataHostsMain.on("search:done", function () {
            // function here
            $("#loadingGrayInitial").remove()
        })

        var searchMainTableHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputDataHostFilterMode$ (data_host=$inputDataHostFilter$ OR object_group_name= $inputDataHostFilter$) | search $inputDataHost$ $inputDataHostIndexes$ $inputDataHostSourcetypes$ $data_host_state$ $data_monitored_state$ $inputDataHostPriority$ | fillnull data_last_lag_seen, data_last_ingestion_lag_seen | eval data_last_lag_seen=round(data_last_lag_seen, 0) | eval data_last_ingestion_lag_seen=round(data_last_ingestion_lag_seen, 0) | fillnull value=\"N/A\" data_last_lag_seen, data_last_ingestion_lag_seen\n| eval \"lag (event / ingestion)\" = if(data_last_lag_seen>60, tostring(data_last_lag_seen, \"duration\"), data_last_lag_seen . \" sec\") . \" / \" . if(data_last_ingestion_lag_seen>60, tostring(data_last_ingestion_lag_seen, \"duration\"), data_last_ingestion_lag_seen . \" sec\") | sort limit=10000 data_host",
            "managerid": "searchDataHostsMain",
            "id": "searchMainTableHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchDataHostsMainStats = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputDataHostFilterMode$ (data_host=$inputDataHostFilter$ OR object_group_name= $inputDataHostFilter$) | search $inputDataHostIndexes$ $inputDataHostSourcetypes$ | stats count as total, count(eval(data_monitored_state=\"disabled\")) as total_disabled, count(eval(data_host_state!=\"green\" AND data_host_state!=\"blue\" AND data_monitored_state=\"enabled\")) as total_in_alert, count(eval(data_host_state=\"red\" AND priority=\"high\" AND data_monitored_state=\"enabled\")) as total_high_priority_red, count(eval(data_monitored_state=\"enabled\" AND priority=\"low\")) as low_enabled, count(eval(data_monitored_state=\"enabled\" AND priority=\"medium\")) as medium_enabled, count(eval(data_monitored_state=\"enabled\" AND priority=\"high\")) as high_enabled, count(eval(data_host_state=\"blue\" AND data_monitored_state=\"enabled\")) as \"blue\", count(eval(data_host_state=\"orange\" AND data_monitored_state=\"enabled\")) as \"orange\", count(eval(data_host_state=\"green\" AND data_monitored_state=\"enabled\")) as \"green\", count(eval(data_host_state=\"red\" AND data_monitored_state=\"enabled\" AND priority=\"high\")) as \"red - high priority\", count(eval(data_host_state=\"red\" AND data_monitored_state=\"enabled\" AND priority!=\"high\")) as \"red - other priority\"",
            "managerid": "searchDataHostsMain",
            "id": "searchDataHostsMainStats"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateDataHostsIndexes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "makemv data_index delim=\",\" | search $inputDataHostFilterMode$ (data_host=$inputDataHostFilter$ OR object_group_name= $inputDataHostFilter$) | search $inputDataHostSourcetypes$ | stats values(data_index) as data_index | mvexpand data_index | dedup data_index | sort limit=1000 data_index",
            "managerid": "searchDataHostsMain",
            "id": "searchPopulateDataHostsIndexes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateDataHostsSourcetypes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "makemv data_index delim=\",\" | makemv data_sourcetype delim=\",\" | search $inputDataHostFilterMode$ (data_host=$inputDataHostFilter$ OR object_group_name= $inputDataHostFilter$) | search $inputDataHostIndexes$ | stats values(data_sourcetype) as data_sourcetype | mvexpand data_sourcetype | dedup data_sourcetype | sort limit=1000 data_sourcetype",
            "managerid": "searchDataHostsMain",
            "id": "searchPopulateDataHostsSourcetypes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateDataHosts = new PostProcessManager({
            "tokenDependencies": {},
            "search": "makemv data_index delim=\",\" | makemv data_sourcetype delim=\",\" | search $inputDataHostIndexes$ $inputDataHostSourcetypes$ | stats values(data_host) as data_host | mvexpand data_host | dedup data_host | sort limit=1000 data_host",
            "managerid": "searchDataHostsMain",
            "id": "searchPopulateDataHosts"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleNoDataSources = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count by data_name | sort limit=0 data_name",
            "managerid": "searchDataSourcesMain",
            "id": "searchSingleNoDataSources"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleNoDataIndexes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count by data_index | sort limit=0 data_index",
            "managerid": "searchDataSourcesMain",
            "id": "searchSingleNoDataIndexes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleNoDataSourcetypes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count by data_sourcetype | sort limit=0 data_sourcetype",
            "managerid": "searchDataSourcesMain",
            "id": "searchSingleNoDataSourcetypes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleNoDataHosts = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count by data_host | sort limit=0 data_host",
            "managerid": "searchDataHostsMain",
            "id": "searchSingleNoDataHosts"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataSourceDonutAlerts = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields blue, orange, green, \"red - high priority\", \"red - other priority\"\n| transpose | rename column as state, \"row 1\" as count | `trackme_donut_alert_by_type(state)`",
            "managerid": "searchDataSourcesMainStats",
            "id": "searchSingleDataSourceDonutAlerts"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataSourceDonutPriorities = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields low_enabled, medium_enabled, high_enabled | rename low_enabled as low, medium_enabled as medium, high_enabled as high | transpose | rename column as priority, \"row 1\" as count | `trackme_donut_alert_by_priority`",
            "managerid": "searchDataSourcesMainStats",
            "id": "searchSingleDataSourceDonutPriorities"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataSource1 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total",
            "managerid": "searchDataSourcesMainStats",
            "id": "searchSingleDataSource1"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataSourceInAlert = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total_in_alert",
            "managerid": "searchDataSourcesMainStats",
            "id": "searchSingleDataSourceInAlert"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataSourceHighPriority = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total_high_priority_red",
            "managerid": "searchDataSourcesMainStats",
            "id": "searchSingleDataSourceHighPriority"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataSourceNotMonitored = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total_disabled",
            "managerid": "searchDataSourcesMainStats",
            "id": "searchSingleDataSourceNotMonitored"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataHostDonutAlerts = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields blue, orange, green, \"red - high priority\", \"red - other priority\"\n| transpose | rename column as state, \"row 1\" as count | `trackme_donut_alert_by_type(state)`",
            "managerid": "searchDataHostsMainStats",
            "id": "searchSingleDataHostDonutAlerts"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataHostDonutPriorities = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields low_enabled, medium_enabled, high_enabled | rename low_enabled as low, medium_enabled as medium, high_enabled as high | transpose | rename column as priority, \"row 1\" as count | `trackme_donut_alert_by_priority`",
            "managerid": "searchDataHostsMainStats",
            "id": "searchSingleDataHostDonutPriorities"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataHost1 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total",
            "managerid": "searchDataHostsMainStats",
            "id": "searchSingleDataHost1"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataHostInAlert = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total_in_alert",
            "managerid": "searchDataHostsMainStats",
            "id": "searchSingleDataHostInAlert"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataHostNotMonitored = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total_disabled",
            "managerid": "searchDataHostsMainStats",
            "id": "searchSingleDataHostNotMonitored"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataHostHighPriority = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total_high_priority_red",
            "managerid": "searchDataHostsMainStats",
            "id": "searchSingleDataHostHighPriority"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchGetDataHostTags = new SearchManager({
            "id": "searchGetDataHostTags",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| makeresults | eval data_host=\"$tk_data_host$\" | fields - _time | `trackme_get_data_host_tags` | fields - data_host",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // metric_host

        var searchSingleMetricHostDonutAlerts = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields blue, orange, green, \"red - high priority\", \"red - other priority\"\n| transpose | rename column as state, \"row 1\" as count | `trackme_donut_alert_by_type(state)`",
            "managerid": "searchMetricHostsMainStats",
            "id": "searchSingleMetricHostDonutAlerts"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleMetricHostDonutPriorities = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields low_enabled, medium_enabled, high_enabled | rename low_enabled as low, medium_enabled as medium, high_enabled as high | transpose | rename column as priority, \"row 1\" as count | `trackme_donut_alert_by_priority`",
            "managerid": "searchMetricHostsMainStats",
            "id": "searchSingleMetricHostDonutPriorities"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleMetricHost1 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total",
            "managerid": "searchMetricHostsMainStats",
            "id": "searchSingleMetricHost1"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleMetricHostInAlert = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total_in_alert",
            "managerid": "searchMetricHostsMainStats",
            "id": "searchSingleMetricHostInAlert"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleMetricHostHighPriority = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total_high_priority_red",
            "managerid": "searchMetricHostsMainStats",
            "id": "searchSingleMetricHostHighPriority"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleMetricHostNotMonitored = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total_disabled",
            "managerid": "searchMetricHostsMainStats",
            "id": "searchSingleMetricHostNotMonitored"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchGetMetricHostTags = new SearchManager({
            "id": "searchGetMetricHostTags",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| makeresults | eval metric_host=\"$tk_metric_host$\" | fields - _time | `trackme_get_metric_host_tags` | fields - metric_host",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchGetMetricHostTags",
            event: "progress",
            conditions: [{
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "tk_metric_host_tags",
                        "value": "$result.metric_host_tags$"
                    }]
                }
            ]
        });

        var searchChartLag = new SearchManager({
            "id": "searchChartLag",
            "sample_ratio": 1,
            "search": "$tk_data_source_overview_root_search$ | timechart span=$modalTime.span$ $tk_data_source_timechart_count_aggreg$(count) as events_count, avg(delta) as avg_lag_sec, max(dcount_host) as dcount_host | fields _time, $tk_input_data_source_overview_chart_series$",
            "status_buckets": 0,
            "earliest_time": "$modalTime.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTime.latest$",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // data source monitoring

        // Data parsing quality
        var SearchDataSourceParsingQualityMain = new SearchManager({
            "id": "SearchDataSourceParsingQualityMain",
            "tokenDependencies": {
                "depends": "$show_data_quality$"
            },
            "sample_ratio": 1,
            "earliest_time": "$modalTime.earliest$",
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` (component=LineBreakingProcessor OR component=AggregatorMiningProcessor OR component=DateParserVerbose) | `trackme_data_quality_parse` | search data_sourcetype=\"$tk_data_sourcetype$\"",
            "latest_time": "$modalTime.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "SearchDataSourceParsingQualityMain",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_data_quality_no_results"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_data_quality_no_results",
                        "value": "True"
                    }]
                }
            ]
        });

        var SearchDataSourceParsingQualityChart = new PostProcessManager({
            "tokenDependencies": {},
            "search": "timechart span=$modalTime.span$ count by component",
            "managerid": "SearchDataSourceParsingQualityMain",
            "id": "SearchDataSourceParsingQualityChart"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var SearchDataSourceParsingQualitySingle = new PostProcessManager({
            "tokenDependencies": {},
            "search": "top limit=0 component | eval percent=round(percent, 2) | eval summary=component . \": \" . percent . \" %\" | fields summary | stats values(summary) as summary | append [ | makeresults | eval summary=\"No parsing issues detected (bravo!?), review the trackme_idx_filter macro to target indexing instances.\" | fields - _time ] | head 1",
            "managerid": "SearchDataSourceParsingQualityMain",
            "id": "SearchDataSourceParsingQualitySingle"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Outlier detection
        var searchOutlierDetectionChart = new SearchManager({
            "id": "searchOutlierDetectionChart",
            "sample_ratio": 1,
            "search": "| `trackme_outlier_chart(data_source, \"$tk_data_name$\", data_name, $tk_outlier_span$)`",
            "status_buckets": 0,
            "earliest_time": "$modalTime.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTime.latest$",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$",
                "depends": "$show_data_source_outlier$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchOutlierDetectionChartSimulation = new SearchManager({
            "id": "searchOutlierDetectionChartSimulation",
            "sample_ratio": 1,
            "search": "| `trackme_outlier_chart_simulate(data_source, \"$tk_data_name$\", data_name, $tk_input_data_source_outlier_lower_threshold_multiplier$, $tk_input_data_source_outlier_upper_threshold_multiplier$, $tk_input_data_source_outlier_min_eventcount$, $tk_input_data_source_outlier_span$)`",
            "status_buckets": 0,
            "earliest_time": "$tk_input_data_source_outlier_period$",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$",
                "depends": "$show_data_source_outlier_configuration$",
                "depends": "$start_outliers_simulation_data_source$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchOutlierDetectionTable = new SearchManager({
            "id": "searchOutlierDetectionTable",
            "sample_ratio": 1,
            "search": "| `trackme_outlier_table(trackme_data_source_monitoring, data_name, $tk_data_name$)`",
            "status_buckets": 0,
            "earliest_time": "-24h",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$",
                "depends": "$show_data_source_outlier$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataSource7d = new SearchManager({
            "id": "searchSingleLagAutoLaggingDataSource7d",
            "sample_ratio": 1,
            "search": "$tk_data_source_overview_root_search$ | stats perc95(delta) as perc95_lag, avg(delta) as avg_lag | eval perc95_lag=round(perc95_lag, 0), avg_lag=round(avg_lag, 0)",
            "status_buckets": 0,
            "earliest_time": "-7d",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_autolagging$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataSource7dSingleLagPerc95 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields perc95_lag | eval perc95_lag = round(perc95_lag, 0) . \" sec (\" . tostring(perc95_lag, \"duration\") . \")\"",
            "managerid": "searchSingleLagAutoLaggingDataSource7d",
            "id": "searchSingleLagAutoLaggingDataSource7dSingleLagPerc95"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataSource7dSingleLagAvg = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields avg_lag | eval avg_lag = round(avg_lag, 0) . \" sec (\" . tostring(avg_lag, \"duration\") . \")\"",
            "managerid": "searchSingleLagAutoLaggingDataSource7d",
            "id": "searchSingleLagAutoLaggingDataSource7dSingleLagAvg"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLag30dAutoLagging = new SearchManager({
            "id": "searchSingleLag30dAutoLagging",
            "sample_ratio": 1,
            "search": "$tk_data_source_overview_root_search$ | stats perc95(delta) as perc95_lag, avg(delta) as avg_lag | eval perc95_lag=round(perc95_lag, 0), avg_lag=round(avg_lag, 0)",
            "status_buckets": 0,
            "earliest_time": "-30d",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_autolagging$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataSource30dSingleLagPerc95 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields perc95_lag | eval perc95_lag = round(perc95_lag, 0) . \" sec (\" . tostring(perc95_lag, \"duration\") . \")\"",
            "managerid": "searchSingleLag30dAutoLagging",
            "id": "searchSingleLagAutoLaggingDataSource30dSingleLagPerc95"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataSource30dSingleLagAvg = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields avg_lag | eval avg_lag = round(avg_lag, 0) . \" sec (\" . tostring(avg_lag, \"duration\") . \")\"",
            "managerid": "searchSingleLag30dAutoLagging",
            "id": "searchSingleLagAutoLaggingDataSource30dSingleLagAvg"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataHost7d = new SearchManager({
            "id": "searchSingleLagAutoLaggingDataHost7d",
            "sample_ratio": 1,
            "search": "| tstats count latest(_indextime) as indextime where [ | inputlookup trackme_host_monitoring where data_host=\"$tk_data_host$\" | fields data_index | makemv delim=\",\" data_index | mvexpand data_index | rename data_index as index | table index ] host=\"$tk_data_host$\" `trackme_tstats_main_filter` ( ( `trackme_get_idx_whitelist(trackme_data_host_monitoring_whitelist_index, data_index)` `apply_data_host_blacklists_data_retrieve` ) OR `trackme_tstats_main_filter_for_host` ) by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats perc95(delta) as perc95_lag, avg(delta) as avg_lag | eval perc95_lag=round(perc95_lag, 0), avg_lag=round(avg_lag, 0)",
            "status_buckets": 0,
            "earliest_time": "-7d",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_autolagging$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataHost7dSingleLagPerc95 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields perc95_lag | eval perc95_lag = round(perc95_lag, 0) . \" sec (\" . tostring(perc95_lag, \"duration\") . \")\"",
            "managerid": "searchSingleLagAutoLaggingDataHost7d",
            "id": "searchSingleLagAutoLaggingDataHost7dSingleLagPerc95"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataHost7dSingleLagAvg = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields avg_lag | eval avg_lag = round(avg_lag, 0) . \" sec (\" . tostring(avg_lag, \"duration\") . \")\"",
            "managerid": "searchSingleLagAutoLaggingDataHost7d",
            "id": "searchSingleLagAutoLaggingDataHost7dSingleLagAvg"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLag30dAutoLaggingDataHost = new SearchManager({
            "id": "searchSingleLag30dAutoLaggingDataHost",
            "sample_ratio": 1,
            "search": "| tstats count latest(_indextime) as indextime where [ | inputlookup trackme_host_monitoring where data_host=\"$tk_data_host$\" | fields data_index | makemv delim=\",\" data_index | mvexpand data_index | rename data_index as index | table index ] host=\"$tk_data_host$\" `trackme_tstats_main_filter` ( ( `trackme_get_idx_whitelist(trackme_data_host_monitoring_whitelist_index, data_index)` `apply_data_host_blacklists_data_retrieve` ) OR `trackme_tstats_main_filter_for_host` ) by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats perc95(delta) as perc95_lag, avg(delta) as avg_lag | eval perc95_lag=round(perc95_lag, 0), avg_lag=round(avg_lag, 0)",
            "status_buckets": 0,
            "earliest_time": "-30d",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_autolagging$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataHost30dSingleLagPerc95 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields perc95_lag | eval perc95_lag = round(perc95_lag, 0) . \" sec (\" . tostring(perc95_lag, \"duration\") . \")\"",
            "managerid": "searchSingleLag30dAutoLaggingDataHost",
            "id": "searchSingleLagAutoLaggingDataHost30dSingleLagPerc95"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataHost30dSingleLagAvg = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields avg_lag | eval avg_lag = round(avg_lag, 0) . \" sec (\" . tostring(avg_lag, \"duration\") . \")\"",
            "managerid": "searchSingleLag30dAutoLaggingDataHost",
            "id": "searchSingleLagAutoLaggingDataHost30dSingleLagAvg"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLag = new SearchManager({
            "id": "searchSingleLag",
            "sample_ratio": 1,
            "search": "$tk_data_source_overview_root_search$ | stats perc95(delta) as perc95_lag, avg(delta) as avg_lag, latest(event_lag) as event_lag",
            "status_buckets": 0,
            "earliest_time": "$modalTime.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTime.latest$",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagPerc95 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields perc95_lag | `trackme_parse_duration(perc95_lag, 60)`",
            "managerid": "searchSingleLag",
            "id": "searchSingleLagPerc95"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAvg = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields avg_lag | `trackme_parse_duration(avg_lag, 60)`",
            "managerid": "searchSingleLag",
            "id": "searchSingleLagAvg"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleEventLag = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields event_lag | `trackme_parse_duration(event_lag, 60)`",
            "managerid": "searchSingleLag",
            "id": "searchSingleEventLag"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleSLApct = new SearchManager({
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "search": "`trackme_get_sla_pct_per_entity(data_source,$tk_data_name$)`",
            "id": "searchSingleSLApct",
            "sample_ratio": 1,
            "status_buckets": 0,
            "earliest_time": "-90d@d",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleByMetricsLag = new SearchManager({
            "id": "searchSingleByMetricsLag",
            "sample_ratio": 1,
            "search": "| mstats perc95(trackme.lag_ingestion_sec) as perc95_lag, avg(trackme.lag_ingestion_sec) as avg_lag, latest(trackme.lag_event_sec) as event_lag where `trackme_metrics_idx` object_category=\"data_source\" object=\"$tk_data_name$\"",
            "status_buckets": 0,
            "earliest_time": "$modalTime.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTime.latest$",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_lagging_metrics$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagByMetricsPerc95 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields perc95_lag | `trackme_parse_duration(perc95_lag, 60)`",
            "managerid": "searchSingleByMetricsLag",
            "id": "searchSingleLagByMetricsPerc95"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagByMetricsAvg = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields avg_lag | `trackme_parse_duration(avg_lag, 60)`",
            "managerid": "searchSingleByMetricsLag",
            "id": "searchSingleLagByMetricsAvg"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleEventByMetricsLag = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields event_lag | `trackme_parse_duration(event_lag, 60)`",
            "managerid": "searchSingleByMetricsLag",
            "id": "searchSingleEventByMetricsLag"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // data host monitoring

        // Data parsing quality
        var SearchDataHostParsingQualityMain = new SearchManager({
            "id": "SearchDataHostParsingQualityMain",
            "tokenDependencies": {
                "depends": "$show_data_host_quality$"
            },
            "sample_ratio": 1,
            "earliest_time": "$modalTimeHost.earliest$",
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=LineBreakingProcessor OR component=AggregatorMiningProcessor OR component=DateParserVerbose | `trackme_data_quality_parse` | search data_host=\"$tk_data_host$\"",
            "latest_time": "$modalTimeHost.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "SearchDataHostParsingQualityMain",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_data_host_quality_no_results"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_data_host_quality_no_results",
                        "value": "True"
                    }]
                }
            ]
        });

        var SearchDataHostParsingQualityChart = new PostProcessManager({
            "tokenDependencies": {},
            "search": "timechart span=$modalTimeHost.span$ count by component",
            "managerid": "SearchDataHostParsingQualityMain",
            "id": "SearchDataHostParsingQualityChart"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var SearchDataHostParsingQualitySingle = new PostProcessManager({
            "tokenDependencies": {},
            "search": "top limit=0 component | eval percent=round(percent, 2) | eval summary=component . \": \" . percent . \" %\" | fields summary | stats values(summary) as summary",
            "managerid": "SearchDataHostParsingQualityMain",
            "id": "SearchDataHostParsingQualitySingle"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Outlier detection
        var searchOutlierDetectionChartDataHost = new SearchManager({
            "id": "searchOutlierDetectionChartDataHost",
            "sample_ratio": 1,
            "search": "| `trackme_outlier_chart(data_host, \"$tk_data_host$\", data_host, $tk_outlier_span$)`",
            "status_buckets": 0,
            "earliest_time": "$modalTimeHost.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTimeHost.latest$",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$",
                "depends": "$show_data_host_outlier$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchOutlierDetectionChartSimulationDataHost = new SearchManager({
            "id": "searchOutlierDetectionChartSimulationDataHost",
            "sample_ratio": 1,
            "search": "| `trackme_outlier_chart_simulate(data_host, \"$tk_data_host$\", data_host, $tk_input_data_host_outlier_lower_threshold_multiplier$, $tk_input_data_host_outlier_upper_threshold_multiplier$, $tk_input_data_host_outlier_min_eventcount$, $tk_input_data_host_outlier_span$)`",
            "status_buckets": 0,
            "earliest_time": "$tk_input_data_host_outlier_period$",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$",
                "depends": "$show_data_host_outlier_configuration$",
                "depends": "$start_outliers_simulation_data_host$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchOutlierDetectionTableDataHost = new SearchManager({
            "id": "searchOutlierDetectionTableDataHost",
            "sample_ratio": 1,
            "search": "| `trackme_outlier_table(trackme_host_monitoring, data_host, $tk_data_host$)`",
            "status_buckets": 0,
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$",
                "depends": "$show_data_host_outlier$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagHost = new SearchManager({
            "id": "searchSingleLagHost",
            "sample_ratio": 1,
            "search": "| tstats count latest(_indextime) as indextime max(_time) as maxtime where [ | inputlookup trackme_host_monitoring where data_host=\"$tk_data_host$\" | fields data_index | makemv delim=\",\" data_index | mvexpand data_index | rename data_index as index | table index ] host=\"$tk_data_host$\" `trackme_tstats_main_filter` ( ( `trackme_get_idx_whitelist(trackme_data_host_monitoring_whitelist_index, data_index)` `apply_data_host_blacklists_data_retrieve` ) OR `trackme_tstats_main_filter_for_host` ) by _time, index, sourcetype span=1s | eval delta=(indextime-_time), event_lag=(now() - maxtime) | stats perc95(delta) as perc95_lag, avg(delta) as avg_lag, latest(event_lag) as event_lag",
            "status_buckets": 0,
            "earliest_time": "$modalTimeHost.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTimeHost.latest$",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagHostPerc95 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields perc95_lag | `trackme_parse_duration(perc95_lag, 60)`",
            "managerid": "searchSingleLagHost",
            "id": "searchSingleLagHostPerc95"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagHostAvg = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields avg_lag | `trackme_parse_duration(avg_lag, 60)`",
            "managerid": "searchSingleLagHost",
            "id": "searchSingleLagHostAvg"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagHostEventLag = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields event_lag | `trackme_parse_duration(event_lag, 60)`",
            "managerid": "searchSingleLagHost",
            "id": "searchSingleLagHostEventLag"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagByMetricsHost = new SearchManager({
            "id": "searchSingleLagByMetricsHost",
            "sample_ratio": 1,
            "search": "| mstats perc95(trackme.lag_ingestion_sec) as perc95_lag, avg(trackme.lag_ingestion_sec) as avg_lag, latest(trackme.lag_event_sec) as event_lag where `trackme_metrics_idx` object_category=\"data_host\" object=\"$tk_data_host$\"",
            "status_buckets": 0,
            "earliest_time": "$modalTimeHost.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTimeHost.latest$",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_lagging_metrics$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagByMetricsHostPerc95 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields perc95_lag | `trackme_parse_duration(perc95_lag, 60)`",
            "managerid": "searchSingleLagByMetricsHost",
            "id": "searchSingleLagByMetricsHostPerc95"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagByMetricsHostAvg = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields avg_lag | `trackme_parse_duration(avg_lag, 60)`",
            "managerid": "searchSingleLagByMetricsHost",
            "id": "searchSingleLagByMetricsHostAvg"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagByMetricsHostEventLag = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields event_lag | `trackme_parse_duration(event_lag, 60)`",
            "managerid": "searchSingleLagByMetricsHost",
            "id": "searchSingleLagByMetricsHostEventLag"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleSLAHostpct = new SearchManager({
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "search": "`trackme_get_sla_pct_per_entity(data_host,$tk_data_host$)`",
            "id": "searchSingleSLAHostpct",
            "sample_ratio": 1,
            "status_buckets": 0,
            "earliest_time": "-90d@d",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchChartHostBaseSearch = new SearchManager({
            "id": "searchChartHostBaseSearch",
            "earliest_time": "$modalTimeHost.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTimeHost.latest$",
            "sample_ratio": 1,
            "search": "| tstats count where [ | inputlookup trackme_host_monitoring where data_host=\"$tk_data_host$\" | fields data_index | makemv delim=\",\" data_index | mvexpand data_index | rename data_index as index | table index ] host=\"$tk_data_host$\" `trackme_tstats_main_filter` ( ( `trackme_get_idx_whitelist(trackme_data_host_monitoring_whitelist_index, data_index)` `apply_data_host_blacklists_data_retrieve` ) OR `trackme_tstats_main_filter_for_host` ) by index, sourcetype",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchChartHostIndexes = new PostProcessManager({
            "tokenDependencies": {},
            "managerid": "searchChartHostBaseSearch",
            "search": "stats sum(count) as count by index | sort - count",
            "id": "searchChartHostIndexes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchChartHostSourcetypes = new PostProcessManager({
            "tokenDependencies": {},
            "managerid": "searchChartHostBaseSearch",
            "search": "stats sum(count) as count by sourcetype | sort - count",
            "id": "searchChartHostSourcetypes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchChartLagHostOverTime = new SearchManager({
            "id": "searchChartLagHostOverTime",
            "earliest_time": "$modalTimeHost.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTimeHost.latest$",
            "sample_ratio": 1,
            "search": "| tstats count, max(_indextime) as indextime where [ | inputlookup trackme_host_monitoring where data_host=\"$tk_data_host$\" | fields data_index | makemv delim=\",\" data_index | mvexpand data_index | rename data_index as index | table index ] host=\"$tk_data_host$\" `trackme_tstats_main_filter` ( ( `trackme_get_idx_whitelist(trackme_data_host_monitoring_whitelist_index, data_index)` `apply_data_host_blacklists_data_retrieve` ) OR `trackme_tstats_main_filter_for_host` ) by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | timechart span=$modalTimeHost.span$ sum(count) as events_count, avg(delta) as avg_lag_sec",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Metric SLA policies

        var searchMetricPolicies = new SearchManager({
            "id": "searchMetricPolicies",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_metric_lagging_definition | eval keyid=_key, select=keyid",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_metric_sla_policies$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchMetricPolicies",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_metric_policies"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_metric_policies",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleMetricPolicies = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchMetricPolicies",
            "id": "searchSingleMetricPolicies"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Data sampling

        var searchDataSamplingTable1 = new SearchManager({
            "id": "searchDataSamplingTable1",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_sampling where data_name=\"$tk_data_name$\" | eval \" \" = \"<--\" | fields data_sample_status_colour, data_sample_status_message, data_sample_feature, data_sampling_nr, current_detected_format, \" \", previous_detected_format, data_sample_anomaly_detected, data_sample_anomaly_reason, multiformat_detected, data_sample_mtime | eval mtime=strftime(data_sample_mtime, \"%c\") | `trackme_eval_icons_data_sampling_enablement` | `trackme_eval_icons_data_sampling_summary` | rename data_sample_anomaly_reason as anomaly_reason, multiformat_detected as multiformat | eval previous_detected_format=if(isnull(previous_detected_format), \"N/A\", previous_detected_format) | append [ | makeresults | eval data_sample_feature=\"N/A\", current_detected_format=\"N/A\", previous_detected_format=\"N/A\", state=\"N/A\", anomaly_reason=\"N/A\", multiformat=\"N/A\", mtime=\"N/A\" ] | eval data_sampling_nr=if(isnum(data_sampling_nr), data_sampling_nr, `trackme_data_sampling_default_sample_record_at_run`) | fields - data_name | rename data_sample_feature as feature | head 1",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_sampling$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchDataSamplingShowCustomRules = new SearchManager({
            "id": "searchDataSamplingShowCustomRules",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| `trackme_show_custom_model_rules` | fillnull value=\"ANY\" sourcetype_scope",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_sampling_custom_rules$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchDataSamplingShowCustomRules",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_sampling_custom_rules"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_sampling_custom_rules",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchDataSamplingShowBuiltinRules = new SearchManager({
            "id": "searchDataSamplingShowBuiltinRules",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| `trackme_show_builtin_model_rules`",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_sampling$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchDataSamplingSimulateCustomRule = new SearchManager({
            "id": "searchDataSamplingSimulateCustomRule",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| `trackme_data_sampling_return_live_sample(\"$tk_input_data_sampling_dropdown$\")` | mvexpand raw_sample | eval sourcetype=\"$tk_data_sampling_custom_st_value$\", sourcetype_scope=\"$tk_data_sampling_custom_sourcetype_scope$\", model_type=\"$tk_data_sampling_custom_rule_type$\" | eval detected_format = case((sourcetype_scope==\"*\"), case(match(raw_sample, \"$tk_data_sampling_custom_rule_regex$\"), \"$tk_data_sampling_custom_rule_name$\"), in(sourcetype, `trackme_data_sampling_custom_models_simulate_genlist(\"$tk_data_sampling_custom_sourcetype_scope$\")`), case(match(raw_sample, \"$tk_data_sampling_custom_rule_regex$\"), \"$tk_data_sampling_custom_rule_name$\")) | `trackme_data_sampling_simulate_custom_rule`",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_simulation_data_sampling_custom_rule$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchDataSamplingSimulateCustomRuleLatestEvent = new SearchManager({
            "id": "searchDataSamplingSimulateCustomRuleLatestEvent",
            "earliest_time": "-24h",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| `trackme_data_sampling_return_live_sample(\"$tk_input_data_sampling_dropdown$\")`",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_simulation_data_sampling_custom_rule_show_events$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Custom lagging

        var searchCustomLagging = new SearchManager({
            "id": "searchCustomLagging",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_custom_lagging_definition | eval keyid=_key | search name=$tk_input_custom_lagging_search$ | eval select=keyid, object=if(isnull(object), \"all\", object) | fields keyid, level, name, object, value, select",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_custom_lagging$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchCustomLagging",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_custom_lagging"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_custom_lagging",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleCustomLagging = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchCustomLagging",
            "id": "searchSingleCustomLagging"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Elastic Sources Shared

        var searchElasticSources = new SearchManager({
            "id": "searchElasticSources",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_elastic_sources | eval keyid=_key | search data_name=$tk_input_elastic_sources_search$ | eval select=data_name | fields keyid, data_name, search_mode, search_constraint, elastic_data_index, elastic_data_sourcetype, select",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_elastic_sources$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchElasticSources",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_elastic_sources"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_elastic_sources",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleElasticSources = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchElasticSources",
            "id": "searchSingleElasticSources"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Elastic Sources Shared

        var searchElasticSourcesDedicated = new SearchManager({
            "id": "searchElasticSourcesDedicated",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_elastic_sources_dedicated | eval keyid=_key | search data_name=$tk_input_elastic_sources_dedicated_search$ | eval select=data_name | fields keyid, data_name, search_mode, search_constraint, elastic_data_index, elastic_data_sourcetype, select",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_elastic_sources_dedicated$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchElasticSourcesDedicated",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_elastic_sources_dedicated"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_elastic_sources_dedicated",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleElasticSourcesDedicated = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchElasticSourcesDedicated",
            "id": "searchSingleElasticSourcesDedicated"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchElasticSourcesTest = new SearchManager({
            "id": "searchElasticSourcesTest",
            "earliest_time": "$tk_input_elastic_source_earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$tk_input_elastic_source_latest$",
            "search": "| savedsearch runSPL [ | makeresults | eval data_name=\"$tk_input_elastic_source_data_name$\", search_mode=\"$form.tk_input_elastic_source_search_type$\", search_constraint=\"$tk_input_elastic_source_search_constraint$\", elastic_data_index=\"$tk_input_elastic_source_elastic_data_index$\", elastic_data_sourcetype=\"$tk_input_elastic_source_elastic_data_sourcetype$\" | `trackme_elastic_sources_simulate(\"$tk_input_elastic_source_data_name$\", \"$tk_input_elastic_source_earliest$\", \"$tk_input_elastic_source_latest$\")`",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_simulation_elastic_sources$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // whitelist

        // whitelist data_source

        var searchWhiteListDataSource = new SearchManager({
            "id": "searchWhiteListDataSource",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_source_monitoring_whitelist_index | eval keyid=_key | search data_index=\"$form.tk_input_data_source_whitelist_search$\" | sort limit=0 data_index | eval select=keyid | fields data_index, keyid, select",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$",
                "depends": "$start_modify_data_source_whitelist$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchWhiteListDataSource",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_source_whitelist"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_source_whitelist",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleWhiteListDataSource = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchWhiteListDataSource",
            "id": "searchSingleWhiteListDataSource"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // whitelist metric_host

        var searchWhiteListMetricHost = new SearchManager({
            "id": "searchWhiteListMetricHost",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_metric_host_monitoring_whitelist_index | eval keyid=_key | search metric_index=\"$form.tk_input_metric_host_whitelist_search$\" | eval select=keyid | sort limit=0 metric_index | fields metric_index, select",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$",
                "depends": "$start_modify_metric_host_whitelist$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchWhiteListMetricHost",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_metric_host_whitelist"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_metric_host_whitelist",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleWhiteListMetricHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchWhiteListMetricHost",
            "id": "searchSingleWhiteListMetricHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // whitelist data_host

        var searchWhiteListDataHost = new SearchManager({
            "id": "searchWhiteListDataHost",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_host_monitoring_whitelist_index | eval keyid=_key | search data_index=\"$form.tk_input_data_host_whitelist_search$\" | eval select=keyid | sort limit=0 data_index",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$",
                "depends": "$start_modify_data_host_whitelist$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchWhiteListDataHost",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_host_whitelist"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_host_whitelist",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleWhiteListDataHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchWhiteListDataHost",
            "id": "searchSingleWhiteListDataHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist

        // blacklist host

        var searchBlackListDataSourceHost = new SearchManager({
            "id": "searchBlackListDataSourceHost",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_source_monitoring_blacklist_host | eval keyid=_key | `detect_rex(data_host)` | search data_host=\"$form.tk_input_data_source_blacklist_host_search$\" | eval select=keyid | fields data_host, data_blacklist_state, is_rex, select",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$",
                "depends": "$start_modify_data_source_blacklist_host$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListDataSourceHost",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_source_blacklist_host"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_source_blacklist_host",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleBlackListDataSourceHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListDataSourceHost",
            "id": "searchSingleBlackListDataSourceHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist index

        var searchBlackListDataSourceIndex = new SearchManager({
            "id": "searchBlackListDataSourceIndex",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_source_monitoring_blacklist_index | eval keyid=_key | `detect_rex(data_index)` | eval select=keyid | search data_index=\"$form.tk_input_data_source_blacklist_index_search$\" | fields keyid, data_index, data_blacklist_state, is_rex, select",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_data_source_blacklist_index$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListDataSourceIndex",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_source_blacklist_index"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_source_blacklist_index",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleBlackListDataSourceIndex = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListDataSourceIndex",
            "id": "searchSingleBlackListDataSourceIndex"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist sourcetype

        var searchBlackListDataSourceSourcetype = new SearchManager({
            "id": "searchBlackListDataSourceSourcetype",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_source_monitoring_blacklist_sourcetype | eval keyid=_key | `detect_rex(data_sourcetype)` | eval select=keyid | search data_sourcetype=\"$form.tk_input_data_source_blacklist_sourcetype_search$\" | fields keyid, data_sourcetype, data_blacklist_state, is_rex, select",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_data_source_blacklist_sourcetype$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListDataSourceSourcetype",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_source_blacklist_sourcetype"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_source_blacklist_sourcetype",
                        "value": "True"
                    }]
                }
            ]
        });

        // blacklist data_name

        var searchBlackListDataSourceDataName = new SearchManager({
            "id": "searchBlackListDataSourceDataName",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_source_monitoring_blacklist_data_name | eval keyid=_key | `detect_rex(data_name)` | eval select=keyid | search data_name=\"$form.tk_input_data_source_blacklist_data_name_search$\" | fields keyid, data_name, data_blacklist_state, is_rex, select",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_data_source_blacklist_data_name$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListDataSourceDataName",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_source_blacklist_data_name"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_source_blacklist_data_name",
                        "value": "True"
                    }]
                }
            ]
        });

        // blacklist host

        var searchBlackListDataHostHost = new SearchManager({
            "id": "searchBlackListDataHostHost",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_host_monitoring_blacklist_host | eval keyid=_key | `detect_rex(data_host)` | eval select=keyid | search data_host=\"$form.tk_input_data_host_blacklist_host_search$\" | fields data_host, data_blacklist_state, is_rex, select",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_data_host_blacklist_host$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListDataHostHost",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_host_blacklist_host"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_host_blacklist_host",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleBlackListDataHostHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListDataHostHost",
            "id": "searchSingleBlackListDataHostHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist host

        var searchBlackListMetricHostHost = new SearchManager({
            "id": "searchBlackListMetricHostHost",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_metric_host_monitoring_blacklist_host | eval keyid=_key | `detect_rex(metric_host)` | search metric_host=\"$form.tk_input_metric_host_blacklist_host_search$\" | eval select=keyid | fields keyid, metric_host, is_rex, select",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_metric_host_blacklist_host$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListMetricHostHost",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_metric_host_blacklist_host"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_metric_host_blacklist_host",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleBlackListMetricHostHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListMetricHostHost",
            "id": "searchSingleBlackListMetricHostHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist index

        var searchBlackListDataHostIndex = new SearchManager({
            "id": "searchBlackListDataHostIndex",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_host_monitoring_blacklist_index | eval keyid=_key | `detect_rex(data_index)` | search data_index=\"$form.tk_input_data_host_blacklist_index_search$\" | eval select = keyid | fields keyid, data_index, is_rex, select",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_data_host_blacklist_index$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListDataHostIndex",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_host_blacklist_index"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_host_blacklist_index",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleBlackListDataHostIndex = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListDataHostIndex",
            "id": "searchSingleBlackListDataHostIndex"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist metric index
        var searchBlackListMetricHostIndex = new SearchManager({
            "id": "searchBlackListMetricHostIndex",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_metric_host_monitoring_blacklist_index | eval keyid=_key | `detect_rex(metric_index)` | search metric_index=\"$form.tk_input_metric_host_blacklist_index_search$\" | eval select = keyid | fields keyid, metric_index, is_rex, select",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_metric_host_blacklist_index$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListMetricHostIndex",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_metric_host_blacklist_index"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_metric_host_blacklist_index",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleBlackListMetricHostIndex = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListMetricHostIndex",
            "id": "searchSingleBlackListMetricHostIndex"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist sourcetype

        var searchBlackListDataHostSourcetype = new SearchManager({
            "id": "searchBlackListDataHostSourcetype",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_host_monitoring_blacklist_sourcetype | eval keyid=_key | `detect_rex(data_sourcetype)` | search data_sourcetype=\"$form.tk_input_data_host_blacklist_sourcetype_search$\" | eval select = keyid | fields keyid, data_sourcetype, is_rex, select",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_data_host_blacklist_sourcetype$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListDataHostSourcetype",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_host_blacklist_sourcetype"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_host_blacklist_sourcetype",
                        "value": "True"
                    }]
                }
            ]
        });

        // blacklist metric_category

        var searchBlackListMetricHostMetricCategory = new SearchManager({
            "id": "searchBlackListMetricHostMetricCategory",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_metric_host_monitoring_blacklist_metric_category | eval keyid=_key | `detect_rex(metric_category)` | search metric_category=\"$form.tk_input_metric_host_blacklist_metric_category_search$\" | eval select = keyid | fields keyid, metric_category, is_rex, select",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_metric_host_blacklist_metric_category$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListMetricHostMetricCategory",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_metric_host_blacklist_metric_category"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_metric_host_blacklist_metric_category",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleBlackListDataSourceSourcetype = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListDataSourceSourcetype",
            "id": "searchSingleBlackListDataSourceSourcetype"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleBlackListDataSourceDataName = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListDataSourceDataName",
            "id": "searchSingleBlackListDataSourceDataName"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleBlackListDataHostSourcetype = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListDataHostSourcetype",
            "id": "searchSingleBlackListDataHostSourcetype"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleBlackListMetricHostMetricCategory = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListMetricHostMetricCategory",
            "id": "searchSingleBlackListMetricHostMetricCategory"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Indexer queues

        var searchPopulateHostQueues = new SearchManager({
            "id": "searchPopulateHostQueues",
            "earliest_time": "$inputLinkQueuesTime.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "refreshType": "delay",
            "latest_time": "$inputLinkQueuesTime.latest$",
            "search": "| tstats count where (index=_internal `trackme_idx_filter` source=*metrics.log sourcetype=splunkd) by host | sort 0 host | fields host",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$tk_start_indexers_queues_searches$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchQueueAll = new SearchManager({
            "id": "searchQueueAll",
            "tokenDependencies": {
                "depends": "$tk_start_indexers_queues_searches$"
            },
            "sample_ratio": 1,
            "earliest_time": "$inputLinkQueuesTime.earliest$",
            "search": "(index=_internal `trackme_idx_filter` source=*metrics.log sourcetype=splunkd $inputHostQueues$ group=queue) | eval max=if(isnotnull(max_size_kb),max_size_kb,max_size) | eval curr=if(isnotnull(current_size_kb),current_size_kb,current_size) | eval fill_perc=round((curr/max)*100,2) | bucket _time span=1m | stats Median(fill_perc) AS \"fill_percentage\" by host, _time, name | timechart limit=0 useother=f span=2m avg(fill_percentage) as \"pct_fill_indexqueue\" by name",
            "latest_time": "$inputLinkQueuesTime.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchQueueTreillis = new SearchManager({
            "id": "searchQueueTreillis",
            "earliest_time": "$inputLinkQueuesTime.earliest$",
            "latest_time": "$inputLinkQueuesTime.latest$",
            "sample_ratio": 1,
            "search": "(index=_internal `trackme_idx_filter` source=*metrics.log sourcetype=splunkd $inputHostQueues$ group=queue) | eval max=if(isnotnull(max_size_kb),max_size_kb,max_size) | eval curr=if(isnotnull(current_size_kb),current_size_kb,current_size) | eval fill_perc=round((curr/max)*100,2) | bucket _time span=1m | eval ingest_pipe=if(isnull(ingest_pipe), 0, ingest_pipe) | eval key = $inputHostQueuesBreak$ | stats Median(fill_perc) AS \"fill_percentage\" by key, _time | timechart limit=0 useother=f span=2m avg(fill_percentage) as \"pct_fill_indexqueue\" by key",
            "status_buckets": 0,
            "cancelOnUnload": true,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$tk_start_indexers_queues_searches$"
            },
            "runWhenTimeIsUndefined": false
        }, {tokens: true, tokenNamespace: "submitted"});

        // Parsing issues

        var searchPopulateHostParsing = new SearchManager({
            "id": "searchPopulateHostParsing",
            "earliest_time": "$inputLinkParsingIssuesTime.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "refreshType": "delay",
            "latest_time": "$inputLinkParsingIssuesTime.latest$",
            "search": "| tstats count where (index=_internal `trackme_idx_filter` source=*metrics.log sourcetype=splunkd) by host | sort 0 host | fields host",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });
        
        var searchParsingIssuesChart = new SearchManager({
            "id": "searchParsingIssuesChart",
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "sample_ratio": 1,
            "earliest_time": "$inputLinkParsingIssuesTime.earliest$",
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` $inputHostParsing$ component=LineBreakingProcessor OR component=AggregatorMiningProcessor OR component=DateParserVerbose | timechart span=$inputLinkParsingIssuesTime.span$ count by component",
            "latest_time": "$inputLinkParsingIssuesTime.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchParsingIssuesSingle = new SearchManager({
            "id": "searchParsingIssuesSingle",
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "sample_ratio": 1,
            "earliest_time": "$inputLinkParsingIssuesTime.earliest$",
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` $inputHostParsing$ component=LineBreakingProcessor OR component=AggregatorMiningProcessor OR component=DateParserVerbose | top limit=0 component | eval percent=round(percent, 2) | eval summary=component . \": \" . percent . \" %\" | fields summary | stats values(summary) as summary | append [ | makeresults | eval summary=\"No parsing issues detected (bravo!?), review the trackme_idx_filter macro to target indexing instances.\" | fields - _time ] | head 1",
            "latest_time": "$inputLinkParsingIssuesTime.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchLineBreakingProcessorTopSource = new SearchManager({
            "id": "searchLineBreakingProcessorTopSource",
            "earliest_time": "$inputLinkParsingIssuesTime.earliest$",
            "latest_time": "$inputLinkParsingIssuesTime.latest$",
            "sample_ratio": 1,
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=LineBreakingProcessor | top limit=50 data_source | eval percent=round(percent, 2)",
            "status_buckets": 0,
            "cancelOnUnload": true,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "runWhenTimeIsUndefined": false
        }, {tokens: true, tokenNamespace: "submitted"});
        
        var searchLineBreakingProcessorTopHost = new SearchManager({
            "id": "searchLineBreakingProcessorTopHost",
            "earliest_time": "$inputLinkParsingIssuesTime.earliest$",
            "latest_time": "$inputLinkParsingIssuesTime.latest$",
            "sample_ratio": 1,
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=LineBreakingProcessor | top limit=50 data_host | eval percent=round(percent, 2)",
            "status_buckets": 0,
            "cancelOnUnload": true,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "runWhenTimeIsUndefined": false
        }, {tokens: true, tokenNamespace: "submitted"});
        
        var searchLineBreakingProcessorTopSourcetype = new SearchManager({
            "id": "searchLineBreakingProcessorTopSourcetype",
            "earliest_time": "$inputLinkParsingIssuesTime.earliest$",
            "latest_time": "$inputLinkParsingIssuesTime.latest$",
            "sample_ratio": 1,
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=LineBreakingProcessor | top limit=50 data_sourcetype | eval percent=round(percent, 2)",
            "status_buckets": 0,
            "cancelOnUnload": true,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "runWhenTimeIsUndefined": false
        }, {tokens: true, tokenNamespace: "submitted"});
        
        var searchAggregatorMiningProcessorTopSource = new SearchManager({
            "id": "searchAggregatorMiningProcessorTopSource",
            "earliest_time": "$inputLinkParsingIssuesTime.earliest$",
            "latest_time": "$inputLinkParsingIssuesTime.latest$",
            "sample_ratio": 1,
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=AggregatorMiningProcessor | top limit=50 data_source | eval percent=round(percent, 2)",
            "status_buckets": 0,
            "cancelOnUnload": true,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "runWhenTimeIsUndefined": false
        }, {tokens: true, tokenNamespace: "submitted"});
        
        var searchAggregatorMiningProcessorTopHost = new SearchManager({
            "id": "searchAggregatorMiningProcessorTopHost",
            "earliest_time": "$inputLinkParsingIssuesTime.earliest$",
            "latest_time": "$inputLinkParsingIssuesTime.latest$",
            "sample_ratio": 1,
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=AggregatorMiningProcessor | top limit=50 data_host | eval percent=round(percent, 2)",
            "status_buckets": 0,
            "cancelOnUnload": true,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "runWhenTimeIsUndefined": false
        }, {tokens: true, tokenNamespace: "submitted"});
        
        var searchAggregatorMiningProcessorTopSourcetype = new SearchManager({
            "id": "searchAggregatorMiningProcessorTopSourcetype",
            "earliest_time": "$inputLinkParsingIssuesTime.earliest$",
            "latest_time": "$inputLinkParsingIssuesTime.latest$",
            "sample_ratio": 1,
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=AggregatorMiningProcessor | top limit=50 data_sourcetype | eval percent=round(percent, 2)",
            "status_buckets": 0,
            "cancelOnUnload": true,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "runWhenTimeIsUndefined": false
        }, {tokens: true, tokenNamespace: "submitted"});
        
        var searchDateParserVerboseTopSource = new SearchManager({
            "id": "searchDateParserVerboseTopSource",
            "earliest_time": "$inputLinkParsingIssuesTime.earliest$",
            "latest_time": "$inputLinkParsingIssuesTime.latest$",
            "sample_ratio": 1,
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=DateParserVerbose | `trackme_rex_dateparserverbose` | top limit=50 data_source | eval percent=round(percent, 2)",
            "status_buckets": 0,
            "cancelOnUnload": true,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "runWhenTimeIsUndefined": false
        }, {tokens: true, tokenNamespace: "submitted"});
        
        var searchDateParserVerboseTopHost = new SearchManager({
            "id": "searchDateParserVerboseTopHost",
            "earliest_time": "$inputLinkParsingIssuesTime.earliest$",
            "latest_time": "$inputLinkParsingIssuesTime.latest$",
            "sample_ratio": 1,
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=DateParserVerbose | `trackme_rex_dateparserverbose` | top limit=50 data_host | eval percent=round(percent, 2)",
            "status_buckets": 0,
            "cancelOnUnload": true,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "runWhenTimeIsUndefined": false
        }, {tokens: true, tokenNamespace: "submitted"});
        
        var searchDateParserVerboseTopSourcetype = new SearchManager({
            "id": "searchDateParserVerboseTopSourcetype",
            "earliest_time": "$inputLinkParsingIssuesTime.earliest$",
            "latest_time": "$inputLinkParsingIssuesTime.latest$",
            "sample_ratio": 1,
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=DateParserVerbose | `trackme_rex_dateparserverbose` | top limit=50 data_sourcetype | eval percent=round(percent, 2)",
            "status_buckets": 0,
            "cancelOnUnload": true,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "runWhenTimeIsUndefined": false
        }, {tokens: true, tokenNamespace: "submitted"});

        var searchLineBreakingProcessorEvent = new SearchManager({
            "id": "searchLineBreakingProcessorEvent",
            "earliest_time": "$inputLinkParsingIssuesTime.earliest$",
            "latest_time": "$inputLinkParsingIssuesTime.latest$",
            "sample_ratio": null,
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=LineBreakingProcessor | head 100",
            "status_buckets": 300,
            "cancelOnUnload": true,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "runWhenTimeIsUndefined": false
        }, {tokens: true, tokenNamespace: "submitted"});

        var searchAggregatorMiningProcessorEvent = new SearchManager({
            "id": "searchAggregatorMiningProcessorEvent",
            "earliest_time": "$inputLinkParsingIssuesTime.earliest$",
            "latest_time": "$inputLinkParsingIssuesTime.latest$",
            "sample_ratio": null,
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=aggregatorMiningProcessor | head 100",
            "status_buckets": 300,
            "cancelOnUnload": true,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "runWhenTimeIsUndefined": false
        }, {tokens: true, tokenNamespace: "submitted"});

        var searchDateParserVerboseEvent = new SearchManager({
            "id": "searchDateParserVerboseEvent",
            "earliest_time": "$inputLinkParsingIssuesTime.earliest$",
            "latest_time": "$inputLinkParsingIssuesTime.latest$",
            "sample_ratio": null,
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=DateParserVerbose | head 100",
            "status_buckets": 300,
            "cancelOnUnload": true,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "runWhenTimeIsUndefined": false
        }, {tokens: true, tokenNamespace: "submitted"});

        // Identity card

        var searchIdentityCardTable = new SearchManager({
            "id": "searchIdentityCardTable",
            "tokenDependencies": {
                "depends": "$tk_start_associate_identity_card$"
            },
            "sample_ratio": 1,
            "search": "| inputlookup trackme_sources_knowledge | eval keyid=_key | search object=*$FilterIdentityCardTable$* OR doc_link=*$FilterIdentityCardTable$ OR doc_note=*$FilterIdentityCardTable$* | table keyid, object, doc_link, doc_note",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Logical group

        var searchLogicalGroupTable = new SearchManager({
            "id": "searchLogicalGroupTable",
            "tokenDependencies": {
                "depends": "$tk_start_logical_member_get$"
            },
            "sample_ratio": 1,
            "search": "| inputlookup trackme_logical_group | eval keyid=_key | search object_group_members=\"$input_object$\" | eval object_group_mtime=strftime(object_group_mtime, \"%c\") | table keyid, object_group_name, object_group_members, object_group_min_green_percent, object_group_mtime",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchLogicalGroupTable",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "set",
                        "token": "show_add_logical_group",
                        "value": "True"
                    },
                    {
                        "type": "unset",
                        "token": "show_table_logical_group"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_logical_group",
                        "value": "True"
                    },
                    {
                        "type": "unset",
                        "token": "show_add_logical_group"
                    }
                    ]
                }
            ]
        });

        // Logical group add member

        var searchLogicalGroupTableAddMember = new SearchManager({
            "id": "searchLogicalGroupTableAddMember",
            "tokenDependencies": {
                "depends": "$tk_start_logical_member_add$"
            },
            "sample_ratio": 1,
            "search": "| inputlookup trackme_logical_group | eval keyid=_key | search object_group_name=*$FilterLogicalGroupTable$* OR object_group_members=*$FilterLogicalGroupTable$* | eval object_group_mtime=strftime(object_group_mtime, \"%c\") | table keyid, object_group_name, object_group_members, object_group_min_green_percent, object_group_mtime",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Ack

        var searchAckGet = new SearchManager({
            "id": "searchAckGet",
            "tokenDependencies": {
                "depends": "$tk_start_ack_get$"
            },
            "sample_ratio": 1,
            "search": "| `trackme_ack_get(\"$input_object$\", \"$input_object_category$\")` | `trackme_ack_join_comment(\"$input_object$\", \"$input_object_category$\")`",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAckDuration = new SearchManager({
            "id": "searchAckDuration",
            "tokenDependencies": {
                "depends": "$tk_start_ack_get$"
            },
            "earliest_time": "-5m",
            "latest_time": "now",
            "sample_ratio": null,
            "search": "| `trackme_ack_populate_dropdown`",
            "status_buckets": 0,
            "cancelOnUnload": true,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {tokens: true});

        // whitelist

        // whitelist data_source
        // input link selection for modal window
        var inputLinkTimeWhiteListDataSource = new LinkListInput({
            "id": "inputLinkTimeWhiteListDataSource",
            "choices": [{
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.LinkTimeWhiteListDataSource$",
            "el": $('#inputLinkTimeWhiteListDataSource')
        }, {
            tokens: true
        }).render();

        inputLinkTimeWhiteListDataSource.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkTimeWhiteListDataSource.on("valueChange", function(e) {
            if (e.value === "24h") {
                EventHandler.setToken("modalTimeWhiteListDataSource.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataSource.latest", "now", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTimeWhiteListDataSource.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataSource.latest", "now", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTimeWhiteListDataSource.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataSource.latest", "now", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTimeWhiteListDataSource.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataSource.latest", "now", {}, e.data);
            }
        });

        // whitelist data_host
        // input link selection for modal window
        var inputLinkTimeWhiteListDataHost = new LinkListInput({
            "id": "inputLinkTimeWhiteListDataHost",
            "choices": [
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.LinkTimeWhiteListDataHost$",
            "el": $('#inputLinkTimeWhiteListDataHost')
        }, {
            tokens: true
        }).render();

        inputLinkTimeWhiteListDataHost.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkTimeWhiteListDataHost.on("valueChange", function(e) {
            if (e.value === "24h") {
                EventHandler.setToken("modalTimeWhiteListDataHost.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataHost.latest", "now", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTimeWhiteListDataHost.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataHost.latest", "now", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTimeWhiteListDataHost.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataHost.latest", "now", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTimeWhiteListDataHost.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataHost.latest", "now", {}, e.data);
            }
        });

        // whitelist metric_host
        // input link selection for modal window
        var inputLinkTimeWhiteListMetricHost = new LinkListInput({
            "id": "inputLinkTimeWhiteListMetricHost",
            "choices": [
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.LinkTimeWhiteListMetricHost$",
            "el": $('#inputLinkTimeWhiteListMetricHost')
        }, {
            tokens: true
        }).render();

        inputLinkTimeWhiteListMetricHost.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkTimeWhiteListMetricHost.on("valueChange", function(e) {
            if (e.value === "24h") {
                EventHandler.setToken("modalTimeWhiteListMetricHost.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListMetricHost.latest", "now", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTimeWhiteListMetricHost.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListMetricHost.latest", "now", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTimeWhiteListMetricHost.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListMetricHost.latest", "now", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTimeWhiteListMetricHost.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListMetricHost.latest", "now", {}, e.data);
            }
        });

        // blacklist metric_host
        // input link selection for modal window
        var inputLinkTimeBlackListMetricHost = new LinkListInput({
            "id": "inputLinkTimeBlackListMetricHost",
            "choices": [
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.LinkTimeBlackListMetricHost$",
            "el": $('#inputLinkTimeBlackListMetricHost')
        }, {
            tokens: true
        }).render();

        inputLinkTimeBlackListMetricHost.on("change", function(newValue) {
            FormUtils.handleValueChange(inputLinkTimeBlackListMetricHost);
        });

        inputLinkTimeBlackListMetricHost.on("valueChange", function(e) {
            if (e.value === "24h") {
                EventHandler.setToken("modalTimeBlackListMetricHost.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTimeBlackListMetricHost.latest", "now", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTimeBlackListMetricHost.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTimeBlackListMetricHost.latest", "now", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTimeBlackListMetricHost.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTimeBlackListMetricHost.latest", "now", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTimeBlackListMetricHost.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTimeBlackListMetricHost.latest", "now", {}, e.data);
            }
        });

        // data source monitoring

        // data host outlier configuration
        var inputDataSourceOverviewChartSeries = new DropdownInput({
            "id": "inputDataSourceOverviewChartSeries",
            "choices": [
                {"label": "events / lag", "value": "events_count, avg_lag_sec"},
                {"label": "events / host dcount", "value": "events_count, dcount_host"}
            ],
            "default": "events_count, avg_lag_sec",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "showClearButton": true,
            "initialValue": "events_count, avg_lag_sec",
            "value": "$form.tk_input_data_source_overview_chart_series$",
            "el": $('#inputDataSourceOverviewChartSeries')
        }, {tokens: true}).render();

        inputDataSourceOverviewChartSeries.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourceOverviewChartSeries);
        });

        inputDataSourceOverviewChartSeries.on("valueChange", function(e) {
            if (e.value === "events_count, avg_lag_sec") {
                EventHandler.setToken("data_source_overview_chart1_axis", "lagging (sec)", {}, e.data);
                EventHandler.setToken("data_source_overview_chart1_axisUnit", "0.1", {}, e.data);
            } else if (e.value === "events_count, dcount_host") {
                EventHandler.setToken("data_source_overview_chart1_axis", "hosts distinct count", {}, e.data);
                EventHandler.setToken("data_source_overview_chart1_axisUnit", "1", {}, e.data);
            }
        });

        var inputDataSourceOverviewMetricsChartSeries = new DropdownInput({
            "id": "inputDataSourceOverviewMetricsChartSeries",
            "choices": [
                {"label": "events / lag", "value": "eventcount_4h, lag_event_sec, lag_ingestion_sec"},
                {"label": "events / host dcount", "value": "eventcount_4h, hostcount_4h"}
            ],
            "default": "eventcount_4h, lag_event_sec, lag_ingestion_sec",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "showClearButton": true,
            "initialValue": "eventcount_4h, lag_event_sec, lag_ingestion_sec",
            "value": "$form.tk_input_data_source_overview_metrics_chart_series$",
            "el": $('#inputDataSourceOverviewMetricsChartSeries')
        }, {tokens: true}).render();

        inputDataSourceOverviewMetricsChartSeries.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourceOverviewMetricsChartSeries);
        });

        inputDataSourceOverviewMetricsChartSeries.on("valueChange", function(e) {
            if (e.value === "eventcount_4h, lag_event_sec, lag_ingestion_sec") {
                EventHandler.setToken("data_source_overview_metrics_chart1_axis", "lagging (sec)", {}, e.data);
                EventHandler.setToken("data_source_overview_metrics_chart1_axisUnit", "0.1", {}, e.data);
            } else if (e.value === "eventcount_4h, hostcount_4h") {
                EventHandler.setToken("data_source_overview_metrics_chart1_axis", "hosts distinct count", {}, e.data);
                EventHandler.setToken("data_source_overview_metrics_chart1_axisUnit", "1", {}, e.data);
            }
        });

        // main data_source link input for modal window
        var inputLinkDataSource = new LinkListInput({
            "id": "inputLinkDataSource",
            "choices": [{
                    "value": "overview",
                    "label": "Overview data source"
                },
                {
                    "value": "outlier",
                    "label": "Outlier detection overview"
                },
                {
                    "value": "outlier_configuration",
                    "label": "Outlier detection configuration"
                },
                {
                    "value": "data_sampling",
                    "label": "Data sampling"
                },
                {
                    "value": "data_quality",
                    "label": "Data parsing quality"
                },
                {
                    "value": "lagging_metrics",
                    "label": "Lagging performances"
                },
                {
                    "value": "flipping_status",
                    "label": "Status flipping"
                },
                {
                    "value": "status_message",
                    "label": "Status message"
                },
                {
                    "value": "data_source_audit_changes",
                    "label": "Audit changes"
                }                
            ],
            "default": "overview",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "overview",
            "value": "$form.inputLinkDataSource$",
            "el": $('#inputLinkDataSource')
        }, {
            tokens: true
        }).render();

        inputLinkDataSource.on("change", function(newValue) {
            FormUtils.handleValueChange(inputLinkDataSource);
        });

        inputLinkDataSource.on("valueChange", function(e) {
            if (e.value === "overview") {
                EventHandler.setToken("show_data_source_overview", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_outlier");
                EventHandler.unsetToken("show_data_source_outlier_configuration");
                EventHandler.unsetToken("show_data_source_status_message");
                EventHandler.unsetToken("show_data_quality");
                EventHandler.unsetToken("show_flipping_status");
                EventHandler.unsetToken("show_data_source_audit_changes");
                EventHandler.unsetToken("show_data_source_lagging_metrics");
                EventHandler.unsetToken("show_data_sampling");
            } else if (e.value === "outlier") {
                EventHandler.setToken("show_data_source_outlier", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_overview");
                EventHandler.unsetToken("show_data_source_outlier_configuration");
                EventHandler.unsetToken("show_data_source_status_message");
                EventHandler.unsetToken("show_data_quality");
                EventHandler.unsetToken("show_flipping_status");
                EventHandler.unsetToken("show_data_source_audit_changes");
                EventHandler.unsetToken("show_data_source_lagging_metrics");
                EventHandler.unsetToken("show_data_sampling");
            } else if (e.value === "outlier_configuration") {
                EventHandler.setToken("show_data_source_outlier_configuration", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_overview");
                EventHandler.unsetToken("show_data_source_outlier");
                EventHandler.unsetToken("show_data_source_status_message");
                EventHandler.unsetToken("show_data_quality");
                EventHandler.unsetToken("show_flipping_status");
                EventHandler.unsetToken("show_data_source_audit_changes");
                EventHandler.unsetToken("show_data_source_lagging_metrics");
                EventHandler.unsetToken("show_data_sampling");
            } else if (e.value === "data_sampling") {
                EventHandler.setToken("show_data_sampling", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_overview");
                EventHandler.unsetToken("show_data_source_outlier");
                EventHandler.unsetToken("show_data_source_outlier_configuration");
                EventHandler.unsetToken("show_data_source_status_message");
                EventHandler.unsetToken("show_flipping_status");
                EventHandler.unsetToken("show_data_source_audit_changes");
                EventHandler.unsetToken("show_data_source_lagging_metrics");
                EventHandler.unsetToken("show_data_quality");
            } else if (e.value === "data_quality") {
                EventHandler.setToken("show_data_quality", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_overview");
                EventHandler.unsetToken("show_data_source_outlier");
                EventHandler.unsetToken("show_data_source_outlier_configuration");
                EventHandler.unsetToken("show_data_source_status_message");
                EventHandler.unsetToken("show_flipping_status");
                EventHandler.unsetToken("show_data_source_audit_changes");
                EventHandler.unsetToken("show_data_source_lagging_metrics");
                EventHandler.unsetToken("show_data_sampling");
            } else if (e.value === "lagging_metrics") {
                EventHandler.setToken("show_data_source_lagging_metrics", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_overview");
                EventHandler.unsetToken("show_data_source_outlier");
                EventHandler.unsetToken("show_data_source_outlier_configuration");
                EventHandler.unsetToken("show_data_source_status_message");
                EventHandler.unsetToken("show_flipping_status");
                EventHandler.unsetToken("show_data_source_audit_changes");
                EventHandler.unsetToken("show_data_quality");
                EventHandler.unsetToken("show_data_sampling");
            } else if (e.value === "flipping_status") {
                EventHandler.setToken("show_flipping_status", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_overview");
                EventHandler.unsetToken("show_data_source_outlier");
                EventHandler.unsetToken("show_data_source_outlier_configuration");
                EventHandler.unsetToken("show_data_source_status_message");
                EventHandler.unsetToken("show_data_quality");
                EventHandler.unsetToken("show_data_source_audit_changes");
                EventHandler.unsetToken("show_data_source_lagging_metrics");
                EventHandler.unsetToken("show_data_sampling");
            } else if (e.value === "status_message") {
                EventHandler.setToken("show_data_source_status_message", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_overview");
                EventHandler.unsetToken("show_data_source_outlier_configuration");
                EventHandler.unsetToken("show_data_source_outlier");
                EventHandler.unsetToken("show_data_quality");
                EventHandler.unsetToken("show_flipping_status");
                EventHandler.unsetToken("show_data_source_audit_changes");
                EventHandler.unsetToken("show_data_source_lagging_metrics");
                EventHandler.unsetToken("show_data_sampling");
            } else if (e.value === "data_source_audit_changes") {
                EventHandler.setToken("show_data_source_audit_changes", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_overview");
                EventHandler.unsetToken("show_data_source_outlier_configuration");
                EventHandler.unsetToken("show_data_source_outlier");
                EventHandler.unsetToken("show_data_quality");
                EventHandler.unsetToken("show_flipping_status");
                EventHandler.unsetToken("show_data_source_status_message");
                EventHandler.unsetToken("show_data_source_lagging_metrics");
                EventHandler.unsetToken("show_data_sampling");
            }            
        });

        // show alerts
        // main data_source link input for modal window
        var inputLinkAlerts = new LinkListInput({
            "id": "inputLinkAlerts",
            "choices": [{
                    "value": "activity",
                    "label": "Overview alert activity"
                },
                {
                    "value": "auto_ack",
                    "label": "Auto Ack actions"
                },
                {
                    "value": "smart_status",
                    "label": "Smart Status actions"
                },
                {
                    "value": "free_style",
                    "label": "Free style REST actions"
                }                
            ],
            "default": "activity",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "activity",
            "value": "$form.inputLinkAlerts$",
            "el": $('#inputLinkAlerts')
        }, {
            tokens: true
        }).render();

        inputLinkAlerts.on("change", function(newValue) {
            FormUtils.handleValueChange(inputLinkAlerts);
        });

        inputLinkAlerts.on("valueChange", function(e) {
            if (e.value === "activity") {
                EventHandler.setToken("show_alerts_activity", "true", {}, e.data);
                EventHandler.unsetToken("show_alerts_auto_ack");
                EventHandler.unsetToken("show_alerts_smart_status");
                EventHandler.unsetToken("show_alerts_free_style");
            } else if (e.value === "auto_ack") {
                EventHandler.setToken("show_alerts_auto_ack", "true", {}, e.data);
                EventHandler.unsetToken("show_alerts_activity");
                EventHandler.unsetToken("show_alerts_smart_status");
                EventHandler.unsetToken("show_alerts_free_style");
            } else if (e.value === "smart_status") {
                EventHandler.setToken("show_alerts_smart_status", "true", {}, e.data);
                EventHandler.unsetToken("show_alerts_activity");
                EventHandler.unsetToken("show_alerts_auto_ack");
                EventHandler.unsetToken("show_alerts_free_style");
            } else if (e.value === "free_style") {
                EventHandler.setToken("show_alerts_free_style", "true", {}, e.data);
                EventHandler.unsetToken("show_alerts_activity");
                EventHandler.unsetToken("show_alerts_auto_ack");
                EventHandler.unsetToken("show_alerts_smart_status");
            }            
        });

        // input link selection for modal window
        var inputLinkTime = new LinkListInput({
            "id": "inputLinkTime",
            "choices": [{
                    "value": "60m",
                    "label": "60m"
                },
                {
                    "value": "4h",
                    "label": "4h"
                },
                {
                    "value": "8h",
                    "label": "8h"
                },
                {
                    "value": "12h",
                    "label": "12h"
                },
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "48h",
                    "label": "48h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "15d",
                    "label": "15d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "60d",
                    "label": "60d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.modalActionTime$",
            "el": $('#inputLinkTime')
        }, {
            tokens: true
        }).render();

        inputLinkTime.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkTime.on("valueChange", function(e) {
            if (e.value === "60m") {
                EventHandler.setToken("modalTime.earliest", "-60m", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "1m", {}, e.data);
            } else if (e.value === "4h") {
                EventHandler.setToken("modalTime.earliest", "-4h", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "5m", {}, e.data);
            } else if (e.value === "8h") {
                EventHandler.setToken("modalTime.earliest", "-8h", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "5m", {}, e.data);
            } else if (e.value === "12h") {
                EventHandler.setToken("modalTime.earliest", "-12h", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "10m", {}, e.data);
            } else if (e.value === "24h") {
                EventHandler.setToken("modalTime.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "15m", {}, e.data);
            } else if (e.value === "48h") {
                EventHandler.setToken("modalTime.earliest", "-48h", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "30m", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTime.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "1h", {}, e.data);
            } else if (e.value === "15d") {
                EventHandler.setToken("modalTime.earliest", "-15d", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "2h", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTime.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "4h", {}, e.data);
            } else if (e.value === "60d") {
                EventHandler.setToken("modalTime.earliest", "-60d", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "8h", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTime.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "12h", {}, e.data);
            }
        });

        // show alerts
        // input link selection for modal window
        var inputLinktAlertsTimeRange = new LinkListInput({
            "id": "inputLinktAlertsTimeRange",
            "choices": [{
                    "value": "60m",
                    "label": "60m"
                },
                {
                    "value": "4h",
                    "label": "4h"
                },
                {
                    "value": "8h",
                    "label": "8h"
                },
                {
                    "value": "12h",
                    "label": "12h"
                },
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "48h",
                    "label": "48h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "15d",
                    "label": "15d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "60d",
                    "label": "60d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.showAlertsTime$",
            "el": $('#inputLinktAlertsTimeRange')
        }, {
            tokens: true
        }).render();

        inputLinktAlertsTimeRange.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinktAlertsTimeRange.on("valueChange", function(e) {
            if (e.value === "60m") {
                EventHandler.setToken("showAlertsTime.earliest", "-60m", {}, e.data);
                EventHandler.setToken("showAlertsTime.latest", "now", {}, e.data);
                EventHandler.setToken("showAlertsTime.span", "1m", {}, e.data);
            } else if (e.value === "4h") {
                EventHandler.setToken("showAlertsTime.earliest", "-4h", {}, e.data);
                EventHandler.setToken("showAlertsTime.latest", "now", {}, e.data);
                EventHandler.setToken("showAlertsTime.span", "5m", {}, e.data);
            } else if (e.value === "8h") {
                EventHandler.setToken("showAlertsTime.earliest", "-8h", {}, e.data);
                EventHandler.setToken("showAlertsTime.latest", "now", {}, e.data);
                EventHandler.setToken("showAlertsTime.span", "5m", {}, e.data);
            } else if (e.value === "12h") {
                EventHandler.setToken("showAlertsTime.earliest", "-12h", {}, e.data);
                EventHandler.setToken("showAlertsTime.latest", "now", {}, e.data);
                EventHandler.setToken("showAlertsTime.span", "10m", {}, e.data);
            } else if (e.value === "24h") {
                EventHandler.setToken("showAlertsTime.earliest", "-24h", {}, e.data);
                EventHandler.setToken("showAlertsTime.latest", "now", {}, e.data);
                EventHandler.setToken("showAlertsTime.span", "15m", {}, e.data);
            } else if (e.value === "48h") {
                EventHandler.setToken("showAlertsTime.earliest", "-48h", {}, e.data);
                EventHandler.setToken("showAlertsTime.latest", "now", {}, e.data);
                EventHandler.setToken("showAlertsTime.span", "30m", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("showAlertsTime.earliest", "-7d", {}, e.data);
                EventHandler.setToken("showAlertsTime.latest", "now", {}, e.data);
                EventHandler.setToken("showAlertsTime.span", "1h", {}, e.data);
            } else if (e.value === "15d") {
                EventHandler.setToken("showAlertsTime.earliest", "-15d", {}, e.data);
                EventHandler.setToken("showAlertsTime.latest", "now", {}, e.data);
                EventHandler.setToken("showAlertsTime.span", "2h", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("showAlertsTime.earliest", "-30d", {}, e.data);
                EventHandler.setToken("showAlertsTime.latest", "now", {}, e.data);
                EventHandler.setToken("showAlertsTime.span", "4h", {}, e.data);
            } else if (e.value === "60d") {
                EventHandler.setToken("showAlertsTime.earliest", "-60d", {}, e.data);
                EventHandler.setToken("showAlertsTime.latest", "now", {}, e.data);
                EventHandler.setToken("showAlertsTime.span", "8h", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("showAlertsTime.earliest", "-90d", {}, e.data);
                EventHandler.setToken("showAlertsTime.latest", "now", {}, e.data);
                EventHandler.setToken("showAlertsTime.span", "12h", {}, e.data);
            }
        });

        // outliers configuration data_source
        var LinkTimeOutlierConfigurationDataSource = new LinkListInput({
            "id": "LinkTimeOutlierConfigurationDataSource",
            "choices": [{
                    "value": "-24h",
                    "label": "24h"
                },
                {
                    "value": "-48h",
                    "label": "48h"
                },
                {
                    "value": "-7d",
                    "label": "7d"
                },
                {
                    "value": "-30d",
                    "label": "30d"
                }
            ],
            "default": "7d",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "7d",
            "value": "$form.TimeOutlierConfigurationDataSource$",
            "el": $('#LinkTimeOutlierConfigurationDataSource')
        }, {
            tokens: true
        }).render();

        LinkTimeOutlierConfigurationDataSource.on("change", function(newValue) {
            FormUtils.handleValueChange(LinkTimeOutlierConfigurationDataSource);
        });

        LinkTimeOutlierConfigurationDataSource.on("valueChange", function(e) {
			if (e.value === "-24h") {
                EventHandler.setToken("tk_input_data_source_outlier_period", "-24h", {}, e.data);
            } else if (e.value === "-48h") {
                EventHandler.setToken("tk_input_data_source_outlier_period", "-48h", {}, e.data);
            } else if (e.value === "-7d") {
                EventHandler.setToken("tk_input_data_source_outlier_period", "-7d", {}, e.data);
            } else if (e.value === "-30d") {
                EventHandler.setToken("tk_input_data_source_outlier_period", "-30d", {}, e.data);
            }
        });

        var LinkTimeOutlierConfigurationDataSourceSpan = new LinkListInput({
            "id": "LinkTimeOutlierConfigurationDataSourceSpan",
            "choices": [{
                    "value": "5m",
                    "label": "5m"
                },
                {
                    "value": "60m",
                    "label": "60m"
                },
                {
                    "value": "4h",
                    "label": "4h"
                },
                {
                    "value": "12h",
                    "label": "12h"
                },
                {
                    "value": "1d",
                    "label": "1d"
                }
            ],
            "default": "5m",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "5m",
            "value": "$form.TimeOutlierConfigurationDataSourceSpan$",
            "el": $('#LinkTimeOutlierConfigurationDataSourceSpan')
        }, {
            tokens: true
        }).render();

        LinkTimeOutlierConfigurationDataSourceSpan.on("change", function(newValue) {
            FormUtils.handleValueChange(LinkTimeOutlierConfigurationDataSourceSpan);
        });

        LinkTimeOutlierConfigurationDataSourceSpan.on("valueChange", function(e) {
			if (e.value === "5m") {
                EventHandler.setToken("tk_input_data_source_outlier_span", "5m", {}, e.data);
            } else if (e.value === "60m") {
                EventHandler.setToken("tk_input_data_source_outlier_span", "60m", {}, e.data);
            } else if (e.value === "4h") {
                EventHandler.setToken("tk_input_data_source_outlier_span", "4h", {}, e.data);
            } else if (e.value === "12h") {
                EventHandler.setToken("tk_input_data_source_outlier_span", "12h", {}, e.data);
            } else if (e.value === "1d") {
                EventHandler.setToken("tk_input_data_source_outlier_span", "1d", {}, e.data);
            }
        });

        // data host monitoring

        // main data_host link input for modal window
        var inputLinkDataHost = new LinkListInput({
            "id": "inputLinkDataHost",
            "choices": [{
                    "value": "overview",
                    "label": "Overview data host"
                },
                {
                    "value": "outlier",
                    "label": "Outlier detection overview"
                },
                {
                    "value": "outlier_configuration",
                    "label": "Outlier detection configuration"
                },
                {
                    "value": "data_quality",
                    "label": "Data parsing quality"
                },
                {
                    "value": "lagging_metrics",
                    "label": "Lagging performances"
                },
                {
                    "value": "flipping_status",
                    "label": "Status flipping"
                },
                {
                    "value": "status_message",
                    "label": "Status message"
                },
                {
                    "value": "audit_changes",
                    "label": "Audit changes"
                }
            ],
            "default": "overview",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "overview",
            "value": "$form.inputLinkDataHost$",
            "el": $('#inputLinkDataHost')
        }, {
            tokens: true
        }).render();

        inputLinkDataHost.on("change", function(newValue) {
            FormUtils.handleValueChange(inputLinkDataHost);
        });

        inputLinkDataHost.on("valueChange", function(e) {
            if (e.value === "overview") {
                EventHandler.setToken("show_data_host_overview", "true", {}, e.data);
                EventHandler.unsetToken("show_data_host_outlier");
                EventHandler.unsetToken("show_data_host_outlier_configuration");
                EventHandler.unsetToken("show_data_host_status_message");
                EventHandler.unsetToken("show_data_host_quality");
                EventHandler.unsetToken("show_data_host_flipping_status");
                EventHandler.unsetToken("show_data_host_audit_changes");
                EventHandler.unsetToken("show_data_host_lagging_metrics");
            } else if (e.value === "outlier") {
                EventHandler.setToken("show_data_host_outlier", "true", {}, e.data);
                EventHandler.unsetToken("show_data_host_overview");
                EventHandler.unsetToken("show_data_host_outlier_configuration");
                EventHandler.unsetToken("show_data_host_status_message");
                EventHandler.unsetToken("show_data_host_quality");
                EventHandler.unsetToken("show_data_host_flipping_status");
                EventHandler.unsetToken("show_data_host_audit_changes");
                EventHandler.unsetToken("show_data_host_lagging_metrics");
            } else if (e.value === "outlier_configuration") {
                EventHandler.setToken("show_data_host_outlier_configuration", "true", {}, e.data);
                EventHandler.unsetToken("show_data_host_overview");
                EventHandler.unsetToken("show_data_host_outlier");
                EventHandler.unsetToken("show_data_host_status_message");
                EventHandler.unsetToken("show_data_host_quality");
                EventHandler.unsetToken("show_data_host_flipping_status");
                EventHandler.unsetToken("show_data_host_audit_changes");
                EventHandler.unsetToken("show_data_host_lagging_metrics");
            } else if (e.value === "data_quality") {
                EventHandler.setToken("show_data_host_quality", "true", {}, e.data);
                EventHandler.unsetToken("show_data_host_overview");
                EventHandler.unsetToken("show_data_host_outlier");
                EventHandler.unsetToken("show_data_host_status_message");
                EventHandler.unsetToken("show_data_host_outlier_configuration");
                EventHandler.unsetToken("show_data_host_flipping_status");
                EventHandler.unsetToken("show_data_host_audit_changes");
                EventHandler.unsetToken("show_data_host_lagging_metrics");
            } else if (e.value === "lagging_metrics") {
                EventHandler.setToken("show_data_host_lagging_metrics", "true", {}, e.data);
                EventHandler.unsetToken("show_data_host_overview");
                EventHandler.unsetToken("show_data_host_outlier");
                EventHandler.unsetToken("show_data_host_status_message");
                EventHandler.unsetToken("show_data_host_outlier_configuration");
                EventHandler.unsetToken("show_data_host_flipping_status");
                EventHandler.unsetToken("show_data_host_audit_changes");
                EventHandler.unsetToken("show_data_host_quality");
            } else if (e.value === "flipping_status") {
                EventHandler.setToken("show_data_host_flipping_status", "true", {}, e.data);
                EventHandler.unsetToken("show_data_host_overview");
                EventHandler.unsetToken("show_data_host_outlier");
                EventHandler.unsetToken("show_data_host_status_message");
                EventHandler.unsetToken("show_data_host_outlier_configuration");
                EventHandler.unsetToken("show_data_host_quality");
                EventHandler.unsetToken("show_data_host_audit_changes");
                EventHandler.unsetToken("show_data_host_lagging_metrics");
            } else if (e.value === "status_message") {
                EventHandler.setToken("show_data_host_status_message", "true", {}, e.data);
                EventHandler.unsetToken("show_data_host_overview");
                EventHandler.unsetToken("show_data_host_outlier_configuration");
                EventHandler.unsetToken("show_data_host_outlier");
                EventHandler.unsetToken("show_data_host_quality");
                EventHandler.unsetToken("show_data_host_flipping_status");
                EventHandler.unsetToken("show_data_host_audit_changes");
                EventHandler.unsetToken("show_data_host_lagging_metrics");
            } else if (e.value === "audit_changes") {
                EventHandler.setToken("show_data_host_audit_changes", "true", {}, e.data);
                EventHandler.unsetToken("show_data_host_overview");
                EventHandler.unsetToken("show_data_host_outlier_configuration");
                EventHandler.unsetToken("show_data_host_outlier");
                EventHandler.unsetToken("show_data_host_quality");
                EventHandler.unsetToken("show_data_host_flipping_status");
                EventHandler.unsetToken("show_data_host_status_message");
                EventHandler.unsetToken("show_data_host_lagging_metrics");
            }
        });

        // outliers configuration data_host
        var LinkTimeOutlierConfigurationDataHost = new LinkListInput({
            "id": "LinkTimeOutlierConfigurationDataHost",
            "choices": [{
                    "value": "-24h",
                    "label": "24h"
                },
                {
                    "value": "-48h",
                    "label": "48h"
                },
                {
                    "value": "-7d",
                    "label": "7d"
                },
                {
                    "value": "-30d",
                    "label": "30d"
                }
            ],
            "default": "-7d",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "-7d",
            "value": "$form.TimeOutlierConfigurationDataHost$",
            "el": $('#LinkTimeOutlierConfigurationDataHost')
        }, {
            tokens: true
        }).render();

        LinkTimeOutlierConfigurationDataHost.on("change", function(newValue) {
            FormUtils.handleValueChange(LinkTimeOutlierConfigurationDataHost);
        });

        LinkTimeOutlierConfigurationDataHost.on("valueChange", function(e) {
			if (e.value === "-24h") {
                EventHandler.setToken("tk_input_data_host_outlier_period", "-24h", {}, e.data);
            } else if (e.value === "-48h") {
                EventHandler.setToken("tk_input_data_host_outlier_period", "-48h", {}, e.data);
            } else if (e.value === "-7d") {
                EventHandler.setToken("tk_input_data_host_outlier_period", "-7d", {}, e.data);
            } else if (e.value === "-30d") {
                EventHandler.setToken("tk_input_data_host_outlier_period", "-30d", {}, e.data);
            }
        });

        var LinkTimeOutlierConfigurationDataHostSpan = new LinkListInput({
            "id": "LinkTimeOutlierConfigurationDataHostSpan",
            "choices": [{
                    "value": "5m",
                    "label": "5m"
                },
                {
                    "value": "60m",
                    "label": "60m"
                },
                {
                    "value": "4h",
                    "label": "4h"
                },
                {
                    "value": "12h",
                    "label": "12h"
                },
                {
                    "value": "1d",
                    "label": "1d"
                }
            ],
            "default": "5m",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "5m",
            "value": "$form.TimeOutlierConfigurationDataHostSpan$",
            "el": $('#LinkTimeOutlierConfigurationDataHostSpan')
        }, {
            tokens: true
        }).render();

        LinkTimeOutlierConfigurationDataHostSpan.on("change", function(newValue) {
            FormUtils.handleValueChange(LinkTimeOutlierConfigurationDataHostSpan);
        });

        LinkTimeOutlierConfigurationDataHostSpan.on("valueChange", function(e) {
			if (e.value === "5m") {
                EventHandler.setToken("tk_input_data_host_outlier_span", "5m", {}, e.data);
            } else if (e.value === "60m") {
                EventHandler.setToken("tk_input_data_host_outlier_span", "60m", {}, e.data);
            } else if (e.value === "4h") {
                EventHandler.setToken("tk_input_data_host_outlier_span", "4h", {}, e.data);
            } else if (e.value === "12h") {
                EventHandler.setToken("tk_input_data_host_outlier_span", "12h", {}, e.data);
            } else if (e.value === "1d") {
                EventHandler.setToken("tk_input_data_host_outlier_span", "1d", {}, e.data);
            }
        });

        // data source outlier configuration
        var inputDataSourceConfigOutlierEnableOutlier = new DropdownInput({
            "id": "inputDataSourceConfigOutlierEnableOutlier",
            "choices": [
                {"label": "True", "value": "true"},
                {"label": "False", "value": "false"}
            ],
            "default": "true",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "showClearButton": true,
            "initialValue": "true",
            "value": "$form.tk_input_data_source_enable_outlier$",
            "el": $('#inputDataSourceConfigOutlierEnableOutlier')
        }, {tokens: true}).render();

        inputDataSourceConfigOutlierEnableOutlier.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourceConfigOutlierEnableOutlier);
        });

        var inputDataSourceConfigOutlierOutlierMinEventCountMode = new DropdownInput({
            "id": "inputDataSourceConfigOutlierOutlierMinEventCountMode",
            "choices": [
                {"label": "Dynamic", "value": "dynamic"},
                {"label": "Static", "value": "static"}
            ],
            "default": "dynamic",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "showClearButton": true,
            "initialValue": "dynamic",
            "value": "$form.tk_input_data_source_outlier_min_eventcount_mode$",
            "el": $('#inputDataSourceConfigOutlierOutlierMinEventCountMode')
        }, {tokens: true}).render();

        inputDataSourceConfigOutlierOutlierMinEventCountMode.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourceConfigOutlierOutlierMinEventCountMode);
        });

        var inputDataSourceConfigOutlierAlertOnUpper = new DropdownInput({
            "id": "inputDataSourceConfigOutlierAlertOnUpper",
            "choices": [
                {"label": "True", "value": "true"},
                {"label": "False", "value": "false"}
            ],
            "default": "false",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "showClearButton": true,
            "initialValue": "false",
            "value": "$form.tk_input_data_source_outlier_alert_on_upper$",
            "el": $('#inputDataSourceConfigOutlierAlertOnUpper')
        }, {tokens: true}).render();

        inputDataSourceConfigOutlierAlertOnUpper.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourceConfigOutlierAlertOnUpper);
        });

        inputDataSourceConfigOutlierOutlierMinEventCountMode.on("valueChange", function(e) {
            if (e.value === "dynamic") {
                EventHandler.setToken("form.tk_input_data_source_outlier_min_eventcount", "disabled", {}, e.data);
            } else if (e.value === "static") {
                EventHandler.unsetToken("form.tk_input_data_source_outlier_min_eventcount");
            }
        });

        var inputDataSourceConfigOutlierOutlierMinEventCount = new TextInput({
            "id": "inputDataSourceConfigOutlierOutlierMinEventCount",
            "tokenDependencies": {"depends": "$show_tk_input_data_source_outlier_min_eventcount$"},
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_outlier_min_eventcount$",
            "el": $('#inputDataSourceConfigOutlierOutlierMinEventCount')
        }, {tokens: true}).render();

        inputDataSourceConfigOutlierOutlierMinEventCount.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourceConfigOutlierOutlierMinEventCount);
        });

        var inputDataSourceConfigOutlierOutlierLowerThresholdMultiplier = new TextInput({
            "id": "inputDataSourceConfigOutlierOutlierLowerThresholdMultiplier",
            "default": "4",
            "searchWhenChanged": true,
            "initialValue": "4",
            "value": "$form.tk_input_data_source_outlier_lower_threshold_multiplier$",
            "el": $('#inputDataSourceConfigOutlierOutlierLowerThresholdMultiplier')
        }, {tokens: true}).render();

        inputDataSourceConfigOutlierOutlierLowerThresholdMultiplier.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourceConfigOutlierOutlierLowerThresholdMultiplier);
        });

        var inputDataSourceConfigOutlierOutlierUpperThresholdMultiplier = new TextInput({
            "id": "inputDataSourceConfigOutlierOutlierUpperThresholdMultiplier",
            "default": "4",
            "searchWhenChanged": true,
            "initialValue": "4",
            "value": "$form.tk_input_data_source_outlier_upper_threshold_multiplier$",
            "el": $('#inputDataSourceConfigOutlierOutlierUpperThresholdMultiplier')
        }, {tokens: true}).render();

        inputDataSourceConfigOutlierOutlierUpperThresholdMultiplier.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourceConfigOutlierOutlierUpperThresholdMultiplier);
        });

        // data host outlier configuration
        var inputDataHostConfigOutlierEnableOutlier = new DropdownInput({
            "id": "inputDataHostConfigOutlierEnableOutlier",
            "choices": [
                {"label": "True", "value": "true"},
                {"label": "False", "value": "false"}
            ],
            "default": "true",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "showClearButton": true,
            "initialValue": "true",
            "value": "$form.tk_input_data_host_enable_outlier$",
            "el": $('#inputDataHostConfigOutlierEnableOutlier')
        }, {tokens: true}).render();

        inputDataHostConfigOutlierEnableOutlier.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostConfigOutlierEnableOutlier);
        });

        var inputDataHostConfigOutlierAlertOnUpper = new DropdownInput({
            "id": "inputDataHostConfigOutlierAlertOnUpper",
            "choices": [
                {"label": "True", "value": "true"},
                {"label": "False", "value": "false"}
            ],
            "default": "false",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "showClearButton": true,
            "initialValue": "false",
            "value": "$form.tk_input_data_host_outlier_alert_on_upper$",
            "el": $('#inputDataHostConfigOutlierAlertOnUpper')
        }, {tokens: true}).render();

        inputDataHostConfigOutlierAlertOnUpper.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostConfigOutlierAlertOnUpper);
        });

        var inputDataHostConfigOutlierOutlierMinEventCountMode = new DropdownInput({
            "id": "inputDataHostConfigOutlierOutlierMinEventCountMode",
            "choices": [
                {"label": "Dynamic", "value": "dynamic"},
                {"label": "Static", "value": "static"}
            ],
            "default": "dynamic",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "showClearButton": true,
            "initialValue": "dynamic",
            "value": "$form.tk_input_data_host_outlier_min_eventcount_mode$",
            "el": $('#inputDataHostConfigOutlierOutlierMinEventCountMode')
        }, {tokens: true}).render();

        inputDataHostConfigOutlierOutlierMinEventCountMode.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostConfigOutlierOutlierMinEventCountMode);
        });

        inputDataHostConfigOutlierOutlierMinEventCountMode.on("valueChange", function(e) {
            if (e.value === "dynamic") {
                EventHandler.setToken("form.tk_input_data_host_outlier_min_eventcount", "disabled", {}, e.data);
            } else if (e.value === "static") {
                EventHandler.unsetToken("form.tk_input_data_host_outlier_min_eventcount");
            }
        });

        var inputDataHostConfigOutlierOutlierMinEventCount = new TextInput({
            "id": "inputDataHostConfigOutlierOutlierMinEventCount",
            "tokenDependencies": {"depends": "$show_tk_input_data_host_outlier_min_eventcount$"},
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_outlier_min_eventcount$",
            "el": $('#inputDataHostConfigOutlierOutlierMinEventCount')
        }, {tokens: true}).render();

        inputDataHostConfigOutlierOutlierMinEventCount.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostConfigOutlierOutlierMinEventCount);
        });

        var inputDataHostConfigOutlierOutlierLowerThresholdMultiplier = new TextInput({
            "id": "inputDataHostConfigOutlierOutlierLowerThresholdMultiplier",
            "default": "4",
            "searchWhenChanged": true,
            "initialValue": "4",
            "value": "$form.tk_input_data_host_outlier_lower_threshold_multiplier$",
            "el": $('#inputDataHostConfigOutlierOutlierLowerThresholdMultiplier')
        }, {tokens: true}).render();

        inputDataHostConfigOutlierOutlierLowerThresholdMultiplier.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostConfigOutlierOutlierLowerThresholdMultiplier);
        });

        var inputDataHostConfigOutlierOutlierUpperThresholdMultiplier = new TextInput({
            "id": "inputDataHostConfigOutlierOutlierUpperThresholdMultiplier",
            "default": "4",
            "searchWhenChanged": true,
            "initialValue": "4",
            "value": "$form.tk_input_data_host_outlier_upper_threshold_multiplier$",
            "el": $('#inputDataHostConfigOutlierOutlierUpperThresholdMultiplier')
        }, {tokens: true}).render();

        inputDataHostConfigOutlierOutlierUpperThresholdMultiplier.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostConfigOutlierOutlierUpperThresholdMultiplier);
        });

        DashboardController.onReady(function() {
            if (!submittedTokenModel.has('earliest') && !submittedTokenModel.has('latest')) {
                submittedTokenModel.set({ earliest: '0', latest: '' });
            }
        });

        // input multiselect for queues
        var inputHostQueues = new MultiSelectInput({
            "id": "inputHostQueues",
            "tokenDependencies": {
                "depends": "$tk_start_indexers_queues_searches$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "host",
            "valuePrefix": "host=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "host",
            "value": "$form.inputHostQueues$",
            "managerid": "searchPopulateHostQueues",
            "el": $('#inputHostQueues')
        }, {
            tokens: true
        }).render();

        inputHostQueues.on("change", function(newValue) {
            FormUtils.handleValueChange(inputHostQueues);
        });

        var inputHostQueuesBreak = new DropdownInput({
            "id": "inputHostQueuesBreak",
            "choices": [
                {"label": "Queue", "value": "name"},
                {"label": "Queue, Ingest pipe", "value": "name . \":\" . ingest_pipe"},
                {"label": "Queue, Ingest pipe, host", "value": "host . \":\" . name . \":\" . ingest_pipe"}
            ],
            "default": "name",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "showClearButton": true,
            "initialValue": "name",
            "value": "$form.inputHostQueuesBreak$",
            "el": $('#inputHostQueuesBreak')
        }, {tokens: true}).render();

        inputHostQueuesBreak.on("change", function(newValue) {
            FormUtils.handleValueChange(inputHostQueuesBreak);
        });

        // input multiselect for parsing
        var inputHostParsing = new MultiSelectInput({
            "id": "inputHostParsing",
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "host",
            "valuePrefix": "host=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "host",
            "value": "$form.inputHostParsing$",
            "managerid": "searchPopulateHostParsing",
            "el": $('#inputHostParsing')
        }, {
            tokens: true
        }).render();

        inputHostParsing.on("change", function(newValue) {
            FormUtils.handleValueChange(inputHostParsing);
        });

        // input link selection for modal window
        var inputLinkTimeHost = new LinkListInput({
            "id": "inputLinkTimeHost",
            "choices": [{
                    "value": "60m",
                    "label": "60m"
                },
                {
                    "value": "4h",
                    "label": "4h"
                },
                {
                    "value": "8h",
                    "label": "8h"
                },
                {
                    "value": "12h",
                    "label": "12h"
                },
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "48h",
                    "label": "48h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "15d",
                    "label": "15d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "60d",
                    "label": "60d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.modalActionTimeHost$",
            "el": $('#inputLinkTimeHost')
        }, {
            tokens: true
        }).render();

        inputLinkTimeHost.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkTimeHost.on("valueChange", function(e) {
            if (e.value === "60m") {
                EventHandler.setToken("modalTimeHost.earliest", "-60m", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "1m", {}, e.data);
            } else if (e.value === "4h") {
                EventHandler.setToken("modalTimeHost.earliest", "-4h", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "5m", {}, e.data);
            } else if (e.value === "8h") {
                EventHandler.setToken("modalTimeHost.earliest", "-8h", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "5m", {}, e.data);
            } else if (e.value === "12h") {
                EventHandler.setToken("modalTimeHost.earliest", "-12h", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "10m", {}, e.data);
            } else if (e.value === "24h") {
                EventHandler.setToken("modalTimeHost.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "15m", {}, e.data);
            } else if (e.value === "48h") {
                EventHandler.setToken("modalTimeHost.earliest", "-48h", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "30m", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTimeHost.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "1h", {}, e.data);
            } else if (e.value === "15d") {
                EventHandler.setToken("modalTimeHost.earliest", "-15d", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "2h", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTimeHost.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "4h", {}, e.data);
            } else if (e.value === "60d") {
                EventHandler.setToken("modalTimeHost.earliest", "-60d", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "8h", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTimeHost.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "12h", {}, e.data);
            }
        });

        // input link selection for modal window
        var inputLinkTimeMetricHost = new LinkListInput({
            "id": "inputLinkTimeMetricHost",
            "choices": [{
                    "value": "60m",
                    "label": "60m"
                },
                {
                    "value": "4h",
                    "label": "4h"
                },
                {
                    "value": "8h",
                    "label": "8h"
                },
                {
                    "value": "12h",
                    "label": "12h"
                },
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "48h",
                    "label": "48h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "15d",
                    "label": "15d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "60d",
                    "label": "60d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.modalActionTimeMetricHost$",
            "el": $('#inputLinkTimeMetricHost')
        }, {
            tokens: true
        }).render();

        inputLinkTimeMetricHost.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkTimeMetricHost.on("valueChange", function(e) {
            if (e.value === "60m") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-60m", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "1m", {}, e.data);
            } else if (e.value === "4h") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-4h", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "5m", {}, e.data);
            } else if (e.value === "8h") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-8h", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "5m", {}, e.data);
            } else if (e.value === "12h") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-12h", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "10m", {}, e.data);
            } else if (e.value === "24h") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "15m", {}, e.data);
            } else if (e.value === "48h") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-48h", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "30m", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "1h", {}, e.data);
            } else if (e.value === "15d") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-15d", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "2h", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "4h", {}, e.data);
            } else if (e.value === "60d") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-60d", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "8h", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "12h", {}, e.data);
            }
        });

        // input link selection for modal window
        var inputLinkQueuesTime = new LinkListInput({
            "id": "inputLinkQueuesTime",
            "choices": [{
                    "value": "4h",
                    "label": "4h"
                },
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                }
            ],
            "default": "4h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "4h",
            "value": "$form.inputLinkQueuesTime$",
            "el": $('#inputLinkQueuesTime')
        }, {
            tokens: true
        }).render();

        inputLinkQueuesTime.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkQueuesTime.on("valueChange", function(e) {
            if (e.value === "4h") {
                EventHandler.setToken("inputLinkQueuesTime.earliest", "-4h", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.span", "5m", {}, e.data);
            } else if (e.value === "24h") {
                EventHandler.setToken("inputLinkQueuesTime.earliest", "-24h", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.span", "15m", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("inputLinkQueuesTime.earliest", "-7d", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.span", "30m", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("inputLinkQueuesTime.earliest", "-30d", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.span", "4h", {}, e.data);
            }
        });

        // input link selection for modal window
        var inputLinkParsingIssuesTime = new LinkListInput({
            "id": "inputLinkParsingIssuesTime",
            "choices": [{
                    "value": "4h",
                    "label": "4h"
                },
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                }
            ],
            "default": "4h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "4h",
            "value": "$form.inputLinkParsingIssuesTime$",
            "el": $('#inputLinkParsingIssuesTime')
        }, {
            tokens: true
        }).render();

        inputLinkParsingIssuesTime.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkParsingIssuesTime.on("valueChange", function(e) {
            if (e.value === "4h") {
                EventHandler.setToken("inputLinkParsingIssuesTime.earliest", "-4h", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.span", "5m", {}, e.data);
            } else if (e.value === "24h") {
                EventHandler.setToken("inputLinkParsingIssuesTime.earliest", "-24h", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.span", "15m", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("inputLinkParsingIssuesTime.earliest", "-7d", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.span", "30m", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("inputLinkParsingIssuesTime.earliest", "-30d", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.span", "4h", {}, e.data);
            }
        });

        // data source monitoring

        // input lag

        var modal_input_lag = new TextInput({
            "id": "modal_input_lag",
            "searchWhenChanged": true,
            "value": "$form.tk_input_lag$",
            "el": $('#modal_input_lag')
        }, {
            tokens: true
        }).render();

        modal_input_lag.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_lag);
        });

        var modal_input_lag_override_class = new DropdownInput({
            "id": "modal_input_lag_override_class",
            "choices": [{
                    "label": "true",
                    "value": "true"
                },
                {
                    "label": "false",
                    "value": "false"
                }
            ],
            "searchWhenChanged": true,
            "default": "true",
            "showClearButton": true,
            "initialValue": "true",
            "selectFirstChoice": false,
            "value": "$form.modal_input_lag_override_class$",
            "el": $('#modal_input_lag_override_class')
        }, {
            tokens: true
        }).render();

        modal_input_lag_override_class.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_lag_override_class);
        });

        var modal_input_lag_alert_over = new DropdownInput({
            "id": "modal_input_lag_alert_over",
            "choices": [{
                    "label": "lag event / lag ingestion",
                    "value": "all_kpis"
                },
                {
                    "label": "lag ingestion only",
                    "value": "lag_ingestion_kpi"
                },
                {
                    "label": "lag event only",
                    "value": "lag_event_kpi"
                }                
            ],
            "searchWhenChanged": true,
            "default": "all_kpis",
            "showClearButton": true,
            "initialValue": "true",
            "selectFirstChoice": false,
            "value": "$form.tk_input_data_lag_alert_kpis$",
            "el": $('#modal_input_lag_alert_over')
        }, {
            tokens: true
        }).render();

        modal_input_lag_alert_over.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_lag_alert_over);
        });

        var modal_input_lag_override_class_host = new DropdownInput({
            "id": "modal_input_lag_override_class_host",
            "choices": [{
                    "label": "true",
                    "value": "true"
                },
                {
                    "label": "false",
                    "value": "false"
                }
            ],
            "searchWhenChanged": true,
            "default": "true",
            "showClearButton": true,
            "initialValue": "true",
            "selectFirstChoice": false,
            "value": "$form.modal_input_lag_override_class_host$",
            "el": $('#modal_input_lag_override_class_host')
        }, {
            tokens: true
        }).render();

        modal_input_lag_override_class_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_lag_override_class_host);
        });

        // distinct count hosts
        var modal_input_dcount_host = new TextInput({
            "id": "modal_input_dcount_host",
            "searchWhenChanged": true,
            "default": "any",
            "initialValue": "any",            
            "value": "$form.tk_input_data_source_dcount_host$",
            "el": $('#modal_input_dcount_host')
        }, {
            tokens: true
        }).render();

        modal_input_dcount_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_dcount_host);
        });

        // ALERT summary

        var modal_input_custom_alert_name = new TextInput({
            "id": "modal_input_custom_alert_name",
            "searchWhenChanged": false,
            "value": "$form.tk_input_custom_alert_name$",
            "default": "TrackMe - Alert custom on $create_alert_object_type$",
            "el": $('#modal_input_custom_alert_name')
        }, {
            tokens: true
        }).render();

        modal_input_custom_alert_name.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_alert_name);
        });

        // input link selection for modal window
        var modal_input_custom_alert_object_type = new LinkListInput({
            "id": "modal_input_custom_alert_object_type",
            "choices": [{
                    "value": "data_source",
                    "label": "DATA SOURCES"
                },
                {
                    "value": "data_host",
                    "label": "DATA HOSTS"
                },
                {
                    "value": "metric_host",
                    "label": "METRIC HOSTS"
                }
            ],
            "default": "data_source",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "data_source",
            "value": "$form.inputCustomAlertObjectType$",
            "el": $('#modal_input_custom_alert_object_type')
        }, {
            tokens: true
        }).render();

        modal_input_custom_alert_object_type.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        modal_input_custom_alert_object_type.on("valueChange", function(e) {
            if (e.value === "data_source") {
                EventHandler.setToken("create_alert_object_type", "data_source", {}, e.data);
                EventHandler.setToken("create_alert_data_source", "true", {}, e.data);
                EventHandler.setToken("form.tk_input_custom_alert_suppress_fields", "object", {}, e.data);
                EventHandler.unsetToken("create_alert_data_host");
                EventHandler.unsetToken("create_alert_metric_host");
            } else if (e.value === "data_host") {
                EventHandler.setToken("create_alert_object_type", "data_host", {}, e.data);
                EventHandler.setToken("create_alert_data_host", "true", {}, e.data);
                EventHandler.setToken("form.tk_input_custom_alert_suppress_fields", "object", {}, e.data);
                EventHandler.unsetToken("create_alert_data_source");
                EventHandler.unsetToken("create_alert_metric_host");
            } else if (e.value === "metric_host") {
                EventHandler.setToken("create_alert_object_type", "metric_host", {}, e.data);
                EventHandler.setToken("create_alert_metric_host", "true", {}, e.data);
                EventHandler.setToken("form.tk_input_custom_alert_suppress_fields", "object", {}, e.data);
                EventHandler.unsetToken("create_alert_data_host");
                EventHandler.unsetToken("create_alert_data_source");
            }
        });

        var modal_input_custom_alert_data_source_filter = new TextInput({
            "id": "modal_input_custom_alert_data_source_filter",
            "searchWhenChanged": false,
            "value": "$form.tk_input_custom_alert_data_source_filter$",
            "default": "*",
            "el": $('#modal_input_custom_alert_data_source_filter')
        }, {
            tokens: true
        }).render();

        modal_input_custom_alert_data_source_filter.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_alert_data_source_filter);
        });

        var modal_input_custom_alert_data_host_filter = new TextInput({
            "id": "modal_input_custom_alert_data_host_filter",
            "searchWhenChanged": false,
            "value": "$form.tk_input_custom_alert_data_host_filter$",
            "default": "*",
            "el": $('#modal_input_custom_alert_data_host_filter')
        }, {
            tokens: true
        }).render();

        modal_input_custom_alert_data_host_filter.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_alert_data_host_filter);
        });

        var modal_input_custom_alert_metric_host_filter = new TextInput({
            "id": "modal_input_custom_alert_metric_host_filter",
            "searchWhenChanged": false,
            "value": "$form.tk_input_custom_alert_metric_host_filter$",
            "default": "*",
            "el": $('#modal_input_custom_alert_metric_host_filter')
        }, {
            tokens: true
        }).render();

        modal_input_custom_alert_metric_host_filter.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_alert_metric_host_filter);
        });

        var modal_input_custom_priority_levels = new MultiSelectInput({
            "id": "modal_input_custom_priority_levels",
            "choices": [
                {"label": "ANY", "value": "*"},
                {"label": "low", "value": "low"},
                {"label": "medium", "value": "medium"},
                {"label": "high", "value": "high"}
            ],
            "valuePrefix": "priority=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "searchWhenChanged": true,
            "initialValue": ["*"],
            "value": "$form.tk_input_custom_alert_priority$",
            "el": $('#modal_input_custom_priority_levels')
        }, {tokens: true}).render();

        modal_input_custom_priority_levels.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_priority_levels);
        });

        var modal_input_custom_state_levels = new MultiSelectInput({
            "id": "modal_input_custom_state_levels",
            "choices": [
                {"label": "red", "value": "red"},
                {"label": "orange", "value": "orange"},
                {"label": "Any (red/orange)", "value": "*"},
            ],
            "valuePrefix": "state=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "searchWhenChanged": true,
            "initialValue": ["red"],
            "value": "$form.tk_input_custom_alert_state$",
            "el": $('#modal_input_custom_state_levels')
        }, {tokens: true}).render();

        modal_input_custom_state_levels.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_state_levels);
        });

        var modal_input_custom_tags = new MultiSelectInput({
            "id": "modal_input_custom_tags",
            "choices": [
                {"label": "ANY", "value": "*"}
            ],
            "valuePrefix": "tags=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "labelField": "tags",
            "searchWhenChanged": true,
            "initialValue": ["*"],
            "selectFirstChoice": false,
            "valueField": "tags",            
            "value": "$form.tk_input_custom_tags$",
            "managerid": "search_alerts_get_tags",
            "el": $('#modal_input_custom_tags')
        }, {tokens: true}).render();

        modal_input_custom_tags.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_tags);
        });

        var modal_input_custom_alert_trigger_on_outliers = new DropdownInput({
            "id": "modal_input_custom_alert_trigger_on_outliers",
            "choices": [{
                    "label": "true",
                    "value": "true"
                },
                {
                    "label": "false",
                    "value": "false"
                }
            ],
            "searchWhenChanged": false,
            "default": "true",
            "showClearButton": true,
            "initialValue": "true",
            "selectFirstChoice": false,
            "value": "$form.tk_input_custom_alert_trigger_on_outliers$",
            "el": $('#modal_input_custom_alert_trigger_on_outliers')
        }, {
            tokens: true
        }).render();

        modal_input_custom_alert_trigger_on_outliers.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_alert_trigger_on_outliers);
        });

        var modal_input_custom_alert_trigger_on_outliers_data_host = new DropdownInput({
            "id": "modal_input_custom_alert_trigger_on_outliers_data_host",
            "choices": [{
                    "label": "true",
                    "value": "true"
                },
                {
                    "label": "false",
                    "value": "false"
                }
            ],
            "searchWhenChanged": false,
            "default": "true",
            "showClearButton": true,
            "initialValue": "true",
            "selectFirstChoice": false,
            "value": "$form.tk_input_custom_alert_trigger_on_outliers_data_host$",
            "el": $('#modal_input_custom_alert_trigger_on_outliers_data_host')
        }, {
            tokens: true
        }).render();

        modal_input_custom_alert_trigger_on_outliers_data_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_alert_trigger_on_outliers_data_host);
        });

        var modal_input_custom_alert_trigger_on_data_sampling = new DropdownInput({
            "id": "modal_input_custom_alert_trigger_on_data_sampling",
            "choices": [{
                    "label": "true",
                    "value": "true"
                },
                {
                    "label": "false",
                    "value": "false"
                }
            ],
            "searchWhenChanged": false,
            "default": "true",
            "showClearButton": true,
            "initialValue": "true",
            "selectFirstChoice": false,
            "value": "$form.tk_input_custom_alert_trigger_on_data_sampling$",
            "el": $('#modal_input_custom_alert_trigger_on_data_sampling')
        }, {
            tokens: true
        }).render();

        modal_input_custom_alert_trigger_on_data_sampling.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_alert_trigger_on_data_sampling);
        });

        var modal_input_custom_alert_cron = new TextInput({
            "id": "modal_input_custom_alert_cron",
            "searchWhenChanged": false,
            "value": "$form.tk_input_custom_alert_cron$",
            "default": "*/5 * * * *",
            "el": $('#modal_input_custom_alert_cron')
        }, {
            tokens: true
        }).render();

        modal_input_custom_alert_cron.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_alert_cron);
        });

        var modal_input_custom_alert_suppress_fields = new TextInput({
            "id": "modal_input_custom_alert_suppress_fields",
            "searchWhenChanged": false,
            "value": "$form.tk_input_custom_alert_suppress_fields$",
            "el": $('#modal_input_custom_alert_suppress_fields')
        }, {
            tokens: true
        }).render();

        modal_input_custom_alert_suppress_fields.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_alert_suppress_fields);
        });

        var modal_input_custom_alert_suppress_period = new TextInput({
            "id": "modal_input_custom_alert_suppress_period",
            "searchWhenChanged": false,
            "value": "$form.tk_input_custom_alert_suppress_period$",
            "default": "24h",
            "el": $('#modal_input_custom_alert_suppress_period')
        }, {
            tokens: true
        }).render();

        modal_input_custom_alert_suppress_period.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_alert_suppress_period);
        });

        var modal_input_custom_alert_time_filtering = new DropdownInput({
            "id": "modal_input_custom_alert_time_filtering",
            "choices": [{
                    "label": "Any time",
                    "value": "AnyTime"
                },
                {
                    "label": "Days business (08h-20h)",
                    "value": "Day_BusinessDays_8h-20h"
                },
                {
                    "label": "Days WE only (08h-20h)",
                    "value": "Day_WeekEnd_8h-20h"
                },
                {
                    "label": "Days of the Week (08h-20h)",
                    "value": "Day_AllDays_8h-20h"
                },
                {
                    "label": "Night business (20h-08h)",
                    "value": "Night_BusinessDays_20h-8h"
                },
                {
                    "label": "Night WE only (20h-08h)",
                    "value": "Night_WeekEnd_20h-8h"
                },
                {
                    "label": "Night days of the week (20h-08h)",
                    "value": "Night_AllDays_20h-8h"
                },
            ],
            "searchWhenChanged": false,
            "default": "AnyTime",
            "showClearButton": true,
            "initialValue": "AnyTime",
            "selectFirstChoice": false,
            "value": "$form.tk_input_custom_alert_time_filtering$",
            "el": $('#modal_input_custom_alert_time_filtering')
        }, {
            tokens: true
        }).render();

        modal_input_custom_alert_time_filtering.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_alert_time_filtering);
        });

        var modal_input_custom_alert_auto_ack = new DropdownInput({
            "id": "modal_input_custom_alert_auto_ack",
            "choices": [{
                    "label": "enabled",
                    "value": "1"
                },
                {
                    "label": "disabled",
                    "value": "0"
                }
            ],
            "searchWhenChanged": false,
            "default": "1",
            "showClearButton": true,
            "initialValue": "1",
            "selectFirstChoice": false,
            "value": "$form.tk_input_custom_alert_auto_ack$",
            "el": $('#modal_input_custom_alert_auto_ack')
        }, {
            tokens: true
        }).render();

        modal_input_custom_alert_auto_ack.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_alert_auto_ack);
        });

        var modal_input_custom_alert_smart_status = new DropdownInput({
            "id": "modal_input_custom_alert_smart_status",
            "choices": [{
                    "label": "enabled",
                    "value": "1"
                },
                {
                    "label": "disabled",
                    "value": "0"
                }
            ],
            "searchWhenChanged": false,
            "default": "1",
            "showClearButton": true,
            "initialValue": "1",
            "selectFirstChoice": false,
            "value": "$form.tk_input_custom_alert_smart_status$",
            "el": $('#modal_input_custom_alert_smart_status')
        }, {
            tokens: true
        }).render();

        modal_input_custom_alert_smart_status.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_alert_smart_status);
        });

        // elastic sources

        var modal_input_elastic_source_search_type = new DropdownInput({
            "id": "modal_input_elastic_source_search_type",
            "choices": [{
                    "label": "tstats",
                    "value": "tstats"
                },
                {
                    "label": "raw",
                    "value": "raw"
                },
                {
                    "label": "from",
                    "value": "from"
                },
                {
                    "label": "mstats",
                    "value": "mstats"
                },
                {
                    "label": "rest (tstats)",
                    "value": "rest_tstats"
                },
                {
                    "label": "rest (raw)",
                    "value": "rest_raw"
                },
                {
                    "label": "rest (from)",
                    "value": "rest_from"
                },
                {
                    "label": "rest (mstats)",
                    "value": "rest_mstats"
                },
            ],
            "searchWhenChanged": false,
            "default": "tstats",
            "showClearButton": true,
            "initialValue": "tstats",
            "selectFirstChoice": false,
            "value": "$form.tk_input_elastic_source_search_type$",
            "el": $('#modal_input_elastic_source_search_type')
        }, {
            tokens: true
        }).render();

        modal_input_elastic_source_search_type.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_elastic_source_search_type);
        });

        var modal_input_elastic_source_data_name = new TextInput({
            "id": "modal_input_elastic_source_data_name",
            "searchWhenChanged": false,
            "value": "$form.tk_input_elastic_source_data_name$",
            "el": $('#modal_input_elastic_source_data_name')
        }, {
            tokens: true
        }).render();

        modal_input_elastic_source_data_name.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_elastic_source_data_name);
        });

        var modal_input_elastic_source_elastic_data_index = new TextInput({
            "id": "modal_input_elastic_source_elastic_data_index",
            "searchWhenChanged": false,
            "default": "none",
            "initialValue": "none",
            "value": "$form.tk_input_elastic_source_elastic_data_index$",
            "el": $('#modal_input_elastic_source_elastic_data_index')
        }, {
            tokens: true
        }).render();

        modal_input_elastic_source_elastic_data_index.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_elastic_source_elastic_data_index);
        });

        var modal_input_elastic_source_elastic_data_sourcetype = new TextInput({
            "id": "modal_input_elastic_source_elastic_data_sourcetype",
            "searchWhenChanged": false,
            "default": "none",
            "initialValue": "none",
            "value": "$form.tk_input_elastic_source_elastic_data_sourcetype$",
            "el": $('#modal_input_elastic_source_elastic_data_sourcetype')
        }, {
            tokens: true
        }).render();

        modal_input_elastic_source_elastic_data_sourcetype.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_elastic_source_elastic_data_sourcetype);
        });

        var modal_input_elastic_source_earliest = new TextInput({
            "id": "modal_input_elastic_source_earliest",
            "searchWhenChanged": false,
            "default": "-4h",
            "initialValue": "-4h",
            "value": "$form.tk_input_elastic_source_earliest$",
            "el": $('#modal_input_elastic_source_earliest')
        }, {
            tokens: true
        }).render();

        modal_input_elastic_source_earliest.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_elastic_source_earliest);
        });

        var modal_input_elastic_source_latest = new TextInput({
            "id": "modal_input_elastic_source_latest",
            "searchWhenChanged": false,
            "default": "+4h",
            "initialValue": "+4h",
            "value": "$form.tk_input_elastic_source_latest$",
            "el": $('#modal_input_elastic_source_latest')
        }, {
            tokens: true
        }).render();

        modal_input_elastic_source_latest.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_elastic_source_latest);
        });

        // Data sampling
        var modal_input_data_sampling_custom_rule_name = new TextInput({
            "id": "modal_input_data_sampling_custom_rule_name",
            "searchWhenChanged": false,
            "value": "$form.tk_data_sampling_custom_rule_name$",
            "el": $('#modal_input_data_sampling_custom_rule_name')
        }, {
            tokens: true
        }).render();

        modal_input_data_sampling_custom_rule_name.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_sampling_custom_rule_name);
        });

        var modal_input_data_sampling_custom_rule_type = new DropdownInput({
            "id": "modal_input_data_sampling_custom_rule_type",
            "choices": [{
                    "label": "rule must match",
                    "value": "inclusive"
                },
                {
                    "label": "rule must not match",
                    "value": "exclusive"
                }
            ],
            "searchWhenChanged": true,
            "default": "inclusive",
            "showClearButton": true,
            "initialValue": "inclusive",
            "selectFirstChoice": false,
            "value": "$form.tk_data_sampling_custom_rule_type$",
            "el": $('#modal_input_data_sampling_custom_rule_type')
        }, {
            tokens: true
        }).render();

        modal_input_data_sampling_custom_rule_type.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_sampling_custom_rule_type);
        });

        // Data sampling sourcetype value
        var modal_input_data_sampling_custom_st_value = new TextInput({
            "id": "modal_input_data_sampling_custom_st_value",
            "searchWhenChanged": false,
            "default": "simulation:test_sourcetype",
            "initialValue": "simulation:test_sourcetype",
            "value": "$form.tk_data_sampling_custom_st_value$",
            "el": $('#modal_input_data_sampling_custom_st_value')
        }, {
            tokens: true
        }).render();

        modal_input_data_sampling_custom_st_value.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_sampling_custom_st_value);
        });

        // Data sampling scope
        var modal_input_data_sampling_custom_sourcetype_scope = new TextInput({
            "id": "modal_input_data_sampling_custom_sourcetype_scope",
            "searchWhenChanged": false,
            "initialValue": "*",
            "default": "*",
            "value": "$form.tk_data_sampling_custom_sourcetype_scope$",
            "el": $('#modal_input_data_sampling_custom_sourcetype_scope')
        }, {
            tokens: true
        }).render();

        modal_input_data_sampling_custom_sourcetype_scope.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_sampling_custom_sourcetype_scope);
        });

        // Data sampling number of records per sample
        var modal_input_data_sampling_records_nr = new TextInput({
            "id": "modal_input_data_sampling_records_nr",
            "searchWhenChanged": true,
            "default": "50",
            "initialValue": "50",            
            "value": "$form.tk_input_data_sampling_records_nr$",
            "el": $('#modal_input_data_sampling_records_nr')
        }, {
            tokens: true
        }).render();

        modal_input_data_sampling_records_nr.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_sampling_records_nr);
        });

        // Custom lagging

        var modal_input_custom_lagging_type = new DropdownInput({
            "id": "modal_input_custom_lagging_type",
            "choices": [{
                    "label": "sourcetype",
                    "value": "sourcetype"
                },
                {
                    "label": "index",
                    "value": "index"
                },
                {
                    "label": "priority",
                    "value": "priority"
                }                
            ],
            "searchWhenChanged": true,
            "default": "sourcetype",
            "showClearButton": true,
            "initialValue": "sourcetype",
            "selectFirstChoice": false,
            "value": "$form.tk_input_custom_lagging_type$",
            "el": $('#modal_input_custom_lagging_type')
        }, {
            tokens: true
        }).render();

        modal_input_custom_lagging_type.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_lagging_type);
        });       

        var modal_input_custom_lagging_name = new TextInput({
            "id": "modal_input_custom_lagging_name",
            "searchWhenChanged": true,
            "value": "$form.tk_input_custom_lagging_name$",
            "el": $('#modal_input_custom_lagging_name')
        }, {
            tokens: true
        }).render();

        modal_input_custom_lagging_name.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_lagging_name);
        });

        var modal_input_custom_lagging_value = new TextInput({
            "id": "modal_input_custom_lagging_value",
            "searchWhenChanged": true,
            "value": "$form.tk_input_custom_lagging_value$",
            "el": $('#modal_input_custom_lagging_value')
        }, {
            tokens: true
        }).render();

        modal_input_custom_lagging_value.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_lagging_value);
        });

        var modal_input_custom_lagging_object = new DropdownInput({
            "id": "modal_input_custom_lagging_object",
            "choices": [{
                    "label": "data_source",
                    "value": "data_source"
                },
                {
                    "label": "data_host",
                    "value": "data_host"
                },
                {
                    "label": "all",
                    "value": "all"
                }                
            ],
            "searchWhenChanged": true,
            "default": "all",
            "showClearButton": true,
            "initialValue": "all",
            "selectFirstChoice": false,
            "value": "$form.tk_input_custom_lagging_object$",
            "el": $('#modal_input_custom_lagging_object')
        }, {
            tokens: true
        }).render();

        modal_input_custom_lagging_object.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_lagging_object);
        });

        // data host monitoring

        // input lag

        var modal_input_lag_host = new TextInput({
            "id": "modal_input_lag_host",
            "searchWhenChanged": true,
            "value": "$form.tk_input_lag_host$",
            "el": $('#modal_input_lag_host')
        }, {
            tokens: true
        }).render();

        modal_input_lag_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_lag_host);
        });

        var modal_input_lag_alert_over_host = new DropdownInput({
            "id": "modal_input_lag_alert_over_host",
            "choices": [{
                    "label": "lag event / lag ingestion",
                    "value": "all_kpis"
                },
                {
                    "label": "lag ingestion only",
                    "value": "lag_ingestion_kpi"
                },
                {
                    "label": "lag event only",
                    "value": "lag_event_kpi"
                }                
            ],
            "searchWhenChanged": true,
            "default": "all_kpis",
            "showClearButton": true,
            "initialValue": "all_kpis",
            "selectFirstChoice": false,
            "value": "$form.tk_input_data_lag_alert_kpis_host$",
            "el": $('#modal_input_lag_alert_over_host')
        }, {
            tokens: true
        }).render();

        modal_input_lag_alert_over_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_lag_alert_over_host);
        });

        var modal_input_host_alerting_policy = new DropdownInput({
            "id": "modal_input_host_alerting_policy",
            "choices": [{
                    "label": "global policy",
                    "value": "global_policy"
                },
                {
                    "label": "red if at least one sourcetype is red",
                    "value": "track_per_sourcetype"
                },
                {
                    "label": "red only if all sourcetypes are red",
                    "value": "track_per_host"
                }                
            ],
            "searchWhenChanged": true,
            "default": "global_policy",
            "showClearButton": true,
            "initialValue": "global_policy",
            "selectFirstChoice": false,
            "value": "$form.tk_input_host_alerting_policy$",
            "el": $('#modal_input_host_alerting_policy')
        }, {
            tokens: true
        }).render();

        modal_input_host_alerting_policy.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_host_alerting_policy);
        });

        // metric host priority

        var modal_input_metric_host_priority = new DropdownInput({
            "id": "modal_input_metric_host_priority",
            "choices": [{
                    "label": "low",
                    "value": "low"
                },
                {
                    "label": "medium",
                    "value": "medium"
                },
                {
                    "label": "high",
                    "value": "high"
                }
            ],
            "searchWhenChanged": true,
            "default": "medium",
            "showClearButton": true,
            "initialValue": "medium",
            "selectFirstChoice": false,
            "value": "$form.tk_input_metric_host_priority$",
            "el": $('#modal_input_metric_host_priority')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_priority.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_priority);
        });

        // data host priority

        var modal_input_host_priority = new DropdownInput({
            "id": "modal_input_host_priority",
            "choices": [{
                    "label": "low",
                    "value": "low"
                },
                {
                    "label": "medium",
                    "value": "medium"
                },
                {
                    "label": "high",
                    "value": "high"
                }
            ],
            "searchWhenChanged": true,
            "default": "medium",
            "showClearButton": true,
            "initialValue": "medium",
            "selectFirstChoice": false,
            "value": "$form.tk_input_host_priority$",
            "el": $('#modal_input_host_priority')
        }, {
            tokens: true
        }).render();

        modal_input_host_priority.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_host_priority);
        });

        var modal_input_level = new DropdownInput({
            "id": "modal_input_level",
            "choices": [{
                    "label": "sourcetype",
                    "value": "sourcetype"
                },
                {
                    "label": "index",
                    "value": "index"
                }
            ],
            "searchWhenChanged": true,
            "default": "sourcetype",
            "showClearButton": true,
            "initialValue": "sourcetype",
            "selectFirstChoice": false,
            "value": "$form.tk_input_level$",
            "el": $('#modal_input_level')
        }, {
            tokens: true
        }).render();

        modal_input_level.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_level);
        });

        // data source priority

        var modal_input_priority = new DropdownInput({
            "id": "modal_input_priority",
            "choices": [{
                    "label": "low",
                    "value": "low"
                },
                {
                    "label": "medium",
                    "value": "medium"
                },
                {
                    "label": "high",
                    "value": "high"
                }
            ],
            "searchWhenChanged": true,
            "default": "medium",
            "showClearButton": true,
            "initialValue": "medium",
            "selectFirstChoice": false,
            "value": "$form.tk_input_priority$",
            "el": $('#modal_input_priority')
        }, {
            tokens: true
        }).render();

        modal_input_priority.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_priority);
        });

        // data source monitoring

        var modal_input_wdays = new DropdownInput({
            "id": "modal_input_wdays",
            "choices": [{
                    "label": "manual:all_days",
                    "value": "manual:all_days"
                },
                {
                    "label": "manual:monday-to-friday",
                    "value": "manual:monday-to-friday"
                },
                {
                    "label": "manual:monday-to-saturday",
                    "value": "manual:monday-to-saturday"
                }
            ],
            "searchWhenChanged": true,
            "default": "manual:all_days",
            "showClearButton": true,
            "initialValue": "all_days",
            "selectFirstChoice": false,
            "value": "$form.tk_input_wdays$",
            "el": $('#modal_input_wdays')
        }, {
            tokens: true
        }).render();

        modal_input_wdays.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_wdays);
        });

        modal_input_wdays.on("valueChange", function(e) {
            if (e.value === "manual:enter_days_numbers") {
                EventHandler.setToken("show_manual_wdays", "true", {}, e.data);
            } else {
                EventHandler.unsetToken("show_manual_wdays");
            }
        });

        var modal_input_wdays_no = new CheckboxGroupInput({
            "id": "modal_input_wdays_no",
            "choices": [{
                    "label": "Monday",
                    "value": "1"
                },
                {
                    "label": "Tuesday",
                    "value": "2"
                },
                {
                    "label": "Wednesday",
                    "value": "3"
                },
                {
                    "label": "Thursday",
                    "value": "4"
                },
                {
                    "label": "Friday",
                    "value": "5"
                },
                {
                    "label": "Saturday",
                    "value": "6"
                },
                {
                    "label": "Sunday",
                    "value": "0"
                }
            ],
            "prefix": "manual:",
            "searchWhenChanged": true,
            "default": ["1", "2", "3", "4", "5", "6", "0"],
            "delimiter": ",",
            "value": "$form.tk_input_wdays_no$",
            "el": $('#modal_input_wdays_no')
        }, {
            tokens: true
        }).render();

        modal_input_wdays_no.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_wdays_no);
        });

        // data host monitoring

        var modal_input_wdays_host = new DropdownInput({
            "id": "modal_input_wdays_host",
            "choices": [{
                    "label": "manual:all_days",
                    "value": "manual:all_days"
                },
                {
                    "label": "manual:monday-to-friday",
                    "value": "manual:monday-to-friday"
                },
                {
                    "label": "manual:monday-to-saturday",
                    "value": "manual:monday-to-saturday"
                }
            ],
            "searchWhenChanged": true,
            "default": "manual:all_days",
            "showClearButton": true,
            "initialValue": "all_days",
            "selectFirstChoice": false,
            "value": "$form.tk_input_wdays_host$",
            "el": $('#modal_input_wdays_host')
        }, {
            tokens: true
        }).render();

        modal_input_wdays_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_wdays_host);
        });

        modal_input_wdays_host.on("valueChange", function(e) {
            if (e.value === "manual:enter_days_numbers") {
                EventHandler.setToken("show_manual_wdays_host", "true", {}, e.data);
            } else {
                EventHandler.unsetToken("show_manual_wdays_host");
            }
        });

        var modal_input_wdays_host_no = new CheckboxGroupInput({
            "id": "modal_input_wdays_host_no",
            "choices": [{
                    "label": "Monday",
                    "value": "1"
                },
                {
                    "label": "Tuesday",
                    "value": "2"
                },
                {
                    "label": "Wednesday",
                    "value": "3"
                },
                {
                    "label": "Thursday",
                    "value": "4"
                },
                {
                    "label": "Friday",
                    "value": "5"
                },
                {
                    "label": "Saturday",
                    "value": "6"
                },
                {
                    "label": "Sunday",
                    "value": "0"
                }
            ],
            "prefix": "manual:",
            "searchWhenChanged": true,
            "default": ["1", "2", "3", "4", "5", "6", "0"],
            "delimiter": ",",
            "value": "$form.tk_input_wdays_host_no$",
            "el": $('#modal_input_wdays_host_no')
        }, {
            tokens: true
        }).render();

        modal_input_wdays_host_no.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_wdays_host_no);
        });

        // metric host monitoring

        // modal link input
        var inputLinkMetricHost = new LinkListInput({
            "id": "inputLinkMetricHost",
            "choices": [{
                    "value": "overview",
                    "label": "Overview metric host"
                },
                {
                    "value": "flipping_status",
                    "label": "Status flipping"
                },
                {
                    "value": "status_message",
                    "label": "Status message"
                },
                {
                    "value": "audit_changes",
                    "label": "Audit changes"
                }
            ],
            "default": "overview",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "overview",
            "value": "$form.inputLinkMetricHost$",
            "el": $('#inputLinkMetricHost')
        }, {
            tokens: true
        }).render();

        inputLinkMetricHost.on("change", function(newValue) {
            FormUtils.handleValueChange(inputLinkMetricHost);
        });

        inputLinkMetricHost.on("valueChange", function(e) {
            if (e.value === "overview") {
                EventHandler.setToken("show_metric_host_overview", "true", {}, e.data);
                EventHandler.unsetToken("show_metric_host_status_message");
                EventHandler.unsetToken("show_metric_host_flipping_status");
                EventHandler.unsetToken("show_metric_host_audit_changes");
            } else if (e.value === "flipping_status") {
                EventHandler.setToken("show_metric_host_flipping_status", "true", {}, e.data);
                EventHandler.unsetToken("show_metric_host_overview");
                EventHandler.unsetToken("show_metric_host_status_message");
                EventHandler.unsetToken("show_metric_host_audit_changes");
            } else if (e.value === "status_message") {
                EventHandler.setToken("show_metric_host_status_message", "true", {}, e.data);
                EventHandler.unsetToken("show_metric_host_overview");
                EventHandler.unsetToken("show_metric_host_flipping_status");
                EventHandler.unsetToken("show_metric_host_audit_changes");
            } else if (e.value === "audit_changes") {
                EventHandler.setToken("show_metric_host_audit_changes", "true", {}, e.data);
                EventHandler.unsetToken("show_metric_host_overview");
                EventHandler.unsetToken("show_metric_host_flipping_status");
                EventHandler.unsetToken("show_metric_host_status_message");
            }
        });

        // data sampling dropdown
        var modal_input_data_sampling_dropdown = new DropdownInput({
            "id": "modal_input_data_sampling_dropdown",
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "data_name",
            "selectFirstChoice": false,
            "valueField": "key",
            "value": "$form.tk_input_data_sampling_dropdown$",
            "managerid": "searchPopulateDataSampling",
            "el": $('#modal_input_data_sampling_dropdown')
        }, {
            tokens: true
        }).render();

        modal_input_data_sampling_dropdown.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_sampling_dropdown);
        });

        // ALERT SUMMARY

        var modal_input_alert_actions_ack = new DropdownInput({
            "id": "modal_input_alert_actions_ack",
            "choices": [{
                    "label": "ANY",
                    "value": "*"
                }
            ],            
            "tokenDependencies": {
                "depends": "$show_alerts_auto_ack$"
            },
            "searchWhenChanged": true,
            "default": "*",
            "prefix": "object=\"",
            "suffix": "\"",
            "showClearButton": true,
            "initialValue": "*",
            "labelField": "object",
            "selectFirstChoice": false,
            "valueField": "object",
            "value": "$form.tk_input_alert_actions_ack$",
            "managerid": "searchPopulateAlertActionsAck",
            "el": $('#modal_input_alert_actions_ack')
        }, {
            tokens: true
        }).render();

        modal_input_alert_actions_ack.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_alert_actions_ack);
        });

        var modal_input_alert_actions_smart_status = new DropdownInput({
            "id": "modal_input_alert_actions_smart_status",
            "choices": [{
                    "label": "ANY",
                    "value": "*"
                }
            ],            
            "tokenDependencies": {
                "depends": "$show_alerts_smart_status$"
            },
            "searchWhenChanged": true,
            "default": "*",
            "prefix": "object=\"",
            "suffix": "\"",
            "showClearButton": true,
            "initialValue": "*",
            "labelField": "object",
            "selectFirstChoice": false,
            "valueField": "object",
            "value": "$form.tk_input_alert_actions_smart_status$",
            "managerid": "searchPopulateAlertActionsSmartStatus",
            "el": $('#modal_input_alert_actions_smart_status')
        }, {
            tokens: true
        }).render();

        modal_input_alert_actions_smart_status.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_alert_actions_smart_status);
        });        

        var modal_input_alert_actions_free_style = new DropdownInput({
            "id": "modal_input_alert_actions_free_style",
            "choices": [{
                    "label": "ANY",
                    "value": "*"
                }
            ],            
            "tokenDependencies": {
                "depends": "$show_alerts_free_style$"
            },
            "searchWhenChanged": true,
            "default": "*",
            "prefix": "object=\"",
            "suffix": "\"",
            "showClearButton": true,
            "initialValue": "*",
            "labelField": "object",
            "selectFirstChoice": false,
            "valueField": "object",
            "value": "$form.tk_input_alert_actions_free_style$",
            "managerid": "searchPopulateAlertActionsFreeStyle",
            "el": $('#modal_input_alert_actions_free_style')
        }, {
            tokens: true
        }).render();

        modal_input_alert_actions_free_style.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_alert_actions_free_style);
        });

        // whitelist

        // whitelist data_source

        var modal_input_data_source_whitelist = new DropdownInput({
            "id": "modal_input_data_source_whitelist",
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "index",
            "selectFirstChoice": false,
            "valueField": "index",
            "value": "$form.tk_input_whitelist_data_source$",
            "managerid": "searchPopulateIndexesForWhiteListDataSource",
            "el": $('#modal_input_data_source_whitelist')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_whitelist.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_whitelist);
        });

        var modal_textinput_data_source_whitelist = new TextInput({
            "id": "modal_textinput_data_source_whitelist",
            "searchWhenChanged": true,
            "value": "$form.tk_textinput_whitelist_data_source$",
            "el": $('#modal_textinput_data_source_whitelist')
        }, {
            tokens: true
        }).render();

        modal_textinput_data_source_whitelist.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_textinput_data_source_whitelist);
        });

        var modal_input_data_source_whitelist_search = new TextInput({
            "id": "modal_input_data_source_whitelist_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_whitelist_search$",
            "el": $('#modal_input_data_source_whitelist_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_whitelist_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_whitelist_search);
        });

        // whitelist metric_host

        var modal_input_metric_host_whitelist = new DropdownInput({
            "id": "modal_input_metric_host_whitelist",
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "index",
            "selectFirstChoice": false,
            "valueField": "index",
            "value": "$form.tk_input_whitelist_metric_host$",
            "managerid": "searchPopulateIndexesForWhiteListMetricHost",
            "el": $('#modal_input_metric_host_whitelist')
        }, {
            tokens: true
        }).render();
        
        modal_input_metric_host_whitelist.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_whitelist);
        });

        var modal_textinput_metric_host_whitelist = new TextInput({
            "id": "modal_textinput_metric_host_whitelist",
            "searchWhenChanged": true,
            "value": "$form.tk_textinput_whitelist_metric_host$",
            "el": $('#modal_textinput_metric_host_whitelist')
        }, {
            tokens: true
        }).render();

        modal_textinput_metric_host_whitelist.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_textinput_metric_host_whitelist);
        });

        var modal_input_metric_host_whitelist_search = new TextInput({
            "id": "modal_input_metric_host_whitelist_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_metric_host_whitelist_search$",
            "el": $('#modal_input_metric_host_whitelist_search')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_whitelist_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_whitelist_search);
        });

        // whitelist data_host

        var modal_input_data_host_whitelist = new DropdownInput({
            "id": "modal_input_data_host_whitelist",
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "index",
            "selectFirstChoice": false,
            "valueField": "index",
            "value": "$form.tk_input_whitelist_data_host$",
            "managerid": "searchPopulateIndexesForWhiteListDataHost",
            "el": $('#modal_input_data_host_whitelist')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_whitelist.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_whitelist);
        });

        var modal_textinput_data_host_whitelist = new TextInput({
            "id": "modal_textinput_data_host_whitelist",
            "searchWhenChanged": true,
            "value": "$form.tk_textinput_whitelist_data_host$",
            "el": $('#modal_textinput_data_host_whitelist')
        }, {
            tokens: true
        }).render();

        modal_textinput_data_host_whitelist.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_textinput_data_host_whitelist);
        });

        var modal_input_data_host_whitelist_search = new TextInput({
            "id": "modal_input_data_host_whitelist_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_whitelist_search$",
            "el": $('#modal_input_data_host_whitelist_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_whitelist_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_whitelist_search);
        });

        // blacklist data source

        // blacklist host

        var modal_input_data_source_blacklist_host = new TextInput({
            "id": "modal_input_data_source_blacklist_host",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_blacklist_host$",
            "el": $('#modal_input_data_source_blacklist_host')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_host);
        });

        var modal_input_data_source_blacklist_host_search = new TextInput({
            "id": "modal_input_data_source_blacklist_host_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_blacklist_host_search$",
            "el": $('#modal_input_data_source_blacklist_host_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_host_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_host_search);
        });

        // blacklist index

        var modal_input_data_source_blacklist_index = new TextInput({
            "id": "modal_input_data_source_blacklist_index",
            "searchWhenChanged": true,
            "value": "$form.tk_input_blacklist_index$",
            "el": $('#modal_input_data_source_blacklist_index')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_index.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_index);
        });

        var modal_input_data_source_blacklist_index_search = new TextInput({
            "id": "modal_input_data_source_blacklist_index_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_blacklist_index_search$",
            "el": $('#modal_input_data_source_blacklist_index_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_index_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_index_search);
        });

        // Identify card
        var FilterIdentityCardTable = new TextInput({
            "id": "FilterIdentityCardTable",
            "searchWhenChanged": true,
            "default": "*",
            "value": "$form.FilterIdentityCardTable$",
            "el": $('#FilterIdentityCardTable')
        }, {
            tokens: true
        }).render();

        FilterIdentityCardTable.on("change", function(newValue) {
            FormUtils.handleValueChange(FilterIdentityCardTable);
        });

        // Logical group
        var FilterLogicalGroupTable = new TextInput({
            "id": "FilterLogicalGroupTable",
            "searchWhenChanged": true,
            "default": "*",
            "value": "$form.FilterLogicalGroupTable$",
            "el": $('#FilterLogicalGroupTable')
        }, {
            tokens: true
        }).render();

        FilterLogicalGroupTable.on("change", function(newValue) {
            FormUtils.handleValueChange(FilterLogicalGroupTable);
        });

        // Logical group add
        var InputLogicalGroupName = new TextInput({
            "id": "InputLogicalGroupName",
            "searchWhenChanged": true,
            "value": "$form.InputLogicalGroupName$",
            "el": $('#InputLogicalGroupName')
        }, {
            tokens: true
        }).render();

        InputLogicalGroupName.on("change", function(newValue) {
            FormUtils.handleValueChange(InputLogicalGroupName);
        });

        var InputLogicalGroupNamePercent = new DropdownInput({
            "id": "InputLogicalGroupNamePercent",
            "choices": [{
                    "label": "50%",
                    "value": "50"
                },
                {
                    "label": "33.33%",
                    "value": "33.33"
                },
                {
                    "label": "25%",
                    "value": "25"
                },
                {
                    "label": "12.5%",
                    "value": "12.5"
                }
            ],
            "searchWhenChanged": true,
            "default": "50",
            "showClearButton": true,
            "initialValue": "50",
            "selectFirstChoice": false,
            "value": "$form.InputLogicalGroupNamePercent$",
            "el": $('#InputLogicalGroupNamePercent')
        }, {
            tokens: true
        }).render();

        InputLogicalGroupNamePercent.on("change", function(newValue) {
            FormUtils.handleValueChange(InputLogicalGroupNamePercent);
        });

        // blacklist sourcetype

        var modal_input_data_source_blacklist_sourcetype = new TextInput({
            "id": "modal_input_data_source_blacklist_sourcetype",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_blacklist_sourcetype$",
            "el": $('#modal_input_data_source_blacklist_sourcetype')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_sourcetype.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_sourcetype);
        });

        var modal_input_data_source_blacklist_sourcetype_search = new TextInput({
            "id": "modal_input_data_source_blacklist_sourcetype_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_blacklist_sourcetype_search$",
            "el": $('#modal_input_data_source_blacklist_sourcetype_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_sourcetype_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_sourcetype_search);
        });


        // blacklist data_name

        var modal_input_data_source_blacklist_data_name = new TextInput({
            "id": "modal_input_data_source_blacklist_data_name",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_blacklist_data_name$",
            "el": $('#modal_input_data_source_blacklist_data_name')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_data_name.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_data_name);
        });

        var modal_input_data_source_blacklist_data_name_search = new TextInput({
            "id": "modal_input_data_source_blacklist_data_name_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_blacklist_data_name_search$",
            "el": $('#modal_input_data_source_blacklist_data_name_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_data_name_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_data_name_search);
        });

        // blacklist data host

        // blacklist host

        var modal_input_data_host_blacklist_host = new TextInput({
            "id": "modal_input_data_host_blacklist_host",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_blacklist_host$",
            "el": $('#modal_input_data_host_blacklist_host')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_blacklist_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_blacklist_host);
        });

        var modal_input_data_host_blacklist_host_search = new TextInput({
            "id": "modal_input_data_host_blacklist_host_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_blacklist_host_search$",
            "el": $('#modal_input_data_host_blacklist_host_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_blacklist_host_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_blacklist_host_search);
        });

        // blacklist host

        var modal_input_metric_host_blacklist_host = new TextInput({
            "id": "modal_input_metric_host_blacklist_host",
            "searchWhenChanged": true,
            "value": "$form.tk_input_metric_host_blacklist_host$",
            "el": $('#modal_input_metric_host_blacklist_host')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_blacklist_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_blacklist_host);
        });

        var modal_input_metric_host_blacklist_host_search = new TextInput({
            "id": "modal_input_metric_host_blacklist_host_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_metric_host_blacklist_host_search$",
            "el": $('#modal_input_metric_host_blacklist_host_search')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_blacklist_host_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_blacklist_host_search);
        });

        // blacklist index

        var modal_input_data_host_blacklist_index = new TextInput({
            "id": "modal_input_data_host_blacklist_index",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_blacklist_index$",
            "el": $('#modal_input_data_host_blacklist_index')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_blacklist_index.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_blacklist_index);
        });

        var modal_input_data_host_blacklist_index_search = new TextInput({
            "id": "modal_input_data_host_blacklist_index_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_blacklist_index_search$",
            "el": $('#modal_input_data_host_blacklist_index_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_blacklist_index_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_blacklist_index_search);
        });

        var modal_input_metric_host_blacklist_index = new TextInput({
            "id": "modal_input_metric_host_blacklist_index",
            "searchWhenChanged": true,
            "value": "$form.tk_input_metric_host_blacklist_index$",
            "el": $('#modal_input_metric_host_blacklist_index')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_blacklist_index.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_blacklist_index);
        });

        var modal_input_metric_host_blacklist_index_search = new TextInput({
            "id": "modal_input_metric_host_blacklist_index_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_metric_host_blacklist_index_search$",
            "el": $('#modal_input_metric_host_blacklist_index_search')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_blacklist_index_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_blacklist_index_search);
        });

        // blacklist sourcetype

        var modal_input_data_host_blacklist_sourcetype = new TextInput({
            "id": "modal_input_data_host_blacklist_sourcetype",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_blacklist_sourcetype$",
            "el": $('#modal_input_data_host_blacklist_sourcetype')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_blacklist_sourcetype.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_blacklist_sourcetype);
        });

        var modal_input_data_host_blacklist_sourcetype_search = new TextInput({
            "id": "modal_input_data_host_blacklist_sourcetype_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_blacklist_sourcetype_search$",
            "el": $('#modal_input_data_host_blacklist_sourcetype_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_blacklist_sourcetype_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_blacklist_sourcetype_search);
        });

        // blacklist metric_category

        var modal_input_metric_host_blacklist_metric_category = new DropdownInput({
            "id": "modal_input_metric_host_blacklist_metric_category",
            "tokenDependencies": {
                "depends": "$start_modify_metric_host_blacklist_metric_category$"
            },
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "metric_category",
            "selectFirstChoice": false,
            "valueField": "metric_category",
            "value": "$form.tk_input_metric_host_blacklist_metric_category$",
            "managerid": "searchPopulateMetricCategoriesForBlackListMetricHost",
            "el": $('#modal_input_metric_host_blacklist_metric_category')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_blacklist_metric_category.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_blacklist_metric_category);
        });

        var modal_input_metric_host_blacklist_metric_category_search = new TextInput({
            "id": "modal_input_metric_host_blacklist_metric_category_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_metric_host_blacklist_metric_category_search$",
            "el": $('#modal_input_metric_host_blacklist_metric_category_search')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_blacklist_metric_category_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_blacklist_metric_category_search);
        });

        // Elastic Sources Shared

        var modal_input_elastic_sources_search = new TextInput({
            "id": "modal_input_elastic_sources_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_elastic_sources_search$",
            "el": $('#modal_input_elastic_sources_search')
        }, {
            tokens: true
        }).render();

        modal_input_elastic_sources_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_elastic_sources_search);
        });

        // Elastic Sources Dedicated

        var modal_input_elastic_sources_dedicated_search = new TextInput({
            "id": "modal_input_elastic_sources_dedicated_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_elastic_sources_dedicated_search$",
            "el": $('#modal_input_elastic_sources_dedicated_search')
        }, {
            tokens: true
        }).render();

        modal_input_elastic_sources_dedicated_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_elastic_sources_dedicated_search);
        });

        // Custom lagging

        var modal_input_custom_lagging_search = new TextInput({
            "id": "modal_input_custom_lagging_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_custom_lagging_search$",
            "el": $('#modal_input_custom_lagging_search')
        }, {
            tokens: true
        }).render();

        modal_input_custom_lagging_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_lagging_search);
        });

        //
        // SPLUNK LAYOUT
        //

        $('header').remove();
        new LayoutView({
                "hideChrome": false,
                "hideAppBar": false,
                "hideSplunkBar": false,
                "hideFooter": false
            })
            .render()
            .getContainerElement()
            .appendChild($('.dashboard-body')[0]);

        //
        // DASHBOARD EDITOR
        //

        new Dashboard({
            id: 'dashboard',
            el: $('.dashboard-body'),
            showTitle: true,
            editable: false
        }, {
            tokens: true
        }).render();


        //
        // VIEWS: VISUALIZATION ELEMENTS
        //

        //
        // ALERT SUMMARY
        //

        var element_alerts_main_table = new TableElement({
            "id": "element_alerts_main_table",
            "count": 100,
            "dataOverlayMode": "none",
            "drilldown": "row",
            "fields": "title, cron_schedule, schedule_window, alert.suppress.fields, alert.suppress.period, disabled, next_scheduled_time, \" \"",
            "percentagesRow": "false",
            "rowNumbers": "false",
            "totalsRow": "false",
            "wrap": "true",
            "managerid": "search_alerts_main_table",
            "el": $('#element_alerts_main_table')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        element_alerts_main_table.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_alert_title", TokenUtils.replaceTokenNames("$row.title$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_alert_cron_schedule", TokenUtils.replaceTokenNames("$row.cron_schedule$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_alert_schedule_window", TokenUtils.replaceTokenNames("$row.schedule_window$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_alert_suppress_fields", TokenUtils.replaceTokenNames("$row.alert.suppress.fields$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_alert_suppress_period", TokenUtils.replaceTokenNames("$row.alert.suppress.period$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_alert_disabled", TokenUtils.replaceTokenNames("$row.disabled$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_alert_next_scheduled_time", TokenUtils.replaceTokenNames("$row.next_scheduled_time$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_alert_actions", TokenUtils.replaceTokenNames("$row.actions$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // Define the alert URL
                var url = TokenUtils.replaceTokenNames("{{SPLUNKWEB_URL_PREFIX}}/app/trackme/alert?s=%2FservicesNS%2Fnobody%2Ftrackme%2Fsaved%2Fsearches%2F$row.id$", _.extend(submittedTokenModel.toJSON(), e.data), TokenUtils.getEscaper('url'), TokenUtils.getFilters(mvc.Components));
                var alert_url = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + url;

                // Define the URL target
                document.getElementById("btn_url_modal_manage_alert").href = alert_url;

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // Retrieve alert title token
                var tk_alert_title = tokens.get("tk_alert_title");

                // Define the history search
                var alert_search_history = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + '//app/trackme/search' + "?q=search%20index%3D_audit%20action%3D\"alert_fired\"%20ss_app%3D\"trackme\"%20ss_name%3D\"" + encodeURI(tk_alert_title) + "\""

                // Define the URL target
                document.getElementById("btn_url_modal_history_alert").href = alert_search_history;

                // Enable modal context
                $("#modal_manage_alerts").modal();

            }
        });

        var body_modal_manage_alerts = new HtmlElement({
            "id": "body_modal_manage_alerts",
            "useTokens": true,
            "el": $('#body_modal_manage_alerts')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_alerts.contentLoaded());

        var singleFormEnabledAlerts = new SingleElement({
            "id": "singleFormEnabledAlerts",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x7fbfff\",\"0x7fbfff\"]",
            "underLabel": "ENABLED ALERTS",
            "managerid": "searchSingleEnabledAlerts",
            "el": $('#singleFormEnabledAlerts')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleFormTriggeredAlerts = new SingleElement({
            "id": "singleFormTriggeredAlerts",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x7fbfff\",\"0xffb347\"]",
            "underLabel": "TRIGGERED ALERTS IN THE PAST 24h",
            "managerid": "search_alerts_triggered_history",
            "el": $('#singleFormTriggeredAlerts')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var DonutAlertTriggered = new VisualizationElement({
            "id": "DonutAlertTriggered",
            "type": "semicircle_donut.semicircle_donut",
            "resizable": true,
            "drilldown": "none",
            "height": "170",
            "refresh.display": "progressbar",
            "semicircle_donut.semicircle_donut.colorField": "color",
            "semicircle_donut.semicircle_donut.cutoutPercentage": "50",
            "semicircle_donut.semicircle_donut.legendPosition": "top",
            "semicircle_donut.semicircle_donut.type": "half",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchDonutAlertsTriggered",
            "el": $('#DonutAlertTriggered')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var chartAlertTriggered = new ChartElement({
            "id": "chartAlertTriggered",
            "charting.axisTitleX.visibility": "collapsed",
            "charting.chart.stackMode": "stacked",
            "charting.chart": "column",
            "charting.drilldown": "all",
            "charting.legend.placement": "top",
            "resizable": true,
            "managerid": "searchAlertTriggeredOverTime",
            "el": $('#chartAlertTriggered')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAlertTriggeredPerAlert = new ChartElement({
            "id": "chartAlertTriggeredPerAlert",
            "charting.axisTitleX.visibility": "collapsed",
            "charting.chart.stackMode": "stacked",
            "charting.chart": "column",
            "charting.drilldown": "all",
            "charting.legend.placement": "top",
            "height": "200",
            "resizable": true,
            "managerid": "searchAlertTriggeredOverTimePerAlert",
            "el": $('#chartAlertTriggeredPerAlert')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAlertActionsPerAlert = new ChartElement({
            "id": "chartAlertActionsPerAlert",
            "charting.axisTitleX.visibility": "collapsed",
            "charting.chart.stackMode": "stacked",
            "charting.chart": "column",
            "charting.drilldown": "all",
            "charting.legend.placement": "top",
            "height": "200",
            "resizable": true,
            "managerid": "searchAlertActionsTriggeredOverTimePerAlert",
            "el": $('#chartAlertActionsPerAlert')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var eventAlertActionsAckPerAlert = new EventElement({
            "id": "eventAlertActionsAckPerAlert",
            "list.drilldown": "none",
            "table.drilldown": "all",
            "list.wrap": "1",
            "table.wrap": "1",
            "rowNumbers": "0",
            "table.sortDirection": "asc",
            "count": 1,
            "raw.drilldown": "full",
            "type": "list",
            "maxLines": 5,
            "managerid": "searchAlertActionsAckEventsOverTimePerAlert",
            "el": $('#eventAlertActionsAckPerAlert')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var eventAlertActionsSmartStatusPerAlert = new EventElement({
            "id": "eventAlertActionsSmartStatusPerAlert",
            "list.drilldown": "none",
            "table.drilldown": "all",
            "list.wrap": "1",
            "table.wrap": "1",
            "rowNumbers": "0",
            "table.sortDirection": "asc",
            "count": 1,
            "raw.drilldown": "full",
            "type": "list",
            "maxLines": 5,
            "managerid": "searchAlertActionsSmartStatusdEventsOverTimePerAlert",
            "el": $('#eventAlertActionsSmartStatusPerAlert')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var eventAlertActionsFreeStylePerAlert = new EventElement({
            "id": "eventAlertActionsFreeStylePerAlert",
            "list.drilldown": "none",
            "table.drilldown": "all",
            "list.wrap": "1",
            "table.wrap": "1",
            "rowNumbers": "0",
            "table.sortDirection": "asc",
            "count": 1,
            "raw.drilldown": "full",
            "type": "list",
            "maxLines": 5,
            "managerid": "searchAlertActionsFreeStyleEventsOverTimePerAlert",
            "el": $('#eventAlertActionsFreeStylePerAlert')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var TimelineDataSource = new VisualizationElement({
            "id": "TimelineDataSource",
            "type": "timeline_app.timeline",
            "resizable": true,
            "drilldown": "none",
            "timeline_app.timeline.axisTimeFormat": "DAYS",
            "timeline_app.timeline.colorMode": "categorical",
            "timeline_app.timeline.maxColor": "#DA5C5C",
            "timeline_app.timeline.minColor": "#FFE8E8",
            "timeline_app.timeline.numOfBins": "6",
            "timeline_app.timeline.tooltipTimeFormat": "DAYS",
            "timeline_app.timeline.useColors": "1",
            "height": "150",
            "managerid": "searchDataSourceTimeline",
            "el": $('#TimelineDataSource')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var TimelineDataHost = new VisualizationElement({
            "id": "TimelineDataHost",
            "type": "timeline_app.timeline",
            "resizable": true,
            "drilldown": "none",
            "timeline_app.timeline.axisTimeFormat": "DAYS",
            "timeline_app.timeline.colorMode": "categorical",
            "timeline_app.timeline.maxColor": "#DA5C5C",
            "timeline_app.timeline.minColor": "#FFE8E8",
            "timeline_app.timeline.numOfBins": "6",
            "timeline_app.timeline.tooltipTimeFormat": "DAYS",
            "timeline_app.timeline.useColors": "1",
            "height": "150",
            "managerid": "searchDataHostTimeline",
            "el": $('#TimelineDataHost')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var TimelineMetricHost = new VisualizationElement({
            "id": "TimelineMetricHost",
            "type": "timeline_app.timeline",
            "resizable": true,
            "drilldown": "none",
            "timeline_app.timeline.axisTimeFormat": "DAYS",
            "timeline_app.timeline.colorMode": "categorical",
            "timeline_app.timeline.maxColor": "#DA5C5C",
            "timeline_app.timeline.minColor": "#FFE8E8",
            "timeline_app.timeline.numOfBins": "6",
            "timeline_app.timeline.tooltipTimeFormat": "DAYS",
            "timeline_app.timeline.useColors": "1",
            "height": "150",
            "managerid": "searchMetricHostTimeline",
            "el": $('#TimelineMetricHost')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var DonutDataSourceCountByStateAndPriority = new VisualizationElement({
            "id": "DonutDataSourceCountByStateAndPriority",
            "type": "semicircle_donut.semicircle_donut",
            "resizable": true,
            "drilldown": "none",
            "height": "170",
            "refresh.display": "progressbar",
            "semicircle_donut.semicircle_donut.colorField": "color",
            "semicircle_donut.semicircle_donut.cutoutPercentage": "50",
            "semicircle_donut.semicircle_donut.legendPosition": "top",
            "semicircle_donut.semicircle_donut.type": "half",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchSingleDataSourceDonutAlerts",
            "el": $('#DonutDataSourceCountByStateAndPriority')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var DonutDataSourceCountByPriority = new VisualizationElement({
            "id": "DonutDataSourceCountByPriority",
            "type": "semicircle_donut.semicircle_donut",
            "resizable": true,
            "drilldown": "all",
            "height": "170",
            "refresh.display": "progressbar",
            "semicircle_donut.semicircle_donut.colorField": "color",
            "semicircle_donut.semicircle_donut.cutoutPercentage": "50",
            "semicircle_donut.semicircle_donut.legendPosition": "top",
            "semicircle_donut.semicircle_donut.type": "half",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchSingleDataSourceDonutPriorities",
            "el": $('#DonutDataSourceCountByPriority')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        DonutDataSourceCountByPriority.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.inputDataPriority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_source_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataSource = new SingleElement({
            "id": "singleFormTotalDataSource",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x7fbfff\",\"0x7fbfff\"]",
            "underLabel": "DATA SOURCES",
            "managerid": "searchSingleDataSource1",
            "el": $('#singleFormTotalDataSource')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataSource.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_source_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataSourceAlerts = new SingleElement({
            "id": "singleFormTotalDataSourceAlerts",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x7fbfff\",\"0xffb347\"]",
            "underLabel": "ANY PRIORITY DATA SOURCES IN ALERT",
            "managerid": "searchSingleDataSourceInAlert",
            "el": $('#singleFormTotalDataSourceAlerts')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataSourceAlerts.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.inputDataPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_source_state", TokenUtils.replaceTokenNames("red", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataSourceAlertsHighPriority = new SingleElement({
            "id": "singleFormTotalDataSourceAlertsHighPriority",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x7fbfff\",\"0xff6961\"]",
            "underLabel": "HIGH PRIORITY DATA SOURCES IN ALERT",
            "managerid": "searchSingleDataSourceHighPriority",
            "el": $('#singleFormTotalDataSourceAlertsHighPriority')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataSourceAlertsHighPriority.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_source_state", TokenUtils.replaceTokenNames("red", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataPriority", TokenUtils.replaceTokenNames("high", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataSourceDisabled = new SingleElement({
            "id": "singleFormTotalDataSourceDisabled",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x7fbfff\",\"0x7fbfff\"]",
            "underLabel": "DATA SOURCES NOT MONITORED",
            "managerid": "searchSingleDataSourceNotMonitored",
            "el": $('#singleFormTotalDataSourceDisabled')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataSourceDisabled.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("disabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_source_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var DonutDataHostCountByPriority = new VisualizationElement({
            "id": "DonutDataHostCountByPriority",
            "type": "semicircle_donut.semicircle_donut",
            "resizable": true,
            "drilldown": "none",
            "height": "170",
            "refresh.display": "progressbar",
            "semicircle_donut.semicircle_donut.colorField": "color",
            "semicircle_donut.semicircle_donut.cutoutPercentage": "50",
            "semicircle_donut.semicircle_donut.legendPosition": "top",
            "semicircle_donut.semicircle_donut.type": "half",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchSingleDataHostDonutAlerts",
            "el": $('#DonutDataHostCountByPriority')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var DonutDataHostCountByStateAndPriority = new VisualizationElement({
            "id": "DonutDataHostCountByStateAndPriority",
            "type": "semicircle_donut.semicircle_donut",
            "resizable": true,
            "drilldown": "all",
            "height": "170",
            "refresh.display": "progressbar",
            "semicircle_donut.semicircle_donut.colorField": "color",
            "semicircle_donut.semicircle_donut.cutoutPercentage": "50",
            "semicircle_donut.semicircle_donut.legendPosition": "top",
            "semicircle_donut.semicircle_donut.type": "half",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchSingleDataHostDonutPriorities",
            "el": $('#DonutDataHostCountByStateAndPriority')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        DonutDataHostCountByStateAndPriority.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_host_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataHostPriority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataHost = new SingleElement({
            "id": "singleFormTotalDataHost",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x7fbfff\",\"0x7fbfff\"]",
            "underLabel": "DATA HOSTS",
            "managerid": "searchSingleDataHost1",
            "el": $('#singleFormTotalDataHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_host_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataHostPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataHostAlerts = new SingleElement({
            "id": "singleFormTotalDataHostAlerts",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x7fbfff\",\"0xffb347\"]",
            "underLabel": "ANY PRIORITY DATA HOSTS IN ALERT",
            "managerid": "searchSingleDataHostInAlert",
            "el": $('#singleFormTotalDataHostAlerts')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataHostAlerts.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.inputDataHostPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_host_state", TokenUtils.replaceTokenNames("red", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataHostAlertsHighPriority = new SingleElement({
            "id": "singleFormTotalDataHostAlertsHighPriority",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x7fbfff\",\"0xff6961\"]",
            "underLabel": "HIGH PRIORITY DATA HOSTS IN ALERT",
            "managerid": "searchSingleDataHostHighPriority",
            "el": $('#singleFormTotalDataHostAlertsHighPriority')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataHostAlertsHighPriority.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_host_state", TokenUtils.replaceTokenNames("red", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataHostPriority", TokenUtils.replaceTokenNames("high", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataHostDisabled = new SingleElement({
            "id": "singleFormTotalDataHostDisabled",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x7fbfff\",\"0x7fbfff\"]",
            "underLabel": "DATA HOSTS NOT MONITORED",
            "managerid": "searchSingleDataHostNotMonitored",
            "el": $('#singleFormTotalDataHostDisabled')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataHostDisabled.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("disabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_host_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataHostPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var DonutMetricHostCountByPriority = new VisualizationElement({
            "id": "DonutMetricHostCountByPriority",
            "type": "semicircle_donut.semicircle_donut",
            "resizable": true,
            "drilldown": "none",
            "height": "170",
            "refresh.display": "progressbar",
            "semicircle_donut.semicircle_donut.colorField": "color",
            "semicircle_donut.semicircle_donut.cutoutPercentage": "50",
            "semicircle_donut.semicircle_donut.legendPosition": "top",
            "semicircle_donut.semicircle_donut.type": "half",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchSingleMetricHostDonutAlerts",
            "el": $('#DonutMetricHostCountByPriority')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var DonutMetricHostCountByStateAndPriority = new VisualizationElement({
            "id": "DonutMetricHostCountByStateAndPriority",
            "type": "semicircle_donut.semicircle_donut",
            "resizable": true,
            "drilldown": "all",
            "height": "170",
            "refresh.display": "progressbar",
            "semicircle_donut.semicircle_donut.colorField": "color",
            "semicircle_donut.semicircle_donut.cutoutPercentage": "50",
            "semicircle_donut.semicircle_donut.legendPosition": "top",
            "semicircle_donut.semicircle_donut.type": "half",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchSingleMetricHostDonutPriorities",
            "el": $('#DonutMetricHostCountByStateAndPriority')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        DonutMetricHostCountByStateAndPriority.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.metric_host_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputMetricHostPriority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.metric_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalMetricHost = new SingleElement({
            "id": "singleFormTotalMetricHost",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x7fbfff\",\"0x7fbfff\"]",
            "underLabel": "METRIC HOSTS",
            "managerid": "searchSingleMetricHost1",
            "el": $('#singleFormTotalMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalMetricHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.metric_host_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputMetricHostPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.metric_monitored_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalMetricHostAlerts = new SingleElement({
            "id": "singleFormTotalMetricHostAlerts",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x7fbfff\",\"0xffb347\"]",
            "underLabel": "ANY PRIORITY METRIC HOSTS IN ALERT",
            "managerid": "searchSingleMetricHostInAlert",
            "el": $('#singleFormTotalMetricHostAlerts')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalMetricHostAlerts.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.inputMetricHostPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.metric_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.metric_host_state", TokenUtils.replaceTokenNames("red", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalMetricHostAlertsHighPriority = new SingleElement({
            "id": "singleFormTotalMetricHostAlertsHighPriority",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x7fbfff\",\"0xff6961\"]",
            "underLabel": "HIGH PRIORITY METRIC HOSTS IN ALERT",
            "managerid": "searchSingleMetricHostHighPriority",
            "el": $('#singleFormTotalMetricHostAlertsHighPriority')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalMetricHostAlertsHighPriority.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.metric_host_state", TokenUtils.replaceTokenNames("red", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.metric_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputMetricHostPriority", TokenUtils.replaceTokenNames("high", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalMetricHostDisabled = new SingleElement({
            "id": "singleFormTotalMetricHostDisabled",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x7fbfff\",\"0x7fbfff\"]",
            "underLabel": "METRIC HOSTS NOT MONITORED",
            "managerid": "searchSingleMetricHostNotMonitored",
            "el": $('#singleFormTotalMetricHostDisabled')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalMetricHostDisabled.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.metric_monitored_state", TokenUtils.replaceTokenNames("disabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.metric_host_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputMetricHostPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        // whitelist

        // whitelist data_source

        var singleWhiteListDataSource = new SingleElement({
            "id": "singleWhiteListDataSource",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "index(es) in whitelist currently",
            "managerid": "searchSingleWhiteListDataSource",
            "el": $('#singleWhiteListDataSource')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // whitelist metric_host

        var singleWhiteListMetricHost = new SingleElement({
            "id": "singleWhiteListMetricHost",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "index(es) in whitelist currently",
            "managerid": "searchSingleWhiteListMetricHost",
            "el": $('#singleWhiteListMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // whitelist data_host

        var singleWhiteListDataHost = new SingleElement({
            "id": "singleWhiteListDataHost",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "index(es) in whitelist currently",
            "managerid": "searchSingleWhiteListDataHost",
            "el": $('#singleWhiteListDataHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListDataSourceHost = new SingleElement({
            "id": "singleBlackListDataSourceHost",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "host(s) in blacklist currently",
            "managerid": "searchSingleBlackListDataSourceHost",
            "el": $('#singleBlackListDataSourceHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListDataSourceIndex = new SingleElement({
            "id": "singleBlackListDataSourceIndex",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "index(es) in blacklist currently",
            "managerid": "searchSingleBlackListDataSourceIndex",
            "el": $('#singleBlackListDataSourceIndex')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListDataSourceSourcetype = new SingleElement({
            "id": "singleBlackListDataSourceSourcetype",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "sourcetype(s) in blacklist currently",
            "managerid": "searchSingleBlackListDataSourceSourcetype",
            "el": $('#singleBlackListDataSourceSourcetype')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListDataSourceDataName = new SingleElement({
            "id": "singleBlackListDataSourceDataName",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "data name(s) in blacklist currently",
            "managerid": "searchSingleBlackListDataSourceDataName",
            "el": $('#singleBlackListDataSourceDataName')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListDataHostHost = new SingleElement({
            "id": "singleBlackListDataHostHost",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "host(s) in blacklist currently",
            "managerid": "searchSingleBlackListDataHostHost",
            "el": $('#singleBlackListDataHostHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListDataHostIndex = new SingleElement({
            "id": "singleBlackListDataHostIndex",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "index(es) in blacklist currently",
            "managerid": "searchSingleBlackListDataHostIndex",
            "el": $('#singleBlackListDataHostIndex')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListMetricHostIndex = new SingleElement({
            "id": "singleBlackListMetricHostIndex",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "index(es) in blacklist currently",
            "managerid": "searchSingleBlackListMetricHostIndex",
            "el": $('#singleBlackListMetricHostIndex')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListDataHostSourcetype = new SingleElement({
            "id": "singleBlackListDataHostSourcetype",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "sourcetype(s) in blacklist currently",
            "managerid": "searchSingleBlackListDataHostSourcetype",
            "el": $('#singleBlackListDataHostSourcetype')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // blacklist netric host
        var singleBlackListMetricHostHost = new SingleElement({
            "id": "singleBlackListMetricHostHost",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "host(s) in blacklist currently",
            "managerid": "searchSingleBlackListMetricHostHost",
            "el": $('#singleBlackListMetricHostHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // blacklist metric_category
        var singleBlackListMetricHostMetricCategory = new SingleElement({
            "id": "singleBlackListMetricHostMetricCategory",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "metric categorie(s) in blacklist currently",
            "managerid": "searchSingleBlackListMetricHostMetricCategory",
            "el": $('#singleBlackListMetricHostMetricCategory')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // metric sla policies
        var SingleMetricPolicies = new SingleElement({
            "id": "SingleMetricPolicies",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "metric policies",
            "managerid": "searchSingleMetricPolicies",
            "el": $('#SingleMetricPolicies')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Elastic Sources Shared
        var SingleElasticSources = new SingleElement({
            "id": "SingleElasticSources",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "current elastic source(s)",
            "managerid": "searchSingleElasticSources",
            "el": $('#SingleElasticSources')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Elastic Sources Dedicated
        var SingleElasticSourcesDedicated = new SingleElement({
            "id": "SingleElasticSourcesDedicated",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "current elastic source(s)",
            "managerid": "searchSingleElasticSourcesDedicated",
            "el": $('#SingleElasticSourcesDedicated')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Custom lagging
        var SingleCustomLagging = new SingleElement({
            "id": "SingleCustomLagging",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "current lagging class(es)",
            "managerid": "searchSingleCustomLagging",
            "el": $('#SingleCustomLagging')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementMainTable = new TableElement({
            "id": "elementMainTable",
            "count": 20,
            "drilldown": "row",
            "fields": "data_name, \"last time\", \"last ingest\", priority, state, \"lag (event / ingestion)\", \"last time idx\", data_last_lag_seen_idx, data_max_lag_allowed, monitoring, data_monitoring_level, data_monitoring_wdays",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchDataSourcesPostTable",
            "el": $('#elementMainTable')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementMainTable.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                // clean any previously set main token, used for variable purposes
                unsetToken("tk_data_host");
                unsetToken("tk_metric_host");

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_name", TokenUtils.replaceTokenNames("$row.data_name$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_index", TokenUtils.replaceTokenNames("$row.data_index$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_sourcetype", TokenUtils.replaceTokenNames("$row.data_sourcetype$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_lag_seen", TokenUtils.replaceTokenNames("$row.data_last_lag_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_ingestion_lag_seen", TokenUtils.replaceTokenNames("$row.data_last_ingestion_lag_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_lag_summary", TokenUtils.replaceTokenNames("$row.lag (event / ingestion)$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_lag_seen_idx", TokenUtils.replaceTokenNames("$row.data_last_lag_seen_idx$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_eventcount", TokenUtils.replaceTokenNames("$row.data_eventcount$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_first_time_seen", TokenUtils.replaceTokenNames("$row.data_first_time_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_time_seen", TokenUtils.replaceTokenNames("$row.data_last_time_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_time_seen_human", TokenUtils.replaceTokenNames("$row.last time$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_ingest", TokenUtils.replaceTokenNames("$row.data_last_ingest$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_ingest_human", TokenUtils.replaceTokenNames("$row.last ingest$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_time_seen_idx", TokenUtils.replaceTokenNames("$row.data_last_time_seen_idx$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_time_seen_idx_human", TokenUtils.replaceTokenNames("$row.data_last_time_seen_idx (translated)$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_max_lag_allowed", TokenUtils.replaceTokenNames("$row.data_max_lag_allowed$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_lag_alert_kpis", TokenUtils.replaceTokenNames("$row.data_lag_alert_kpis$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_monitored_state", TokenUtils.replaceTokenNames("$row.data_monitored_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_monitoring_level", TokenUtils.replaceTokenNames("$row.data_monitoring_level$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_monitoring_wdays", TokenUtils.replaceTokenNames("$row.data_monitoring_wdays$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_override_lagging_class", TokenUtils.replaceTokenNames("$row.data_override_lagging_class$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_source_state", TokenUtils.replaceTokenNames("$row.data_source_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_tracker_runtime", TokenUtils.replaceTokenNames("$row.data_tracker_runtime$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_previous_source_state", TokenUtils.replaceTokenNames("$row.data_previous_source_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_previous_tracker_runtime", TokenUtils.replaceTokenNames("$row.data_previous_tracker_runtime$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_state", TokenUtils.replaceTokenNames("$row.latest_flip_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_time", TokenUtils.replaceTokenNames("$row.latest_flip_time$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_time_human", TokenUtils.replaceTokenNames("$row.latest_flip_time (translated)$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_priority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // dcount hosts
                setToken("tk_dcount_host", TokenUtils.replaceTokenNames("$row.dcount_host$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_min_dcount_host", TokenUtils.replaceTokenNames("$row.min_dcount_host$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.tk_input_data_source_dcount_host", TokenUtils.replaceTokenNames("$row.min_dcount_host$", _.extend(submittedTokenModel.toJSON(), e.data)));                                                

                // outlier
                setToken("tk_outlierenabledstatus", TokenUtils.replaceTokenNames("$row.enable_behaviour_analytic$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outliermineventcount", TokenUtils.replaceTokenNames("$row.OutlierMinEventCount$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlierlowerthresholdmultiplier", TokenUtils.replaceTokenNames("$row.OutlierLowerThresholdMultiplier$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlierupperthresholdmultiplier", TokenUtils.replaceTokenNames("$row.OutlierUpperThresholdMultiplier$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlieralertonupper", TokenUtils.replaceTokenNames("$row.OutlierAlertOnUpper$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlier_period", TokenUtils.replaceTokenNames("$row.OutlierTimePeriod$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlier_span", TokenUtils.replaceTokenNames("$row.OutlierSpan$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_isoutlier", TokenUtils.replaceTokenNames("$row.isOutlier$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_enable_behaviour_analytic", TokenUtils.replaceTokenNames("$row.enable_behaviour_analytic$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // elastic sources
                setToken("tk_elastic_source_search_mode", TokenUtils.replaceTokenNames("$row.elastic_source_search_mode$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_elastic_source_search_constraint", TokenUtils.replaceTokenNames("$row.elastic_source_search_constraint$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_elastic_source_from_part1", TokenUtils.replaceTokenNames("$row.elastic_source_from_part1$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_elastic_source_from_part2", TokenUtils.replaceTokenNames("$row.elastic_source_from_part2$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_elastic_mstats_idx", TokenUtils.replaceTokenNames("$row.elastic_mstats_idx$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_elastic_mstats_filters", TokenUtils.replaceTokenNames("$row.elastic_mstats_filters$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // data sampling
                setToken("tk_data_sampling_status_message", TokenUtils.replaceTokenNames("$row.data_sample_status_message$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_sampling_status_colour", TokenUtils.replaceTokenNames("$row.data_sample_status_colour$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_sample_anomaly_reason", TokenUtils.replaceTokenNames("$row.data_sample_anomaly_reason$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_isanomaly", TokenUtils.replaceTokenNames("$row.isAnomaly$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_sample_lastrun", TokenUtils.replaceTokenNames("$row.data_sample_lastrun$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // status message
                setToken("tk_status_message", TokenUtils.replaceTokenNames("$row.status_message$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // doc href
                setToken("tk_doc_link", TokenUtils.replaceTokenNames("$row.doc_link$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_doc_note", TokenUtils.replaceTokenNames("$row.doc_note$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_doc_identity_card_is_global", TokenUtils.replaceTokenNames("$row.doc_identity_card_is_global$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_doc_key_match", TokenUtils.replaceTokenNames("$row.doc_key_match$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // tags
                setToken("tk_tags", TokenUtils.replaceTokenNames("$row.tags$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pref-fill current lagging input
                setToken("form.tk_input_lag", TokenUtils.replaceTokenNames("$row.data_max_lag_allowed$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pref-fill current wdays input
                setToken("form.tk_input_wdays", TokenUtils.replaceTokenNames("$row.data_monitoring_wdays$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pre-fill current monitoring level
                setToken("form.tk_input_level", TokenUtils.replaceTokenNames("$row.data_monitoring_level$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pre-fill current priority
                setToken("form.tk_input_priority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pre-fill lagging class override
                setToken("form.modal_input_lag_override_class", TokenUtils.replaceTokenNames("$row.data_override_lagging_class$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pre-fill alert over kpis
                setToken("form.tk_input_data_lag_alert_kpis", TokenUtils.replaceTokenNames("$row.data_lag_alert_kpis$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_name = tokens.get("tk_data_name");
                var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
                var tk_data_index = tokens.get("tk_data_index");
                var tk_data_sourcetype = tokens.get("tk_data_sourcetype");

                // Get earliest / latest to be recycled in some use cases
                var tk_earliest = tokens.get("modalTime.earliest");
                var tk_latest = tokens.get("modalTime.latest");

                // Manage Outliers
                var tk_outlierenabledstatus = tokens.get("tk_outlierenabledstatus");
                var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
                var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
                var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
                var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
                var tk_isoutlier = tokens.get("tk_isoutlier");
                var tk_outlier_span = tokens.get("tk_outlier_span");
                var tk_outlier_period = tokens.get("tk_outlier_period");

                // Outliers configuration

                // prefill the current status
                if (tk_outlierenabledstatus && tk_outlierenabledstatus == "true") {
                    setToken("form.tk_input_data_source_enable_outlier", TokenUtils.replaceTokenNames("true", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else {
                    setToken("form.tk_input_data_source_enable_outlier", TokenUtils.replaceTokenNames("false", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // prefill the current lower multiplier
                if (tk_outlierlowerthresholdmultiplier && isNumeric(tk_outlierlowerthresholdmultiplier)) {
                    setToken("form.tk_input_data_source_outlier_lower_threshold_multiplier", TokenUtils.replaceTokenNames(tk_outlierlowerthresholdmultiplier, _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // prefill the current upper multiplier
                if (tk_outlierupperthresholdmultiplier && isNumeric(tk_outlierupperthresholdmultiplier)) {
                    setToken("form.tk_input_data_source_outlier_upper_threshold_multiplier", TokenUtils.replaceTokenNames(tk_outlierupperthresholdmultiplier, _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Define the Outliers lowerbound mode
                if (tk_outliermineventcount && isNumeric(tk_outliermineventcount) && tk_outliermineventcount > 0) {
                    setToken("form.tk_input_data_source_outlier_min_eventcount_mode", TokenUtils.replaceTokenNames("static", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("form.tk_input_data_source_outlier_min_eventcount", TokenUtils.replaceTokenNames(tk_outliermineventcount, _.extend(submittedTokenModel.toJSON(), e.data)));
                }
                else {
                    setToken("form.tk_input_data_source_outlier_min_eventcount_mode", TokenUtils.replaceTokenNames("dynamic", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("form.tk_input_data_source_outlier_min_eventcount", TokenUtils.replaceTokenNames("disabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // prefill the current status
                if (tk_outlieralertonupper && tk_outlieralertonupper != "null") {
                    setToken("form.tk_input_data_source_outlier_alert_on_upper", TokenUtils.replaceTokenNames(tk_outlieralertonupper, _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // prefill the outlier span
                if (tk_outlier_span && tk_outlier_span != "null") {
                    setToken("form.TimeOutlierConfigurationDataSourceSpan", TokenUtils.replaceTokenNames(tk_outlier_span, _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // prefill the outlier period
                if (tk_outlier_period && tk_outlier_period != "null") {
                    setToken("form.TimeOutlierConfigurationDataSource", TokenUtils.replaceTokenNames(tk_outlier_period, _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // href docs
                var tk_doc_link = tokens.get("tk_doc_link");
                var tk_doc_note = tokens.get("tk_doc_note");
                var tk_doc_identity_card_is_global = tokens.get("tk_doc_identity_card_is_global");
                var tk_doc_key_match = tokens.get("tk_doc_key_match");

                // If the documentation reference has not been set, define the href format
                if (tk_doc_link == "null") {
                    setToken("tk_doc_link_main", TokenUtils.replaceTokenNames("Click here to define a documentation reference", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_doc_modal_target", TokenUtils.replaceTokenNames("define_identity_card", _.extend(submittedTokenModel.toJSON(), e.data)));
                    // replace the textinput for modification requests
                    document.getElementById("input_doc_link").value = "link to documentation";
                } else {
                    setToken("tk_doc_link_main", TokenUtils.replaceTokenNames("Show data source identity card", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_doc_modal_target", TokenUtils.replaceTokenNames("manage_identity_card", _.extend(submittedTokenModel.toJSON(), e.data)));
                    // replace the textinput for modification requests
                    document.getElementById("input_doc_link").value = tk_doc_link;
                }

                if (tk_doc_note == "null") {
                    setToken("tk_doc_link", TokenUtils.replaceTokenNames("No documentation defined.", _.extend(submittedTokenModel.toJSON(), e.data)));
                    // replace the textarea for modification requests
                    document.getElementById("input_doc_note").value = "documentation note";
                } else {
                    // replace the textarea for modification requests
                    document.getElementById("input_doc_note").value = tk_doc_note;
                }

                // If the identity card info is global, disable the delete card
                if (tk_doc_identity_card_is_global == "true") {
                    document.getElementById('btn_delete_manage_identity_card').disabled = true;
                    document.getElementById('btn_modify_manage_identity_card').disabled = false;
                    setToken("tk_msg_doc_identity_card_is_global", TokenUtils.replaceTokenNames("TrackMe info: this is a default identity card configured at the system level, you cannot delete this card but you can create a new card linked to this specific data source, consult: ", _.extend(submittedTokenModel.toJSON(), e.data)));                
                } else if (tk_doc_key_match == "wildcard") {
                    document.getElementById('btn_delete_manage_identity_card').disabled = true;
                    document.getElementById('btn_modify_manage_identity_card').disabled = true;
                    setToken("tk_msg_doc_identity_card_is_global", TokenUtils.replaceTokenNames("TrackMe info: this is a wildcard matching identity card, this card has to be managed via the API endpoints, consult: ", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else {
                    document.getElementById('btn_delete_manage_identity_card').disabled = false;
                    document.getElementById('btn_modify_manage_identity_card').disabled = false;
                    setToken("tk_msg_doc_identity_card_is_global", TokenUtils.replaceTokenNames("TrackMe info: this identity card was associated to this data source, you can update or delete this card, consult: ", _.extend(submittedTokenModel.toJSON(), e.data)));
                }
            
                // tags
                var tk_tags = tokens.get("tk_tags");

                // define the href depending on the tags
                if (tk_tags == "No tags defined, click on Update tags to define one or more tags to be associated with this data source.") {
                    setToken("tk_tags_link_main", TokenUtils.replaceTokenNames("Click here to define tags", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_tags_modal_target", TokenUtils.replaceTokenNames("manage_tags", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else {
                    setToken("tk_tags_link_main", TokenUtils.replaceTokenNames("Show tags", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_tags_modal_target", TokenUtils.replaceTokenNames("manage_tags", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Manage root search for overview, conditionally define the query depending on the search
                var tk_elastic_source_search_mode = tokens.get("tk_elastic_source_search_mode");
                var tk_elastic_source_search_constraint = tokens.get("tk_elastic_source_search_constraint");
                var tk_elastic_source_from_part1 = tokens.get("tk_elastic_source_from_part1");
                var tk_elastic_source_from_part2 = tokens.get("tk_elastic_source_from_part2");
                var tk_elastic_mstats_idx = tokens.get("tk_elastic_mstats_idx");
                var tk_elastic_mstats_filters = tokens.get("tk_elastic_mstats_filters");

                // Handle regular data sources and additional integration modes
                if (tk_elastic_source_search_mode == "null") {

                    // cribl integration
                    if (/\|cribl:/i.test(tk_data_name)) {

                        // Extract the cribl_pipe value
                        cribl_pipe_matches = tk_data_name.match(/\|cribl:(.*)/);
                        cribl_pipe = cribl_pipe_matches[1];

                        // create a token for the cribl_pipe
                        setToken("tk_cribl_pipe", TokenUtils.replaceTokenNames(cribl_pipe, _.extend(submittedTokenModel.toJSON(), e.data)));

                        // define the root search
                        tk_data_source_overview_root_search = "| `trackme_tstats` dc(host) as dcount_host count latest(_indextime) as indextime max(_time) as maxtime where index=\"" + tk_data_index + "\" sourcetype=\"" + tk_data_sourcetype + "\" cribl_pipe::" + cribl_pipe + " `trackme_tstats_main_filter` by _time, index, sourcetype span=1s | eval delta=(indextime-_time), event_lag=(now() - maxtime)";
                        tk_data_source_raw_search = "null";
                        setToken("tk_data_source_timechart_count_aggreg", TokenUtils.replaceTokenNames("sum", _.extend(submittedTokenModel.toJSON(), e.data)));

                    }

                    // split by custom mode
                    else if (/\|key:/i.test(tk_data_name)) {
                        regex_matches = tk_data_name.match(/\|key:([^\|]+)\|(.*)/);
                        keyName = regex_matches[1];
                        keyValue = regex_matches[2];
                        tk_data_source_overview_root_search = "| `trackme_tstats` dc(host) as dcount_host count latest(_indextime) as indextime max(_time) as maxtime where index=\"" + tk_data_index + "\" sourcetype=\"" + tk_data_sourcetype + "\" " + keyName + "=\"" + keyValue + "\" `trackme_tstats_main_filter` by _time, index, sourcetype, source span=1s | eval delta=(indextime-_time), event_lag=(now() - maxtime)";
                        tk_data_source_raw_search = "null";
                        setToken("tk_data_source_timechart_count_aggreg", TokenUtils.replaceTokenNames("sum", _.extend(submittedTokenModel.toJSON(), e.data)));
                    }

                    // standard mode
                    else {
                        tk_data_source_overview_root_search = "| `trackme_tstats` dc(host) as dcount_host count latest(_indextime) as indextime max(_time) as maxtime where index=\"" + tk_data_index + "\" sourcetype=\"" + tk_data_sourcetype + "\" `trackme_tstats_main_filter` by _time, index, sourcetype span=1s | eval delta=(indextime-_time), event_lag=(now() - maxtime)";
                        tk_data_source_raw_search = "null";
                        setToken("tk_data_source_timechart_count_aggreg", TokenUtils.replaceTokenNames("sum", _.extend(submittedTokenModel.toJSON(), e.data)));
                    }
                }

                else if (tk_elastic_source_search_mode == "tstats") {
                    tk_data_source_overview_root_search = "| `trackme_tstats` dc(host) as dcount_host count latest(_indextime) as indextime max(_time) as maxtime where " + tk_elastic_source_search_constraint + " by _time, index, sourcetype span=1s | eval delta=(indextime-_time), event_lag=(now() - maxtime)";
                    tk_data_source_raw_search = "?q=search%20" + encodeURI(tk_elastic_source_search_constraint);
                    setToken("tk_data_source_timechart_count_aggreg", TokenUtils.replaceTokenNames("sum", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                else if (tk_elastic_source_search_mode == "raw") {
                    tk_data_source_overview_root_search = tk_elastic_source_search_constraint + " | eval delta=(_indextime-_time), event_lag=(now() - _time) | bucket _time span=1s | stats count, avg(delta) as delta, latest(event_lag) as event_lag, dc(host) as dcount_host by _time";
                    tk_data_source_raw_search = "?q=search%20" + encodeURI(tk_elastic_source_search_constraint);
                    setToken("tk_data_source_timechart_count_aggreg", TokenUtils.replaceTokenNames("sum", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                else if (tk_elastic_source_search_mode == "from" && tk_elastic_source_from_part1 != "null" && tk_elastic_source_from_part2 != "null") {

                    if (/datamodel:/i.test(tk_elastic_source_search_constraint)) {
                        // rest search needs special handling
                        tk_data_source_overview_root_search = "| " + tk_elastic_source_search_mode + " " + tk_elastic_source_from_part1 + " | " +  tk_elastic_source_from_part2 + " | eventstats max(_time) as maxtime | eval delta=(_indextime-_time), event_lag=(now() - maxtime) | bucket _time span=1s | stats count, avg(delta) as delta, latest(event_lag) as event_lag, dc(host) as dcount_host by _time";
                        setToken("tk_data_source_timechart_count_aggreg", TokenUtils.replaceTokenNames("sum", _.extend(submittedTokenModel.toJSON(), e.data)));
                    }

                    else if (/lookup:/i.test(tk_elastic_source_search_constraint)) {
                        // rest search needs special handling
                        tk_data_source_overview_root_search = "| mstats latest(_value) as value where `trackme_metrics_idx` (metric_name=trackme.eventcount_4h OR metric_name=trackme.lag_event_sec OR metric_name=trackme.hostcount_4h) object_category=\"data_source\" object=\"" + tk_data_name + "\" by metric_name span=5m | eval {metric_name}=value | stats first(trackme.eventcount_4h) as count, first(trackme.lag_event_sec) as delta, max(trackme.hostcount_4h) as dcount_host by _time | eval event_lag=delta";
                        setToken("tk_data_source_timechart_count_aggreg", TokenUtils.replaceTokenNames("latest", _.extend(submittedTokenModel.toJSON(), e.data)));
                    }

                    tk_data_source_raw_search = "?q=" + encodeURI("| ") + encodeURI(tk_elastic_source_search_mode) + " " + encodeURI(tk_elastic_source_from_part1) + encodeURI(" | ") +  encodeURI(tk_elastic_source_from_part2);
                }

                else if (tk_elastic_source_search_mode == "rest_from" && tk_elastic_source_from_part1 != "null" && tk_elastic_source_from_part2 != "null") {                    

                    // rest seach requires escaping
                    tk_elastic_source_from_part2 = tk_elastic_source_from_part2.replace(/\"/g, "\\\"");

                    if (/datamodel:/i.test(tk_elastic_source_search_constraint)) {
                        // rest search needs special handling
                        tk_data_source_overview_root_search = "| rest " + tk_elastic_source_from_part1 + " /servicesNS/admin/search/search/jobs/export search=\"" + "| from " + tk_elastic_source_from_part2 + "| eventstats max(_time) as maxtime | eval delta=(_indextime-_time), event_lag=(now() - maxtime) | bucket _time span=1s | stats count, avg(delta) as delta, latest(event_lag) as event_lag, dc(host) as dcount_host by _time" + " | eval data_name=\\\"" + tk_data_name + "\\\", data_index=\\\"" + tk_data_index + "\\\", data_sourcetype=\\\"" + tk_data_sourcetype + "\\\", data_last_ingestion_lag_seen=data_last_ingest-data_last_time_seen\"" + " output_mode=\"csv\"" + " earliest_time=\"" + tk_earliest + "\"" + " latest_time=\"" + tk_latest + "\"" + "| head 1 | table value | restextractforstats" + " | eval _time=strptime(_time, \"%Y-%m-%d %H:%M:%S.%3N %Z\")";
                        tk_data_source_raw_search = "?q=" + encodeURI("| rest " + tk_elastic_source_from_part1 + " /servicesNS/admin/search/search/jobs/export search=\"" + "| from " + tk_elastic_source_from_part2 + "| head 100 | fields _time _raw\"" + " output_mode=\"csv\"" + " earliest_time=\"" + tk_earliest + "\"" + " latest_time=\"" + tk_latest + "\"" + " | head 1 | table value | restextractraw" + " | eval _time=strptime(_time, \"%Y-%m-%d %H:%M:%S.%3N %Z\")");
                        setToken("tk_data_source_timechart_count_aggreg", TokenUtils.replaceTokenNames("sum", _.extend(submittedTokenModel.toJSON(), e.data)));
                    }

                    else if (/lookup:/i.test(tk_elastic_source_search_constraint)) {
                        // rest search needs special handling
                        tk_data_source_overview_root_search = "| mstats latest(_value) as value where `trackme_metrics_idx` (metric_name=trackme.eventcount_4h OR metric_name=trackme.lag_event_sec OR metric_name=trackme.hostcount_4h) object_category=\"data_source\" object=\"" + tk_data_name + "\" by metric_name span=5m | eval {metric_name}=value | stats first(trackme.eventcount_4h) as count, first(trackme.lag_event_sec) as delta, max(trackme.hostcount_4h) as dcount_host by _time | eval event_lag=delta";
                        tk_data_source_raw_search = "?q=" + encodeURI("| rest " + tk_elastic_source_from_part1 + " /servicesNS/admin/search/search/jobs/export search=\"" + "| from " + tk_elastic_source_from_part2 + "| head 100" + "\" output_mode=\"csv\"" + "| head 1");
                        setToken("tk_data_source_timechart_count_aggreg", TokenUtils.replaceTokenNames("latest", _.extend(submittedTokenModel.toJSON(), e.data)));
                    }

                }

                else if (tk_elastic_source_search_mode == "mstats" && tk_elastic_mstats_filters != "null") {
                    tk_data_source_overview_root_search = "| mstats latest(_value) as value where `trackme_metrics_idx` (metric_name=trackme.eventcount_4h OR metric_name=trackme.lag_event_sec OR metric_name=trackme.hostcount_4h) object_category=\"data_source\" object=\"" + tk_data_name + "\" by metric_name span=5m | eval {metric_name}=value | stats first(trackme.eventcount_4h) as count, first(trackme.lag_event_sec) as delta, max(trackme.hostcount_4h) as dcount_host by _time | eval event_lag=delta";
                    if (tk_elastic_mstats_idx == "null") {
                        tk_data_source_raw_search = "?q=" + encodeURI("| msearch ") + encodeURI("index=*") + " " + encodeURI("filter=\"" + tk_elastic_mstats_filters + "\"") + encodeURI(" earliest=\"-5m\" latest=now");
                    } else {
                        tk_data_source_raw_search = "?q=" + encodeURI("| msearch ") + encodeURI(tk_elastic_mstats_idx) + " " + encodeURI("filter=\"" + tk_elastic_mstats_filters + "\"") + encodeURI(" earliest=\"-5m\" latest=now");
                    }
                    setToken("tk_data_source_timechart_count_aggreg", TokenUtils.replaceTokenNames("latest", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // tstats over rest
                else if (tk_elastic_source_search_mode == "rest_tstats" && tk_elastic_source_from_part1 != "null" && tk_elastic_source_from_part2 != "null") {                    
                    // rest seach requires escaping
                    tk_elastic_source_from_part2 = tk_elastic_source_from_part2.replace(/\"/g, "\\\"");
                    // rest search needs special handling
                    tk_data_source_overview_root_search = "| rest count=0 " + tk_elastic_source_from_part1 + " /servicesNS/admin/search/search/jobs/export search=\"" + "| tstats dc(host) as dcount_host count latest(_indextime) as indextime max(_time) as maxtime where " + tk_elastic_source_from_part2 + " by _time, index, sourcetype span=1s | eval delta=(indextime-_time), event_lag=(now() - maxtime) | fields _time count delta event_lag dcount_host\"" + " output_mode=\"csv\"" + " earliest_time=\"" + tk_earliest + "\"" + " latest_time=\"" + tk_latest + "\"" + " | table value | restextractforstats" + " | eval _time=strptime(_time, \"%Y-%m-%d %H:%M:%S.%3N %Z\")";
                    tk_data_source_raw_search = "?q=" + encodeURI("| rest count=0 " + tk_elastic_source_from_part1 + " /servicesNS/admin/search/search/jobs/export search=\"" + "search " + tk_elastic_source_from_part2 + " | head 100 | fields _time _raw\"" + " output_mode=\"csv\"" + " earliest_time=\"" + tk_earliest + "\"" + " latest_time=\"" + tk_latest + "\"" + " | head 1 | table value | restextractraw" + " | eval _time=strptime(_time, \"%Y-%m-%d %H:%M:%S.%3N %Z\")");
                    setToken("tk_data_source_timechart_count_aggreg", TokenUtils.replaceTokenNames("sum", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // raw over rest
                else if (tk_elastic_source_search_mode == "rest_raw" && tk_elastic_source_from_part1 != "null" && tk_elastic_source_from_part2 != "null") {                    
                    // rest seach requires escaping
                    tk_elastic_source_from_part2 = tk_elastic_source_from_part2.replace(/\"/g, "\\\"");
                    // rest search needs special handling
                    tk_data_source_overview_root_search = "| rest count=0 " + tk_elastic_source_from_part1 + " /servicesNS/admin/search/search/jobs/export search=\"" + "search " + tk_elastic_source_from_part2 + " | eval delta=(_indextime-_time), event_lag=(now() - _time) | bucket _time span=1s | stats count, avg(delta) as delta, latest(event_lag) as event_lag, dc(host) as dcount_host by _time\"" + " output_mode=\"csv\"" + " earliest_time=\"" + tk_earliest + "\"" + " latest_time=\"" + tk_latest + "\"" + " | table value | restextractforstats" + " | eval _time=strptime(_time, \"%Y-%m-%d %H:%M:%S.%3N %Z\")";
                    tk_data_source_raw_search = "?q=" + encodeURI("| rest count=0 " + tk_elastic_source_from_part1 + " /servicesNS/admin/search/search/jobs/export search=\"" + "search " + tk_elastic_source_from_part2 + " | head 100 | fields _time _raw\"" + " output_mode=\"csv\"" + " earliest_time=\"" + tk_earliest + "\"" + " latest_time=\"" + tk_latest + "\"" + " | head 1 | table value | restextractraw" + " | eval _time=strptime(_time, \"%Y-%m-%d %H:%M:%S.%3N %Z\")");
                    setToken("tk_data_source_timechart_count_aggreg", TokenUtils.replaceTokenNames("sum", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // mstats over rest (uses summary data)
                else if (tk_elastic_source_search_mode == "rest_mstats" && tk_elastic_mstats_filters != "null") {
                    tk_data_source_overview_root_search = "| mstats latest(_value) as value where `trackme_metrics_idx` (metric_name=trackme.eventcount_4h OR metric_name=trackme.lag_event_sec OR metric_name=trackme.hostcount_4h) object_category=\"data_source\" object=\"" + tk_data_name + "\" by metric_name span=5m | eval {metric_name}=value | stats first(trackme.eventcount_4h) as count, first(trackme.lag_event_sec) as delta, max(trackme.hostcount_4h) as dcount_host by _time | eval event_lag=delta";
                    if (tk_elastic_mstats_idx == "null") {
                        tk_data_source_raw_search = "?q=" + encodeURI("| msearch ") + encodeURI("index=*") + " " + encodeURI("filter=\"" + tk_elastic_mstats_filters + "\"") + encodeURI(" earliest=\"-5m\" latest=now");
                    } else {
                        tk_data_source_raw_search = "?q=" + encodeURI("| msearch ") + encodeURI(tk_elastic_mstats_idx) + " " + encodeURI("filter=\"" + tk_elastic_mstats_filters + "\"") + encodeURI(" earliest=\"-5m\" latest=now");
                    }
                    setToken("tk_data_source_timechart_count_aggreg", TokenUtils.replaceTokenNames("latest", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                else
                {
                    tk_data_source_overview_root_search = "| `trackme_tstats` dc(host) as dcount_host count latest(_indextime) as indextime max(_time) as maxtime where index=\"" + tk_data_index + "\" sourcetype=\"" + tk_data_sourcetype + "\" `trackme_tstats_main_filter` by _time, index, sourcetype span=1s | eval delta=(indextime-_time), event_lag=(now() - maxtime)";
                    setToken("tk_data_source_timechart_count_aggreg", TokenUtils.replaceTokenNames("sum", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                setToken("tk_data_source_overview_root_search", TokenUtils.replaceTokenNames(tk_data_source_overview_root_search, _.extend(submittedTokenModel.toJSON(), e.data)));

                // Define the history search

                // Honour elastic sources

                if (tk_elastic_source_search_mode == "null") {

                    // cribl integration
                    if (/\|cribl:/i.test(tk_data_name)) {
                        var search_data_source = 'search' + "?q=search%20index%3D\"" + encodeURI(tk_data_index) + "\"" + " sourcetype%3D\"" + encodeURI(tk_data_sourcetype) + "\"" + " cribl_pipe::" + encodeURI(cribl_pipe)
                    }
                    
                    // split by custom
                    else if (/\|key:/i.test(tk_data_name)) {
                        regex_matches = tk_data_name.match(/\|key:([^\|]+)\|(.*)/);
                        keyName = regex_matches[1];
                        keyValue = regex_matches[2];
                        var search_data_source = 'search' + "?q=search%20index%3D\"" + encodeURI(tk_data_index) + "\"" + " sourcetype%3D\"" + encodeURI(tk_data_sourcetype) + "\" " + keyName + "%3D\"" + encodeURI(keyValue) + "\""
                    }

                    // standard split
                    else {
                        var search_data_source = 'search' + "?q=search%20index%3D\"" + encodeURI(tk_data_index) + "\"" + " sourcetype%3D\"" + encodeURI(tk_data_sourcetype) + "\""
                    }
                    
                } else {
                    var search_data_source = 'search' + tk_data_source_raw_search
                }

                // state
                var tk_data_source_state = tokens.get("tk_data_source_state");

                // priority
                var tk_priority = tokens.get("tk_priority");

                // Define the URL target
                document.getElementById("btn_search_data_source").href = search_data_source;

                // Dynamically manage buttons states
                if (tk_data_monitored_state == "enabled") {
                    document.getElementById('btn_enable_monitoring').disabled = true;
                    document.getElementById('btn_disable_monitoring').disabled = false;
                    setToken("tk_data_monitored_state_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else {
                    document.getElementById('btn_enable_monitoring').disabled = false;
                    document.getElementById('btn_disable_monitoring').disabled = true;
                    setToken("tk_data_monitored_state_class", TokenUtils.replaceTokenNames("title_grey", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Dynamically manage Ack button
                if (tk_data_source_state == "red") {
                    document.getElementById('btn_ack_data_source').disabled = false;
                } else {
                    document.getElementById('btn_ack_data_source').disabled = true;
                }

                // Dynamically manage state color
                if (tk_data_source_state == "green") {
                    setToken("tk_data_source_state_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_data_source_status_message_class", TokenUtils.replaceTokenNames("status_message_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_data_source_state == "orange") {
                    setToken("tk_data_source_state_class", TokenUtils.replaceTokenNames("title_orange", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_data_source_status_message_class", TokenUtils.replaceTokenNames("status_message_orange", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_data_source_state == "blue") {
                    setToken("tk_data_source_state_class", TokenUtils.replaceTokenNames("title_blue", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_data_source_status_message_class", TokenUtils.replaceTokenNames("status_message_blue", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_data_source_state == "red") {
                    setToken("tk_data_source_state_class", TokenUtils.replaceTokenNames("title_red", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_data_source_status_message_class", TokenUtils.replaceTokenNames("status_message_red", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Dynamically manage priority color
                if (tk_priority == "low") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_low_priority", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_priority == "medium") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_medium_priority", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_priority == "high") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_high_priority", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Data sampling

                var tk_data_sampling_status_colour = tokens.get("tk_data_sampling_status_colour");

                if (tk_data_sampling_status_colour == "green") {
                    setToken("tk_data_sampling_status_message_class", TokenUtils.replaceTokenNames("status_message_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_data_sampling_status_colour == "orange") {
                    setToken("tk_data_sampling_status_message_class", TokenUtils.replaceTokenNames("status_message_orange", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_data_sampling_status_colour == "blue") {
                    setToken("tk_data_sampling_status_message_class", TokenUtils.replaceTokenNames("status_message_blue", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_data_sampling_status_colour == "red") {
                    setToken("tk_data_sampling_status_message_class", TokenUtils.replaceTokenNames("status_message_red", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Enable modal context
                $("#modal_manage").modal();

            }
        });

        // Get assets tags
        var elementGetTagsDataHost = new TableElement({
            "id": "elementGetTagsDataHost",
            "count": 100,
            "drilldown": "row",
            "refresh.display": "none",
            "wrap": "true",
            "managerid": "searchGetDataHostTags",
            "el": $('#elementGetTagsDataHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementGetTagsMetricHost = new TableElement({
            "id": "elementGetTagsMetricHost",
            "count": 100,
            "drilldown": "row",
            "refresh.display": "none",
            "wrap": "true",
            "managerid": "searchGetMetricHostTags",
            "el": $('#elementGetTagsMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Ack
        var elementAckGet = new TableElement({
            "id": "elementAckGet",
            "count": 100,
            "drilldown": "row",
            "fields": "object, ack_mtime, ack_expiration, ack_state, comment",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchAckGet",
            "el": $('#elementAckGet')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementAckGet.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("input_object", TokenUtils.replaceTokenNames("$row.object$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("input_object_category", TokenUtils.replaceTokenNames("$row.object_category$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("ack_expiration", TokenUtils.replaceTokenNames("$row.ack_expiration$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("ack_state", TokenUtils.replaceTokenNames("$row.ack_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // check if already inactive
                var ack_state = tokens.get("ack_state");

                if (ack_state === "inactive") {
                    // Enable modal context
                    $("#ack_disable_already").modal();
                }
                else {
                    // Enable modal context
                    $("#disable_ack").modal();
                }

            }
        });

        // Identity card
        var elementIdentityCardTable = new TableElement({
            "id": "elementIdentityCardTable",
            "count": 100,
            "drilldown": "row",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchIdentityCardTable",
            "el": $('#elementIdentityCardTable')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementIdentityCardTable.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_object", TokenUtils.replaceTokenNames("$row.object$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_doc_link", TokenUtils.replaceTokenNames("$row.doc_link$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_doc_note", TokenUtils.replaceTokenNames("$row.doc_note$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // Enable modal context
                $("#confirm_associate_identity_card").modal();

            }
        });

        // Logical group
        var elementLogicalGroupTable = new TableElement({
            "id": "elementLogicalGroupTable",
            "count": 100,
            "drilldown": "row",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchLogicalGroupTable",
            "el": $('#elementLogicalGroupTable')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementLogicalGroupTable.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // Enable modal context
                $("#confirm_remove_from_logical_group").modal();

            }
        });

        // Logical group add member
        var elementLogicalGroupTableAddMember = new TableElement({
            "id": "elementLogicalGroupTableAddMember",
            "count": 5,
            "drilldown": "row",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchLogicalGroupTableAddMember",
            "el": $('#elementLogicalGroupTableAddMember')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementLogicalGroupTableAddMember.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_object_group_name", TokenUtils.replaceTokenNames("$row.object_group_name$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // Enable modal context
                $("#confirm_add_member_logical_group").modal();

            }
        });

        // Audit Flip
        var elementMainTableAuditFlip = new TableElement({
            "id": "elementMainTableAuditFlip",
            "count": 100,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainAuditFlipTable",
            "el": $('#elementMainTableAuditFlip')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditFlipOverTime = new ChartElement({
            "id": "chartAuditFlipOverTime",
            "charting.chart.stackMode": "stacked",
            "charting.chart": "column",
            "charting.drilldown": "all",
            "resizable": true,
            "managerid": "searchAuditFlipOverTime",
            "el": $('#chartAuditFlipOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditFlipTopObject = new ChartElement({
            "id": "chartAuditFlipTopObject",
            "charting.chart": "pie",
            "charting.drilldown": "all",
            "resizable": true,
            "managerid": "searchAuditFlipTopObject",
            "el": $('#chartAuditFlipTopObject')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Audit Changes Data Source
        var elementMainTableAuditChangesDataSource = new TableElement({
            "id": "elementMainTableAuditChangesDataSource",
            "count": 5,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainDataSourceAuditChangesTable",
            "el": $('#elementMainTableAuditChangesDataSource')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditChangesDataSourceOverTime = new ChartElement({
            "id": "chartAuditChangesDataSourceOverTime",
            "charting.chart.stackMode": "stacked",
            "charting.chart": "column",
            "charting.drilldown": "all",
            "charting.axisLabelsY.majorUnit": "1",
            "charting.fieldColors": "{\"success\": 0xb6edb6, \"failure\": 0xFFBABA}",
            "resizable": true,
            "height": "150",
            "managerid": "searchAuditDataSourceAuditChangesOverTime",
            "el": $('#chartAuditChangesDataSourceOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Lagging performance metrics
        var chartLaggingMetricDataSourceOverTime = new ChartElement({
            "id": "chartLaggingMetricDataSourceOverTime",
            "charting.axisX.abbreviation": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.axisTitleY.text": "4h Events count",
            "refresh.display": "progressbar",
            "charting.chart.nullValueMode": "gaps",
            "charting.axisTitleX.visibility": "collapsed",
            "charting.axisTitleY2.text": "$data_source_overview_metrics_chart1_axis$",
            "charting.axisLabelsY2.majorUnit": "$data_source_overview_metrics_chart1_axisUnit$",
            "charting.axisX.scale": "linear",
            "charting.drilldown": "none",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.chart.overlayFields": "lag_event_sec,lag_ingestion_sec,hostcount_4h",
            "charting.chart.showDataLabels": "none",
            "charting.axisTitleY2.visibility": "visible",
            "charting.axisY2.enabled": "1",
            "charting.axisY2.scale": "inherit",
            "trellis.scales.shared": "1",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart.bubbleSizeBy": "area",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.chart.style": "shiny",
            "charting.axisY.scale": "linear",
            "charting.layout.splitSeries": "0",
            "charting.fieldColors": "{\"eventcount_4h\": 0xaec6cf, \"lag_event_sec\": 0x9542f5, \"lag_ingestion_sec\": 0xff6961, \"hostcount_4h\": 0xff6961}",
            "resizable": true,
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.lineWidth": "2",
            "charting.axisTitleY.visibility": "visible",
            "charting.chart.stackMode": "default",
            "charting.legend.placement": "right",
            "trellis.size": "medium",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisY2.abbreviation": "none",
            "charting.chart": "column",
            "charting.axisY.abbreviation": "none",
            "trellis.enabled": "0",
            "managerid": "searchLaggingMetricDataSource",
            "el": $('#chartLaggingMetricDataSourceOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartLaggingMetricDataHostOverTime = new ChartElement({
            "id": "chartLaggingMetricDataHostOverTime",
            "charting.axisX.abbreviation": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.axisTitleY.text": "4h Events count",
            "refresh.display": "progressbar",
            "charting.chart.nullValueMode": "gaps",
            "charting.axisTitleX.visibility": "collapsed",
            "charting.axisTitleY2.text": "lagging (sec)",
            "charting.axisLabelsY2.majorUnit": "0.1",
            "charting.axisX.scale": "linear",
            "charting.drilldown": "none",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.chart.overlayFields": "lag_event_sec,lag_ingestion_sec,host_count_4h",
            "charting.chart.showDataLabels": "none",
            "charting.axisTitleY2.visibility": "visible",
            "charting.axisY2.enabled": "1",
            "charting.axisY2.scale": "inherit",
            "trellis.scales.shared": "1",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart.bubbleSizeBy": "area",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.chart.style": "shiny",
            "charting.axisY.scale": "linear",
            "charting.layout.splitSeries": "0",
            "charting.fieldColors": "{\"eventcount_4h\": 0xaec6cf, \"lag_event_sec\": 0x9542f5, \"lag_ingestion_sec\": 0xff6961}",
            "resizable": true,
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.lineWidth": "2",
            "charting.axisTitleY.visibility": "visible",
            "charting.chart.stackMode": "default",
            "charting.legend.placement": "right",
            "trellis.size": "medium",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisY2.abbreviation": "none",
            "charting.chart": "column",
            "charting.axisY.abbreviation": "none",
            "trellis.enabled": "0",
            "managerid": "searchLaggingMetricDataHost",
            "el": $('#chartLaggingMetricDataHostOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Audit Changes Data Host
        var elementMainTableAuditChangesDataHost = new TableElement({
            "id": "elementMainTableAuditChangesDataHost",
            "count": 5,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainDataHostAuditChangesTable",
            "el": $('#elementMainTableAuditChangesDataHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditChangesDataHostOverTime = new ChartElement({
            "id": "chartAuditChangesDataHostOverTime",
            "charting.chart.stackMode": "stacked",
            "charting.chart": "column",
            "charting.drilldown": "all",
            "charting.axisLabelsY.majorUnit": "1",
            "charting.fieldColors": "{\"success\": 0xb6edb6, \"failure\": 0xFFBABA}",
            "resizable": true,
            "height": "150",
            "managerid": "searchAuditDataHostAuditChangesOverTime",
            "el": $('#chartAuditChangesDataHostOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Audit Changes Metric Host
        var elementMainTableAuditChangesMetricHost = new TableElement({
            "id": "elementMainTableAuditChangesMetricHost",
            "count": 5,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainMetricHostAuditChangesTable",
            "el": $('#elementMainTableAuditChangesMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditChangesMetricHostOverTime = new ChartElement({
            "id": "chartAuditChangesMetricHostOverTime",
            "charting.chart.stackMode": "stacked",
            "charting.chart": "column",
            "charting.drilldown": "all",
            "charting.axisLabelsY.majorUnit": "1",
            "charting.fieldColors": "{\"success\": 0xb6edb6, \"failure\": 0xFFBABA}",
            "resizable": true,
            "height": "150",
            "managerid": "searchAuditMetricHostAuditChangesOverTime",
            "el": $('#chartAuditChangesMetricHostOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Audit Flip Data Source
        var elementMainTableAuditFlipDataSource = new TableElement({
            "id": "elementMainTableAuditFlipDataSource",
            "count": 5,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainDataSourceAuditFlipTable",
            "el": $('#elementMainTableAuditFlipDataSource')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditFlipDataSourceOverTime = new ChartElement({
            "id": "chartAuditFlipDataSourceOverTime",
            "charting.chart.stackMode": "stacked",
            "charting.chart": "column",
            "charting.drilldown": "all",
            "charting.axisLabelsY.majorUnit": "1",
            "charting.fieldColors": "{\"orange\": 0xffd394, \"blue\": 0xcfebf9, \"green\": 0xb6edb6, \"red\": 0xFFBABA}",
            "resizable": true,
            "height": "150",
            "managerid": "searchAuditDataSourceFlipOverTime",
            "el": $('#chartAuditFlipDataSourceOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Audit Flip Data Host
        var elementMainTableAuditFlipDataHost = new TableElement({
            "id": "elementMainTableAuditFlipDataHost",
            "count": 5,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainDataHostAuditFlipTable",
            "el": $('#elementMainTableAuditFlipDataHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditFlipDataHostOverTime = new ChartElement({
            "id": "chartAuditFlipDataHostOverTime",
            "charting.chart.stackMode": "stacked",
            "charting.chart": "column",
            "charting.drilldown": "all",
            "charting.axisLabelsY.majorUnit": "1",
            "charting.fieldColors": "{\"orange\": 0xffd394, \"blue\": 0xcfebf9, \"green\": 0xb6edb6, \"red\": 0xFFBABA}",
            "resizable": true,
            "height": "150",
            "managerid": "searchAuditDataHostFlipOverTime",
            "el": $('#chartAuditFlipDataHostOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Audit Flip Metric Host
        var elementMainTableAuditFlipMetricHost = new TableElement({
            "id": "elementMainTableAuditFlipMetricHost",
            "count": 5,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainMetricHostAuditFlipTable",
            "el": $('#elementMainTableAuditFlipMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditFlipMetricHostOverTime = new ChartElement({
            "id": "chartAuditFlipMetricHostOverTime",
            "charting.chart.stackMode": "stacked",
            "charting.chart": "column",
            "charting.drilldown": "all",
            "charting.axisLabelsY.majorUnit": "1",
            "charting.fieldColors": "{\"orange\": 0xffd394, \"blue\": 0xcfebf9, \"green\": 0xb6edb6, \"red\": 0xFFBABA}",
            "resizable": true,
            "height": "150",
            "managerid": "searchAuditmetricHostFlipOverTime",
            "el": $('#chartAuditFlipMetricHostOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Audit Changes
        var elementMainTableAuditChanges = new TableElement({
            "id": "elementMainTableAuditChanges",
            "count": 100,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "true",
            "managerid": "searchMainAuditChanges",
            "el": $('#elementMainTableAuditChanges')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditChangesTopAction = new ChartElement({
            "id": "chartAuditChangesTopAction",
            "charting.chart": "pie",
            "charting.drilldown": "all",
            "resizable": true,
            "managerid": "searchAuditChangesTopAction",
            "el": $('#chartAuditChangesTopAction')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditChangesTopUser = new ChartElement({
            "id": "chartAuditChangesUser",
            "charting.chart": "pie",
            "charting.drilldown": "all",
            "resizable": true,
            "managerid": "searchAuditChangesTopUser",
            "el": $('#chartAuditChangesTopUser')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditChangesTopChangeType = new ChartElement({
            "id": "chartAuditChangesTopChangeType",
            "charting.chart": "pie",
            "charting.drilldown": "all",
            "resizable": true,
            "managerid": "searchAuditChangesTopChangeType",
            "el": $('#chartAuditChangesTopChangeType')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // data host monitoring

        var elementMainTableHost = new TableElement({
            "id": "elementMainTableHost",
            "count": 20,
            "drilldown": "row",
            "fields": "data_host, sourcetype_summary, \"last time\", \"last ingest\", priority, state, \"lag (event / ingestion)\", data_max_lag_allowed, monitoring, data_monitoring_wdays",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainTableHost",
            "el": $('#elementMainTableHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementMainTableHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                // clean any previously set main token, used for variable purposes
                unsetToken("tk_data_name");
                unsetToken("tk_metric_host");

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_host", TokenUtils.replaceTokenNames("$row.data_host$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_index", TokenUtils.replaceTokenNames("$row.data_index_raw$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_sourcetype", TokenUtils.replaceTokenNames("$row.data_sourcetype_raw$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_host_st_summary", TokenUtils.replaceTokenNames("$row.data_host_st_summary_raw$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_host_alerting_policy", TokenUtils.replaceTokenNames("$row.data_host_alerting_policy$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_lag_seen", TokenUtils.replaceTokenNames("$row.data_last_lag_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_ingestion_lag_seen", TokenUtils.replaceTokenNames("$row.data_last_ingestion_lag_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_lag_summary", TokenUtils.replaceTokenNames("$row.lag (event / ingestion)$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_eventcount", TokenUtils.replaceTokenNames("$row.data_eventcount$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_first_time_seen", TokenUtils.replaceTokenNames("$row.data_first_time_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_time_seen", TokenUtils.replaceTokenNames("$row.data_last_time_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_time_seen_human", TokenUtils.replaceTokenNames("$row.last time$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_ingest", TokenUtils.replaceTokenNames("$row.data_last_ingest$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_ingest_human", TokenUtils.replaceTokenNames("$row.last ingest$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_max_lag_allowed", TokenUtils.replaceTokenNames("$row.data_max_lag_allowed$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_lag_alert_kpis", TokenUtils.replaceTokenNames("$row.data_lag_alert_kpis$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_monitored_state", TokenUtils.replaceTokenNames("$row.data_monitored_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_monitoring_wdays", TokenUtils.replaceTokenNames("$row.data_monitoring_wdays$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_override_lagging_class", TokenUtils.replaceTokenNames("$row.data_override_lagging_class$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_host_state", TokenUtils.replaceTokenNames("$row.data_host_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_tracker_runtime", TokenUtils.replaceTokenNames("$row.data_tracker_runtime$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_previous_host_state", TokenUtils.replaceTokenNames("$row.data_previous_host_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_previous_tracker_runtime", TokenUtils.replaceTokenNames("$row.data_previous_tracker_runtime$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_state", TokenUtils.replaceTokenNames("$row.latest_flip_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_time", TokenUtils.replaceTokenNames("$row.latest_flip_time$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_time_human", TokenUtils.replaceTokenNames("$row.latest_flip_time (translated)$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_priority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // outlier
                setToken("tk_outlierenabledstatus", TokenUtils.replaceTokenNames("$row.enable_behaviour_analytic$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outliermineventcount", TokenUtils.replaceTokenNames("$row.OutlierMinEventCount$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlierlowerthresholdmultiplier", TokenUtils.replaceTokenNames("$row.OutlierLowerThresholdMultiplier$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlierupperthresholdmultiplier", TokenUtils.replaceTokenNames("$row.OutlierUpperThresholdMultiplier$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlieralertonupper", TokenUtils.replaceTokenNames("$row.OutlierAlertOnUpper$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlier_period", TokenUtils.replaceTokenNames("$row.OutlierTimePeriod$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlier_span", TokenUtils.replaceTokenNames("$row.OutlierSpan$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_isoutlier", TokenUtils.replaceTokenNames("$row.isOutlier$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // status message
                setToken("tk_status_message", TokenUtils.replaceTokenNames("$row.status_message$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // tags
                setToken("tk_data_host_tags", TokenUtils.replaceTokenNames("$row.data_host_tags$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pref-fill current lagging input
                setToken("form.tk_input_lag_host", TokenUtils.replaceTokenNames("$row.data_max_lag_allowed$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pref-fill current wdays input
                setToken("form.tk_input_wdays_host", TokenUtils.replaceTokenNames("$row.data_monitoring_wdays$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pre-fill current priority
                setToken("form.tk_input_host_priority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pre-fill lagging class override
                setToken("form.modal_input_lag_override_class_host", TokenUtils.replaceTokenNames("$row.data_override_lagging_class$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pre-fill alert over kpis
                setToken("form.tk_input_data_lag_alert_kpis_host", TokenUtils.replaceTokenNames("$row.data_lag_alert_kpis$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pre-fill alerting policy
                setToken("form.tk_input_host_alerting_policy", TokenUtils.replaceTokenNames("$row.data_host_alerting_policy$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
                var tk_data_host = tokens.get("tk_data_host");

                // state
                var tk_data_host_state = tokens.get("tk_data_host_state");

                // priority
                var tk_priority = tokens.get("tk_priority");

                // Define the history search
                var search_data_host = 'search' + "?q=search%20index%3D\"*\" " + "host=\"" + encodeURI(tk_data_host) + "\""

                // Define the URL target
                document.getElementById("btn_search_data_host").href = search_data_host;

                // Dynamically manage buttons states
                if (tk_data_monitored_state == "enabled") {
                    document.getElementById('btn_enable_monitoring_host').disabled = true;
                    document.getElementById('btn_disable_monitoring_host').disabled = false;
                    setToken("tk_data_monitored_state_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else {
                    document.getElementById('btn_enable_monitoring_host').disabled = false;
                    document.getElementById('btn_disable_monitoring_host').disabled = true;
                    setToken("tk_data_monitored_state_class", TokenUtils.replaceTokenNames("title_grey", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Dynamically manage Ack button
                if (tk_data_host_state == "red") {
                    document.getElementById('btn_ack_data_host').disabled = false;
                } else {
                    document.getElementById('btn_ack_data_host').disabled = true;
                }

                // Dynamically manage state color
                if (tk_data_host_state == "green") {
                    setToken("tk_data_host_state_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_data_host_status_message_class", TokenUtils.replaceTokenNames("status_message_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_data_host_state == "orange") {
                    setToken("tk_data_host_state_class", TokenUtils.replaceTokenNames("title_orange", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_data_host_status_message_class", TokenUtils.replaceTokenNames("status_message_orange", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_data_host_state == "blue") {
                    setToken("tk_data_host_state_class", TokenUtils.replaceTokenNames("title_blue", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_data_host_status_message_class", TokenUtils.replaceTokenNames("status_message_blue", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_data_host_state == "red") {
                    setToken("tk_data_host_state_class", TokenUtils.replaceTokenNames("title_red", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_data_host_status_message_class", TokenUtils.replaceTokenNames("status_message_red", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Dynamically manage priority color
                if (tk_priority == "low") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_low_priority", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_priority == "medium") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_medium_priority", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_priority == "high") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_high_priority", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Manage Outliers
                var tk_outlierenabledstatus = tokens.get("tk_outlierenabledstatus");
                var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
                var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
                var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
                var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
                var tk_isoutlier = tokens.get("tk_isoutlier");
                var tk_outlier_span = tokens.get("tk_outlier_span");
                var tk_outlier_period = tokens.get("tk_outlier_period");

                // Outliers configuration

                // prefill the current status
                if (tk_outlierenabledstatus && tk_outlierenabledstatus == "true") {
                    setToken("form.tk_input_data_host_enable_outlier", TokenUtils.replaceTokenNames("true", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else {
                    setToken("form.tk_input_data_host_enable_outlier", TokenUtils.replaceTokenNames("false", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // prefill the current lower multiplier
                if (tk_outlierlowerthresholdmultiplier && isNumeric(tk_outlierlowerthresholdmultiplier)) {
                    setToken("form.tk_input_data_host_outlier_lower_threshold_multiplier", TokenUtils.replaceTokenNames(tk_outlierlowerthresholdmultiplier, _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // prefill the current upper multiplier
                if (tk_outlierupperthresholdmultiplier && isNumeric(tk_outlierupperthresholdmultiplier)) {
                    setToken("form.tk_input_data_host_outlier_upper_threshold_multiplier", TokenUtils.replaceTokenNames(tk_outlierupperthresholdmultiplier, _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Define the Outliers lowerbound mode
                if (tk_outliermineventcount && isNumeric(tk_outliermineventcount) && tk_outliermineventcount > 0) {
                    setToken("form.tk_input_data_host_outlier_min_eventcount_mode", TokenUtils.replaceTokenNames("static", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("form.tk_input_data_host_outlier_min_eventcount", TokenUtils.replaceTokenNames(tk_outliermineventcount, _.extend(submittedTokenModel.toJSON(), e.data)));
                }
                else {
                    setToken("form.tk_input_data_host_outlier_min_eventcount_mode", TokenUtils.replaceTokenNames("dynamic", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("form.tk_input_data_host_outlier_min_eventcount", TokenUtils.replaceTokenNames("disabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // prefill the current status
                if (tk_outlieralertonupper && tk_outlieralertonupper != "null") {
                    setToken("form.tk_input_data_host_outlier_alert_on_upper", TokenUtils.replaceTokenNames(tk_outlieralertonupper, _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // prefill the outlier span
                if (tk_outlier_span && tk_outlier_span != "null") {
                    setToken("form.TimeOutlierConfigurationDataHostSpan", TokenUtils.replaceTokenNames(tk_outlier_span, _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // prefill the outlier period
                if (tk_outlier_period && tk_outlier_period != "null") {
                    setToken("form.TimeOutlierConfigurationDataHost", TokenUtils.replaceTokenNames(tk_outlier_period, _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Explicitly refresh the get tags search
                searchGetDataHostTags.startSearch();

                // Enable modal context
                $("#modal_manage_host").modal();

            }
        });

        // Metric host monitoring

        var elementMainTableMetricHost = new TableElement({
            "id": "elementMainTableMetricHost",
            "count": 20,
            "drilldown": "row",
            "fields": "metric_host, metric_index, metric_category, metric_details_human, \"last time\", priority, state, monitoring",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainTableMetricHost",
            "el": $('#elementMainTableMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementMainTableMetricHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                // clean any previously set main token, used for variable purposes
                unsetToken("tk_data_name");
                unsetToken("tk_data_host");

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_host", TokenUtils.replaceTokenNames("$row.metric_host$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_index", TokenUtils.replaceTokenNames("$row.metric_index_raw$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_category", TokenUtils.replaceTokenNames("$row.metric_category_raw$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_first_time_seen", TokenUtils.replaceTokenNames("$row.metric_first_time_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_last_time_seen", TokenUtils.replaceTokenNames("$row.metric_last_time_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_last_time_seen_human", TokenUtils.replaceTokenNames("$row.last time$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_last_lag_seen", TokenUtils.replaceTokenNames("$row.metric_last_lag_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_details", TokenUtils.replaceTokenNames("$row.metric_details_raw$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_monitored_state", TokenUtils.replaceTokenNames("$row.metric_monitored_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_host_state", TokenUtils.replaceTokenNames("$row.metric_host_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_tracker_runtime", TokenUtils.replaceTokenNames("$row.metric_tracker_runtime$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_previous_host_state", TokenUtils.replaceTokenNames("$row.metric_previous_host_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_previous_tracker_runtime", TokenUtils.replaceTokenNames("$row.metric_previous_tracker_runtime$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_state", TokenUtils.replaceTokenNames("$row.latest_flip_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_time", TokenUtils.replaceTokenNames("$row.latest_flip_time$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_time_human", TokenUtils.replaceTokenNames("$row.latest_flip_time (translated)$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_priority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pre-fill current priority
                setToken("form.tk_input_metric_host_priority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // logical group
                setToken("tk_object_group_name", TokenUtils.replaceTokenNames("$row.object_group_name$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_object_group_state", TokenUtils.replaceTokenNames("$row.object_group_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_object_group_green_percent", TokenUtils.replaceTokenNames("$row.object_group_green_percent$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_object_group_min_green_percent", TokenUtils.replaceTokenNames("$row.object_group_min_green_percent$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // status message
                setToken("tk_status_message", TokenUtils.replaceTokenNames("$row.status_message$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_metric_monitored_state = tokens.get("tk_metric_monitored_state");
                var tk_metric_host = tokens.get("tk_metric_host");

                // state
                var tk_metric_host_state = tokens.get("tk_metric_host_state");

                // priority
                var tk_priority = tokens.get("tk_priority");

                // Define the history search
                var search_metric_host = '| mcatalog values(metric_name), values(_dims) where index=* host=\"' + tk_metric_host + '\" by host'
                search_metric_host = 'search' + "?q=" + encodeURI(search_metric_host) + '&earliest=-15m&latest=now'

                // Define the history msearch
                var msearch_metric_host = '| msearch index=* filter=\"host=\"' + tk_metric_host + '\"\"'
                msearch_metric_host = 'search' + "?q=" + encodeURI(msearch_metric_host) + '&earliest=-15m&latest=now'

                // Define the history msearch
                var mpreview_metric_host = '| mpreview index=* filter=\"host=\"' + tk_metric_host + '\"\"'
                mpreview_metric_host = 'search' + "?q=" + encodeURI(mpreview_metric_host) + '&earliest=-15m&latest=now'

                // Define the URL target
                document.getElementById("btn_search_metric_host").href = search_metric_host;
                document.getElementById("btn_msearch_metric_host").href = msearch_metric_host;
                document.getElementById("btn_mpreview_metric_host").href = mpreview_metric_host;

                var search_metric_host_live_report = '| savedsearch \"trackMe - metric host live report\" host=\"' + tk_metric_host + '"'
                search_metric_host_live_report = 'search' + "?q=" + encodeURI(search_metric_host_live_report) + '&earliest=-15m&latest=now'

                // Define the URL target
                document.getElementById("btn_search_metric_host_live_report").href = search_metric_host_live_report;

                // Dynamically manage buttons states
                if (tk_metric_monitored_state == "enabled") {
                    document.getElementById('btn_enable_monitoring_metric_host').disabled = true;
                    document.getElementById('btn_disable_monitoring_metric_host').disabled = false;
                    setToken("tk_metric_monitored_state_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else {
                    document.getElementById('btn_enable_monitoring_metric_host').disabled = false;
                    document.getElementById('btn_disable_monitoring_metric_host').disabled = true;
                    setToken("tk_metric_monitored_state_class", TokenUtils.replaceTokenNames("title_grey", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Dynamically manage Ack button
                if (tk_metric_host_state == "red") {
                    document.getElementById('btn_ack_metric_host').disabled = false;
                } else {
                    document.getElementById('btn_ack_metric_host').disabled = true;
                }

                // Dynamically manage state color
                if (tk_metric_host_state == "green") {
                    setToken("tk_metric_host_state_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_metric_host_status_message_class", TokenUtils.replaceTokenNames("status_message_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_metric_host_state == "orange") {
                    setToken("tk_metric_host_state_class", TokenUtils.replaceTokenNames("title_orange", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_metric_host_status_message_class", TokenUtils.replaceTokenNames("status_message_orange", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_metric_host_state == "blue") {
                    setToken("tk_metric_host_state_class", TokenUtils.replaceTokenNames("title_blue", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_metric_host_status_message_class", TokenUtils.replaceTokenNames("status_message_blue", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_metric_host_state == "red") {
                    setToken("tk_metric_host_state_class", TokenUtils.replaceTokenNames("title_red", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_metric_host_status_message_class", TokenUtils.replaceTokenNames("status_message_red", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Dynamically manage priority color
                if (tk_priority == "low") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_low_priority", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_priority == "medium") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_medium_priority", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_priority == "high") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_high_priority", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Explicitly refresh the get tags search
                searchGetMetricHostTags.startSearch();

                // Enable modal context
                $("#modal_manage_metric_host").modal();

            }
        });

        var elementHostTableMetricHost = new TableElement({
            "id": "elementHostTableMetricHost",
            "count": 5,
            "drilldown": "none",
            "fields": "metric_category, metric_last_time, metric_max_lag_allowed, metric_current_lag_sec, duration, state",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchHostTableMetricHost",
            "el": $('#elementHostTableMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementHostChartMetricHost = new ChartElement({
            "id": "elementHostChartMetricHost",
            "charting.chart": "pie",
            "charting.drilldown": "all",
            "charting.fieldColors": "{\"red\": 0xff6961, \"orange\": 0xffb347, \"blue\": 0x89cff0, \"green\": 0x77dd77}",
            "height": "180",
            "resizable": true,
            "managerid": "searchHostChartMetricHost",
            "el": $('#elementHostChartMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSingleSLAMetricHostpct = new SingleElement({
            "id": "elementSingleSLAMetricHostpct",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "all",
            "height": "60",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "%",
            "rangeColors": "[\"0xdc4e41\",\"0xf1813f\",\"0x77dd77\"]",
            "colorMode": "none",
            "rangeValues": "[50,90]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "useThousandSeparators": "1",
            "underLabel": "SLA PCT (% time spent in green/blue over 90d)",
            "managerid": "searchSingleSLAMetricHostpct",
            "el": $('#elementSingleSLAMetricHostpct')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementSingleSLAMetricHostpct.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                var url = TokenUtils.replaceTokenNames("{{SPLUNKWEB_URL_PREFIX}}/app/trackme/trackMe_qos?form.timerange.earliest=-90d%40d&form.timerange.latest=now&form.object_category=metric_host&form.object_freetext=*&form.object=$tk_metric_host$&form.priority=*", _.extend(submittedTokenModel.toJSON(), e.data), TokenUtils.getEscaper('url'), TokenUtils.getFilters(mvc.Components));
                utils.redirect(url, false, "_blank");
            }
        });

        // Data Sampling

        var tableDataSamplingSummary = new TableElement({
            "id": "tableDataSamplingSummary",
            "tokenDependencies": {
                "depends": "$show_data_sampling$"
            },
            "count": 8,
            "drilldown": "none",
            "fields": "feature, current_detected_format, \" \", previous_detected_format, state, anomaly_reason, multiformat, mtime, data_sampling_nr",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchDataSamplingTable1",
            "el": $('#tableDataSamplingSummary')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var tableDataSamplingShowBuiltinRules = new TableElement({
            "id": "tableDataSamplingShowBuiltinRules",
            "tokenDependencies": {
                "depends": "$show_data_sampling$"
            },
            "count": 8,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchDataSamplingShowBuiltinRules",
            "el": $('#tableDataSamplingShowBuiltinRules')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var tableDataSamplingShowCustomRules = new TableElement({
            "id": "tableDataSamplingShowCustomRules",
            "tokenDependencies": {
                "depends": "$show_data_sampling_custom_rules$",
                "depends": "$show_table_data_sampling_custom_rules$"
            },
            "count": 8,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchDataSamplingShowCustomRules",
            "el": $('#tableDataSamplingShowCustomRules')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Smart Status

        var eventSmartStatusDataSource = new EventElement({
            "id": "eventSmartStatusDataSource",
            "list.drilldown": "none",
            "table.drilldown": "all",
            "list.wrap": "1",
            "table.wrap": "1",
            "rowNumbers": "0",
            "table.sortDirection": "asc",
            "count": 20,
            "raw.drilldown": "full",
            "type": "list",
            "maxLines": 5,
            "managerid": "searchSmartStatusDataSource",
            "el": $('#eventSmartStatusDataSource')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var eventSmartStatusDataHost = new EventElement({
            "id": "eventSmartStatusDataHost",
            "list.drilldown": "none",
            "table.drilldown": "all",
            "list.wrap": "1",
            "table.wrap": "1",
            "rowNumbers": "0",
            "table.sortDirection": "asc",
            "count": 20,
            "raw.drilldown": "full",
            "type": "list",
            "maxLines": 5,
            "managerid": "searchSmartStatusDataHost",
            "el": $('#eventSmartStatusDataHost')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var eventSmartStatusMetricHost = new EventElement({
            "id": "eventSmartStatusMetricHost",
            "list.drilldown": "none",
            "table.drilldown": "all",
            "list.wrap": "1",
            "table.wrap": "1",
            "rowNumbers": "0",
            "table.sortDirection": "asc",
            "count": 20,
            "raw.drilldown": "full",
            "type": "list",
            "maxLines": 5,
            "managerid": "searchSmartStatusMetricHost",
            "el": $('#eventSmartStatusMetricHost')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        // tags policies
        var tableTagsPolicies = new TableElement({
            "id": "tableTagsPolicies",
            "tokenDependencies": {
                "depends": "$show_tags_policies$"
            },
            "count": 8,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchShowTagsPolicies",
            "el": $('#tableTagsPolicies')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var modal_input_tags_policies_policy_id = new TextInput({
            "id": "modal_input_tags_policies_id",
            "searchWhenChanged": false,
            "value": "$form.tk_tags_policies_policy_id$",
            "el": $('#modal_input_tags_policies_policy_id')
        }, {
            tokens: true
        }).render();

        modal_input_tags_policies_policy_id.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_tags_policies_policy_id);
        });

       // Simulation
       var tableTagsPoliciesSimulate = new TableElement({
            "id": "tableTagsPoliciesSimulate",
            "tokenDependencies": {
                "depends": "$start_simulation_tags_policies$"
            },
            "count": 1,
            "drilldown": "row",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchTagsPoliciesSimulate",
            "el": $('#tableTagsPoliciesSimulate')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Data sampling

        // Simulation
        var tableDataSamplingSimulateCustomRule = new TableElement({
            "id": "tableDataSamplingSimulateCustomRule",
            "tokenDependencies": {
                "depends": "$start_simulation_data_sampling_custom_rule$"
            },
            "count": 1,
            "drilldown": "row",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchDataSamplingSimulateCustomRule",
            "el": $('#tableDataSamplingSimulateCustomRule')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var tableDataSamplingSimulateCustomRuleLatestEvent = new TableElement({
            "id": "tableDataSamplingSimulateCustomRuleLatestEvent",
            "tokenDependencies": {
                "depends": "$start_simulation_data_sampling_custom_rule_show_events$"
            },
            "count": 5,
            "drilldown": "row",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchDataSamplingSimulateCustomRuleLatestEvent",
            "el": $('#tableDataSamplingSimulateCustomRuleLatestEvent')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Metric SLA policies

        var tableMetricPolicies = new TableElement({
            "id": "tableMetricPolicies",
            "tokenDependencies": {
                "depends": "$show_table_metric_policies$"
            },
            "count": 8,
            "drilldown": "none",
            "fields": "metric_category, metric_max_lag_allowed, select",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMetricPolicies",
            "el": $('#tableMetricPolicies')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Custom lagging

        var tableCustomLagging = new TableElement({
            "id": "tableCustomLagging",
            "tokenDependencies": {
                "depends": "$show_table_custom_lagging$"
            },
            "count": 5,
            "drilldown": "none",
            "fields": "level, name, object, value, select",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchCustomLagging",
            "el": $('#tableCustomLagging')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Elastic Sources Shared

        var tableElasticSources = new TableElement({
            "id": "tableElasticSources",
            "tokenDependencies": {
                "depends": "$show_table_elastic_sources$"
            },
            "count": 8,
            "drilldown": "none",
            "fields": "data_name, search_mode, search_constraint, elastic_data_index, elastic_data_sourcetype, select",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchElasticSources",
            "el": $('#tableElasticSources')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Elastic Sources Dedicated

        var tableElasticSourcesDedicated = new TableElement({
            "id": "tableElasticSourcesDedicated",
            "tokenDependencies": {
                "depends": "$show_table_elastic_sources_dedicated$"
            },
            "count": 8,
            "drilldown": "none",
            "fields": "data_name, search_mode, search_constraint, elastic_data_index, elastic_data_sourcetype, select",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchElasticSourcesDedicated",
            "el": $('#tableElasticSourcesDedicated')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Simulation
        var tableElasticSourcesTest = new TableElement({
            "id": "tableElasticSourcesTest",
            "tokenDependencies": {
                "depends": "$start_simulation_elastic_sources$"
            },
            "count": 1,
            "drilldown": "row",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchElasticSourcesTest",
            "el": $('#tableElasticSourcesTest')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // whitelist

        // whitelist data_source

        var tableWhiteListDataSource = new TableElement({
            "id": "tableWhiteListDataSource",
            "tokenDependencies": {
                "depends": "$show_table_data_source_whitelist$",
            },
            "count": 5,
            "drilldown": "none",
            "fields": "data_index, select",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchWhiteListDataSource",
            "el": $('#tableWhiteListDataSource')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // whitelist data_host

        var tableWhiteListDataHost = new TableElement({
            "id": "tableWhiteListDataHost",
            "tokenDependencies": {
                "depends": "$show_table_data_host_whitelist$",
            },
            "count": 5,
            "drilldown": "none",
            "fields": "data_index, select",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchWhiteListDataHost",
            "el": $('#tableWhiteListDataHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // whitelist metric_host

        var tableWhiteListMetricHost = new TableElement({
            "id": "tableWhiteListMetricHost",
            "tokenDependencies": {
                "depends": "$show_table_metric_host_whitelist$",
            },
            "count": 5,
            "drilldown": "none",
            "fields": "metric_index, select",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchWhiteListMetricHost",
            "el": $('#tableWhiteListMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // blacklist

        var tableBlackListDataSourceHost = new TableElement({
            "id": "tableBlackListDataSourceHost",
            "tokenDependencies": {
                "depends": "$show_table_data_source_blacklist_host$"
            },
            "count": 5,
            "drilldown": "none",
            "fields": "data_host, is_rex, select",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListDataSourceHost",
            "el": $('#tableBlackListDataSourceHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var tableBlackListDataSourceIndex = new TableElement({
            "id": "tableBlackListDataSourceIndex",
            "tokenDependencies": {
                "depends": "$show_table_data_source_blacklist_index$",
            },
            "count": 5,
            "drilldown": "none",
            "fields": "data_index, is_rex, select",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListDataSourceIndex",
            "el": $('#tableBlackListDataSourceIndex')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var tableBlackListDataSourceSourcetype = new TableElement({
            "id": "tableBlackListDataSourceSourcetype",
            "tokenDependencies": {
                "depends": "$show_table_data_source_blacklist_sourcetype$"
            },
            "count": 5,
            "drilldown": "none",
            "fields": "data_sourcetype, is_rex, select",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListDataSourceSourcetype",
            "el": $('#tableBlackListDataSourceSourcetype')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var tableBlackListDataSourceDataName = new TableElement({
            "id": "tableBlackListDataSourceDataName",
            "tokenDependencies": {
                "depends": "$show_table_data_source_blacklist_data_name$"
            },
            "count": 5,
            "drilldown": "none",
            "fields": "data_name, is_rex, select",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListDataSourceDataName",
            "el": $('#tableBlackListDataSourceDataName')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var tableBlackListDataHostHost = new TableElement({
            "id": "tableBlackListDataHostHost",
            "tokenDependencies": {
                "depends": "$show_table_data_host_blacklist_host$"
            },
            "count": 5,
            "drilldown": "none",
            "fields": "data_host, is_rex, select",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListDataHostHost",
            "el": $('#tableBlackListDataHostHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var tableBlackListDataHostIndex = new TableElement({
            "id": "tableBlackListDataHostIndex",
            "tokenDependencies": {
                "depends": "$show_table_data_host_blacklist_index$"
            },
            "count": 5,
            "drilldown": "none",
            "fields": "data_index, is_rex, select",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListDataHostIndex",
            "el": $('#tableBlackListDataHostIndex')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var tableBlackListMetricHostIndex = new TableElement({
            "id": "tableBlackListMetricHostIndex",
            "tokenDependencies": {
                "depends": "$show_table_metric_host_blacklist_index$"
            },
            "count": 5,
            "drilldown": "none",
            "fields": "metric_index, is_rex, select",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListMetricHostIndex",
            "el": $('#tableBlackListMetricHostIndex')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var tableBlackListDataHostSourcetype = new TableElement({
            "id": "tableBlackListDataHostSourcetype",
            "tokenDependencies": {
                "depends": "$show_table_data_host_blacklist_sourcetype$"
            },
            "count": 5,
            "drilldown": "none",
            "fields": "data_sourcetype, is_rex, select",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListDataHostSourcetype",
            "el": $('#tableBlackListDataHostSourcetype')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var tableBlackListMetricHostHost = new TableElement({
            "id": "tableBlackListMetricHostHost",
            "tokenDependencies": {
                "depends": "$show_table_metric_host_blacklist_host$"
            },
            "count": 5,
            "drilldown": "none",
            "fields": "metric_host, is_rex, select",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListMetricHostHost",
            "el": $('#tableBlackListMetricHostHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var tableBlackListMetricHostMetricCategory = new TableElement({
            "id": "tableBlackListMetricHostMetricCategory",
            "tokenDependencies": {
                "depends": "$show_table_metric_host_blacklist_metric_category$"
            },
            "count": 5,
            "drilldown": "none",
            "fields": "metric_category, is_rex, select",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListMetricHostMetricCategory",
            "el": $('#tableBlackListMetricHostMetricCategory')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // modal window chart
        var elementChartLag = new ChartElement({
            "id": "elementChartLag",
            "charting.axisX.abbreviation": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.axisTitleY.text": "Events count",
            "refresh.display": "progressbar",
            "charting.chart.nullValueMode": "gaps",
            "charting.axisTitleX.visibility": "collapsed",
            "charting.axisTitleY2.text": "$data_source_overview_chart1_axis$",
            "charting.axisLabelsY2.majorUnit": "$data_source_overview_chart1_axisUnit$",
            "charting.axisX.scale": "linear",
            "charting.drilldown": "none",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.chart.overlayFields": "avg_lag_sec,dcount_host",
            "charting.chart.showDataLabels": "none",
            "charting.axisTitleY2.visibility": "visible",
            "charting.axisY2.enabled": "1",
            "charting.axisY2.scale": "inherit",
            "trellis.scales.shared": "1",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart.bubbleSizeBy": "area",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.chart.style": "shiny",
            "charting.axisY.scale": "linear",
            "charting.layout.splitSeries": "0",
            "charting.fieldColors": "{\"events_count\": 0xaec6cf, \"avg_lag_sec\": 0x8b0000, \"dcount_host\": 0x8b0000}",
            "resizable": true,
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.lineWidth": "2",
            "charting.axisTitleY.visibility": "visible",
            "charting.chart.stackMode": "default",
            "charting.legend.placement": "right",
            "trellis.size": "medium",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisY2.abbreviation": "none",
            "charting.chart": "column",
            "charting.axisY.abbreviation": "none",
            "trellis.enabled": "0",
            "managerid": "searchChartLag",
            "el": $('#elementChartLag')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // data source monitoring

        // Data Parsing Quality
        var elementSearchDataSourceParsingQualityChart = new ChartElement({
            "id": "elementSearchDataSourceParsingQualityChart",
            "charting.chart.nullValueMode": "gaps",
            "resizable": true,
            "trellis.enabled": "0",
            "charting.axisTitleX.visibility": "collapsed",
            "refresh.display": "progressbar",
            "charting.chart.stackMode": "stacked",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisY.abbreviation": "none",
            "charting.legend.placement": "bottom",
            "charting.axisY2.abbreviation": "none",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.chart.showDataLabels": "none",
            "charting.axisY2.enabled": "0",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.style": "shiny",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart": "column",
            "charting.axisX.scale": "linear",
            "trellis.scales.shared": "1",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.drilldown": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "trellis.size": "medium",
            "charting.axisY.scale": "linear",
            "charting.chart.bubbleSizeBy": "area",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisX.abbreviation": "none",
            "charting.layout.splitSeries": "0",
            "charting.lineWidth": "2",
            "charting.axisY2.scale": "inherit",
            "managerid": "SearchDataSourceParsingQualityChart",
            "el": $('#elementSearchDataSourceParsingQualityChart')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSearchDataSourceParsingQualitySingle = new SingleElement({
            "id": "elementSearchDataSourceParsingQualitySingle",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "all",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "height": "50",
            "unit": "",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "SUMMARY OF INDEXING TIME PARSING ERRORS (click to drilldown in a new tab)",
            "managerid": "SearchDataSourceParsingQualitySingle",
            "el": $('#elementSearchDataSourceParsingQualitySingle')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementSearchDataSourceParsingQualitySingle.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                var url = TokenUtils.replaceTokenNames("{{SPLUNKWEB_URL_PREFIX}}/app/trackme/search?q=index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=LineBreakingProcessor OR component=AggregatorMiningProcessor OR component=DateParserVerbose | `trackme_data_quality_parse` | search data_sourcetype=\"$tk_data_sourcetype$\"", _.extend(submittedTokenModel.toJSON(), e.data), TokenUtils.getEscaper('url'), TokenUtils.getFilters(mvc.Components));
                utils.redirect(url, false, "_blank");
            }
        });

        // Outliers
        var elementOutlier = new VisualizationElement({
            "id": "elementOutlier",
            "type": "Splunk_ML_Toolkit.OutliersViz",
            "resizable": true,
            "Splunk_ML_Toolkit.OutliersViz.showOutlierCount": "true",
            "drilldown": "none",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "height": "350",
            "managerid": "searchOutlierDetectionChart",
            "el": $('#elementOutlier')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var elementOutlierSimulation = new VisualizationElement({
            "id": "elementOutlierSimulation",
            "type": "Splunk_ML_Toolkit.OutliersViz",
            "resizable": true,
            "Splunk_ML_Toolkit.OutliersViz.showOutlierCount": "true",
            "drilldown": "none",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "height": "300",
            "managerid": "searchOutlierDetectionChartSimulation",
            "el": $('#elementOutlierSimulation')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var elementOutlierTable = new TableElement({
            "id": "elementOutlierTable",
            "count": 100,
            "dataOverlayMode": "none",
            "drilldown": "none",
            "percentagesRow": "false",
            "rowNumbers": "false",
            "totalsRow": "false",
            "wrap": "true",
            "managerid": "searchOutlierDetectionTable",
            "el": $('#elementOutlierTable')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        // modal Single AutoLag
        var elementDataSourceAutoLaggingDataSourceSingleLagPerc95 = new SingleElement({
            "id": "elementDataSourceAutoLaggingDataSourceSingleLagPerc95",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "LAST 7 DAYS PERCENTILE 95 AUTO LAG",
            "managerid": "searchSingleLagAutoLaggingDataSource7dSingleLagPerc95",
            "el": $('#elementDataSourceAutoLaggingDataSourceSingleLagPerc95')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementDataSourceAutoLaggingDataSourceSingleLagAvg = new SingleElement({
            "id": "elementDataSourceAutoLaggingDataSourceSingleLagAvg",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "LAST 7 DAYS AVERAGE AUTO LAG",
            "managerid": "searchSingleLagAutoLaggingDataSource7dSingleLagAvg",
            "el": $('#elementDataSourceAutoLaggingDataSourceSingleLagAvg')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementDataSourceAutoLaggingDataSourceSingleLagPerc95Last30d = new SingleElement({
            "id": "elementDataSourceAutoLaggingDataSourceSingleLagPerc95Last30d",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "LAST 30 DAYS PERCENTILE 95 AUTO LAG",
            "managerid": "searchSingleLagAutoLaggingDataSource30dSingleLagPerc95",
            "el": $('#elementDataSourceAutoLaggingDataSourceSingleLagPerc95Last30d')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementDataSourceAutoLaggingDataSourceSingleLagAvgLast30d = new SingleElement({
            "id": "elementDataSourceAutoLaggingDataSourceSingleLagAvgLast30d",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "LAST 30 DAYS AVERAGE AUTO LAG",
            "managerid": "searchSingleLagAutoLaggingDataSource30dSingleLagAvg",
            "el": $('#elementDataSourceAutoLaggingDataSourceSingleLagAvgLast30d')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // modal Single AutoLag
        var elementDataHostAutoLaggingDataHostSingleLagPerc95 = new SingleElement({
            "id": "elementDataHostAutoLaggingDataHostSingleLagPerc95",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "LAST 7 DAYS PERCENTILE 95 AUTO LAG",
            "managerid": "searchSingleLagAutoLaggingDataHost7dSingleLagPerc95",
            "el": $('#elementDataHostAutoLaggingDataHostSingleLagPerc95')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementDataHostAutoLaggingDataHostSingleLagAvg = new SingleElement({
            "id": "elementDataHostAutoLaggingDataHostSingleLagAvg",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "LAST 7 DAYS AVERAGE AUTO LAG",
            "managerid": "searchSingleLagAutoLaggingDataHost7dSingleLagAvg",
            "el": $('#elementDataHostAutoLaggingDataHostSingleLagAvg')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementDataHostAutoLaggingDataHostSingleLagPerc95Last30d = new SingleElement({
            "id": "elementDataHostAutoLaggingDataHostSingleLagPerc95Last30d",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "LAST 30 DAYS PERCENTILE 95 AUTO LAG",
            "managerid": "searchSingleLagAutoLaggingDataHost30dSingleLagPerc95",
            "el": $('#elementDataHostAutoLaggingDataHostSingleLagPerc95Last30d')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementDataHostAutoLaggingDataHostSingleLagAvgLast30d = new SingleElement({
            "id": "elementDataHostAutoLaggingDataHostSingleLagAvgLast30d",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "LAST 30 DAYS AVERAGE AUTO LAG",
            "managerid": "searchSingleLagAutoLaggingDataHost30dSingleLagAvg",
            "el": $('#elementDataHostAutoLaggingDataHostSingleLagAvgLast30d')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // modal Single Lag
        var elementSingleLagPerc95 = new SingleElement({
            "id": "elementSingleLagPerc95",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "PERC95 INGESTION LAG (sec or [D+]HH:MM:SS)",
            "managerid": "searchSingleLagPerc95",
            "el": $('#elementSingleLagPerc95')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSingleLagAvg = new SingleElement({
            "id": "elementSingleLagAvg",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "AVG INGESTION LAG (sec or [D+]HH:MM:SS)",
            "managerid": "searchSingleLagAvg",
            "el": $('#elementSingleLagAvg')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSingleEventLag = new SingleElement({
            "id": "elementSingleEventLag",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "CURRENT EVENT LAG (sec or [D+]HH:MM:SS)",
            "managerid": "searchSingleEventLag",
            "el": $('#elementSingleEventLag')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSingleSLApct = new SingleElement({
            "id": "elementSingleSLApct",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "all",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "%",
            "rangeColors": "[\"0xdc4e41\",\"0xf1813f\",\"0x77dd77\"]",
            "colorMode": "none",
            "rangeValues": "[50,90]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "useThousandSeparators": "1",
            "underLabel": "SLA PCT (% time spent in green/blue over 90d)",
            "managerid": "searchSingleSLApct",
            "el": $('#elementSingleSLApct')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementSingleSLApct.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                var url = TokenUtils.replaceTokenNames("{{SPLUNKWEB_URL_PREFIX}}/app/trackme/trackMe_qos?form.timerange.earliest=-90d%40d&form.timerange.latest=now&form.object_category=data_source&form.object_freetext=*&form.object=$tk_data_name$&form.priority=*", _.extend(submittedTokenModel.toJSON(), e.data), TokenUtils.getEscaper('url'), TokenUtils.getFilters(mvc.Components));
                utils.redirect(url, false, "_blank");
            }
        });

        // modal Single Lag
        var elementSingleLagByMetricsPerc95 = new SingleElement({
            "id": "elementSingleLagByMetricsPerc95",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "PERC95 INGESTION LAG (sec or [D+]HH:MM:SS)",
            "managerid": "searchSingleLagByMetricsPerc95",
            "el": $('#elementSingleLagByMetricsPerc95')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSingleLagByMetricsAvg = new SingleElement({
            "id": "elementSingleLagByMetricsAvg",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "AVG INGESTION LAG (sec or [D+]HH:MM:SS)",
            "managerid": "searchSingleLagByMetricsAvg",
            "el": $('#elementSingleLagByMetricsAvg')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSingleEventByMetricsLag = new SingleElement({
            "id": "elementSingleEventByMetricsLag",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "CURRENT EVENT LAG (sec or [D+]HH:MM:SS)",
            "managerid": "searchSingleEventByMetricsLag",
            "el": $('#elementSingleEventByMetricsLag')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // data host monitoring

        // Data Parsing Quality
        var elementSearchDataHostParsingQualityChart = new ChartElement({
            "id": "elementSearchDataHostParsingQualityChart",
            "charting.chart.nullValueMode": "gaps",
            "resizable": true,
            "trellis.enabled": "0",
            "charting.axisTitleX.visibility": "collapsed",
            "refresh.display": "progressbar",
            "charting.chart.stackMode": "stacked",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisY.abbreviation": "none",
            "charting.legend.placement": "bottom",
            "charting.axisY2.abbreviation": "none",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.chart.showDataLabels": "none",
            "charting.axisY2.enabled": "0",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.style": "shiny",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart": "column",
            "charting.axisX.scale": "linear",
            "trellis.scales.shared": "1",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.drilldown": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "trellis.size": "medium",
            "charting.axisY.scale": "linear",
            "charting.chart.bubbleSizeBy": "area",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisX.abbreviation": "none",
            "charting.layout.splitSeries": "0",
            "charting.lineWidth": "2",
            "charting.axisY2.scale": "inherit",
            "managerid": "SearchDataHostParsingQualityChart",
            "el": $('#elementSearchDataHostParsingQualityChart')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSearchDataHostParsingQualitySingle = new SingleElement({
            "id": "elementSearchDataHostParsingQualitySingle",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "all",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "height": "50",
            "unit": "",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "SUMMARY OF INDEXING TIME PARSING ERRORS (click to drilldown in a new tab)",
            "managerid": "SearchDataHostParsingQualitySingle",
            "el": $('#elementSearchDataHostParsingQualitySingle')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementSearchDataHostParsingQualitySingle.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                var url = TokenUtils.replaceTokenNames("{{SPLUNKWEB_URL_PREFIX}}/app/trackme/search?q=index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=LineBreakingProcessor OR component=AggregatorMiningProcessor OR component=DateParserVerbose | `trackme_data_quality_parse` | search data_host=\"$tk_data_host$\"", _.extend(submittedTokenModel.toJSON(), e.data), TokenUtils.getEscaper('url'), TokenUtils.getFilters(mvc.Components));
                utils.redirect(url, false, "_blank");
            }
        });

        // outlier chart
        var elementOutlierDataHost = new VisualizationElement({
            "id": "elementOutlierDataHost",
            "type": "Splunk_ML_Toolkit.OutliersViz",
            "resizable": true,
            "Splunk_ML_Toolkit.OutliersViz.showOutlierCount": "true",
            "drilldown": "none",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "height": "350",
            "managerid": "searchOutlierDetectionChartDataHost",
            "el": $('#elementOutlierDataHost')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var elementOutlierTableDataHost = new TableElement({
            "id": "elementOutlierTableDataHost",
            "count": 100,
            "dataOverlayMode": "none",
            "drilldown": "none",
            "percentagesRow": "false",
            "rowNumbers": "false",
            "totalsRow": "false",
            "wrap": "true",
            "managerid": "searchOutlierDetectionTableDataHost",
            "el": $('#elementOutlierTableDataHost')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var elementOutlierSimulationDataHost = new VisualizationElement({
            "id": "elementOutlierSimulationDataHost",
            "type": "Splunk_ML_Toolkit.OutliersViz",
            "resizable": true,
            "Splunk_ML_Toolkit.OutliersViz.showOutlierCount": "true",
            "drilldown": "none",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "height": "300",
            "managerid": "searchOutlierDetectionChartSimulationDataHost",
            "el": $('#elementOutlierSimulationDataHost')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        // modal window chart
        var elementChartLagHostOverTime = new ChartElement({
            "id": "elementChartLagHostOverTime",
            "charting.axisX.abbreviation": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.axisTitleY.text": "Events count",
            "refresh.display": "progressbar",
            "charting.chart.nullValueMode": "gaps",
            "charting.axisTitleX.visibility": "collapsed",
            "charting.axisTitleY2.text": "lag in seconds",
            "charting.axisX.scale": "linear",
            "charting.drilldown": "none",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.chart.overlayFields": "avg_lag_sec",
            "charting.chart.showDataLabels": "none",
            "charting.axisTitleY2.visibility": "visible",
            "charting.axisY2.enabled": "1",
            "charting.axisY2.scale": "inherit",
            "trellis.scales.shared": "1",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart.bubbleSizeBy": "area",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.chart.style": "shiny",
            "charting.axisY.scale": "linear",
            "charting.layout.splitSeries": "0",
            "resizable": true,
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.lineWidth": "2",
            "charting.axisTitleY.visibility": "visible",
            "charting.chart.stackMode": "default",
            "charting.legend.placement": "right",
            "trellis.size": "medium",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisY2.abbreviation": "none",
            "charting.chart": "column",
            "charting.axisY.abbreviation": "none",
            "charting.fieldColors": "{\"events_count\": 0xaec6cf, \"avg_lag_sec\": 0x8b0000}",
            "trellis.enabled": "0",
            "height": "160",
            "managerid": "searchChartLagHostOverTime",
            "el": $('#elementChartLagHostOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // modal Single Lag
        var elementSingleLagHostPerc95 = new SingleElement({
            "id": "elementSingleLagHostPerc95",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "height": "80",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "PERC95 INGESTION LAG (sec or [D+]HH:MM:SS)",
            "managerid": "searchSingleLagHostPerc95",
            "el": $('#elementSingleLagHostPerc95')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSingleLagHostAvg = new SingleElement({
            "id": "elementSingleLagHostAvg",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "height": "80",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "AVG INGESTION LAG (sec or [D+]HH:MM:SS)",
            "managerid": "searchSingleLagHostAvg",
            "el": $('#elementSingleLagHostAvg')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSingleLagHostEventLag = new SingleElement({
            "id": "elementSingleLagHostEventLag",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "height": "80",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "CURRENT EVENT LAG (sec or [D+]HH:MM:SS)",
            "managerid": "searchSingleLagHostEventLag",
            "el": $('#elementSingleLagHostEventLag')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // modal Single Lag
        var elementSingleLagByMetricsHostPerc95 = new SingleElement({
            "id": "elementSingleLagByMetricsHostPerc95",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "height": "80",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "PERC95 INGESTION LAG (sec or [D+]HH:MM:SS)",
            "managerid": "searchSingleLagByMetricsHostPerc95",
            "el": $('#elementSingleLagByMetricsHostPerc95')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSingleLagByMetricsHostAvg = new SingleElement({
            "id": "elementSingleLagByMetricsHostAvg",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "height": "80",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "AVG INGESTION LAG (sec or [D+]HH:MM:SS)",
            "managerid": "searchSingleLagByMetricsHostAvg",
            "el": $('#elementSingleLagByMetricsHostAvg')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSingleLagByMetricsHostEventLag = new SingleElement({
            "id": "elementSingleLagByMetricsHostEventLag",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "height": "80",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "CURRENT EVENT LAG (sec or [D+]HH:MM:SS)",
            "managerid": "searchSingleLagByMetricsHostEventLag",
            "el": $('#elementSingleLagByMetricsHostEventLag')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSingleSLAHostpct = new SingleElement({
            "id": "elementSingleSLAHostpct",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "all",
            "height": "80",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "%",
            "rangeColors": "[\"0xdc4e41\",\"0xf1813f\",\"0x77dd77\"]",
            "colorMode": "none",
            "rangeValues": "[50,90]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "useThousandSeparators": "1",
            "underLabel": "SLA PCT (% time spent in green/blue mode last 90d)",
            "managerid": "searchSingleSLAHostpct",
            "el": $('#elementSingleSLAHostpct')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementSingleSLAHostpct.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                var url = TokenUtils.replaceTokenNames("{{SPLUNKWEB_URL_PREFIX}}/app/trackme/trackMe_qos?form.timerange.earliest=-90d%40d&form.timerange.latest=now&form.object_category=data_host&form.object_freetext=*&form.object=$tk_data_host$&form.priority=*", _.extend(submittedTokenModel.toJSON(), e.data), TokenUtils.getEscaper('url'), TokenUtils.getFilters(mvc.Components));
                utils.redirect(url, false, "_blank");
            }
        });

        var elementChartHostIndexes = new ChartElement({
            "id": "elementChartHostIndexes",
            "charting.drilldown": "all",
            "resizable": true,
            "charting.chart": "pie",
            "height": "160",
            "managerid": "searchChartHostIndexes",
            "el": $('#elementChartHostIndexes')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementChartHostSourcetypes = new ChartElement({
            "id": "elementChartHostSourcetypes",
            "charting.drilldown": "all",
            "resizable": true,
            "charting.chart": "pie",
            "height": "160",
            "managerid": "searchChartHostSourcetypes",
            "el": $('#elementChartHostSourcetypes')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Ops: Indexer Queues
        var elementChartQueueAll = new ChartElement({
            "id": "elementChartQueueAll",
            "charting.chart.nullValueMode": "gaps",
            "resizable": true,
            "trellis.enabled": "0",
            "charting.axisTitleX.visibility": "collapsed",
            "refresh.display": "progressbar",
            "charting.chart.stackMode": "stacked",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisY.abbreviation": "none",
            "charting.legend.placement": "bottom",
            "charting.axisY2.abbreviation": "none",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.chart.showDataLabels": "none",
            "charting.axisY2.enabled": "0",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.style": "shiny",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart": "line",
            "charting.axisX.scale": "linear",
            "trellis.scales.shared": "1",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "height": "350",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.drilldown": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "trellis.size": "medium",
            "charting.axisY.scale": "linear",
            "charting.chart.bubbleSizeBy": "area",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisX.abbreviation": "none",
            "charting.layout.splitSeries": "0",
            "charting.lineWidth": "2",
            "charting.axisY2.scale": "inherit",
            "managerid": "searchQueueAll",
            "el": $('#elementChartQueueAll')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementChartQueuesTreillis = new ChartElement({
            "id": "elementChartQueuesTreillis",
            "resizable": true,
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisTitleX.visibility": "collapsed",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "charting.axisX.abbreviation": "none",
            "charting.axisX.scale": "linear",
            "charting.axisY.abbreviation": "none",
            "charting.axisY.scale": "linear",
            "charting.axisY2.abbreviation": "none",
            "charting.axisY2.enabled": "0",
            "charting.axisY2.scale": "inherit",
            "charting.chart": "line",
            "charting.chart.bubbleMaximumSize": "50",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.chart.bubbleSizeBy": "area",
            "charting.chart.nullValueMode": "gaps",
            "charting.chart.showDataLabels": "none",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.stackMode": "default",
            "charting.chart.style": "shiny",
            "charting.drilldown": "none",
            "charting.layout.splitSeries": "0",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.legend.mode": "standard",
            "charting.legend.placement": "right",
            "charting.lineWidth": "2",
            "trellis.enabled": "1",
            "trellis.scales.shared": "0",
            "trellis.size": "large",
            "height": "1200",
            "managerid": "searchQueueTreillis",
            "el": $('#elementChartQueuesTreillis')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        // Ops: Parsing Issues
        var elementChartParsingIssues = new ChartElement({
            "id": "elementChartParsingIssues",
            "charting.chart.nullValueMode": "gaps",
            "resizable": true,
            "trellis.enabled": "0",
            "charting.axisTitleX.visibility": "collapsed",
            "refresh.display": "progressbar",
            "charting.chart.stackMode": "stacked",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisY.abbreviation": "none",
            "charting.legend.placement": "bottom",
            "charting.axisY2.abbreviation": "none",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.chart.showDataLabels": "none",
            "charting.axisY2.enabled": "0",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.style": "shiny",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart": "column",
            "charting.axisX.scale": "linear",
            "trellis.scales.shared": "1",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "height": "300",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.drilldown": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "trellis.size": "medium",
            "charting.axisY.scale": "linear",
            "charting.chart.bubbleSizeBy": "area",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisX.abbreviation": "none",
            "charting.layout.splitSeries": "0",
            "charting.lineWidth": "2",
            "charting.axisY2.scale": "inherit",
            "managerid": "searchParsingIssuesChart",
            "el": $('#elementChartParsingIssues')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartLineBreakingProcessorTopSource = new ChartElement({
            "id": "chartLineBreakingProcessorTopSource",
            "resizable": true,
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisTitleX.visibility": "visible",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "charting.axisX.abbreviation": "none",
            "charting.axisX.scale": "linear",
            "charting.axisY.abbreviation": "none",
            "charting.axisY.scale": "linear",
            "charting.axisY2.abbreviation": "none",
            "charting.axisY2.enabled": "0",
            "charting.axisY2.scale": "inherit",
            "charting.chart": "pie",
            "charting.chart.bubbleMaximumSize": "50",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.chart.bubbleSizeBy": "area",
            "charting.chart.nullValueMode": "gaps",
            "charting.chart.showDataLabels": "none",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.stackMode": "default",
            "charting.chart.style": "shiny",
            "charting.drilldown": "none",
            "charting.layout.splitSeries": "0",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.legend.mode": "standard",
            "charting.legend.placement": "right",
            "charting.lineWidth": "2",
            "refresh.display": "progressbar",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchLineBreakingProcessorTopSource",
            "el": $('#chartLineBreakingProcessorTopSource')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var tableLineBreakingProcessorTopSource = new TableElement({
            "id": "tableLineBreakingProcessorTopSource",
            "drilldown": "none",
            "count": "5",
            "refresh.display": "progressbar",
            "managerid": "searchLineBreakingProcessorTopSource",
            "el": $('#tableLineBreakingProcessorTopSource')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var chartLineBreakingProcessorTopHost = new ChartElement({
            "id": "chartLineBreakingProcessorTopHost",
            "resizable": true,
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisTitleX.visibility": "visible",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "charting.axisX.abbreviation": "none",
            "charting.axisX.scale": "linear",
            "charting.axisY.abbreviation": "none",
            "charting.axisY.scale": "linear",
            "charting.axisY2.abbreviation": "none",
            "charting.axisY2.enabled": "0",
            "charting.axisY2.scale": "inherit",
            "charting.chart": "pie",
            "charting.chart.bubbleMaximumSize": "50",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.chart.bubbleSizeBy": "area",
            "charting.chart.nullValueMode": "gaps",
            "charting.chart.showDataLabels": "none",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.stackMode": "default",
            "charting.chart.style": "shiny",
            "charting.drilldown": "none",
            "charting.layout.splitSeries": "0",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.legend.mode": "standard",
            "charting.legend.placement": "right",
            "charting.lineWidth": "2",
            "refresh.display": "progressbar",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchLineBreakingProcessorTopHost",
            "el": $('#chartLineBreakingProcessorTopHost')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var tableLineBreakingProcessorTopHost = new TableElement({
            "id": "tableLineBreakingProcessorTopHost",
            "drilldown": "none",
            "count": "5",
            "refresh.display": "progressbar",
            "managerid": "searchLineBreakingProcessorTopHost",
            "el": $('#tableLineBreakingProcessorTopHost')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var chartLineBreakingProcessorTopSourcetype = new ChartElement({
            "id": "chartLineBreakingProcessorTopSourcetype",
            "resizable": true,
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisTitleX.visibility": "visible",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "charting.axisX.abbreviation": "none",
            "charting.axisX.scale": "linear",
            "charting.axisY.abbreviation": "none",
            "charting.axisY.scale": "linear",
            "charting.axisY2.abbreviation": "none",
            "charting.axisY2.enabled": "0",
            "charting.axisY2.scale": "inherit",
            "charting.chart": "pie",
            "charting.chart.bubbleMaximumSize": "50",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.chart.bubbleSizeBy": "area",
            "charting.chart.nullValueMode": "gaps",
            "charting.chart.showDataLabels": "none",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.stackMode": "default",
            "charting.chart.style": "shiny",
            "charting.drilldown": "none",
            "charting.layout.splitSeries": "0",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.legend.mode": "standard",
            "charting.legend.placement": "right",
            "charting.lineWidth": "2",
            "refresh.display": "progressbar",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchLineBreakingProcessorTopSourcetype",
            "el": $('#chartLineBreakingProcessorTopSourcetype')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var tableLineBreakingProcessorTopSourcetype = new TableElement({
            "id": "tableLineBreakingProcessorTopSourcetype",
            "drilldown": "none",
            "count": "5",
            "refresh.display": "progressbar",
            "managerid": "searchLineBreakingProcessorTopSourcetype",
            "el": $('#tableLineBreakingProcessorTopSourcetype')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var elementAggregatorMiningProcessor = new HtmlElement({
            "id": "elementAggregatorMiningProcessor",
            "useTokens": true,
            "el": $('#elementAggregatorMiningProcessor')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        DashboardController.addReadyDep(elementAggregatorMiningProcessor.contentLoaded());
        
        var chartAggregatorMiningProcessorTopSource = new ChartElement({
            "id": "chartAggregatorMiningProcessorTopSource",
            "resizable": true,
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisTitleX.visibility": "visible",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "charting.axisX.abbreviation": "none",
            "charting.axisX.scale": "linear",
            "charting.axisY.abbreviation": "none",
            "charting.axisY.scale": "linear",
            "charting.axisY2.abbreviation": "none",
            "charting.axisY2.enabled": "0",
            "charting.axisY2.scale": "inherit",
            "charting.chart": "pie",
            "charting.chart.bubbleMaximumSize": "50",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.chart.bubbleSizeBy": "area",
            "charting.chart.nullValueMode": "gaps",
            "charting.chart.showDataLabels": "none",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.stackMode": "default",
            "charting.chart.style": "shiny",
            "charting.drilldown": "none",
            "charting.layout.splitSeries": "0",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.legend.mode": "standard",
            "charting.legend.placement": "right",
            "charting.lineWidth": "2",
            "refresh.display": "progressbar",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchAggregatorMiningProcessorTopSource",
            "el": $('#chartAggregatorMiningProcessorTopSource')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var tableAggregatorMiningProcessorTopSource = new TableElement({
            "id": "tableAggregatorMiningProcessorTopSource",
            "drilldown": "none",
            "count": "5",
            "refresh.display": "progressbar",
            "managerid": "searchAggregatorMiningProcessorTopSource",
            "el": $('#tableAggregatorMiningProcessorTopSource')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var chartAggregatorMiningProcessorTopHost = new ChartElement({
            "id": "chartAggregatorMiningProcessorTopHost",
            "resizable": true,
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisTitleX.visibility": "visible",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "charting.axisX.abbreviation": "none",
            "charting.axisX.scale": "linear",
            "charting.axisY.abbreviation": "none",
            "charting.axisY.scale": "linear",
            "charting.axisY2.abbreviation": "none",
            "charting.axisY2.enabled": "0",
            "charting.axisY2.scale": "inherit",
            "charting.chart": "pie",
            "charting.chart.bubbleMaximumSize": "50",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.chart.bubbleSizeBy": "area",
            "charting.chart.nullValueMode": "gaps",
            "charting.chart.showDataLabels": "none",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.stackMode": "default",
            "charting.chart.style": "shiny",
            "charting.drilldown": "none",
            "charting.layout.splitSeries": "0",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.legend.mode": "standard",
            "charting.legend.placement": "right",
            "charting.lineWidth": "2",
            "refresh.display": "progressbar",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchAggregatorMiningProcessorTopHost",
            "el": $('#chartAggregatorMiningProcessorTopHost')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var tableAggregatorMiningProcessorTopHost = new TableElement({
            "id": "tableAggregatorMiningProcessorTopHost",
            "drilldown": "none",
            "count": "5",
            "refresh.display": "progressbar",
            "managerid": "searchAggregatorMiningProcessorTopHost",
            "el": $('#tableAggregatorMiningProcessorTopHost')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var chartAggregatorMiningProcessorTopSourcetype = new ChartElement({
            "id": "chartAggregatorMiningProcessorTopSourcetype",
            "resizable": true,
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisTitleX.visibility": "visible",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "charting.axisX.abbreviation": "none",
            "charting.axisX.scale": "linear",
            "charting.axisY.abbreviation": "none",
            "charting.axisY.scale": "linear",
            "charting.axisY2.abbreviation": "none",
            "charting.axisY2.enabled": "0",
            "charting.axisY2.scale": "inherit",
            "charting.chart": "pie",
            "charting.chart.bubbleMaximumSize": "50",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.chart.bubbleSizeBy": "area",
            "charting.chart.nullValueMode": "gaps",
            "charting.chart.showDataLabels": "none",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.stackMode": "default",
            "charting.chart.style": "shiny",
            "charting.drilldown": "none",
            "charting.layout.splitSeries": "0",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.legend.mode": "standard",
            "charting.legend.placement": "right",
            "charting.lineWidth": "2",
            "refresh.display": "progressbar",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchAggregatorMiningProcessorTopSourcetype",
            "el": $('#chartAggregatorMiningProcessorTopSourcetype')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var tableAggregatorMiningProcessorTopSourcetype = new TableElement({
            "id": "tableAggregatorMiningProcessorTopSourcetype",
            "drilldown": "none",
            "count": "5",
            "refresh.display": "progressbar",
            "managerid": "searchAggregatorMiningProcessorTopSourcetype",
            "el": $('#tableAggregatorMiningProcessorTopSourcetype')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var elementDateParserVerbose = new HtmlElement({
            "id": "elementDateParserVerbose",
            "useTokens": true,
            "el": $('#elementDateParserVerbose')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        DashboardController.addReadyDep(elementDateParserVerbose.contentLoaded());
        
        var chartDateParserVerboseTopSource = new ChartElement({
            "id": "chartDateParserVerboseTopSource",
            "resizable": true,
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisTitleX.visibility": "visible",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "charting.axisX.abbreviation": "none",
            "charting.axisX.scale": "linear",
            "charting.axisY.abbreviation": "none",
            "charting.axisY.scale": "linear",
            "charting.axisY2.abbreviation": "none",
            "charting.axisY2.enabled": "0",
            "charting.axisY2.scale": "inherit",
            "charting.chart": "pie",
            "charting.chart.bubbleMaximumSize": "50",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.chart.bubbleSizeBy": "area",
            "charting.chart.nullValueMode": "gaps",
            "charting.chart.showDataLabels": "none",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.stackMode": "default",
            "charting.chart.style": "shiny",
            "charting.drilldown": "none",
            "charting.layout.splitSeries": "0",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.legend.mode": "standard",
            "charting.legend.placement": "right",
            "charting.lineWidth": "2",
            "refresh.display": "progressbar",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchDateParserVerboseTopSource",
            "el": $('#chartDateParserVerboseTopSource')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var tableDateParserVerboseTopSource = new TableElement({
            "id": "tableDateParserVerboseTopSource",
            "drilldown": "none",
            "count": "5",
            "refresh.display": "progressbar",
            "managerid": "searchDateParserVerboseTopSource",
            "el": $('#tableDateParserVerboseTopSource')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var chartDateParserVerboseTopHost = new ChartElement({
            "id": "chartDateParserVerboseTopHost",
            "resizable": true,
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisTitleX.visibility": "visible",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "charting.axisX.abbreviation": "none",
            "charting.axisX.scale": "linear",
            "charting.axisY.abbreviation": "none",
            "charting.axisY.scale": "linear",
            "charting.axisY2.abbreviation": "none",
            "charting.axisY2.enabled": "0",
            "charting.axisY2.scale": "inherit",
            "charting.chart": "pie",
            "charting.chart.bubbleMaximumSize": "50",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.chart.bubbleSizeBy": "area",
            "charting.chart.nullValueMode": "gaps",
            "charting.chart.showDataLabels": "none",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.stackMode": "default",
            "charting.chart.style": "shiny",
            "charting.drilldown": "none",
            "charting.layout.splitSeries": "0",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.legend.mode": "standard",
            "charting.legend.placement": "right",
            "charting.lineWidth": "2",
            "refresh.display": "progressbar",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchDateParserVerboseTopHost",
            "el": $('#chartDateParserVerboseTopHost')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var tableDateParserVerboseTopHost = new TableElement({
            "id": "tableDateParserVerboseTopHost",
            "drilldown": "none",
            "count": "5",
            "refresh.display": "progressbar",
            "managerid": "searchDateParserVerboseTopHost",
            "el": $('#tableDateParserVerboseTopHost')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var chartDateParserVerboseTopSourcetype = new ChartElement({
            "id": "chartDateParserVerboseTopSourcetype",
            "resizable": true,
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisTitleX.visibility": "visible",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "charting.axisX.abbreviation": "none",
            "charting.axisX.scale": "linear",
            "charting.axisY.abbreviation": "none",
            "charting.axisY.scale": "linear",
            "charting.axisY2.abbreviation": "none",
            "charting.axisY2.enabled": "0",
            "charting.axisY2.scale": "inherit",
            "charting.chart": "pie",
            "charting.chart.bubbleMaximumSize": "50",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.chart.bubbleSizeBy": "area",
            "charting.chart.nullValueMode": "gaps",
            "charting.chart.showDataLabels": "none",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.stackMode": "default",
            "charting.chart.style": "shiny",
            "charting.drilldown": "none",
            "charting.layout.splitSeries": "0",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.legend.mode": "standard",
            "charting.legend.placement": "right",
            "charting.lineWidth": "2",
            "refresh.display": "progressbar",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchDateParserVerboseTopSourcetype",
            "el": $('#chartDateParserVerboseTopSourcetype')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var tableDateParserVerboseTopSourcetype = new TableElement({
            "id": "tableDateParserVerboseTopSourcetype",
            "drilldown": "none",
            "count": "5",
            "refresh.display": "progressbar",
            "managerid": "searchDateParserVerboseTopSourcetype",
            "el": $('#tableDateParserVerboseTopSourcetype')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var EventLineBreakingProcessorEvent = new EventElement({
            "id": "EventLineBreakingProcessorEvent",
            "count": 5,
            "list.drilldown": "none",
            "raw.drilldown": "none",
            "table.drilldown": "none",
            "type": "raw",
            "managerid": "searchLineBreakingProcessorEvent",
            "el": $('#EventLineBreakingProcessorEvent')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var EventAggregatorMiningProcessorEvent = new EventElement({
            "id": "EventAggregatorMiningProcessorEvent",
            "count": 5,
            "list.drilldown": "none",
            "raw.drilldown": "none",
            "table.drilldown": "none",
            "type": "raw",
            "managerid": "searchAggregatorMiningProcessorEvent",
            "el": $('#EventAggregatorMiningProcessorEvent')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var EventDateParserVerboseEvent = new EventElement({
            "id": "EventDateParserVerboseEvent",
            "count": 5,
            "list.drilldown": "none",
            "raw.drilldown": "none",
            "table.drilldown": "none",
            "type": "raw",
            "managerid": "searchDateParserVerboseEvent",
            "el": $('#EventDateParserVerboseEvent')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        // modal Single Lag
        var elementSingleParsingIssues = new SingleElement({
            "id": "elementSingleParsingIssues",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "",
            "rangeColors": "[\"0x77dd77\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "SUMMARY",
            "managerid": "searchParsingIssuesSingle",
            "el": $('#elementSingleParsingIssues')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Manage html dynamic panels

        // object tags

        var body_data_host_tags = new HtmlElement({
            "id": "body_data_host_tags",
            "useTokens": true,
            "el": $('#body_data_host_tags')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var body_metric_host_tags = new HtmlElement({
            "id": "body_metric_host_tags",
            "useTokens": true,
            "el": $('#body_metric_host_tags')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var body_modal_manage = new HtmlElement({
            "id": "body_modal_manage",
            "useTokens": true,
            "el": $('#body_modal_manage')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        //function update_body_modal_manage() {
        //  var tk_keyid = tokens.get("tk_keyid");
        //}

        var body_modal_manage_host = new HtmlElement({
            "id": "body_modal_manage_host",
            "useTokens": true,
            "el": $('#body_modal_manage_host')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var body_data_source_data_sampling = new HtmlElement({
            "id": "body_data_source_data_sampling",
            "useTokens": true,
            "el": $('#body_data_source_data_sampling')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var body_data_source_status_message = new HtmlElement({
            "id": "body_data_source_status_message",
            "useTokens": true,
            "el": $('#body_data_source_status_message')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var body_data_host_status_message = new HtmlElement({
            "id": "body_data_host_status_message",
            "useTokens": true,
            "el": $('#body_data_host_status_message')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // metric host

        var body_metric_host_status_message = new HtmlElement({
            "id": "body_metric_host_status_message",
            "useTokens": true,
            "el": $('#body_metric_host_status_message')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var body_modal_manage_metric_host = new HtmlElement({
            "id": "body_modal_manage_metric_host",
            "useTokens": true,
            "el": $('#body_modal_manage_metric_host')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // data source identity card
        var body_manage_identity_card = new HtmlElement({
            "id": "body_manage_identity_card",
            "useTokens": true,
            "el": $('#body_manage_identity_card')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // tags
        var body_manage_tags = new HtmlElement({
            "id": "body_manage_tags",
            "useTokens": true,
            "el": $('#body_manage_tags')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        //
        // VIEWS: FORM INPUTS
        //

        var link1 = new LinkListInput({
            "id": "link1",
            "choices": [{
                    "value": "show_data_source_tracker",
                    "label": "DATA SOURCES TRACKING"
                },
                {
                    "value": "show_data_host_tracker",
                    "label": "DATA HOSTS TRACKING"
                },
                {
                    "value": "show_metric_host_tracker",
                    "label": "METRIC HOSTS TRACKING"
                },
                {
                    "value": "show_audit_flip",
                    "label": "INVESTIGATE STATUS FLIPPING"
                },
                {
                    "value": "show_audit_changes",
                    "label": "INVESTIGATE AUDIT CHANGES"
                },
                {
                    "value": "show_alerts",
                    "label": "TRACKING ALERTS"
                }                
            ],
            "default": "show_data_source_tracker",
            "selectFirstChoice": false,
            "searchWhenChanged": true,
            "value": "$form.tk_main_link$",
            "el": $('#link1')
        }, {
            tokens: true
        }).render();

        link1.on("change", function(newValue) {
            FormUtils.handleValueChange(link1);
        });

        link1.on("valueChange", function(e) {
            if (e.value === "show_data_source_tracker") {
                EventHandler.setToken("show_data_source_tracker", "true", {}, e.data);
                EventHandler.unsetToken("show_data_host_tracker");
                EventHandler.unsetToken("show_audit_flip");
                EventHandler.unsetToken("show_audit_changes");
                EventHandler.unsetToken("show_metric_host_tracker");
                EventHandler.unsetToken("show_alerts");                
            } else if (e.value === "show_data_host_tracker") {
                EventHandler.setToken("show_data_host_tracker", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_tracker");
                EventHandler.unsetToken("show_audit_flip");
                EventHandler.unsetToken("show_audit_changes");
                EventHandler.unsetToken("show_metric_host_tracker");
                EventHandler.unsetToken("show_alerts");                
            } else if (e.value === "show_metric_host_tracker") {
                EventHandler.setToken("show_metric_host_tracker", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_tracker");
                EventHandler.unsetToken("show_data_host_tracker");
                EventHandler.unsetToken("show_audit_flip");
                EventHandler.unsetToken("show_audit_changes");
                EventHandler.unsetToken("show_alerts");                
            } else if (e.value === "show_audit_flip") {
                EventHandler.setToken("show_audit_flip", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_tracker");
                EventHandler.unsetToken("show_data_host_tracker");
                EventHandler.unsetToken("show_audit_changes");
                EventHandler.unsetToken("show_metric_host_tracker");
                EventHandler.unsetToken("show_alerts");                
            } else if (e.value === "show_audit_changes") {
                EventHandler.setToken("show_audit_changes", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_tracker");
                EventHandler.unsetToken("show_data_host_tracker");
                EventHandler.unsetToken("show_audit_flip");
                EventHandler.unsetToken("show_metric_host_tracker");
                EventHandler.unsetToken("show_alerts");
            } else if (e.value === "show_alerts") {
                EventHandler.setToken("show_alerts", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_tracker");
                EventHandler.unsetToken("show_data_host_tracker");
                EventHandler.unsetToken("show_audit_flip");
                EventHandler.unsetToken("show_metric_host_tracker");
                EventHandler.unsetToken("show_audit_changes");
            }            
        });

        var input1 = new TimeRangeInput({
            "id": "input1",
            "searchWhenChanged": true,
            "default": {
                "latest_time": "now",
                "earliest_time": "-24h@h"
            },
            "earliest_time": "$form.time.earliest$",
            "latest_time": "$form.time.latest$",
            "el": $('#input1')
        }, {
            tokens: true
        }).render();

        input1.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        // Audit Flip

        var input_timerange_audit_flip = new TimeRangeInput({
            "id": "input_timerange_audit_flip",
            "searchWhenChanged": true,
            "default": {"latest_time": "now", "earliest_time": "-24h"},
            "earliest_time": "$form.timerange_audit_flip.earliest$",
            "latest_time": "$form.timerange_audit_flip.latest$",
            "el": $('#input_timerange_audit_flip')
        }, {tokens: true}).render();

        input_timerange_audit_flip.on("change", function(newValue) {
            FormUtils.handleValueChange(input_timerange_audit_flip);
        });

        var inputAuditFlipObjectCategory = new DropdownInput({
            "id": "inputAuditFlipObjectCategory",
            "tokenDependencies": {
                "depends": "$show_audit_flip$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "object_category",
            "prefix": "object_category=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "object_category",
            "value": "$form.audit_flip_object_category$",
            "managerid": "searchAuditFlipObjectCategory",
            "el": $('#inputAuditFlipObjectCategory')
        }, {
            tokens: true
        }).render();

        inputAuditFlipObjectCategory.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditFlipObjectCategory);
        });

        var inputAuditFlipObjectFilter = new TextInput({
            "id": "inputAuditFlipObjectFilter",
            "searchWhenChanged": true,
            "default": "*",
            "prefix": "object=\"*",
            "suffix": "*\"",
            "initialValue": "*",
            "value": "$form.inputAuditFlipObjectFilter$",
            "el": $('#inputAuditFlipObjectFilter')
        }, {
            tokens: true
        }).render();

        inputAuditFlipObjectFilter.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditFlipObjectFilter);
        });

        var inputAuditFlipObject = new DropdownInput({
            "id": "inputAuditFlipObject",
            "tokenDependencies": {
                "depends": "$show_audit_flip$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "object",
            "prefix": "object=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "object",
            "value": "$form.audit_flip_object$",
            "managerid": "searchAuditFlipObject",
            "el": $('#inputAuditFlipObject')
        }, {
            tokens: true
        }).render();

        inputAuditFlipObject.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditFlipObject);
        });

        // Ack
        var input_ack_duration = new DropdownInput({
            "id": "input_ack_duration",
            "choices": [],
            "searchWhenChanged": true,
            "labelField": "label",
            "valueField": "duration",
            "selectFirstChoice": true,
            "showClearButton": true,
            "value": "$form.input_ack_duration$",
            "managerid": "searchAckDuration",
            "el": $('#input_ack_duration')
        }, {tokens: true}).render();

        input_ack_duration.on("change", function(newValue) {
            FormUtils.handleValueChange(input_ack_duration);
        });

        DashboardController.onReady(function() {
            if (!submittedTokenModel.has('earliest') && !submittedTokenModel.has('latest')) {
                submittedTokenModel.set({ earliest: '0', latest: '' });
            }
        });

        // Audit Changes

        var input_timerange_audit_changes = new TimeRangeInput({
            "id": "input_timerange_audit_changes",
            "searchWhenChanged": true,
            "default": {"latest_time": "now", "earliest_time": "-24h"},
            "earliest_time": "$form.timerange_audit_changes.earliest$",
            "latest_time": "$form.timerange_audit_changes.latest$",
            "el": $('#input_timerange_audit_changes')
        }, {tokens: true}).render();

        input_timerange_audit_changes.on("change", function(newValue) {
            FormUtils.handleValueChange(input_timerange_audit_changes);
        });

        var inputAuditChangesAction = new DropdownInput({
            "id": "inputAuditChangesAction",
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "action",
            "prefix": "action=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "action",
            "value": "$form.audit_changes_action$",
            "managerid": "searchAuditChangesAction",
            "el": $('#inputAuditChangesAction')
        }, {
            tokens: true
        }).render();

        inputAuditChangesAction.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditChangesAction);
        });

        var inputAuditChangesObjectCategory = new DropdownInput({
            "id": "inputAuditChangesObjectCategory",
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "object_category",
            "prefix": "object_category=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "object_category",
            "value": "$form.audit_changes_object_category$",
            "managerid": "searchAuditChangesObjectCategory",
            "el": $('#inputAuditChangesObjectCategory')
        }, {
            tokens: true
        }).render();

        inputAuditChangesObjectCategory.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditChangesObjectCategory);
        });

        var inputAuditChangesChangeType = new DropdownInput({
            "id": "inputAuditChangesChangeType",
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "change_type",
            "prefix": "change_type=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "change_type",
            "value": "$form.audit_changes_change_type$",
            "managerid": "searchAuditChangesChangeType",
            "el": $('#inputAuditChangesChangeType')
        }, {
            tokens: true
        }).render();

        inputAuditChangesChangeType.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditChangesChangeType);
        });

        var inputAuditChangesUser = new DropdownInput({
            "id": "inputAuditChangesUser",
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "user",
            "prefix": "user=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "user",
            "value": "$form.audit_changes_user$",
            "managerid": "searchAuditChangesUser",
            "el": $('#inputAuditChangesUser')
        }, {
            tokens: true
        }).render();

        inputAuditChangesUser.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditChangesUser);
        });

        var inputAuditChangesObject = new DropdownInput({
            "id": "inputAuditChangesObject",
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "object",
            "prefix": "object=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "object",
            "value": "$form.audit_changes_object$",
            "managerid": "searchAuditChangesObject",
            "el": $('#inputAuditChangesObject')
        }, {
            tokens: true
        }).render();

        inputAuditChangesObject.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditChangesObject);
        });

        //

        var inputDataNameFilterMode = new DropdownInput({
            "id": "inputDataNameFilterMode",
            "choices": [
                {
                    "label": "Includes",
                    "value": ""
                },
                {
                    "label": "Excludes",
                    "value": "NOT"
                }
            ],
            "searchWhenChanged": true,
            "default": "",
            "showClearButton": true,
            "initialValue": "",
            "selectFirstChoice": false,
            "value": "$form.inputDataNameFilterMode$",
            "el": $('#inputDataNameFilterMode')
        }, {
            tokens: true
        }).render();

        inputDataNameFilterMode.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataNameFilterMode);
        });

        inputDataNameFilterMode.on("valueChange", function(e) {
            if (e.value === "NOT") {
                EventHandler.unsetToken("form.inputDataNameFilter");
            }
        });

        var inputDataNameFilter = new TextInput({
            "id": "inputDataNameFilter",
            "searchWhenChanged": true,
            "prefix": "data_name=\"*",
            "suffix": "*\"",
            "initialValue": "*",
            "value": "$form.inputDataNameFilter$",
            "el": $('#inputDataNameFilter')
        }, {
            tokens: true
        }).render();

        inputDataNameFilter.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataNameFilter);
        });

        var inputDataName = new MultiSelectInput({
            "id": "inputDataName",
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "data_name",
            "valuePrefix": "data_name=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "data_name",
            "value": "$form.inputDataName$",
            "managerid": "searchPopulateDataSources",
            "el": $('#inputDataName')
        }, {
            tokens: true
        }).render();

        inputDataName.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataName);
        });

        var inputTags = new MultiSelectInput({
            "id": "inputTags",
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "tags",
            "valuePrefix": "tags=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "tags",
            "value": "$form.inputTags$",
            "managerid": "searchPopulateDataSourcesTags",
            "el": $('#inputTags')
        }, {
            tokens: true
        }).render();

        inputTags.on("change", function(newValue) {
            FormUtils.handleValueChange(inputTags);
        });

        var inputDataIndex = new MultiSelectInput({
            "id": "inputDataIndex",
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "data_index",
            "valuePrefix": "data_index=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "data_index",
            "value": "$form.inputDataIndex$",
            "managerid": "searchPopulateDataSourcesIndexes",
            "el": $('#inputDataIndex')
        }, {
            tokens: true
        }).render();

        inputDataIndex.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataIndex);
        });

        var inputDataSourcetype = new MultiSelectInput({
            "id": "inputDataSourcetype",
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "data_sourcetype",
            "valuePrefix": "data_sourcetype=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "data_sourcetype",
            "value": "$form.inputDataSourcetype$",
            "managerid": "searchPopulateDataSourcesSourcetypes",
            "el": $('#inputDataSourcetype')
        }, {
            tokens: true
        }).render();

        inputDataSourcetype.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourcetype);
        });

        // tags
        var modal_input_tags_new = new TextInput({
            "id": "modal_input_tags_new",
            "searchWhenChanged": true,
            "value": "$form.modal_input_tags_new$",
            "el": $('#modal_input_tags_new')
        }, {
            tokens: true
        }).render();

        modal_input_tags_new.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_tags_new);
        });

        var modal_input_tags_update = new MultiSelectInput({
            "id": "modal_input_tags_update",
            "tokenDependencies": {
                "depends": "$show_tags_multiselect$"
            },
            "choices": [],
            "searchWhenChanged": true,
            "labelField": "tags",
            "valueField": "tags",
            "delimiter": ",",
            "value": "$form.modal_input_tags_update$",
            "managerid": "searchShowTags",
            "el": $('#modal_input_tags_update')
        }, {tokens: true}).render();

        modal_input_tags_update.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_tags_update);
        });

        // metric host monitoring

        var inputMetricHostIndexes = new MultiSelectInput({
            "id": "inputMetricHostIndexes",
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "metric_index",
            "valuePrefix": "metric_index=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "metric_index",
            "value": "$form.inputMetricHostIndexes$",
            "managerid": "searchPopulateMetricHostsIndexes",
            "el": $('#inputMetricHostIndexes')
        }, {
            tokens: true
        }).render();

        inputMetricHostIndexes.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHostIndexes);
        });

        var inputMetricHostCategories = new MultiSelectInput({
            "id": "inputMetricHostCategories",
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "metric_category",
            "valuePrefix": "metric_category=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "metric_category",
            "value": "$form.inputMetricHostCategories$",
            "managerid": "searchPopulateMetricHostsCategories",
            "el": $('#inputMetricHostCategories')
        }, {
            tokens: true
        }).render();

        inputMetricHostCategories.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHostCategories);
        });

        var inputMetricHostFilterMode = new DropdownInput({
            "id": "inputMetricHostFilterMode",
            "choices": [
                {
                    "label": "Includes",
                    "value": ""
                },
                {
                    "label": "Excludes",
                    "value": "NOT"
                }
            ],
            "searchWhenChanged": true,
            "default": "",
            "showClearButton": true,
            "initialValue": "",
            "selectFirstChoice": false,
            "value": "$form.inputMetricHostFilterMode$",
            "el": $('#inputMetricHostFilterMode')
        }, {
            tokens: true
        }).render();

        inputMetricHostFilterMode.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHostFilterMode);
        });

        inputMetricHostFilterMode.on("valueChange", function(e) {
            if (e.value === "NOT") {
                EventHandler.unsetToken("form.inputMetricHostFilter");
            }
        });

        var inputMetricHostFilter = new TextInput({
            "id": "inputMetricHostFilter",
            "searchWhenChanged": true,
            "prefix": "\"*",
            "suffix": "*\"",
            "initialValue": "*",
            "value": "$form.inputMetricHostFilter$",
            "el": $('#inputMetricHostFilter')
        }, {
            tokens: true
        }).render();

        inputMetricHostFilter.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHostFilter);
        });

        var inputMetricHost = new MultiSelectInput({
            "id": "inputMetricHost",
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "metric_host",
            "valuePrefix": "metric_host=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "metric_host",
            "value": "$form.inputMetricHost$",
            "managerid": "searchPopulateMetricHosts",
            "el": $('#inputMetricHost')
        }, {
            tokens: true
        }).render();

        inputMetricHost.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHost);
        });

        var inputMetricHostState = new MultiSelectInput({
            "id": "inputMetricHostState",
            "choices": [
                {"label": "ALL", "value": "*"},
                {"label": "Green", "value": "green"},
                {"label": "Blue", "value": "blue"},
                {"label": "Orange", "value": "orange"},
                {"label": "Red", "value": "red"}
            ],
            "valuePrefix": "metric_host_state=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "searchWhenChanged": true,
            "initialValue": ["*"],
            "value": "$form.metric_host_state$",
            "el": $('#inputMetricHostState')
        }, {tokens: true}).render();

        inputMetricHostState.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHostState);
        });

        var inputMetricHostMonitoredState = new DropdownInput({
            "id": "inputMetricHostMonitoredState",
            "choices": [{
                    "label": "ALL",
                    "value": "*"
                },
                {
                    "label": "Enabled",
                    "value": "enabled"
                },
                {
                    "label": "Disabled",
                    "value": "disabled"
                }
            ],
            "searchWhenChanged": true,
            "default": "enabled",
            "showClearButton": true,
            "prefix": "metric_monitored_state=\"",
            "suffix": "\"",
            "initialValue": "enabled",
            "selectFirstChoice": false,
            "value": "$form.metric_monitored_state$",
            "el": $('#inputMetricHostMonitoredState')
        }, {
            tokens: true
        }).render();

        inputMetricHostMonitoredState.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHostMonitoredState);
        });

        var refreshMetricHostForm = new DropdownInput({
            "id": "refreshMetricHostForm",
            "choices": [{
                    "value": "60",
                    "label": "1 min"
                },
                {
                    "value": "120",
                    "label": "2 min"
                },
                {
                    "value": "300",
                    "label": "5 min"
                },
                {
                    "value": "none",
                    "label": "none"
                }
            ],
            "selectFirstChoice": false,
            "default": "300",
            "showClearButton": true,
            "initialValue": "300",
            "searchWhenChanged": true,
            "value": "$refresh$",
            "el": $('#refreshMetricHostForm')
        }, {
            tokens: true
        }).render();

        refreshMetricHostForm.on("change", function(newValue) {
            FormUtils.handleValueChange(refreshMetricHostForm);
        });

        var inputMetricPolicySLA_category = new DropdownInput({
            "id": "inputMetricPolicySLA_category",
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "metric_category",
            "selectFirstChoice": false,
            "valueField": "metric_category",
            "value": "$form.tk_input_metric_policy_metric_category$",
            "managerid": "searchPopulateMetricHostsCategories",
            "el": $('#inputMetricPolicySLA_category')
        }, {
            tokens: true
        }).render();

        inputMetricPolicySLA_category.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricPolicySLA_category);
        });

        var inputMetricPolicySLA_value = new TextInput({
            "id": "inputMetricPolicySLA_value",
            "searchWhenChanged": true,
            "value": "$form.tk_input_metric_policy_metric_value$",
            "el": $('#inputMetricPolicySLA_value')
        }, {
            tokens: true
        }).render();

        inputMetricPolicySLA_value.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricPolicySLA_value);
        });

        var inputDataHostIndexes = new MultiSelectInput({
            "id": "inputDataHostIndexes",
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "data_index",
            "valuePrefix": "data_index=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "data_index",
            "value": "$form.inputDataHostIndexes$",
            "managerid": "searchPopulateDataHostsIndexes",
            "el": $('#inputDataHostIndexes')
        }, {
            tokens: true
        }).render();

        inputDataHostIndexes.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostIndexes);
        });

        var inputDataHostSourcetypes = new MultiSelectInput({
            "id": "inputDataHostSourcetypes",
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "data_sourcetype",
            "valuePrefix": "data_sourcetype=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "data_sourcetype",
            "value": "$form.inputDataHostSourcetypes$",
            "managerid": "searchPopulateDataHostsSourcetypes",
            "el": $('#inputDataHostSourcetypes')
        }, {
            tokens: true
        }).render();

        inputDataHostSourcetypes.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostSourcetypes);
        });

        var inputDataHostFilterMode = new DropdownInput({
            "id": "inputDataHostFilterMode",
            "choices": [
                {
                    "label": "Includes",
                    "value": ""
                },
                {
                    "label": "Excludes",
                    "value": "NOT"
                }
            ],
            "searchWhenChanged": true,
            "default": "",
            "showClearButton": true,
            "initialValue": "",
            "selectFirstChoice": false,
            "value": "$form.inputDataHostFilterMode$",
            "el": $('#inputDataHostFilterMode')
        }, {
            tokens: true
        }).render();

        inputDataHostFilterMode.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostFilterMode);
        });

        inputDataHostFilterMode.on("valueChange", function(e) {
            if (e.value === "NOT") {
                EventHandler.unsetToken("form.inputDataHostFilter");
            }
        });

        var inputDataHostFilter = new TextInput({
            "id": "inputDataHostFilter",
            "searchWhenChanged": true,
            "prefix": "\"*",
            "suffix": "*\"",
            "initialValue": "*",
            "default": "*",
            "value": "$form.inputDataHostFilter$",
            "el": $('#inputDataHostFilter')
        }, {
            tokens: true
        }).render();

        inputDataHostFilter.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostFilter);
        });

        var inputDataHost = new MultiSelectInput({
            "id": "inputDataHost",
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "data_host",
            "valuePrefix": "data_host=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "data_host",
            "value": "$form.inputDataHost$",
            "managerid": "searchPopulateDataHosts",
            "el": $('#inputDataHost')
        }, {
            tokens: true
        }).render();

        inputDataHost.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHost);
        });

        var inputDataSourceState = new MultiSelectInput({
            "id": "inputDataSourceState",
            "choices": [
                {"label": "ALL", "value": "*"},
                {"label": "Green", "value": "green"},
                {"label": "Blue", "value": "blue"},
                {"label": "Orange", "value": "orange"},
                {"label": "Red", "value": "red"}
            ],
            "valuePrefix": "data_source_state=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "searchWhenChanged": true,
            "initialValue": ["*"],
            "value": "$form.data_source_state$",
            "el": $('#inputDataSourceState')
        }, {tokens: true}).render();

        inputDataSourceState.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourceState);
        });

        var inputDataHostState = new MultiSelectInput({
            "id": "inputDataHostState",
            "choices": [
                {"label": "ALL", "value": "*"},
                {"label": "Green", "value": "green"},
                {"label": "Blue", "value": "blue"},
                {"label": "Orange", "value": "orange"},
                {"label": "Red", "value": "red"}
            ],
            "valuePrefix": "data_host_state=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "searchWhenChanged": true,
            "initialValue": ["*"],
            "value": "$form.data_host_state$",
            "el": $('#inputDataHostState')
        }, {tokens: true}).render();

        inputDataHostState.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostState);
        });

        var inputDataMonitoredState = new DropdownInput({
            "id": "inputDataMonitoredState",
            "choices": [{
                    "label": "ALL",
                    "value": "*"
                },
                {
                    "label": "Enabled",
                    "value": "enabled"
                },
                {
                    "label": "Disabled",
                    "value": "disabled"
                }
            ],
            "searchWhenChanged": true,
            "default": "enabled",
            "showClearButton": true,
            "prefix": "data_monitored_state=\"",
            "suffix": "\"",
            "initialValue": "enabled",
            "selectFirstChoice": false,
            "value": "$form.data_monitored_state$",
            "el": $('#inputDataMonitoredState')
        }, {
            tokens: true
        }).render();

        inputDataMonitoredState.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataMonitoredState);
        });

        var inputDataPriority = new MultiSelectInput({
            "id": "inputDataPriority",
            "choices": [
                {"label": "ALL", "value": "*"},
                {"label": "low", "value": "low"},
                {"label": "medium", "value": "medium"},
                {"label": "high", "value": "high"}
            ],
            "valuePrefix": "priority=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "searchWhenChanged": true,
            "initialValue": ["*"],
            "value": "$form.inputDataPriority$",
            "el": $('#inputDataPriority')
        }, {tokens: true}).render();

        inputDataPriority.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataPriority);
        });

        var inputDataHostMonitoredState = new DropdownInput({
            "id": "inputDataHostMonitoredState",
            "choices": [{
                    "label": "ALL",
                    "value": "*"
                },
                {
                    "label": "Enabled",
                    "value": "enabled"
                },
                {
                    "label": "Disabled",
                    "value": "disabled"
                }
            ],
            "searchWhenChanged": true,
            "default": "enabled",
            "showClearButton": true,
            "prefix": "data_monitored_state=\"",
            "suffix": "\"",
            "initialValue": "enabled",
            "selectFirstChoice": false,
            "value": "$form.data_monitored_state$",
            "el": $('#inputDataHostMonitoredState')
        }, {
            tokens: true
        }).render();

        inputDataHostMonitoredState.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostMonitoredState);
        });

        var inputDataHostPriority = new MultiSelectInput({
            "id": "inputDataHostPriority",
            "choices": [
                {"label": "ALL", "value": "*"},
                {"label": "low", "value": "low"},
                {"label": "medium", "value": "medium"},
                {"label": "high", "value": "high"}
            ],
            "valuePrefix": "priority=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "searchWhenChanged": true,
            "initialValue": ["*"],
            "value": "$form.inputDataHostPriority$",
            "el": $('#inputDataHostPriority')
        }, {tokens: true}).render();

        inputDataHostPriority.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostPriority);
        });

        var inputMetricHostPriority = new MultiSelectInput({
            "id": "inputMetricHostPriority",
            "choices": [
                {"label": "ALL", "value": "*"},
                {"label": "low", "value": "low"},
                {"label": "medium", "value": "medium"},
                {"label": "high", "value": "high"}
            ],
            "valuePrefix": "priority=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "searchWhenChanged": true,
            "initialValue": ["*"],
            "value": "$form.inputMetricHostPriority$",
            "el": $('#inputMetricHostPriority')
        }, {tokens: true}).render();

        inputMetricHostPriority.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHostPriority);
        });

        var refreshForm = new DropdownInput({
            "id": "refreshForm",
            "choices": [{
                    "value": "60",
                    "label": "1 min"
                },
                {
                    "value": "120",
                    "label": "2 min"
                },
                {
                    "value": "300",
                    "label": "5 min"
                },
                {
                    "value": "3600",
                    "label": "none"
                }
            ],
            "selectFirstChoice": false,
            "default": "300",
            "showClearButton": true,
            "initialValue": "300",
            "searchWhenChanged": true,
            "value": "$refresh$",
            "el": $('#refreshForm')
        }, {
            tokens: true
        }).render();

        refreshForm.on("change", function(newValue) {
            FormUtils.handleValueChange(refreshForm);
        });

        var refreshHostForm = new DropdownInput({
            "id": "refreshHostForm",
            "choices": [{
                    "value": "60",
                    "label": "1 min"
                },
                {
                    "value": "120",
                    "label": "2 min"
                },
                {
                    "value": "300",
                    "label": "5 min"
                },
                {
                    "value": "3600",
                    "label": "none"
                }
            ],
            "selectFirstChoice": false,
            "default": "300",
            "showClearButton": true,
            "initialValue": "300",
            "searchWhenChanged": true,
            "value": "$refresh$",
            "el": $('#refreshHostForm')
        }, {
            tokens: true
        }).render();

        refreshForm.on("change", function(newValue) {
            FormUtils.handleValueChange(refreshForm);
        });

        //
        // SERVICE OBJECT
        //

        // Create a service object using the Splunk SDK for JavaScript
        // to send REST requests
        var service = mvc.createService({
            owner: "nobody"
        });

        //
        // BEGIN OPERATIONS
        //

        // Audit changes
        var tokens = mvc.Components.get("default");
        var currentUser = Splunk.util.getConfigValue("USERNAME");
        tokens.set("currentUser", currentUser);
        var auditendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_audit_changes/"

        // FUNCTIONS

        function updateDataSource(tk_keyid) {


            // Perform a target search to update key values
            var searchQuery = "| savedsearch trackme_get_data_source_table_by_key key=" + tk_keyid;

            // Set the search parameters
            var searchParams = {
              exec_mode: "normal",
              earliest_time: "-5m"
            };

            service.search(
              searchQuery,
              searchParams,
              function(err, job) {

                // Poll the status of the search job
                job.track({period: 200}, {
                  done: function(job) {

                    // Get the results and print them
                    job.results({}, function(err, results, job) {
                      var fields = results.fields;
                      var rows = results.rows;
                      for(var i = 0; i < rows.length; i++) {
                        var values = rows[i];
                        for(var j = 0; j < values.length; j++) {
                          var field = fields[j];
                          var value = values[j];

                            // update state color
                            if (field == "data_source_state") {
                                setToken("tk_data_source_state", value);
                                tk_data_source_state = value
                                // Dynamically manage state color
                                if (tk_data_source_state == "green") {
                                    setToken("tk_data_source_state_class", "title_green");
                                    setToken("tk_data_source_status_message_class", "status_message_green");
                                } else if (tk_data_source_state == "orange") {
                                    setToken("tk_data_source_state_class", "title_orange");
                                    setToken("tk_data_source_status_message_class", "status_message_orange");
                                } else if (tk_data_source_state == "blue") {
                                    setToken("tk_data_source_state_class", "title_blue");
                                    setToken("tk_data_source_status_message_class", "status_message_blue");
                                } else if (tk_data_source_state == "red") {
                                    setToken("tk_data_source_state_class", "title_red");
                                    setToken("tk_data_source_status_message_class", "status_message_red");
                                }
                            }

                            // update priority color
                            if (field == "priority") {
                                setToken("tk_priority", value);
                                tk_priority = value
                                // Dynamically manage state color
                                if (tk_priority == "low") {
                                    setToken("tk_priority_class", "title_low_priority");
                                } else if (tk_priority == "medium") {
                                    setToken("tk_priority_class", "title_medium_priority");
                                } else if (tk_priority == "high") {
                                    setToken("tk_priority_class", "title_high_priority");
                                }
                            }

                            // update monitored state
                            if (field == "data_monitored_state") {
                                setToken("tk_data_monitored_state", value);
                                tk_data_monitored_state = value
                                // Dynamically manage state color
                                if (tk_data_monitored_state == "enabled") {
                                    document.getElementById('btn_enable_monitoring').disabled = true;
                                    document.getElementById('btn_disable_monitoring').disabled = false;
                                    setToken("tk_data_monitored_state_class", "title_green");
                                } else {
                                    document.getElementById('btn_enable_monitoring').disabled = false;
                                    document.getElementById('btn_disable_monitoring').disabled = true;
                                    setToken("tk_data_monitored_state_class", "title_grey");
                                }
                            }

                            // update lag summary
                            if (field == "lag (event / ingestion)") {
                                setToken("tk_data_lag_summary", value);
                                tk_data_lag_summary = value
                            }

                            // update last time
                            if (field == "last time") {
                                setToken("tk_data_last_time_seen_human", value);
                                tk_data_last_time_seen_human = value
                            }

                            // update last ingest
                            if (field == "last ingest") {
                                setToken("tk_data_last_ingest_human", value);
                                tk_data_last_ingest_human = value
                            }

                            // update data_monitoring_level
                            if (field == "data_monitoring_level") {
                                setToken("tk_data_monitoring_level", value);
                                tk_data_monitoring_level = value
                            }

                            // update data_max_lag_allowed
                            if (field == "data_max_lag_allowed") {
                                setToken("tk_data_max_lag_allowed", value);
                                tk_data_max_lag_allowed = value
                            }

                            // update flip
                            if (field == "latest_flip_time (translated)") {
                                setToken("tk_latest_flip_time_human", value);
                                tk_latest_flip_time_human = value
                            }

                            if (field == "latest_flip_state") {
                                setToken("tk_latest_flip_state", value);
                                tk_latest_flip_state = value
                            }

                            // update status_message
                            if (field == "status_message") {
                                setToken("tk_status_message", value);
                                tk_status_message = value
                            }

                            // update data sampling
                            if (field == "data_sample_status_message") {
                                setToken("tk_data_sampling_status_message", value);
                                tk_data_sampling_status_message = value
                            }

                            // update state color
                            if (field == "data_sample_status_colour") {
                                setToken("tk_data_sampling_status_message_class", value);
                                tk_data_sampling_status_message_class = value
                                // Dynamically manage state color
                                if (tk_data_sampling_status_message_class == "green") {
                                    setToken("tk_data_sampling_status_message_class", "status_message_green");
                                } else if (tk_data_sampling_status_message_class == "orange") {
                                    setToken("tk_data_sampling_status_message_class", "status_message_orange");
                                } else if (tk_data_sampling_status_message_class == "blue") {
                                    setToken("tk_data_sampling_status_message_class", "status_message_blue");
                                } else if (tk_data_sampling_status_message_class == "red") {
                                    setToken("tk_data_sampling_status_message_class", "status_message_red");
                                }
                            }

                        }
                      }
                    });

                  },
                  failed: function(job) {
                  },
                  error: function(err) {
                    done(err);
                  }
                });

              }
            );

        }

        function updateDataHost(tk_keyid) {


            // Perform a target search to update key values
            var searchQuery = "| savedsearch trackme_get_data_host_table_by_key key=" + tk_keyid;

            // Set the search parameters
            var searchParams = {
              exec_mode: "normal",
              earliest_time: "-5m"
            };

            service.search(
              searchQuery,
              searchParams,
              function(err, job) {

                // Poll the status of the search job
                job.track({period: 200}, {
                  done: function(job) {

                    // Get the results and print them
                    job.results({}, function(err, results, job) {
                      var fields = results.fields;
                      var rows = results.rows;
                      for(var i = 0; i < rows.length; i++) {
                        var values = rows[i];
                        for(var j = 0; j < values.length; j++) {
                          var field = fields[j];
                          var value = values[j];

                            // update state color
                            if (field == "data_host_state") {
                                setToken("tk_data_host_state", value);
                                tk_data_host_state = value
                                // Dynamically manage state color
                                if (tk_data_host_state == "green") {
                                    setToken("tk_data_host_state_class", "title_green");
                                    setToken("tk_data_host_status_message_class", "status_message_green");
                                } else if (tk_data_host_state == "orange") {
                                    setToken("tk_data_host_state_class", "title_orange");
                                    setToken("tk_data_host_status_message_class", "status_message_orange");
                                } else if (tk_data_host_state == "blue") {
                                    setToken("tk_data_host_state_class", "title_blue");
                                    setToken("tk_data_host_status_message_class", "status_message_blue");
                                } else if (tk_data_host_state == "red") {
                                    setToken("tk_data_host_state_class", "title_red");
                                    setToken("tk_data_host_status_message_class", "status_message_red");
                                }
                            }

                            // update priority color
                            if (field == "priority") {
                                setToken("tk_priority", value);
                                tk_priority = value
                                // Dynamically manage state color
                                if (tk_priority == "low") {
                                    setToken("tk_priority_class", "title_low_priority");
                                } else if (tk_priority == "medium") {
                                    setToken("tk_priority_class", "title_medium_priority");
                                } else if (tk_priority == "high") {
                                    setToken("tk_priority_class", "title_high_priority");
                                }
                            }

                            // update monitored state
                            if (field == "data_monitored_state") {
                                setToken("tk_data_monitored_state", value);
                                tk_data_monitored_state = value
                                // Dynamically manage state color
                                if (tk_data_monitored_state == "enabled") {
                                    document.getElementById('btn_enable_monitoring').disabled = true;
                                    document.getElementById('btn_disable_monitoring').disabled = false;
                                    setToken("tk_data_monitored_state_class", "title_green");
                                } else {
                                    document.getElementById('btn_enable_monitoring').disabled = false;
                                    document.getElementById('btn_disable_monitoring').disabled = true;
                                    setToken("tk_data_monitored_state_class", "title_grey");
                                }
                            }

                            // update lag summary
                            if (field == "lag (event / ingestion)") {
                                setToken("tk_data_lag_summary", value);
                                tk_data_lag_summary = value
                            }

                            // update last time
                            if (field == "last time") {
                                setToken("tk_data_last_time_seen_human", value);
                                tk_data_last_time_seen_human = value
                            }

                            // update last ingest
                            if (field == "last ingest") {
                                setToken("tk_data_last_ingest_human", value);
                                tk_data_last_ingest_human = value
                            }

                            // update data_monitoring_level
                            if (field == "data_monitoring_level") {
                                setToken("tk_data_monitoring_level", value);
                                tk_data_monitoring_level = value
                            }

                            // update data_max_lag_allowed
                            if (field == "data_max_lag_allowed") {
                                setToken("tk_data_max_lag_allowed", value);
                                tk_data_max_lag_allowed = value
                            }

                            // update flip
                            if (field == "latest_flip_time (translated)") {
                                setToken("tk_latest_flip_time_human", value);
                                tk_latest_flip_time_human = value
                            }

                            if (field == "latest_flip_state") {
                                setToken("tk_latest_flip_state", value);
                                tk_latest_flip_state = value
                            }

                            // update status_message
                            if (field == "status_message") {
                                setToken("tk_status_message", value);
                                tk_status_message = value
                            }

                        }
                      }
                    });

                  },
                  failed: function(job) {
                  },
                  error: function(err) {
                    done(err);
                  }
                });

              }
            );

        }

        function clearDataHost(tk_data_host, tk_comment) {


            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/data_hosts/dh_reset";

            // Create a dictionary to store the field names and values
            var record = {
                "data_host": tk_data_host,
                "update_comment": tk_comment
            };

            $.ajax({
                url: myendpoint_URl,
                type: "POST",
                async: true,
                contentType: "application/json",
                dataType: "text",
                beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                data: JSON.stringify(record),
                success: function(returneddata) {
                    // Nothind to do yet
                },
                error: function(xhr, textStatus, error) {
                    message = "server response: " + xhr.responseText + "\n - http response: " + error;

                    // Audit
                    action = "failure";
                    change_type = "reset data";
                    object = tk_data_host;
                    object_category = "data_host";
                    object_attrs = "N/A";
                    result = message;
                    comment = tk_comment;
                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                    $("#modal_update_collection_failure_return").modal()
                }
            });

            // Perform a target search to update key values
            var searchQuery = "| savedsearch \"TrackMe - Data host entity refresh\" host=" + tk_data_host;

            // Set the search parameters
            var searchParams = {
            exec_mode: "normal",
            earliest_time: "-4h"
            };

            service.search(
            searchQuery,
            searchParams,
            function(err, job) {

                // Poll the status of the search job
                job.track({period: 200}, {
                done: function(job) {

                    // Get the results and print them
                    job.results({}, function(err, results, job) {
                    var fields = results.fields;
                    var rows = results.rows;
                    for(var i = 0; i < rows.length; i++) {
                        var values = rows[i];
                        for(var j = 0; j < values.length; j++) {
                        var field = fields[j];
                        var value = values[j];

                        }
                    }
                    });

                },
                failed: function(job) {
                },
                error: function(err) {
                    done(err);
                }
                });

            }
            );

        }

        function clearMetricHost(tk_metric_host, tk_comment) {


            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/metric_hosts/mh_reset";

            // Create a dictionary to store the field names and values
            var record = {
                "metric_host": tk_metric_host,
                "update_comment": tk_comment
            };

            $.ajax({
                url: myendpoint_URl,
                type: "POST",
                async: true,
                contentType: "application/json",
                dataType: "text",
                beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                data: JSON.stringify(record),
                success: function(returneddata) {
                    // Nothind to do yet
                },
                error: function(xhr, textStatus, error) {
                    message = "server response: " + xhr.responseText + "\n - http response: " + error;

                    // Audit
                    action = "failure";
                    change_type = "reset metrics";
                    object = tk_metric_host;
                    object_category = "metric_host";
                    object_attrs = "N/A";
                    result = message;
                    comment = tk_comment;
                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                    $("#modal_update_collection_failure_return").modal()
                }
            });

            // Perform a target search to update key values
            var searchQuery = "| savedsearch trackme_update_metric_host_target_by_metric_host host=\"" + tk_metric_host + "\"";

            // Set the search parameters
            var searchParams = {
            exec_mode: "normal",
            earliest_time: "-5m"
            };

            service.search(
            searchQuery,
            searchParams,
            function(err, job) {

                // Poll the status of the search job
                job.track({period: 200}, {
                done: function(job) {

                    // Get the results and print them
                    job.results({}, function(err, results, job) {
                    var fields = results.fields;
                    var rows = results.rows;
                    for(var i = 0; i < rows.length; i++) {
                        var values = rows[i];
                        for(var j = 0; j < values.length; j++) {
                        var field = fields[j];
                        var value = values[j];

                        }
                    }
                    });

                },
                failed: function(job) {
                },
                error: function(err) {
                    done(err);
                }
                });

            }
            );

        }

        function updateMetricHost(tk_keyid) {


            // Perform a target search to update key values
            var searchQuery = "| savedsearch trackme_get_metric_host_table_by_key key=\"" + tk_keyid + "\"";

            // Set the search parameters
            var searchParams = {
              exec_mode: "normal",
              earliest_time: "-5m"
            };

            service.search(
              searchQuery,
              searchParams,
              function(err, job) {

                // Poll the status of the search job
                job.track({period: 200}, {
                  done: function(job) {

                    // Get the results and print them
                    job.results({}, function(err, results, job) {
                      var fields = results.fields;
                      var rows = results.rows;
                      for(var i = 0; i < rows.length; i++) {
                        var values = rows[i];
                        for(var j = 0; j < values.length; j++) {
                          var field = fields[j];
                          var value = values[j];

                            // update state color
                            if (field == "metric_host_state") {
                                setToken("tk_metric_host_state", value);
                                tk_metric_host_state = value
                                // Dynamically manage state color
                                if (tk_metric_host_state == "green") {
                                    setToken("tk_metric_host_state_class", "title_green");
                                    setToken("tk_metric_host_status_message_class", "status_message_green");
                                } else if (tk_metric_host_state == "orange") {
                                    setToken("tk_metric_host_state_class", "title_orange");
                                    setToken("tk_metric_host_status_message_class", "status_message_orange");
                                } else if (tk_metric_host_state == "blue") {
                                    setToken("tk_metric_host_state_class", "title_blue");
                                    setToken("tk_metric_host_status_message_class", "status_message_blue");
                                } else if (tk_metric_host_state == "red") {
                                    setToken("tk_metric_host_state_class", "title_red");
                                    setToken("tk_metric_host_status_message_class", "status_message_red");
                                }
                            }

                            // update priority color
                            if (field == "priority") {
                                setToken("tk_priority", value);
                                tk_priority = value
                                // Dynamically manage state color
                                if (tk_priority == "low") {
                                    setToken("tk_priority_class", "title_low_priority");
                                } else if (tk_priority == "medium") {
                                    setToken("tk_priority_class", "title_medium_priority");
                                } else if (tk_priority == "high") {
                                    setToken("tk_priority_class", "title_high_priority");
                                }
                            }

                            // update monitored state
                            if (field == "metric_monitored_state") {
                                setToken("tk_metric_monitored_state", value);
                                tk_metric_monitored_state = value
                                // Dynamically manage state color
                                if (tk_metric_monitored_state == "enabled") {
                                    document.getElementById('btn_enable_monitoring').disabled = true;
                                    document.getElementById('btn_disable_monitoring').disabled = false;
                                    setToken("tk_metric_monitored_state_class", "title_green");
                                } else {
                                    document.getElementById('btn_enable_monitoring').disabled = false;
                                    document.getElementById('btn_disable_monitoring').disabled = true;
                                    setToken("tk_metric_monitored_state_class", "title_grey");
                                }
                            }

                            // update last time
                            if (field == "last time") {
                                setToken("tk_metric_last_time_seen_human", value);
                                tk_metric_last_time_seen_human = value
                            }

                            // update flip
                            if (field == "latest_flip_time (translated)") {
                                setToken("tk_latest_flip_time_human", value);
                                tk_latest_flip_time_human = value
                            }

                            if (field == "latest_flip_state") {
                                setToken("tk_latest_flip_state", value);
                                tk_latest_flip_state = value
                            }

                            // update status_message
                            if (field == "status_message") {
                                setToken("tk_status_message", value);
                                tk_status_message = value
                            }

                        }
                      }
                    });

                  },
                  failed: function(job) {
                  },
                  error: function(err) {
                    done(err);
                  }
                });

              }
            );

        }

        function updateDataSourceEntity(tk_data_name, tk_data_index, tk_data_sourcetype) {


            // First retrieve the name of the search to run depending on the context

            // Define the query
            var searchQuery = "| `trackme_get_tracker_data_source(\"" + tk_data_name + "\", \"" + tk_data_index + "\", \"" + tk_data_sourcetype + "\")`";

            // Set the search parameters
            var searchParams = {
              exec_mode: "normal",
              earliest_time: "-4h"
            };

            // Run a oneshot search that returns the job's results
            service.oneshotSearch(
                searchQuery,
                searchParams,
                function(err, results) {

                    // Display the results
                    var fields = results.fields;
                    var rows = results.rows;
                    var current_maintenance_mode;
                    var current_time_updated;

                    for (var i = 0; i < rows.length; i++) {
                        var values = rows[i];

                        for (var j = 0; j < values.length; j++) {
                            var field = fields[j];

                            if (fields[j] == "savedsearch_name") {
                                savedsearch_name = values[j];
                            }
                        }
                    }


                    var searchQuery = "| savedsearch " + savedsearch_name;

                    // Set the search parameters
                    var searchParams = {
                      exec_mode: "normal",
                      earliest_time: "-4h"
                    };

                    service.search(
                      searchQuery,
                      searchParams,
                      function(err, job) {

                        // Poll the status of the search job
                        job.track({period: 200}, {
                          done: function(job) {

                            // Get the results and print them
                            job.results({}, function(err, results, job) {
                              var fields = results.fields;
                              var rows = results.rows;
                              for(var i = 0; i < rows.length; i++) {
                                var values = rows[i];
                                for(var j = 0; j < values.length; j++) {
                                  var field = fields[j];
                                  var value = values[j];

                                }
                              }
                            });

                          },
                          failed: function(job) {
                          },
                          error: function(err) {
                            done(err);
                          }
                        });

                      }
                    );

            });

        }

        function updateDataHostEntity(tk_summary_report, tk_data_host) {


            // Perform a target search to update key values
            var searchQuery = "| savedsearch \"TrackMe - Data host entity refresh\" host=" + tk_data_host;

            // Set the search parameters
            var searchParams = {
              exec_mode: "normal",
              earliest_time: "-4h"
            };

            service.search(
              searchQuery,
              searchParams,
              function(err, job) {

                // Poll the status of the search job
                job.track({period: 200}, {
                  done: function(job) {

                    // Get the results and print them
                    job.results({}, function(err, results, job) {
                      var fields = results.fields;
                      var rows = results.rows;
                      for(var i = 0; i < rows.length; i++) {
                        var values = rows[i];
                        for(var j = 0; j < values.length; j++) {
                          var field = fields[j];
                          var value = values[j];

                        }
                      }
                    });

                  },
                  failed: function(job) {
                  },
                  error: function(err) {
                    done(err);
                  }
                });

              }
            );

        }

        // This function generates outliers statistics and be called when the outliers period calculaton is changed

        function metricOutliersGen(object_category, object, TargetOutlierTimePeriod) {


            // Perform a target search to update key values
            var searchQuery = "| `trackme_outliers_gen_metrics(" + object_category + "," + object + "," + TargetOutlierTimePeriod + ")`";

            // Set the search parameters
            var searchParams = {
                exec_mode: "normal",
                earliest_time: "-30d"
            };

            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    // Poll the status of the search job
                    job.track({
                        period: 200
                    }, {
                        done: function(job) {

                            // Get the results and print them
                            job.results({}, function(err, results, job) {
                                var fields = results.fields;
                                var rows = results.rows;
                                for (var i = 0; i < rows.length; i++) {
                                    var values = rows[i];
                                    for (var j = 0; j < values.length; j++) {
                                        var field = fields[j];
                                        var value = values[j];

                                    }
                                }

                                // Perform a target search to update key values
                                var searchQuery = "| `trackme_summary_investigator_mstats(" + object_category + "," + object + ")`" + " `trackme_summary_investigator_define_bound_abstract` | eval key = md5(object_category . \":\" . object) | `trackme_outputlookup(trackme_summary_investigator_volume_outliers, key)` | stats c";

                                // Set the search parameters
                                var searchParams = {
                                    exec_mode: "normal",
                                    earliest_time: "-30d"
                                };

                                service.search(
                                    searchQuery,
                                    searchParams,
                                    function(err, job) {

                                        // Poll the status of the search job
                                        job.track({
                                            period: 200
                                        }, {
                                            done: function(job) {

                                                // Get the results and print them
                                                job.results({}, function(err, results, job) {
                                                    var fields = results.fields;
                                                    var rows = results.rows;
                                                    for (var i = 0; i < rows.length; i++) {
                                                        var values = rows[i];
                                                        for (var j = 0; j < values.length; j++) {
                                                            var field = fields[j];
                                                            var value = values[j];

                                                        }
                                                    }
                                                });

                                            },
                                            failed: function(job) {},
                                            error: function(err) {
                                                done(err);
                                            }
                                        });

                                    }
                                );

                            });

                        },
                        failed: function(job) {},
                        error: function(err) {
                            done(err);
                        }
                    });

                }
            );

        }

        //
        // ALERT SUMMARY
        //

        $("#btn_refresh_alerts").click(function() {
            submitTokens();
            search_alerts_main_table.startSearch();
            searchDonutAlertsTriggered.startSearch();
            searchAlertTriggeredOverTime.startSearch();
        });

        $("#btn_refresh_alert_tracking").click(function() {
            submitTokens();
            searchAlertTriggeredOverTimePerAlert.startSearch();
            searchPopulateAlertActionsAck.startSearch();
            searchPopulateAlertActionsSmartStatus.startSearch();
            searchPopulateAlertActionsFreeStyle.startSearch();
            searchAlertActionsTriggeredOverTimePerAlert.startSearch();
            searchAlertActionsAckEventsOverTimePerAlert.startSearch();
            searchAlertActionsSmartStatusdEventsOverTimePerAlert.startSearch();
            searchAlertActionsFreeStyleEventsOverTimePerAlert.startSearch();
        });        

        $("#btn_create_alert").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // fire up some searches
            setToken("start_get_tags_for_custom_alert", "true");

            $("#add_custom_alert").modal();
        });

        $("#btn_modal_custom_alert_add_new").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_custom_alert_name = tokens.get("tk_input_custom_alert_name");
            var tk_input_create_alert_data_source = tokens.get("create_alert_data_source");
            var tk_input_create_alert_data_host = tokens.get("create_alert_data_host");
            var tk_input_create_alert_metric_host = tokens.get("create_alert_metric_host");
            var tk_input_custom_alert_priority = tokens.get("tk_input_custom_alert_priority");
            var tk_input_custom_alert_state = tokens.get("tk_input_custom_alert_state");
            var tk_input_custom_alert_data_source_filter = tokens.get("tk_input_custom_alert_data_source_filter");
            var tk_input_custom_alert_data_host_filter = tokens.get("tk_input_custom_alert_data_host_filter");
            var tk_input_custom_alert_metric_host_filter = tokens.get("tk_input_custom_alert_metric_host_filter");
            var tk_input_custom_tags = tokens.get("tk_input_custom_tags");
            var tk_input_custom_alert_trigger_on_outliers = tokens.get("tk_input_custom_alert_trigger_on_outliers");
            var tk_input_custom_alert_trigger_on_outliers_data_host = tokens.get("tk_input_custom_alert_trigger_on_outliers_data_host");
            var tk_input_custom_alert_trigger_on_data_sampling = tokens.get("tk_input_custom_alert_trigger_on_data_sampling");
            var tk_input_custom_alert_cron = tokens.get("tk_input_custom_alert_cron");
            var tk_input_custom_alert_suppress_fields = tokens.get("tk_input_custom_alert_suppress_fields");
            var tk_input_custom_alert_suppress_period = tokens.get("tk_input_custom_alert_suppress_period");
            var tk_input_custom_alert_time_filtering = tokens.get("tk_input_custom_alert_time_filtering");
            var tk_input_custom_alert_smart_status = tokens.get("tk_input_custom_alert_smart_status");
            var tk_input_custom_alert_auto_ack = tokens.get("tk_input_custom_alert_auto_ack");

            // Splunk limits report names to max 100 chars, and will refuse otherwise
            var tk_tracker_name = tk_input_custom_alert_name.substring(0, 100);

            // define the alert search
            var tk_custom_alert;
            var tk_object_category;

            if (tk_input_create_alert_data_source == "true") {

                tk_object_category = "data_source";
                tk_custom_alert = "| inputlookup trackme_data_source_monitoring\n| appendcols [ | inputlookup trackme_maintenance_mode ] | filldown maintenance_mode | where NOT maintenance_mode=\"enabled\"";

                // get state
                tk_custom_alert = tk_custom_alert + "\n| `trackme_eval_data_source_state`";

                // add the data_name filter
                tk_custom_alert = tk_custom_alert + "\n| search data_name=\"" +  tk_input_custom_alert_data_source_filter + "\"";

                // add the priority filter
                tk_custom_alert = tk_custom_alert + "\n| search " +  tk_input_custom_alert_priority;

                // add the state filter
                tk_custom_alert = tk_custom_alert + "\n| eval state=coalesce(data_source_state,data_host_state,metric_host_state) | where (state=\"red\" OR state=\"orange\") | search " +  tk_input_custom_alert_state;

                // handle tags
                if (tk_input_custom_tags != "tags=\"*\"") {
                    tk_custom_alert = tk_custom_alert + "\n| makemv delim=\",\" tags | search " + tk_input_custom_tags;
                }
    
                // handle outliers
                if (tk_input_custom_alert_trigger_on_outliers == "false") {
                    tk_custom_alert = tk_custom_alert + "\n| where isOutlier=0 ";
                }

                // handle data sampling
                if (tk_input_custom_alert_trigger_on_data_sampling == "false") {
                    tk_custom_alert = tk_custom_alert + "\n| where isAnomaly=0";
                }

                // terminate the search
                tk_custom_alert = tk_custom_alert + "\n| search `trackme_get_idx_whitelist_searchtime(trackme_data_source_monitoring_whitelist_index, data_index)`";
                tk_custom_alert = tk_custom_alert + "\n| `apply_data_source_blacklists`";
                tk_custom_alert = tk_custom_alert + "\n| where data_monitored_state=\"enabled\"";

                // handle time filtering
                tk_custom_alert = tk_custom_alert + "\n| `" + tk_input_custom_alert_time_filtering + "`";

                tk_custom_alert = tk_custom_alert + "\n| `trackme_date_format(data_last_ingest)`";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_date_format(data_last_time_seen)`";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_date_format(data_tracker_runtime)`";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_date_format(data_previous_tracker_runtime)`";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_eval_icons`";
                tk_custom_alert = tk_custom_alert + "\n| rename \"* (translated)\" as \"*\"";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_get_identity_card(data_name)`";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_ack_lookup(data_name, data_source)`";
                tk_custom_alert = tk_custom_alert + "\n| fields - monitoring, state";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_alerts_order_data_source`";

            }
            else if (tk_input_create_alert_data_host == "true") {

                tk_object_category = "data_host";
                tk_custom_alert = "| inputlookup trackme_host_monitoring\n| appendcols [ | inputlookup trackme_maintenance_mode ] | filldown maintenance_mode | where NOT maintenance_mode=\"enabled\"";

                // get state
                tk_custom_alert = tk_custom_alert + "\n| `trackme_eval_data_host_state`";

                // add the data_host filter
                tk_custom_alert = tk_custom_alert + "\n| search data_host=\"" +  tk_input_custom_alert_data_host_filter + "\"";

                // add the priority filter
                tk_custom_alert = tk_custom_alert + "\n| search " +  tk_input_custom_alert_priority;

                // add the state filter
                tk_custom_alert = tk_custom_alert + "\n| eval state=coalesce(data_source_state,data_host_state,metric_host_state) | where (state=\"red\" OR state=\"orange\") | search " +  tk_input_custom_alert_state;

                // handle outliers
                if (tk_input_custom_alert_trigger_on_outliers == "false") {
                    tk_custom_alert = tk_custom_alert + "\n| where isOutlier=0 ";
                }

                // terminate the search
                tk_custom_alert = tk_custom_alert + "\n| makemv delim=\",\" data_index";
                tk_custom_alert = tk_custom_alert + "\n| makemv delim=\",\" data_sourcetype";
                tk_custom_alert = tk_custom_alert + "\n| makemv delim=\",\" data_host_st_summary";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_data_host_extract_mvstsummary` | fields - summary_first_time	summary_idx	summary_last_ingest	time, data_host_st_summary";
                tk_custom_alert = tk_custom_alert + "\n| search `trackme_get_idx_whitelist_searchtime(trackme_data_host_monitoring_whitelist_index, data_index)`";
                tk_custom_alert = tk_custom_alert + "\n| `apply_data_host_blacklists`";
                tk_custom_alert = tk_custom_alert + "\n| where data_monitored_state=\"enabled\"";

                // handle time filtering
                tk_custom_alert = tk_custom_alert + "\n| `" + tk_input_custom_alert_time_filtering + "`";

                tk_custom_alert = tk_custom_alert + "\n| `trackme_data_host_group_lookup`";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_date_format(data_last_ingest)`";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_date_format(data_last_time_seen)`";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_date_format(data_tracker_runtime)`";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_date_format(data_previous_tracker_runtime)`";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_eval_icons_host`";
                tk_custom_alert = tk_custom_alert + "\n| rename \"* (translated)\" as \"*\"";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_ack_lookup(data_host, data_host)`";
                tk_custom_alert = tk_custom_alert + "\n| fields - monitoring, state, data_index, data_sourcetype";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_alerts_order_data_host`";

            }
            else if (tk_input_create_alert_metric_host == "true") {

                tk_object_category = "metric_host";
                tk_custom_alert = "| inputlookup trackme_metric_host_monitoring\n| appendcols [ | inputlookup trackme_maintenance_mode ] | filldown maintenance_mode | where NOT maintenance_mode=\"enabled\"";

                // add the metric_host filter
                tk_custom_alert = tk_custom_alert + "\n| search metric_host=\"" +  tk_input_custom_alert_metric_host_filter + "\"";

                // add the priority filter
                tk_custom_alert = tk_custom_alert + "\n| search " +  tk_input_custom_alert_priority;

                // add the state filter
                tk_custom_alert = tk_custom_alert + "\n| eval state=coalesce(data_source_state,data_host_state,metric_host_state) | where (state=\"red\" OR state=\"orange\") | search " +  tk_input_custom_alert_state;

                // terminate the search
                tk_custom_alert = tk_custom_alert + "\n| makemv delim=\",\" metric_index";
                tk_custom_alert = tk_custom_alert + "\n| search `trackme_get_idx_whitelist_searchtime(trackme_metric_host_monitoring_whitelist_index, metric_index)`";
                tk_custom_alert = tk_custom_alert + "\n| `apply_metric_host_blacklists`";
                tk_custom_alert = tk_custom_alert + "\n| where metric_monitored_state=\"enabled\"";

                // handle time filtering
                tk_custom_alert = tk_custom_alert + "\n| `" + tk_input_custom_alert_time_filtering + "`";

                tk_custom_alert = tk_custom_alert + "\n| `trackme_date_format(metric_last_time_seen)`";
                tk_custom_alert = tk_custom_alert + "\n| eval \"last time\"='metric_last_time_seen (translated)'";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_date_format(metric_tracker_runtime)`";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_date_format(metric_previous_tracker_runtime)`";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_eval_icons_metric_host`";
                tk_custom_alert = tk_custom_alert + "\n| rename \"* (translated)\" as \"*\"";
                tk_custom_alert = tk_custom_alert + "\n| makemv metric_category delim=\",\"";
                tk_custom_alert = tk_custom_alert + "\n| makemv metric_details delim=\",\"";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_ack_lookup(metric_host, metric_host)`";
                tk_custom_alert = tk_custom_alert + "\n| `trackme_alerts_order_metric_host`";

            }

            function done(err) {
                        //error handling logic here
                    }

            var alertOptions;

            // Specify properties for the alert.
            if (tk_input_custom_alert_auto_ack == "1" && tk_input_custom_alert_smart_status == "1") {
                alertOptions = {
                    name: tk_tracker_name,
                    description: "TrackMe alert",
                    search: tk_custom_alert,
                    "alert_type": "always",
                    "alert.severity": "5",
                    "alert.suppress": "1",
                    "alert.suppress.fields": tk_input_custom_alert_suppress_fields,
                    "alert.suppress.period": tk_input_custom_alert_suppress_period,
                    "alert.track": "1",
                    "dispatch.earliest_time": "-5m",
                    "dispatch.latest_time": "now",
                    "is_scheduled": "1",
                    "alert_comparator": "greater than",
                    "alert_type": "number of events",
                    "alert_threshold": "0",
                    "alert.digest_mode": "0",
                    "cron_schedule": tk_input_custom_alert_cron,
                    "actions": "trackme_auto_ack,trackme_smart_status",
                    "action.trackme_auto_ack.param.object_category": "$result.object_category$",
                    "action.trackme_auto_ack.param.object_name": "$result.object$",
                    "action.trackme_smart_status.param.object_category": "$result.object_category$",
                    "action.trackme_smart_status.param.object_name": "$result.object$"                    
                };
            }
            else if (tk_input_custom_alert_auto_ack == "1") {
                alertOptions = {
                    name: tk_tracker_name,
                    description: "TrackMe alert",
                    search: tk_custom_alert,
                    "alert_type": "always",
                    "alert.severity": "1",
                    "alert.suppress": "1",
                    "alert.suppress.fields": tk_input_custom_alert_suppress_fields,
                    "alert.suppress.period": tk_input_custom_alert_suppress_period,
                    "alert.track": "1",
                    "dispatch.earliest_time": "-5m",
                    "dispatch.latest_time": "now",
                    "is_scheduled": "1",
                    "cron_schedule": tk_input_custom_alert_cron,
                    "actions": "trackme_auto_ack",                    
                    "action.trackme_auto_ack.param.object_category": "$result.object_category$",
                    "action.trackme_auto_ack.param.object_name": "$result.object$"
                };
            }
            else if (tk_input_custom_alert_smart_status == "1") {
                alertOptions = {
                    name: tk_tracker_name,
                    description: "TrackMe alert",
                    search: tk_custom_alert,
                    "alert_type": "always",
                    "alert.severity": "1",
                    "alert.suppress": "1",
                    "alert.suppress.fields": tk_input_custom_alert_suppress_fields,
                    "alert.suppress.period": tk_input_custom_alert_suppress_period,
                    "alert.track": "1",
                    "dispatch.earliest_time": "-5m",
                    "dispatch.latest_time": "now",
                    "is_scheduled": "1",
                    "cron_schedule": tk_input_custom_alert_cron,
                    "actions": "trackme_smart_status",
                    "action.trackme_smart_status.param.object_category": "$result.object_category$",
                    "action.trackme_smart_status.param.object_name": "$result.object$"                   
                };
            }
            else {
                alertOptions = {
                    name: tk_tracker_name,
                    description: "TrackMe alert",
                    search: tk_custom_alert,
                    "alert_type": "always",
                    "alert.severity": "1",
                    "alert.suppress": "1",
                    "alert.suppress.fields": tk_input_custom_alert_suppress_fields,
                    "alert.suppress.period": tk_input_custom_alert_suppress_period,
                    "alert.track": "1",
                    "dispatch.earliest_time": "-5m",
                    "dispatch.latest_time": "now",
                    "is_scheduled": "1",
                    "cron_schedule": tk_input_custom_alert_cron
                };
            }

            // Create a saved search/report as an alert.
            service.savedSearches().create(alertOptions, function(err, alert) {
                // Error checking.
                if (err && err.status === 409) {
                    msg = "ERROR: A saved search/report with the name " + alertOptions.name + " already exists";

                    // Audit
                    action = "failure";
                    change_type = "add custom alert";
                    object = tk_tracker_name;
                    object_category = tk_object_category;
                    object_attrs = tk_custom_alert;
                    result = msg;
                    comment = "N/A";
                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                    $("#modal_alert_creation_error").find('.modal-error-message p').text(msg);
                    $("#add_custom_alert").modal('hide');
                    $("#modal_alert_creation_error").modal()
                    done();
                    return;
                }
                else if (err) {
                    msg = "There was an error creating the saved search/report: error code " + err.status;

                    let errorStr = "Unknown Error!";
                    if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                        errorStr = "error code: " + err.status + " - " + err.data.messages[0]['text'];
                    } else if (err && err.data && err.data.messages) {
                        errorStr = JSON.stringify( "error code: " + err.status + " - " + err.data.messages);
                    }

                    // Audit
                    action = "failure";
                    change_type = "add custom alert";
                    object = tk_tracker_name;
                    object_category = tk_object_category;
                    object_attrs = tk_custom_alert;
                    result = errorStr;
                    comment = "N/A";
                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                    $("#modal_alert_creation_error").find('.modal-error-message p').text(errorStr);
                    $("#add_custom_alert").modal('hide');
                    $("#modal_alert_creation_error").modal()
                    done(err);
                    return;
                }

                else {

                    // Confirmation message.

                    // Audit
                    action = "success";
                    change_type = "add custom alert";
                    object = tk_tracker_name;
                    object_category = tk_object_category;
                    object_attrs = tk_custom_alert;
                    result = "N/A";
                    comment = "N/A";
                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                    msg = "Created saved search/report as alert: " + alert.name;
                    $("#modal_alert_creation_success").find('.modal-error-message p').text(msg);
                    $("#add_custom_alert").modal('hide');
                    $("#modal_alert_creation_success").modal()

                    search_alerts_main_table.startSearch();
                    searchDonutAlertsTriggered.startSearch();
                    searchAlertTriggeredOverTime.startSearch();

                    done();

                }

            });
            
        });
        
        // enable monitoring

        $("#btn_enable_monitoring").click(function(mode) {

            // Hide main modal
            $("#modal_manage").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/data_sources/ds_enable_monitoring";

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    // Retrieve update comment if any
                    var tk_comment = document.getElementById("input_update_comment").value;

                    // if is not defined, give it a value and override text box content
                    if (tk_comment == "null") {
                        setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else if (tk_comment == "update note") {
                        tk_comment = "No comment for update.";
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else {
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }

                    // Create a dictionary to store the field names and values
                    var record = {
                        "data_name": tk_data_name,
                        "update_comment": tk_comment
                    };

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        dataType: "text",
                        beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            // Run the search again to update the table
                            searchDataSourcesMain.startSearch();
                        },
                        error: function(xhr, textStatus, error) {
                            message = "server response: " + xhr.responseText + "\n - http response: " + error;

                            // Audit
                            action = "failure";
                            change_type = "enable monitoring";
                            object = tk_data_name;
                            object_category = "data_source";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = message;
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        $("#btn_enable_monitoring_host").click(function(mode) {

            // Hide main modal
            $("#modal_manage_host").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/data_hosts/dh_enable_monitoring";

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    // Retrieve update comment if any
                    var tk_comment = document.getElementById("input_update_comment").value;

                    // if is not defined, give it a value and override text box content
                    if (tk_comment == "null") {
                        setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else if (tk_comment == "update note") {
                        tk_comment = "No comment for update.";
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else {
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }

                    // Create a dictionary to store the field names and values
                    var record = {
                        "data_host": tk_data_host,
                        "update_comment": tk_comment
                    };

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        dataType: "text",
                        beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            // Run the search again to update the table
                            searchDataHostsMain.startSearch();
                        },
                        error: function(xhr, textStatus, error) {
                            message = "server response: " + xhr.responseText + "\n - http response: " + error;

                            // Audit
                            action = "failure";
                            change_type = "enable monitoring";
                            object = tk_data_host;
                            object_category = "data_host";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = message;
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        // refresh data_source
        $("#btn_refresh_data_source").click(function(mode) {
            // notify
            notification('Refresh completed.', 6000)
            searchSingleLag.startSearch();
            searchSingleByMetricsLag.startSearch();
            searchChartLag.startSearch();
            searchSingleSLApct.startSearch();
            searchOutlierDetectionChart.startSearch();
            searchOutlierDetectionTable.startSearch();
            searchLaggingMetricDataSource.startSearch();
            searchDataSourceMainAuditFlip.startSearch();
            searchDataSourceMainAuditChanges.startSearch();
            SearchDataSourceParsingQualityMain.startSearch();
            searchDataSourceTimeline.startSearch();
            // call update summary investigator for that entity only
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            updateDataSourceEntity(tk_data_name, tk_data_index, tk_data_sourcetype);
            // call update data source
            var tk_keyid = tokens.get("tk_keyid");
            updateDataSource(tk_keyid);
        });

        // refresh data_host
        $("#btn_refresh_data_host").click(function(mode) {
            // notify
            notification('Refresh completed.', 6000)
            searchSingleLagHost.startSearch();
            searchSingleLagByMetricsHost.startSearch();
            searchChartHostBaseSearch.startSearch();
            searchChartLagHostOverTime.startSearch();
            searchSingleSLAHostpct.startSearch();
            searchOutlierDetectionChartDataHost.startSearch();
            searchOutlierDetectionTableDataHost.startSearch();
            searchLaggingMetricDataHost.startSearch();
            searchDataHostMainAuditFlip.startSearch();
            searchDataHostMainAuditChanges.startSearch();
            SearchDataHostParsingQualityMain.startSearch();
            searchDataHostTimeline.startSearch();

            // call update summary investigator for that entity only
            var tk_data_host = tokens.get("tk_data_host");
            updateDataHostEntity("trackme_datahost_tracker_shorterm", tk_data_host);
            // call update data host
            var tk_keyid = tokens.get("tk_keyid");
            updateDataHost(tk_keyid);
        });

        // refresh metric_host
        $("#btn_refresh_metric_host").click(function(mode) {
            // notify
            notification('Refresh completed.', 6000)
            searchHostTableMetricHost.startSearch();
            searchSingleSLAMetricHostpct.startSearch();
            searchMetricHostMainAuditFlip.startSearch();
            searchMetricHostMainAuditChanges.startSearch();
            searchMetricHostTimeline.startSearch();

            var tk_keyid = tokens.get("tk_keyid");
            // call update metric host
            updateMetricHost(tk_keyid);
        });

        $("#btn_enable_monitoring_metric_host").click(function(mode) {

            // Hide main modal
            $("#modal_manage_metric_host").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_metric_host = tokens.get("tk_metric_host");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/metric_hosts/mh_enable_monitoring";

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    // Retrieve update comment if any
                    var tk_comment = document.getElementById("input_update_comment").value;

                    // if is not defined, give it a value and override text box content
                    if (tk_comment == "null") {
                        setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else if (tk_comment == "update note") {
                        tk_comment = "No comment for update.";
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else {
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }

                    // Create a dictionary to store the field names and values
                    var record = {
                        "metric_host": tk_metric_host,
                        "update_comment": tk_comment
                    };

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        dataType: "text",
                        beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            // Run the search again to update the table
                            searchMetricHostsMain.startSearch();
                        },
                        error: function(xhr, textStatus, error) {
                            message = "server response: " + xhr.responseText + "\n - http response: " + error;

                            // Audit
                            action = "failure";
                            change_type = "enable monitoring";
                            object = tk_metric_host;
                            object_category = "metric_host";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = message;
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        // cancel button: returns to selected
        $("#btn_close_metric_host_unified").click(function() {
            submitTokens();

            // Show modal
            $("#modal_manage_metric_host").modal();

        });

        // metric host priority
        $("#btn_modal_modify_priority_metric_host_confirm").click(function() {

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_metric_host = tokens.get("tk_metric_host");
            var tk_priority = tokens.get("tk_priority");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/metric_hosts/mh_update_priority";

            var tk_origin_priority = tk_priority;
            var tk_new_priority = tokens.get("tk_input_metric_host_priority");

            if (!tk_new_priority || !tk_new_priority.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
	                "metric_host": tk_metric_host,
	                "priority": tk_new_priority,
                    "update_comment": "N/A"
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    dataType: "text",
                    beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        // Run the search again to update the table
                        searchMetricHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // call update data source
                        updateMetricHost(tk_keyid);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "server response: " + xhr.responseText + "\n - http response: " + error;

                        // Audit
                        action = "failure";
                        change_type = "modify priority";
                        object = tk_metric_host;
                        object_category = "metric_host";
                        object_attrs = "priority changed from:" + tk_origin_priority + " to:" + tk_new_priority
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        // disable monitoring

        $("#btn_disable_monitoring").click(function(mode) {

            // Hide main modal
            $("#modal_manage").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/data_sources/ds_disable_monitoring";

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    // Retrieve update comment if any
                    var tk_comment = document.getElementById("input_update_comment").value;

                    // if is not defined, give it a value and override text box content
                    if (tk_comment == "null") {
                        setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else if (tk_comment == "update note") {
                        tk_comment = "No comment for update.";
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else {
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }

                    // Create a dictionary to store the field names and values
                    var record = {
                        "data_name": tk_data_name,
                        "update_comment": tk_comment
                    };

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        dataType: "text",
                        beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            // Run the search again to update the table
                            searchDataSourcesMain.startSearch();
                        },
                        error: function(xhr, textStatus, error) {
                            message = "server response: " + xhr.responseText + "\n - http response: " + error;

                            // Audit
                            action = "failure";
                            change_type = "disable monitoring";
                            object = tk_data_name;
                            object_category = "data_source";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = message;
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        $("#btn_disable_monitoring_host").click(function(mode) {

            // Hide main modal
            $("#modal_manage_host").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/data_hosts/dh_disable_monitoring";

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    // Retrieve update comment if any
                    var tk_comment = document.getElementById("input_update_comment").value;

                    // if is not defined, give it a value and override text box content
                    if (tk_comment == "null") {
                        setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else if (tk_comment == "update note") {
                        tk_comment = "No comment for update.";
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else {
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }

                    // Create a dictionary to store the field names and values
                    var record = {
                        "data_host": tk_data_host,
                        "update_comment": tk_comment
                    };

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        dataType: "text",
                        beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            // Run the search again to update the table
                            searchDataHostsMain.startSearch();
                        },
                        error: function(xhr, textStatus, error) {
                            message = "server response: " + xhr.responseText + "\n - http response: " + error;

                            // Audit
                            action = "failure";
                            change_type = "disable monitoring";
                            object = tk_data_host;
                            object_category = "data_host";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = message;
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        $("#btn_disable_monitoring_metric_host").click(function(mode) {

            // Hide main modal
            $("#modal_manage_metric_host").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_metric_host = tokens.get("tk_metric_host");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/metric_hosts/mh_disable_monitoring";

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    // Retrieve update comment if any
                    var tk_comment = document.getElementById("input_update_comment").value;

                    // if is not defined, give it a value and override text box content
                    if (tk_comment == "null") {
                        setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else if (tk_comment == "update note") {
                        tk_comment = "No comment for update.";
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else {
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }

                    // Create a dictionary to store the field names and values
                    var record = {
                        "metric_host": tk_metric_host,
                        "update_comment": tk_comment
                    };

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        dataType: "text",
                        beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            // Run the search again to update the table
                            searchMetricHostsMain.startSearch();
                        },
                        error: function(xhr, textStatus, error) {
                            message = "server response: " + xhr.responseText + "\n - http response: " + error;

                            // Audit
                            action = "failure";
                            change_type = "disable monitoring";
                            object = tk_metric_host;
                            object_category = "metric_host";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = message;
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        //
        // RESET BUTTON
        //

        $("#btn_reset_metric_host").click(function(mode) {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get tokens
            var tk_keyid = tokens.get("tk_keyid");
            var tk_metric_host= tokens.get("tk_metric_host");

            // Hide main modal
            $("#modal_manage_metric_host").modal('hide');


            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    // Retrieve update comment if any
                    var tk_comment = document.getElementById("input_update_comment").value;

                    // if is not defined, give it a value and override text box content
                    if (tk_comment == "null") {
                        setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else if (tk_comment == "update note") {
                        tk_comment = "No comment for update.";
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else {
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }

		            // notify
		            notification('Reset completed.', 6000)
		            // call reset metric host
		            clearMetricHost(tk_metric_host, tk_comment);
		            searchHostTableMetricHost.startSearch();
		            searchSingleSLAMetricHostpct.startSearch();
		            searchMetricHostMainAuditFlip.startSearch();
		            searchMetricHostMainAuditChanges.startSearch();
		            // call update metric host
		            updateMetricHost(tk_keyid);

                    // Return to modal
                    $("#modal_manage_metric_host").modal();

                });

            }

        });

        //
        // DELETE BUTTON
        //

        $("#btn_delete_metric_host").click(function() {

            // Hide main modal
            $("#modal_manage_metric_host").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_metric_host = tokens.get("tk_metric_host");
            var tk_metric_index = tokens.get("tk_metric_index");
            var tk_metric_category = tokens.get("tk_metric_category");
            var tk_metric_details = tokens.get("tk_metric_details");
            var tk_metric_last_lag_seen = tokens.get("tk_metric_last_lag_seen");
            var tk_metric_first_time_seen = tokens.get("tk_metric_first_time_seen");
            var tk_metric_last_time_seen = tokens.get("tk_metric_last_time_seen");
            var tk_metric_host_state = tokens.get("tk_metric_host_state");
            var tk_metric_tracker_runtime = tokens.get("tk_metric_tracker_runtime");
            var tk_metric_previous_host_state = tokens.get("tk_metric_previous_host_state");
            var tk_metric_previous_tracker_runtime = tokens.get("tk_metric_previous_tracker_runtime");
            var tk_metric_monitored_state = "disabled";
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");

            // Create a dictionary to store the field names and values
            var record = {
                "metric_host": tk_metric_host,
                "metric_index": tk_metric_index,
                "metric_category": tk_metric_category,
                "metric_details": tk_metric_details,
                "metric_last_lag_seen": tk_metric_last_lag_seen,
                "metric_first_time_seen": tk_metric_first_time_seen,
                "metric_last_time_seen": tk_metric_last_time_seen,
                "metric_monitored_state": tk_metric_monitored_state,
                "metric_host_state": tk_metric_host_state,
                "metric_tracker_runtime": tk_metric_tracker_runtime,
                "metric_previous_host_state": tk_metric_previous_host_state,
                "metric_previous_tracker_runtime": tk_metric_previous_tracker_runtime,
                "latest_flip_state": tk_latest_flip_state,
                "latest_flip_time": tk_latest_flip_time,
                "priority": tk_priority
            };

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring/" + tk_keyid;

            if (tk_keyid && tk_keyid.length) {

                $("#modal_entry_deletion").modal()

                $("#btn_modal_entry_deletion_temporary").unbind('click').click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $("#modal_entry_modification").modal()

                    $("#btn_modal_entry_modification").click(function() {

                        var that = $(this);
                        that.off('click'); // remove handler

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("input_update_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else {
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }

                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {
                                // Run the search again to update the table
                                searchMetricHostsMain.startSearch();

                                // Audit
                                action = "success";
                                change_type = "delete temporary";
                                object = tk_metric_host;
                                object_category = "metric_host";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);
                                return;
                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete temporary";
                                object = tk_metric_host;
                                object_category = "metric_host";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                                $("#modal_update_collection_failure_return").modal()
                            }

                        });

                    });

                });

                $("#btn_modal_entry_deletion").unbind('click').click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $("#modal_entry_modification").modal()

                    $("#btn_modal_entry_modification").click(function() {

                        var that = $(this);
                        that.off('click'); // remove handler

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("input_update_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else {
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }

                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {
                                // Run the search again to update the table
                                searchMetricHostsMain.startSearch();

                                // Audit
                                action = "success";
                                change_type = "delete permanent";
                                object = tk_metric_host;
                                object_category = "metric_host";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);
                                return;
                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete permanent";
                                object = tk_metric_host;
                                object_category = "metric_host";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                                $("#modal_update_collection_failure_return").modal()
                            }

                        });

                    });

                });

            }

        });

        // delete entry

        $("#btn_delete_data_source").click(function() {

            // Hide main modal
            $("#modal_manage").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_last_lag_seen_idx = tokens.get("tk_data_last_lag_seen_idx");
            var tk_data_last_time_seen_idx = tokens.get("tk_data_last_time_seen_idx");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_lag_alert_kpis = tokens.get("tk_data_lag_alert_kpis");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_monitoring_level = tokens.get("tk_data_monitoring_level");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");
            var tk_isanomaly = tokens.get("tk_isanomaly");
            var tk_data_sample_lastrun = tokens.get("tk_data_sample_lastrun");
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");
            var tk_dcount_host = tokens.get("tk_dcount_host");
            var tk_min_dcount_host = tokens.get("tk_min_dcount_host");
            var tk_tags = tokens.get("tk_tags");

            // Create a dictionary to store the field names and values
            var record = {
                "object_category": "data_source",
                "data_name": tk_data_name,
                "data_index": tk_data_index,
                "data_sourcetype": tk_data_sourcetype,
                "data_last_lag_seen": tk_data_last_lag_seen,
                "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                "data_eventcount": tk_data_eventcount,
                "data_first_time_seen": tk_data_first_time_seen,
                "data_last_time_seen": tk_data_last_time_seen,
                "data_last_ingest": tk_data_last_ingest,
                "data_last_lag_seen_idx": tk_data_last_lag_seen_idx,
                "data_last_time_seen_idx": tk_data_last_time_seen_idx,
                "data_max_lag_allowed": tk_data_max_lag_allowed,
                "data_lag_alert_kpis": tk_data_lag_alert_kpis,
                "data_monitored_state": tk_data_monitored_state,
                "data_monitoring_level": tk_data_monitoring_level,
                "data_monitoring_wdays": tk_data_monitoring_wdays,
                "data_override_lagging_class": tk_data_override_lagging_class,
                "OutlierMinEventCount": tk_outliermineventcount,
                "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                "OutlierAlertOnUpper": tk_outlieralertonupper,
                "OutlierTimePeriod": tk_outlier_period,
                "OutlierSpan": tk_outlier_span,
                "isOutlier": tk_isoutlier,
                "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                "isAnomaly": tk_isanomaly,
                "data_sample_lastrun": tk_data_sample_lastrun,
                "latest_flip_state": tk_latest_flip_state,
                "latest_flip_time": tk_latest_flip_time,
                "priority": tk_priority,
                "dcount_host": tk_dcount_host,
                "min_dcount_host": tk_min_dcount_host,
                "tags": tk_tags
            };

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring/" + tk_keyid;

            if (tk_keyid && tk_keyid.length) {

                $("#modal_entry_deletion").modal()

                // Delete temporary: change_type will be set to temporary
                $("#btn_modal_entry_deletion_temporary").unbind('click').click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $("#modal_entry_modification").modal()

                    $("#btn_modal_entry_modification").click(function() {

                        var that = $(this);
                        that.off('click'); // remove handler

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("input_update_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else {
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }

                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {
                                // Run the search again to update the table
                                searchDataSourcesMain.startSearch();

                                // Audit
                                action = "success";
                                change_type = "delete temporary";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);
                                return;
                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete temporary";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                                $("#modal_update_collection_failure_return").modal()
                            }

                        });

                    });

                });

                // Delete temporary: change_type will be set to permanent
                $("#btn_modal_entry_deletion").unbind('click').click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $("#modal_entry_modification").modal()

                    $("#btn_modal_entry_modification").click(function() {

                        var that = $(this);
                        that.off('click'); // remove handler

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("input_update_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else {
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }

                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {
                                // Run the search again to update the table
                                searchDataSourcesMain.startSearch();

                                // Audit
                                action = "success";
                                change_type = "delete permanent";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);
                                return;
                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete permanent";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                                $("#modal_update_collection_failure_return").modal()
                            }

                        });

                    });

                });

            }

        });

        //
        // RESET BUTTON
        //

        $("#btn_reset_data_host").click(function(mode) {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get tokens
            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host= tokens.get("tk_data_host");

            // Hide main modal
            $("#modal_manage_host").modal('hide');


            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    // Retrieve update comment if any
                    var tk_comment = document.getElementById("input_update_comment").value;

                    // if is not defined, give it a value and override text box content
                    if (tk_comment == "null") {
                        setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else if (tk_comment == "update note") {
                        tk_comment = "No comment for update.";
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else {
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }

                    // notify
                    notification('Reset completed.', 6000)
		            // call reset data host
                    var tk_data_host= tokens.get("tk_data_host");
		            clearDataHost(tk_data_host, tk_comment);
                    searchSingleLagHost.startSearch();
                    searchSingleLagByMetricsHost.startSearch();
                    searchChartHostBaseSearch.startSearch();
                    searchChartLagHostOverTime.startSearch();
                    searchSingleSLAHostpct.startSearch();
                    searchOutlierDetectionChartDataHost.startSearch();
                    searchOutlierDetectionTableDataHost.startSearch();
                    searchLaggingMetricDataHost.startSearch();
                    searchDataHostMainAuditFlip.startSearch();
                    searchDataHostMainAuditChanges.startSearch();
                    SearchDataHostParsingQualityMain.startSearch();
                    searchDataHostTimeline.startSearch();

                    // call update summary investigator for that entity only
                    var tk_data_host = tokens.get("tk_data_host");
                    updateDataHostEntity("trackme_datahost_tracker_shorterm", tk_data_host);
                    // call update data host
                    var tk_keyid = tokens.get("tk_keyid");
                    updateDataHost(tk_keyid);

                    // Return to modal
                    $("#modal_manage_host").modal();

                });

            }

        });

        //
        // DELETE BUTTON
        //

        $("#btn_delete_data_host").click(function() {

            // Hide main modal
            $("#modal_manage_host").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_host_st_summary = tokens.get("tk_data_host_st_summary");
            var tk_data_host_alerting_policy = tokens.get("tk_data_host_alerting_policy");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_lag_alert_kpis = tokens.get("tk_data_lag_alert_kpis");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");

            // Create a dictionary to store the field names and values
            var record = {
                "object_category": "data_host",
                "data_host": tk_data_host,
                "data_index": tk_data_index,
                "data_sourcetype": tk_data_sourcetype,
                "data_host_st_summary" : tk_data_host_st_summary,
                "data_host_alerting_policy": tk_data_host_alerting_policy,
                "data_last_lag_seen": tk_data_last_lag_seen,
                "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                "data_eventcount": tk_data_eventcount,
                "data_first_time_seen": tk_data_first_time_seen,
                "data_last_time_seen": tk_data_last_time_seen,
                "data_last_ingest": tk_data_last_ingest,
                "data_max_lag_allowed": tk_data_max_lag_allowed,
                "data_lag_alert_kpis": tk_data_lag_alert_kpis,
                "data_monitored_state": tk_data_monitored_state,
                "data_monitoring_wdays": tk_data_monitoring_wdays,
                "data_override_lagging_class": tk_data_override_lagging_class,
                "OutlierMinEventCount": tk_outliermineventcount,
                "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                "OutlierAlertOnUpper": tk_outlieralertonupper,
                "OutlierTimePeriod": tk_outlier_period,
                "OutlierSpan": tk_outlier_span,
                "isOutlier": tk_isoutlier,
                "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                "latest_flip_state": tk_latest_flip_state,
                "latest_flip_time": tk_latest_flip_time,
                "priority": tk_priority
            };

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_host_monitoring/" + tk_keyid;

            if (tk_keyid && tk_keyid.length) {

                $("#modal_entry_deletion").modal()

                $("#btn_modal_entry_deletion_temporary").unbind('click').click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $("#modal_entry_modification").modal()

                    $("#btn_modal_entry_modification").click(function() {

                        var that = $(this);
                        that.off('click'); // remove handler

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("input_update_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else {
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }

                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {
                                // Run the search again to update the table
                                searchDataHostsMain.startSearch();

                                // Audit
                                action = "success";
                                change_type = "delete temporary";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);
                                return;
                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete temporary";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                                $("#modal_update_collection_failure_return").modal()
                            }

                        });

                    });

                });

                $("#btn_modal_entry_deletion").unbind('click').click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $("#modal_entry_modification").modal()

                    $("#btn_modal_entry_modification").click(function() {

                        var that = $(this);
                        that.off('click'); // remove handler

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("input_update_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else {
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }

                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {
                                // Run the search again to update the table
                                searchDataHostsMain.startSearch();

                                // Audit
                                action = "success";
                                change_type = "delete permanent";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);
                                return;
                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete permanent";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                                $("#modal_update_collection_failure_return").modal()
                            }

                        });

                    });

                });

            }

        });

        // metrics sla policy

        // add policy

        $("#btn_modal_metric_policy_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_metric_policy_metric_category = tokens.get("tk_input_metric_policy_metric_category");
            var tk_input_metric_policy_metric_value = tokens.get("tk_input_metric_policy_metric_value");

            // Define the query
            var searchQuery = "| inputlookup trackme_metric_lagging_definition | append [ | makeresults | eval metric_category=\"" + tk_input_metric_policy_metric_category + "\", metric_max_lag_allowed=\"" + tk_input_metric_policy_metric_value + "\" ] | dedup metric_category | sort limit=0 metric_category | outputlookup trackme_metric_lagging_definition";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_metric_policy_metric_category && tk_input_metric_policy_metric_category.length && tk_input_metric_policy_metric_value && tk_input_metric_policy_metric_value.length && isNumeric(tk_input_metric_policy_metric_value)) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "create metric sla policy";
                            object = tk_input_metric_policy_metric_category;
                            object_category = "metric_sla_policy";
                            object_attrs = "SLA policy was created for metric_category:" + tk_input_metric_policy_metric_category + ", metric_max_lag_allowed:" + tk_input_metric_policy_metric_value;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    unsetToken("form.tk_input_metric_policy_metric_category");
                                    searchMetricHostsMain.startSearch();
                                    searchMetricPolicies.startSearch();

                                    // Audit
                                    action = "success";
                                    change_type = "create metric sla policy";
                                    object = tk_input_metric_policy_metric_category;
                                    object_category = "metric_sla_policy";
                                    object_attrs = "SLA policy was created for metric_category:" + tk_input_metric_policy_metric_category + ", metric_max_lag_allowed:" + tk_input_metric_policy_metric_value;
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_metric_sla_policies").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete policy

        $("#btn_delete_metric_sla_policy_level1").click(function() {
                $("#modal_metric_sla_policies").modal('hide');
                $("#manage_metric_sla_policy").modal();
        });

        function foreachDeleteMetricSlaPolicy(item) {

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_lagging_definition/" + item;


            if (item && item.length) {

                // Get the KV entry content first
                $.ajax({
                    url: myendpoint_URl,
                    type: "GET",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        var removedObject = returneddata.metric_category;
                        var removedObjectAttr = returneddata.metric_max_lag_allowed;

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("metric_host_sla_policy_delete_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                        }

                        // Proceed to delete call
                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {


                                // Audit
                                action = "success";
                                change_type = "delete metric sla policy";
                                object = removedObject;
                                object_category = "metric_sla_policy";
                                object_attrs = "{" + "\"metric_category\": \"" + removedObject + "\", \"metric_max_lag_allowed\": \"" + removedObjectAttr + "\", \"_key\": \"" + item + "\"}";
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);

                                // Return to modal
                                $("#modal_metric_sla_policies").modal();

                                // Refresh the search
                                searchMetricPolicies.startSearch();

                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete metric sla policy";
                                object = removedObject;
                                object_category = "metric_sla_policy";
                                object_attrs = "{" + "\"metric_category\": \"" + removedObject + "\", \"metric_max_lag_allowed\": \"" + removedObjectAttr + "\", \"_key\": \"" + item + "\"}";
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                        });

                    }

                });

            }

        }

        $("#btn_delete_metric_sla_policy_level2").click(function() {


            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeMetricPolicies");
            tk_multi_table_array = tk_multi_table_array.split(',');

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachDeleteMetricSlaPolicy);

            // Hide main modal
            $("#manage_metric_sla_policy").modal('hide');

            // Run the search again to update the table
            searchMetricHostsMain.startSearch();

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeMetricPolicies");

        });

        // Custom lagging

        $("#btn_modal_custom_lagging_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_custom_lagging_type = tokens.get("tk_input_custom_lagging_type");
            var tk_input_custom_lagging_name = tokens.get("tk_input_custom_lagging_name");
            var tk_input_custom_lagging_value = tokens.get("tk_input_custom_lagging_value");
            var tk_input_custom_lagging_object = tokens.get("tk_input_custom_lagging_object");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_custom_lagging_definition";


            // Define the query
            var searchQuery = "| inputlookup trackme_custom_lagging_definition | append [ | makeresults | eval level=\"" + tk_input_custom_lagging_type + "\", name=\"" + tk_input_custom_lagging_name + "\", object=\"" + tk_input_custom_lagging_object + "\", value=\"" + tk_input_custom_lagging_value + "\" ] | dedup level, name, object, value | sort limit=0 level, name | outputlookup trackme_custom_lagging_definition";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_custom_lagging_name && tk_input_custom_lagging_name.length && tk_input_custom_lagging_value && tk_input_custom_lagging_value.length && isNumeric(tk_input_custom_lagging_value)) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "create lagging class";
                            object = tk_input_custom_lagging_name;
                            object_category = "lagging_class";
                            object_attrs = "{" + "\"type\": \"" + tk_input_custom_lagging_type + "\", \"name\": \"" + tk_input_custom_lagging_name + "\", \"object\": \"" + tk_input_custom_lagging_object + "\", \"value\": \"" + tk_input_custom_lagging_value + "\"}";
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchCustomLagging.startSearch();

                                    // Audit
                                    action = "success";
                                    change_type = "create lagging class";
                                    object = tk_input_custom_lagging_name;
                                    object_category = "lagging_class";
                                    object_attrs = "{" + "\"type\": \"" + tk_input_custom_lagging_type + "\", \"name\": \"" + tk_input_custom_lagging_name + "\", \"object\": \"" + tk_input_custom_lagging_object + "\", \"value\": \"" + tk_input_custom_lagging_value + "\"}";
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modify_custom_lagging").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete lagging class

        $("#btn_lagging_data_source_policy_delete_level1").click(function() {
                $("#modify_custom_lagging").modal('hide');
                $("#manage_custom_lagging").modal();
        });

        function foreachDeleteLaggingClassDataSource(item) {

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_custom_lagging_definition/" + item;


            if (item && item.length) {

                // Get the KV entry content first
                $.ajax({
                    url: myendpoint_URl,
                    type: "GET",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        var removedObject = returneddata.name;
                        var removedObjectAttr1 = returneddata.level;
                        var removedObjectAttr2 = returneddata.value;
                        var removedObjectAttr3 = returneddata.object;

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("data_source_lagging_policy_delete_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                        }

                        // Proceed to delete call
                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {


                                // Audit
                                action = "success";
                                change_type = "delete lagging class";
                                object = removedObject;
                                object_category = "lagging_class";
                                object_attrs = "{" + "\"name\": \"" + removedObject + "\", \"level\": \"" + removedObjectAttr1 + "\", \"value\": \"" + removedObjectAttr2 + "\", \"object\": \"" + removedObjectAttr3 + "\", \"_key\": \"" + item + "\"}";
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);

                                // Return to modal
                                $("#modify_custom_lagging").modal();

                                // Refresh the search
                                searchCustomLagging.startSearch();

                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete lagging class";
                                object = removedObject;
                                object_category = "lagging_class";
                                object_attrs = "{" + "\"name\": \"" + removedObject + "\", \"level\": \"" + removedObjectAttr1 + "\", \"value\": \"" + removedObjectAttr2 + "\", \"object\": \"" + removedObjectAttr3 + "\", \"_key\": \"" + item + "\"}";
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                        });

                    }

                });

            }

        }

        $("#btn_lagging_data_source_policy_delete_level2").click(function() {


            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeDataSourceLaggingPolicy");
            tk_multi_table_array = tk_multi_table_array.split(',');

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachDeleteLaggingClassDataSource);

            // Hide main modal
            $("#manage_custom_lagging").modal('hide');

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeDataSourceLaggingPolicy");

        });

        // delete lagging class

        $("#btn_delete_custom_lagging").click(function() {


            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_custom_lagging_definition/" + tk_keyid;

            // Get tokens
            var tk_input_custom_lagging_type = tokens.get("tk_input_custom_lagging_type");
            var tk_input_custom_lagging_name = tokens.get("tk_input_custom_lagging_name");
            var tk_input_custom_lagging_value = tokens.get("tk_input_custom_lagging_value");


            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#manage_custom_lagging").modal('hide');

                        // Run the search again to update the table
                        searchCustomLagging.startSearch();

                        // Audit
                        action = "success";
                        change_type = "delete lagging class";
                        object = tk_input_custom_lagging_name;
                        object_category = "lagging_class";
                        object_attrs = "type:" + tk_input_custom_lagging_type + ", name:" + tk_input_custom_lagging_name + ", value:" + tk_input_custom_lagging_value;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modify_custom_lagging").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "delete lagging class";
                        object = tk_input_custom_lagging_name;
                        object_category = "lagging_class";
                        object_attrs = "type:" + tk_input_custom_lagging_type + ", name:" + tk_input_custom_lagging_name + ", value:" + tk_input_custom_lagging_value;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // Hide main modal
                        $("#modify_custom_lagging").modal('hide');
                        $("#manage_custom_lagging").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // whitelist

        // add entry from whitelist

        $("#btn_modal_data_source_whitelist_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_whitelist_data_source = tokens.get("tk_input_whitelist_data_source");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_textinput_whitelist_data_source = tokens.get("tk_textinput_whitelist_data_source");

            // choose
            var tk_add_new_item
            if (tk_textinput_whitelist_data_source && tk_textinput_whitelist_data_source.length) {
                tk_add_new_item = tk_textinput_whitelist_data_source;
            }
            else {
                tk_add_new_item = tk_input_whitelist_data_source;                
            }

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_whitelist_index";


            // Define the query
            var searchQuery = "| inputlookup trackme_data_source_monitoring_whitelist_index | append [ | makeresults | eval data_index=\"" + tk_add_new_item + "\"] | dedup data_index | sort limit=0 data_index | outputlookup trackme_data_source_monitoring_whitelist_index";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_add_new_item && tk_add_new_item.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add allowlist index";
                            object = tk_add_new_item;
                            object_category = "data_source";
                            object_attrs = "{" + "\"data_index\": \"" + tk_add_new_item + "\"}";
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchWhiteListDataSource.startSearch();
                                    searchSingleWhiteListDataSource.startSearch();
                                    searchDataSourcesMain.startSearch();
                                    searchPopulateIndexesForWhiteListDataSource.startSearch();
                                    unsetToken("form.tk_input_whitelist_data_source");
                                    unsetToken("form.tk_textinput_whitelist_data_source");

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add allowlist index";
                                    object = tk_add_new_item;
                                    object_category = "data_source";
                                    object_attrs = "{" + "\"data_index\": \"" + tk_add_new_item + "\"}";
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_data_source_whitelist").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from whitelist

        $("#btn_modal_data_source_whitelist_add_delete").click(function() {
                $("#modal_modify_data_source_whitelist").modal('hide');
                $("#modal_manage_data_source_whitelist").modal();
        });

        function foreachDeleteWhitelistDataSource(item) {

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_whitelist_index/" + item;


            if (item && item.length) {

                // Get the KV entry content first
                $.ajax({
                    url: myendpoint_URl,
                    type: "GET",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        var removedObject = returneddata.data_index;

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("data_source_whitelist_index_delete_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                        }

                        // Proceed to delete call
                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {


                                // Audit
                                action = "success";
                                change_type = "delete allowlist index";
                                object = removedObject;
                                object_category = "data_source";
                                object_attrs = "{" + "\"data_index\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);

                                // Return to modal
                                $("#modal_modify_data_source_whitelist").modal();

                                // Refresh the searches
                                searchWhiteListDataSource.startSearch();
                                searchPopulateIndexesForWhiteListDataSource.startSearch();

                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete allowlist index";
                                object = removedObject;
                                object_category = "data_source";
                                object_attrs = "{" + "\"data_index\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                        });

                    }

                });

            }

        }

        $("#btn_delete_data_source_whitelist").click(function() {


            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeWhitelistDataSource");
            tk_multi_table_array = tk_multi_table_array.split(',');

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachDeleteWhitelistDataSource);

            // Hide main modal
            $("#modal_manage_data_source_whitelist").modal('hide');

            // Run the search again to update the table
            searchDataSourcesMain.startSearch();
            unsetToken("form.tk_input_whitelist_data_source");

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeWhitelistDataSource");

        });

        // add entry from whitelist

        $("#btn_modal_metric_host_whitelist_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_whitelist_metric_host = tokens.get("tk_input_whitelist_metric_host");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_textinput_whitelist_metric_host = tokens.get("tk_textinput_whitelist_metric_host");

            // choose
            var tk_add_new_item
            if (tk_textinput_whitelist_metric_host && tk_textinput_whitelist_metric_host.length) {
                tk_add_new_item = tk_textinput_whitelist_metric_host;
            }
            else {
                tk_add_new_item = tk_input_whitelist_metric_host;                
            }

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring_whitelist_index";


            // Define the query
            var searchQuery = "| inputlookup trackme_metric_host_monitoring_whitelist_index | append [ | makeresults | eval metric_index=\"" + tk_add_new_item + "\"] | dedup metric_index | sort limit=0 metric_index | outputlookup trackme_metric_host_monitoring_whitelist_index";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_add_new_item && tk_add_new_item.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add allowlist index";
                            object = tk_add_new_item;
                            object_category = "metric_host";
                            object_attrs = "{" + "\"metric_index\": \"" + tk_add_new_item + "\"}";
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchPopulateIndexesForWhiteListMetricHost.startSearch();
                                    searchWhiteListMetricHost.startSearch();
                                    searchSingleWhiteListMetricHost.startSearch();
                                    searchMetricHostsMain.startSearch();
                                    unsetToken("form.tk_input_whitelist_metric_host");
                                    unsetToken("form.tk_textinput_whitelist_metric_host");

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add allowlist index";
                                    object = tk_add_new_item;
                                    object_category = "metric_host";
                                    object_attrs = "{" + "\"metric_index\": \"" + tk_add_new_item + "\"}";
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_metric_host_whitelist").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from whitelist

        $("#btn_modal_metric_host_whitelist_add_delete").click(function() {
                $("#modal_modify_metric_host_whitelist").modal('hide');
                $("#modal_manage_metric_host_whitelist").modal();
        });

        function foreachDeleteWhitelistMetricHost(item) {

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring_whitelist_index/" + item;


            if (item && item.length) {

                // Get the KV entry content first
                $.ajax({
                    url: myendpoint_URl,
                    type: "GET",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        var removedObject = returneddata.metric_index;

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("metric_host_whitelist_index_delete_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                        }

                        // Proceed to delete call
                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {


                                // Audit
                                action = "success";
                                change_type = "delete allowlist index";
                                object = removedObject;
                                object_category = "metric_host";
                                object_attrs = "{" + "\"metric_index\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);

                                // Return to modal
                                $("#modal_modify_metric_host_whitelist").modal();

                                // Refresh the searches
                                searchWhiteListMetricHost.startSearch();
                                searchPopulateIndexesForWhiteListMetricHost.startSearch();

                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete allowlist index";
                                object = removedObject;
                                object_category = "metric_host";
                                object_attrs = "{" + "\"metric_index\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                        });

                    }

                });

            }

        }

        $("#btn_delete_metric_host_whitelist").click(function() {


            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeWhitelistMetricHost");
            tk_multi_table_array = tk_multi_table_array.split(',');

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachDeleteWhitelistMetricHost);

            // Hide main modal
            $("#modal_manage_metric_host_whitelist").modal('hide');

            // Run the search again to update the table
            searchMetricHostsMain.startSearch();
            unsetToken("form.tk_input_whitelist_metric_host");

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeWhitelistMetricHost");

        });

        // add entry from whitelist

        $("#btn_modal_data_host_whitelist_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_whitelist_data_host = tokens.get("tk_input_whitelist_data_host");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_textinput_whitelist_data_host = tokens.get("tk_textinput_whitelist_data_host");

            // choose
            var tk_add_new_item
            if (tk_textinput_whitelist_data_host && tk_textinput_whitelist_data_host.length) {
                tk_add_new_item = tk_textinput_whitelist_data_host;
            }
            else {
                tk_add_new_item = tk_input_whitelist_data_host;                
            }
            
            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_whitelist_index";


            // Define the query
            var searchQuery = "| inputlookup trackme_data_host_monitoring_whitelist_index | append [ | makeresults | eval data_index=\"" + tk_add_new_item + "\"] | dedup data_index | sort limit=0 data_index | outputlookup trackme_data_host_monitoring_whitelist_index";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_add_new_item && tk_add_new_item.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add allowlist host";
                            object = tk_add_new_item;
                            object_category = "data_host";
                            object_attrs = "{" + "\"data_host\": \"" + tk_add_new_item + "\"}";
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchWhiteListDataHost.startSearch();
                                    searchSingleWhiteListDataHost.startSearch();
                                    searchDataHostsMain.startSearch();
                                    searchPopulateIndexesForWhiteListDataHost.startSearch();
                                    unsetToken("form.tk_input_whitelist_data_host");
                                    unsetToken("form.tk_textinput_whitelist_data_host");

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add allowlist host";
                                    object = tk_add_new_item;
                                    object_category = "data_host";
                                    object_attrs = "{" + "\"data_host\": \"" + tk_add_new_item + "\"}";
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_data_host_whitelist").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from whitelist

        $("#btn_modal_data_host_whitelist_add_delete").click(function() {
                $("#modal_modify_data_host_whitelist").modal('hide');
                $("#modal_manage_data_host_whitelist").modal();
        });

        function foreachDeleteWhitelistDataHost(item) {

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_whitelist_index/" + item;


            if (item && item.length) {

                // Get the KV entry content first
                $.ajax({
                    url: myendpoint_URl,
                    type: "GET",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        var removedObject = returneddata.data_index;

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("data_host_whitelist_index_delete_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                        }

                        // Proceed to delete call
                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {


                                // Audit
                                action = "success";
                                change_type = "delete allowlist index";
                                object = removedObject;
                                object_category = "data_host";
                                object_attrs = "{" + "\"data_index\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);

                                // Return to modal
                                $("#modal_modify_data_host_whitelist").modal();

                                // Refresh the searches
                                searchWhiteListDataHost.startSearch();
                                searchPopulateIndexesForWhiteListDataHost.startSearch();

                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete allowlist index";
                                object = removedObject;
                                object_category = "data_host";
                                object_attrs = "{" + "\"data_index\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                        });

                    }

                });

            }

        }

        $("#btn_delete_data_host_whitelist").click(function() {


            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeWhitelistDataHost");
            tk_multi_table_array = tk_multi_table_array.split(',');

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachDeleteWhitelistDataHost);

            // Hide main modal
            $("#modal_manage_data_host_whitelist").modal('hide');

            // Run the search again to update the table
            searchDataHostsMain.startSearch();
            unsetToken("form.tk_input_whitelist_data_host");

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeWhitelistDataHost");

        });

        // blacklist

        // host blacklist

        // add entry from blacklist

        $("#btn_modal_data_source_blacklist_host_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_host = tokens.get("tk_input_data_source_blacklist_host");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_host";


            // Define the query
            var searchQuery = "| inputlookup trackme_data_source_monitoring_blacklist_host | append [ | makeresults | eval data_host=\"" + tk_input_blacklist_host + "\", data_blacklist_state=\"true\" ] | dedup data_host | sort limit=0 data_host | outputlookup trackme_data_source_monitoring_blacklist_host";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_host && tk_input_blacklist_host.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add blocklist host";
                            object = tk_input_blacklist_host;
                            object_category = "data_source";
                            object_attrs = "{" + "\"data_host\": \"" + tk_input_blacklist_host + "\"}";
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataSourceHost.startSearch();
                                    searchSingleBlackListDataSourceHost.startSearch();
                                    searchDataSourcesMain.startSearch();
                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add blocklist host";
                                    object = tk_input_blacklist_host;
                                    object_category = "data_source";
                                    object_attrs = "{" + "\"data_host\": \"" + tk_input_blacklist_host + "\"}";
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_data_source_blacklist_host").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_modal_data_source_blacklist_host_add_delete").click(function() {
                $("#modal_modify_data_source_blacklist_host").modal('hide');
                $("#modal_manage_data_source_blacklist_host").modal();
        });

        function foreachDeleteBlacklistDataSourceHost(item) {

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_host/" + item;


            if (item && item.length) {

                // Get the KV entry content first
                $.ajax({
                    url: myendpoint_URl,
                    type: "GET",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        var removedObject = returneddata.data_host;

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("data_source_blocklist_host_delete_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                        }

                        // Proceed to delete call
                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {


                                // Audit
                                action = "success";
                                change_type = "delete blocklist host";
                                object = removedObject;
                                object_category = "data_source";
                                object_attrs = "{" + "\"data_host\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);

                                // Return to modal
                                $("#modal_modify_data_source_blacklist_host").modal();

                                // Refresh the search
                                searchBlackListDataSourceHost.startSearch();

                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete blocklist host";
                                object = removedObject;
                                object_category = "data_source";
                                object_attrs = "{" + "\"data_host\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                        });

                    }

                });

            }

        }

        $("#btn_delete_data_source_blacklist_host").click(function() {


            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeBlacklistDataSourceHost");
            tk_multi_table_array = tk_multi_table_array.split(',');

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachDeleteBlacklistDataSourceHost);

            // Hide main modal
            $("#modal_manage_data_host_whitelist").modal('hide');

            // Run the search again to update the table
            searchDataSourcesMain.startSearch();

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeBlacklistDataSourceHost");

        });

        // add entry from blacklist

        $("#btn_modal_data_host_blacklist_host_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_host = tokens.get("tk_input_data_host_blacklist_host");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_blacklist_host";


            // Define the query
            var searchQuery = "| inputlookup trackme_data_host_monitoring_blacklist_host | append [ | makeresults | eval data_host=\"" + tk_input_blacklist_host + "\", data_blacklist_state=\"true\" ] | dedup data_host | sort limit=0 data_host | outputlookup trackme_data_host_monitoring_blacklist_host";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_host && tk_input_blacklist_host.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add blocklist host";
                            object = tk_input_blacklist_host;
                            object_category = "data_host";
                            object_attrs = "{" + "\"data_host\": \"" + tk_input_blacklist_host + "\"}";
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataHostHost.startSearch();
                                    searchSingleBlackListDataHostHost.startSearch();
                                    searchDataHostsMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add blocklist host";
                                    object = tk_input_blacklist_host;
                                    object_category = "data_host";
                                    object_attrs = "{" + "\"data_host\": \"" + tk_input_blacklist_host + "\"}";
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_data_host_blacklist_host").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // index blacklist

        // add entry from blacklist

        $("#btn_modal_data_source_blacklist_index_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_index = tokens.get("tk_input_blacklist_index");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_index";


            // Define the query
            var searchQuery = "| inputlookup trackme_data_source_monitoring_blacklist_index | append [ | makeresults | eval data_index=\"" + tk_input_blacklist_index + "\", data_blacklist_state=\"true\" ] | dedup data_index | sort limit=0 data_index | outputlookup trackme_data_source_monitoring_blacklist_index";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_index && tk_input_blacklist_index.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add blocklist index";
                            object = tk_input_blacklist_index;
                            object_category = "data_source";
                            object_attrs = "{" + "\"data_index\": \"" + tk_input_blacklist_index + "\"}";
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataSourceIndex.startSearch();
                                    searchSingleBlackListDataSourceIndex.startSearch();
                                    searchDataSourcesMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add blocklist index";
                                    object = tk_input_blacklist_index;
                                    object_category = "data_source";
                                    object_attrs = "{" + "\"data_index\": \"" + tk_input_blacklist_index + "\"}";
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_data_source_blacklist_index").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_modal_data_source_blacklist_index_add_delete").click(function() {
                $("#modal_modify_data_source_blacklist_index").modal('hide');
                $("#modal_manage_data_source_blacklist_index").modal();
        });

        function foreachDeleteBlacklistDataSourceIndex(item) {

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_index/" + item;


            if (item && item.length) {

                // Get the KV entry content first
                $.ajax({
                    url: myendpoint_URl,
                    type: "GET",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        var removedObject = returneddata.data_index;

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("data_source_blocklist_host_delete_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                        }

                        // Proceed to delete call
                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {


                                // Audit
                                action = "success";
                                change_type = "delete blocklist index";
                                object = removedObject;
                                object_category = "data_source";
                                object_attrs = "{" + "\"data_index\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);

                                // Return to modal
                                $("#modal_modify_data_source_blacklist_index").modal();

                                // Refresh the searches
                                searchBlackListDataSourceIndex.startSearch();

                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete blocklist index";
                                object = removedObject;
                                object_category = "data_source";
                                object_attrs = "{" + "\"data_index\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                        });

                    }

                });

            }

        }

        $("#btn_delete_data_source_blacklist_index").click(function() {


            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeBlacklistDataSourceIndex");
            tk_multi_table_array = tk_multi_table_array.split(',');

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachDeleteBlacklistDataSourceIndex);

            // Hide main modal
            $("#modal_manage_data_host_whitelist").modal('hide');

            // Run the search again to update the table
            searchDataSourcesMain.startSearch();

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeBlacklistDataSourceIndex");

        });

        // delete entry from blacklist

        $("#btn_modal_data_host_blacklist_index_add_delete").click(function() {
                $("#modal_modify_data_host_blacklist_index").modal('hide');
                $("#modal_manage_data_host_blacklist_index").modal();
        });

        function foreachDeleteBlacklistDataHostIndex(item) {

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_blacklist_index/" + item;


            if (item && item.length) {

                // Get the KV entry content first
                $.ajax({
                    url: myendpoint_URl,
                    type: "GET",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        var removedObject = returneddata.data_index;

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("data_host_blocklist_host_delete_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                        }

                        // Proceed to delete call
                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {


                                // Audit
                                action = "success";
                                change_type = "delete blocklist index";
                                object = removedObject;
                                object_category = "data_host";
                                object_attrs = "{" + "\"data_index\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);

                                // Return to modal
                                $("#modal_modify_data_host_blacklist_index").modal();

                                // Refresh the search
                                searchBlackListDataHostIndex.startSearch();

                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete blocklist index";
                                object = removedObject;
                                object_category = "data_host";
                                object_attrs = "{" + "\"data_index\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                        });

                    }

                });

            }

        }

        $("#btn_delete_data_host_blacklist_index").click(function() {


            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeBlacklistDataHostIndex");
            tk_multi_table_array = tk_multi_table_array.split(',');

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachDeleteBlacklistDataHostIndex);

            // Hide main modal
            $("#modal_manage_data_host_whitelist").modal('hide');

            // Run the search again to update the table
            searchDataSourcesMain.startSearch();

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeBlacklistDataHostIndex");

        });

        // add entry from blacklist

        $("#btn_modal_data_host_blacklist_index_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_index = tokens.get("tk_input_data_host_blacklist_index");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_blacklist_index";


            // Define the query
            var searchQuery = "| inputlookup trackme_data_host_monitoring_blacklist_index | append [ | makeresults | eval data_index=\"" + tk_input_blacklist_index + "\", data_blacklist_state=\"true\" ] | dedup data_index | sort limit=0 data_index | outputlookup trackme_data_host_monitoring_blacklist_index";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_index && tk_input_blacklist_index.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add blocklist index";
                            object = tk_input_blacklist_index;
                            object_category = "data_host";
                            object_attrs = "{" + "\"data_index\": \"" + tk_input_blacklist_index + "\"}";
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataHostIndex.startSearch();
                                    searchSingleBlackListDataHostIndex.startSearch();
                                    searchDataHostsMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add blocklist index";
                                    object = tk_input_blacklist_index;
                                    object_category = "data_host";
                                    object_attrs = "{" + "\"data_index\": \"" + tk_input_blacklist_index + "\"}";
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_data_host_blacklist_index").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_modal_data_host_blacklist_host_add_delete").click(function() {
                $("#modal_modify_data_host_blacklist_host").modal('hide');
                $("#modal_manage_data_host_blacklist_host").modal();
        });

        function foreachDeleteBlacklistDataHostHost(item) {

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_blacklist_host/" + item;


            if (item && item.length) {

                // Get the KV entry content first
                $.ajax({
                    url: myendpoint_URl,
                    type: "GET",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        var removedObject = returneddata.data_host;

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("data_host_blocklist_host_delete_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                        }

                        // Proceed to delete call
                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {


                                // Audit
                                action = "success";
                                change_type = "delete blocklist host";
                                object = removedObject;
                                object_category = "data_host";
                                object_attrs = "{" + "\"data_host\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);

                                // Return to modal
                                $("#modal_modify_data_host_blacklist_host").modal();

                                // Refresh the search
                                searchBlackListDataHostHost.startSearch();                                

                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete blocklist host";
                                object = removedObject;
                                object_category = "data_host";
                                object_attrs = "{" + "\"data_host\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                        });

                    }

                });

            }

        }

        $("#btn_delete_data_host_blacklist_host").click(function() {


            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeBlacklistDataHostHost");
            tk_multi_table_array = tk_multi_table_array.split(',');

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachDeleteBlacklistDataHostHost);

            // Hide main modal
            $("#modal_manage_data_host_whitelist").modal('hide');

            // Run the search again to update the table
            searchDataHostsMain.startSearch();            

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeBlacklistDataHostHost");

        });

        // add entry from blacklist

        $("#btn_modal_metric_host_blacklist_index_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_index = tokens.get("tk_input_metric_host_blacklist_index");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_index";


            // Define the query
            var searchQuery = "| inputlookup trackme_metric_host_monitoring_blacklist_index | append [ | makeresults | eval metric_index=\"" + tk_input_blacklist_index + "\", metric_blacklist_state=\"true\" ] | dedup metric_index | sort limit=0 metric_index | outputlookup trackme_metric_host_monitoring_blacklist_index";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_index && tk_input_blacklist_index.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add blocklist index";
                            object = tk_input_blacklist_index;
                            object_category = "metric_host";
                            object_attrs = "{" + "\"metric_index\": \"" + tk_input_blacklist_index + "\"}";
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListMetricHostIndex.startSearch();
                                    searchSingleBlackListMetricHostIndex.startSearch();
                                    searchMetricHostsMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add blocklist index";
                                    object = tk_input_blacklist_index;
                                    object_category = "metric_host";
                                    object_attrs = "{" + "\"metric_index\": \"" + tk_input_blacklist_index + "\"}";
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_metric_host_blacklist_index").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_modal_metric_host_blacklist_index_add_delete").click(function() {
                $("#modal_modify_metric_host_blacklist_index").modal('hide');
                $("#modal_manage_metric_host_blacklist_index").modal();
        });

        function foreachDeleteBlacklistMetricHostIndex(item) {

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring_blacklist_index/" + item;


            if (item && item.length) {

                // Get the KV entry content first
                $.ajax({
                    url: myendpoint_URl,
                    type: "GET",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        var removedObject = returneddata.metric_index;

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("metric_host_blocklist_host_delete_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                        }

                        // Proceed to delete call
                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {


                                // Audit
                                action = "success";
                                change_type = "delete blocklist index";
                                object = removedObject;
                                object_category = "metric_host";
                                object_attrs = "{" + "\"metric_index\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);

                                // Return to modal
                                $("#modal_modify_metric_host_blacklist_index").modal();

                                // Refresh the search
                                searchBlackListMetricHostIndex.startSearch();                                

                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete blocklist index";
                                object = removedObject;
                                object_category = "metric_host";
                                object_attrs = "{" + "\"metric_index\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                        });

                    }

                });

            }

        }

        $("#btn_delete_metric_host_blacklist_index").click(function() {


            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeBlacklistMetricHostIndex");
            tk_multi_table_array = tk_multi_table_array.split(',');

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachDeleteBlacklistMetricHostIndex);

            // Hide main modal
            $("#modal_manage_metric_host_whitelist").modal('hide');

            // Run the search again to update the table
            searchMetricHostsMain.startSearch();            

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeBlacklistMetricHostIndex");

        });

        // sourcetype blacklist

        $("#btn_modal_data_source_blacklist_sourcetype_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_sourcetype = tokens.get("tk_input_data_source_blacklist_sourcetype");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_sourcetype";


            // Define the query
            var searchQuery = "| inputlookup trackme_data_source_monitoring_blacklist_sourcetype | append [ | makeresults | eval data_sourcetype=\"" + tk_input_blacklist_sourcetype + "\", data_blacklist_state=\"true\" ] | dedup data_sourcetype | sort limit=0 data_sourcetype | outputlookup trackme_data_source_monitoring_blacklist_sourcetype";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_sourcetype && tk_input_blacklist_sourcetype.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add blocklist sourcetype";
                            object = tk_input_blacklist_sourcetype;
                            object_category = "data_source";
                            object_attrs = "{" + "\"data_sourcetype\": \"" + tk_input_blacklist_sourcetype + "\"}";
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataSourceSourcetype.startSearch();
                                    searchSingleBlackListDataSourceSourcetype.startSearch();
                                    searchDataSourcesMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add blocklist sourcetype";
                                    object = tk_input_blacklist_sourcetype;
                                    object_category = "data_source";
                                    object_attrs = "{" + "\"data_sourcetype\": \"" + tk_input_blacklist_sourcetype + "\"}";
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_data_source_blacklist_sourcetype").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_modal_data_source_blacklist_sourcetype_add_delete").click(function() {
                $("#modal_modify_data_source_blacklist_sourcetype").modal('hide');
                $("#modal_manage_data_source_blacklist_sourcetype").modal();
        });

        function foreachDeleteBlacklistDataSourceSourcetype(item) {

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_sourcetype/" + item;


            if (item && item.length) {

                // Get the KV entry content first
                $.ajax({
                    url: myendpoint_URl,
                    type: "GET",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        var removedObject = returneddata.data_sourcetype;

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("data_source_blocklist_host_delete_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                        }

                        // Proceed to delete call
                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {


                                // Audit
                                action = "success";
                                change_type = "delete blocklist sourcetype";
                                object = removedObject;
                                object_category = "data_source";
                                object_attrs = "{" + "\"data_sourcetype\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);

                                // Return to modal
                                $("#modal_modify_data_source_blacklist_sourcetype").modal();

                                // Refresh the search
                                searchBlackListDataSourceSourcetype.startSearch();

                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete blocklist sourcetype";
                                object = removedObject;
                                object_category = "data_source";
                                object_attrs = "{" + "\"data_sourcetype\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                        });

                    }

                });

            }

        }

        $("#btn_delete_data_source_blacklist_sourcetype").click(function() {


            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeBlacklistDataSourceSourcetype");
            tk_multi_table_array = tk_multi_table_array.split(',');

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachDeleteBlacklistDataSourceSourcetype);

            // Hide main modal
            $("#modal_manage_data_host_whitelist").modal('hide');

            // Run the search again to update the table
            searchDataSourcesMain.startSearch();

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeBlacklistDataSourceSourcetype");

        });

        // data_name blacklist

        $("#btn_modal_data_source_blacklist_data_name_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_data_name = tokens.get("tk_input_data_source_blacklist_data_name");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_data_name";


            // Define the query
            var searchQuery = "| inputlookup trackme_data_source_monitoring_blacklist_data_name | append [ | makeresults | eval data_name=\"" + tk_input_blacklist_data_name + "\", data_blacklist_state=\"true\" ] | dedup data_name | sort limit=0 data_name | outputlookup trackme_data_source_monitoring_blacklist_data_name";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_data_name && tk_input_blacklist_data_name.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add blocklist data_name";
                            object = tk_input_blacklist_data_name;
                            object_category = "data_source";
                            object_attrs = "{" + "\"data_name\": \"" + tk_input_blacklist_data_name + "\"}";
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataSourceDataName.startSearch();
                                    searchSingleBlackListDataSourceDataName.startSearch();
                                    searchDataSourcesMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add blocklist data_name";
                                    object = tk_input_blacklist_data_name;
                                    object_category = "data_source";
                                    object_attrs = "{" + "\"data_name\": \"" + tk_input_blacklist_data_name + "\"}";
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_data_source_blacklist_data_name").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

            });

            // delete entry from blacklist

            $("#btn_modal_data_source_blacklist_data_name_add_delete").click(function() {
                $("#modal_modify_data_source_blacklist_data_name").modal('hide');
                $("#modal_manage_data_source_blacklist_data_name").modal();
            });

            function foreachDeleteBlacklistDataSourceDataName(item) {

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_data_name/" + item;


            if (item && item.length) {

                // Get the KV entry content first
                $.ajax({
                    url: myendpoint_URl,
                    type: "GET",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        var removedObject = returneddata.data_data_name;

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("data_source_blocklist_host_delete_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                        }

                        // Proceed to delete call
                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {


                                // Audit
                                action = "success";
                                change_type = "delete blocklist data_name";
                                object = removedObject;
                                object_category = "data_source";
                                object_attrs = "{" + "\"data_data_name\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);

                                // Return to modal
                                $("#modal_modify_data_source_blacklist_data_name").modal();

                                // Refresh the search
                                searchBlackListDataSourceDataName.startSearch();

                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete blocklist data_name";
                                object = removedObject;
                                object_category = "data_source";
                                object_attrs = "{" + "\"data_data_name\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                        });

                    }

                });

            }

            }

            $("#btn_delete_data_source_blacklist_data_name").click(function() {


            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeBlacklistDataSourceDataName");
            tk_multi_table_array = tk_multi_table_array.split(',');

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachDeleteBlacklistDataSourceDataName);

            // Hide main modal
            $("#modal_manage_data_host_whitelist").modal('hide');

            // Run the search again to update the table
            searchDataSourcesMain.startSearch();

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeBlacklistDataSourceDataName");

        });

        // sourcetype blacklist

        $("#btn_modal_data_host_blacklist_sourcetype_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_sourcetype = tokens.get("tk_input_data_host_blacklist_sourcetype");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_blacklist_sourcetype";


            // Define the query
            var searchQuery = "| inputlookup trackme_data_host_monitoring_blacklist_sourcetype | append [ | makeresults | eval data_sourcetype=\"" + tk_input_blacklist_sourcetype + "\", data_blacklist_state=\"true\" ] | dedup data_sourcetype | sort limit=0 data_sourcetype | outputlookup trackme_data_host_monitoring_blacklist_sourcetype";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_sourcetype && tk_input_blacklist_sourcetype.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add blocklist sourcetype";
                            object = tk_input_blacklist_sourcetype;
                            object_category = "data_host";
                            object_attrs = "{" + "\"data_sourcetype\": \"" + tk_input_blacklist_sourcetype + "\"}";
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataHostSourcetype.startSearch();
                                    searchSingleBlackListDataHostSourcetype.startSearch();
                                    searchDataHostsMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add blocklist sourcetype";
                                    object = tk_input_blacklist_sourcetype;
                                    object_category = "data_host";
                                    object_attrs = "{" + "\"data_sourcetype\": \"" + tk_input_blacklist_sourcetype + "\"}";
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_data_host_blacklist_sourcetype").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_modal_data_host_blacklist_sourcetype_add_delete").click(function() {
                $("#modal_modify_data_host_blacklist_sourcetype").modal('hide');
                $("#modal_manage_data_host_blacklist_sourcetype").modal();
        });

        function foreachDeleteBlacklistDataHostSourcetype(item) {

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_blacklist_sourcetype/" + item;


            if (item && item.length) {

                // Get the KV entry content first
                $.ajax({
                    url: myendpoint_URl,
                    type: "GET",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        var removedObject = returneddata.data_sourcetype;

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("data_host_blocklist_host_delete_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                        }

                        // Proceed to delete call
                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {


                                // Audit
                                action = "success";
                                change_type = "delete blocklist sourcetype";
                                object = removedObject;
                                object_category = "data_host";
                                object_attrs = "{" + "\"data_sourcetype\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);

                                // Return to modal
                                $("#modal_modify_data_host_blacklist_sourcetype").modal();

                                // Refresh the search
                                searchBlackListDataHostSourcetype.startSearch();

                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete blocklist sourcetype";
                                object = removedObject;
                                object_category = "data_host";
                                object_attrs = "{" + "\"data_sourcetype\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                        });

                    }

                });

            }

        }

        $("#btn_delete_data_host_blacklist_sourcetype").click(function() {


            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeBlacklistDataHostSourcetype");
            tk_multi_table_array = tk_multi_table_array.split(',');

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachDeleteBlacklistDataHostSourcetype);

            // Hide main modal
            $("#modal_manage_data_host_whitelist").modal('hide');

            // Run the search again to update the table
            searchDataSourcesMain.startSearch();

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeBlacklistDataHostSourcetype");

        });

        // metric host moonitoring
        // add entry from blacklist

        $("#btn_modal_metric_host_blacklist_host_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_host = tokens.get("tk_input_metric_host_blacklist_host");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring_blacklist_host";


            // Define the query
            var searchQuery = "| inputlookup trackme_metric_host_monitoring_blacklist_host | append [ | makeresults | eval metric_host=\"" + tk_input_blacklist_host + "\", metric_blacklist_state=\"true\" ] | dedup metric_host | sort limit=0 metric_host | outputlookup trackme_metric_host_monitoring_blacklist_host";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_host && tk_input_blacklist_host.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add blocklist host";
                            object = tk_input_blacklist_host;
                            object_category = "metric_host";
                            object_attrs = "{" + "\"metric_host\": \"" + tk_input_blacklist_host + "\"}";
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListMetricHostHost.startSearch();
                                    searchSingleBlackListMetricHostHost.startSearch();
                                    searchMetricHostsMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add blocklist host";
                                    object = tk_input_blacklist_host;
                                    object_category = "metric_host";
                                    object_attrs = "{" + "\"metric_host\": \"" + tk_input_blacklist_host + "\"}";
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_metric_host_blacklist_host").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_modal_metric_host_blacklist_host_add_delete").click(function() {
                $("#modal_modify_metric_host_blacklist_host").modal('hide');
                $("#modal_manage_metric_host_blacklist_host").modal();
        });

        function foreachDeleteBlacklistMetricHostHost(item) {

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring_blacklist_host/" + item;


            if (item && item.length) {

                // Get the KV entry content first
                $.ajax({
                    url: myendpoint_URl,
                    type: "GET",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        var removedObject = returneddata.metric_host;

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("metric_host_blocklist_host_delete_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                        }

                        // Proceed to delete call
                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {


                                // Audit
                                action = "success";
                                change_type = "delete blocklist host";
                                object = removedObject;
                                object_category = "metric_host";
                                object_attrs = "{" + "\"metric_host\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);

                                // Return to modal
                                $("#modal_modify_metric_host_blacklist_host").modal();

                                // Refresh the search
                                searchBlackListMetricHostHost.startSearch();

                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete blocklist host";
                                object = removedObject;
                                object_category = "metric_host";
                                object_attrs = "{" + "\"metric_host\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                        });

                    }

                });

            }

        }

        $("#btn_delete_metric_host_blacklist_host").click(function() {


            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeBlacklistMetricHostHost");
            tk_multi_table_array = tk_multi_table_array.split(',');

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachDeleteBlacklistMetricHostHost);

            // Hide main modal
            $("#modal_manage_metric_host_whitelist").modal('hide');

            // Run the search again to update the table
            searchMetricHostsMain.startSearch();

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeBlacklistMetricHostHost");

        });

        // metric_category blacklist

        $("#btn_modal_metric_host_blacklist_metric_category_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_metric_category = tokens.get("tk_input_metric_host_blacklist_metric_category");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring_blacklist_metric_category";


            // Define the query
            var searchQuery = "| inputlookup trackme_metric_host_monitoring_blacklist_metric_category | append [ | makeresults | eval metric_category=\"" + tk_input_blacklist_metric_category + "\", metric_blacklist_state=\"true\" ] | dedup metric_category | sort limit=0 metric_category | outputlookup trackme_metric_host_monitoring_blacklist_metric_category";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_metric_category && tk_input_blacklist_metric_category.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add blocklist metric_category";
                            object = tk_input_blacklist_metric_category;
                            object_category = "metric_host";
                            object_attrs = "{" + "\"metric_category\": \"" + tk_input_blacklist_metric_category + "\"}";
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListMetricHostMetricCategory.startSearch();
                                    searchPopulateMetricCategoriesForBlackListMetricHost.startSearch();
                                    searchMetricHostsMain.startSearch();
                                    unsetToken("form.tk_input_metric_host_blacklist_metric_category");

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add blocklist metric_category";
                                    object = tk_input_blacklist_metric_category;
                                    object_category = "metric_host";
                                    object_attrs = "{" + "\"metric_category\": \"" + tk_input_blacklist_metric_category + "\"}";
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_metric_host_blacklist_metric_category").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist
        $("#btn_modal_metric_host_blacklist_metric_category_add_delete").click(function() {
                $("#modal_modify_metric_host_blacklist_metric_category").modal('hide');
                $("#modal_manage_metric_host_blacklist_metric_category").modal();
        });

        function foreachDeleteBlacklistMetricHostMetricCategory(item) {

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring_blacklist_metric_category/" + item;


            if (item && item.length) {

                // Get the KV entry content first
                $.ajax({
                    url: myendpoint_URl,
                    type: "GET",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        var removedObject = returneddata.metric_category;

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("metric_host_blocklist_metric_category_delete_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                        }

                        // Proceed to delete call
                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {


                                // Audit
                                action = "success";
                                change_type = "delete blocklist metric category";
                                object = removedObject;
                                object_category = "metric_host";
                                object_attrs = "{" + "\"metric_category\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);

                                // Return to modal
                                $("#modal_modify_metric_host_blacklist_metric_category").modal();

                                // Refresh the search
                                searchBlackListMetricHostMetricCategory.startSearch();

                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete blocklist metric category";
                                object = removedObject;
                                object_category = "metric_host";
                                object_attrs = "{" + "\"metric_category\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                        });

                    }

                });

            }

        }

        $("#btn_delete_metric_host_blacklist_metric_category").click(function() {


            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeBlacklistMetricHostMetricCategory");
            tk_multi_table_array = tk_multi_table_array.split(',');

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachDeleteBlacklistMetricHostMetricCategory);

            // Hide main modal
            $("#modal_manage_data_host_whitelist").modal('hide');

            // Run the search again to update the table
            searchDataSourcesMain.startSearch();

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeBlacklistMetricHostMetricCategory");

        });

        // data sources monitoring

        $("#btn_modal_modify_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_manage").modal();

        });

        // data hosts monitoring

        $("#btn_modal_modify_host_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_manage_host").modal();

        });

        //
        // Elastic sources
        //

        $('.btn_modify_elastic_sources_main').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_elastic_sources", "true");
                setToken("start_modify_elastic_sources_dedicated", "true");
                // Show input modal
                $("#modify_elastic_sources_main").modal();
            });

        });

        $('#btn_modal_elastic_sources_manage').click(function() {
                // Show input modal
                $("#modify_elastic_sources").modal();

                // Excplicitely refresh the search
                searchElasticSources.startSearch();
        });

        $('#btn_modal_elastic_sources_dedicated_manage').click(function() {
                // Show input modal
                $("#modify_elastic_sources_dedicated").modal();

                // Excplicitely refresh the search
                searchElasticSourcesDedicated.startSearch();
        });

        $('#btn_modal_elastic_sources_add').click(function() {
                // Default disable button add state
                document.getElementById('btn_modal_elastic_source_add_new').disabled = true;
                document.getElementById('btn_modal_elastic_source_dedicated_add_new').disabled = true;
                // Show input modal
                $("#add_elastic_sources").modal();
        });

        // Back
        $('#btn_modal_elastic_sources_add_back').click(function() {
                // Show input modal
                $("#modify_elastic_sources_main").modal();
        });

        $('#btn_modal_elastic_sources_dedicated_add_back').click(function() {
                // Show input modal
                $("#modify_elastic_sources_main").modal();
        });

        $('#btn_modal_elastic_sources_add_new_back').click(function() {
                // Show input modal
                $("#modify_elastic_sources_main").modal();
        });

        $('#btn_modal_generic_search_error_back').click(function() {
                // Show input modal
                $("#add_elastic_sources").modal();
        });

        function elastic_sources_check_unique(data_name, status) {

            // Define the query
            var searchQuery = "| makeresults | eval data_name=\"" + data_name + "\" | lookup trackme_elastic_sources data_name OUTPUTNEW _key as found | eval is_unique=if(isnull(found), \"true\", \"false\") | fields - _time | fields is_unique";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-5m",
                latest_time: "now"
            };

            // Run a oneshot search that returns the job's results
            service.oneshotSearch(
                searchQuery,
                searchParams,
                function(err, results) {

                    // Display the results
                    var fields = results.fields;
                    var rows = results.rows;
                    var is_unique;

                    for (var i = 0; i < rows.length; i++) {
                        var values = rows[i];

                        for (var j = 0; j < values.length; j++) {
                            var field = fields[j];

                            if (fields[j] == "is_unique") {
                                is_unique = values[j];
                            }
                        }
                    }

                    if (!is_unique) {
                        var start_simulation_elastic_sources = "false";
                        document.getElementById('btn_modal_elastic_source_add_new').disabled = true;
                        document.getElementById('btn_modal_elastic_source_dedicated_add_new').disabled = true;
                        setToken("start_simulation_elastic_sources", "false");
                    }

                    if (is_unique == "true" && status == "true") {
                        var start_simulation_elastic_sources = "true";
                        document.getElementById('btn_modal_elastic_source_add_new').disabled = false;
                        document.getElementById('btn_modal_elastic_dedicated_ource_add_new').disabled = false;
                        setToken("start_simulation_elastic_sources", "true");
                    }
                    else if (is_unique == "false") {
                        var start_simulation_elastic_sources = "false";
                        document.getElementById('btn_modal_elastic_source_add_new').disabled = true;
                        document.getElementById('btn_modal_elastic_source_dedicated_add_new').disabled = true;
                        setToken("start_simulation_elastic_sources", "false");
                    }

                });

            return false;

        };

        // Run simulation
        $('#btn_modal_elastic_source_add_simulate').click(function(event) {
            event.stopImmediatePropagation();

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // disabled if enabled
            document.getElementById('btn_modal_elastic_source_add_new').disabled = true;
            document.getElementById('btn_modal_elastic_source_dedicated_add_new').disabled = true;

            // Get tokens
            var tk_input_elastic_source_search_type = tokens.get("tk_input_elastic_source_search_type");
            var tk_input_elastic_source_data_name = tokens.get("tk_input_elastic_source_data_name");
            var tk_input_elastic_source_elastic_data_index = tokens.get("tk_input_elastic_source_elastic_data_index");
            var tk_input_elastic_source_elastic_data_sourcetype = tokens.get("tk_input_elastic_source_elastic_data_sourcetype");
            var tk_input_elastic_source_earliest = tokens.get("tk_input_elastic_source_earliest");
            var tk_input_elastic_source_latest = tokens.get("tk_input_elastic_source_latest");

            // This is not a Splunk form
            var tk_input_elastic_source_search_constraint = document.getElementById("modal_input_elastic_source_search_constraint").value
            // the token used by the search needs to have escaped double quotes, but not the value to be stored in the KV
            var tk_raw_input_elastic_source_search_constraint = document.getElementById("modal_input_elastic_source_search_constraint").value
            tk_input_elastic_source_search_constraint = escapeDoubleQuotes(tk_input_elastic_source_search_constraint);
            setToken("tk_input_elastic_source_search_constraint", tk_input_elastic_source_search_constraint);

            // Start the search if all tokens are defined
            if (tk_input_elastic_source_search_type && tk_input_elastic_source_data_name && tk_input_elastic_source_elastic_data_index && tk_input_elastic_source_elastic_data_sourcetype && tk_input_elastic_source_search_constraint && tk_input_elastic_source_search_constraint!=="Enter the Splunk search constraint chain according to the type of search selected") {
                notification('Elastic source simulation started for data_name: ' +  tk_input_elastic_source_data_name + ', if the simulation is successful, click on save new elastic source to include this new source in the collection.', 6000)
                // Free the beast
                var start_simulation_elastic_sources = "true";
                var success_simulation_elastic_sources = "false";
                setToken("start_simulation_elastic_sources", "true");
                searchElasticSourcesTest.startSearch();

                searchElasticSourcesTest.on('search:error', function(properties) {
                    var start_simulation_elastic_sources = "false";
                    var success_simulation_elastic_sources = "false";
                    setToken("start_simulation_elastic_sources", "false");
                    document.getElementById('btn_modal_elastic_source_add_new').disabled = true;
                    document.getElementById('btn_modal_elastic_source_dedicated_add_new').disabled = true;
                    $("#add_elastic_sources").modal('hide');
                    $("#modal_generic_search_error").modal();
                });

                searchElasticSourcesTest.on('search:fail', function(properties) {
                    var start_simulation_elastic_sources = "false";
                    var success_simulation_elastic_sources = "false";
                    setToken("start_simulation_elastic_sources", "false");
                    document.getElementById('btn_modal_elastic_source_add_new').disabled = true;
                    document.getElementById('btn_modal_elastic_source_dedicated_add_new').disabled = true;
                    $("#add_elastic_sources").modal('hide');
                    $("#modal_generic_search_error").modal();
                });

                // If the search is processed successfully
                searchElasticSourcesTest.on('search:done', function(properties) {
                    var start_simulation_elastic_sources = "true";
                    document.getElementById('btn_modal_elastic_source_add_new').disabled = false;
                    document.getElementById('btn_modal_elastic_source_dedicated_add_new').disabled = false;
                    setToken("start_simulation_elastic_sources", "true");
                    // to do: this isn't stable enough yet
                    // elastic_sources_check_unique(tk_input_elastic_source_data_name, "true");
                });

            } else {
                unsetToken("start_simulation_elastic_sources");
                notification('ERROR: Entries are either incorrect or incomplete, please correct and try again.', 6000)
            }

            // add a new elastic source
            $('#btn_modal_elastic_source_add_new').click(function(event) {
                event.stopImmediatePropagation();

                // Get status
                var success_simulation_elastic_sources = tokens.get("start_simulation_elastic_sources");

                // Get tokens
                var tk_input_elastic_source_search_type = tokens.get("tk_input_elastic_source_search_type");
                var tk_input_elastic_source_data_name = tokens.get("tk_input_elastic_source_data_name");
                var tk_input_elastic_source_elastic_data_index = tokens.get("tk_input_elastic_source_elastic_data_index");
                var tk_input_elastic_source_elastic_data_sourcetype = tokens.get("tk_input_elastic_source_elastic_data_sourcetype");
                var tk_input_elastic_source_earliest = tokens.get("tk_input_elastic_source_earliest");
                var tk_input_elastic_source_latest = tokens.get("tk_input_elastic_source_latest");

                // This is not a Splunk form
                var tk_input_elastic_source_search_constraint = document.getElementById("modal_input_elastic_source_search_constraint").value
                // the token used by the search needs to have escaped double quotes, but not the value to be stored in the KV
                var tk_raw_input_elastic_source_search_constraint = document.getElementById("modal_input_elastic_source_search_constraint").value
                tk_input_elastic_source_search_constraint = escapeDoubleQuotes(tk_input_elastic_source_search_constraint);
                setToken("tk_input_elastic_source_search_constraint", tk_input_elastic_source_search_constraint);

                // disable the button once clicked
                document.getElementById('btn_modal_elastic_source_add_new').disabled = true;

                if (start_simulation_elastic_sources && start_simulation_elastic_sources == 'true') {

                    var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_elastic_sources/"

                    // Create a dictionary to store the field names and values
                    var record = {
                        "data_name": tk_input_elastic_source_data_name,
                        "search_constraint": tk_raw_input_elastic_source_search_constraint,
                        "search_mode": tk_input_elastic_source_search_type,
                        "elastic_data_index": tk_input_elastic_source_elastic_data_index,
                        "elastic_data_sourcetype": tk_input_elastic_source_elastic_data_sourcetype
                    };

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {

                            // Processed modal
                            // clean status
                            unsetToken("start_simulation_elastic_sources");
                            // Show message
                            msg = "The new elastic source: " +  tk_input_elastic_source_data_name + " was successfully added to the collection, manually run the tracker report \"TrackMe - Elastic sources shared tracker\" or wait for its next execution."
                            $("#add_elastic_source_processed").find('.modal-error-message p').text(msg);
                            $("#add_elastic_sources").modal('hide');
                            $("#add_elastic_source_processed").modal();

                            // Audit
                            action = "success";
                            change_type = "add elastic source";
                            object = tk_input_elastic_source_data_name;
                            object_category = "elastic_sources";
                            object_attrs = "search_mode:" + tk_input_elastic_source_search_type + ", search_constraint:" + tk_raw_input_elastic_source_search_constraint + ", elastic_data_index:" + tk_input_elastic_source_elastic_data_index + ", elastic_data_sourcetype:" + tk_input_elastic_source_elastic_data_sourcetype;;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            // house cleaning
                            myendpoint_URl = undefined;
                            delete(myendpoint_URl);

                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit
                            action = "failure";
                            change_type = "add elastic source";
                            object = tk_input_elastic_source_data_name;
                            object_category = "elastic_sources";
                            object_attrs = "search_mode:" + tk_input_elastic_source_search_type + ", search_constraint:" + tk_raw_input_elastic_source_search_constraint + ", elastic_data_index:" + tk_input_elastic_source_elastic_data_index + ", elastic_data_sourcetype:" + tk_input_elastic_source_elastic_data_sourcetype;;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            // back tp main modal
                            $("#add_elastic_sources").modal('hide');
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }

                    });

                } else {
                    notification('ERROR: Please successfully run the simulation first.', 6000)
                }

            });

            $('#btn_modal_elastic_source_dedicated_add_new').click(function(event) {
                event.stopImmediatePropagation();

                // Get status
                var success_simulation_elastic_sources = tokens.get("start_simulation_elastic_sources");

                // Get tokens
                var tk_input_elastic_source_search_type = tokens.get("tk_input_elastic_source_search_type");
                var tk_input_elastic_source_data_name = tokens.get("tk_input_elastic_source_data_name");
                var tk_input_elastic_source_elastic_data_index = tokens.get("tk_input_elastic_source_elastic_data_index");
                var tk_input_elastic_source_elastic_data_sourcetype = tokens.get("tk_input_elastic_source_elastic_data_sourcetype");
                var tk_input_elastic_source_earliest = tokens.get("tk_input_elastic_source_earliest");
                var tk_input_elastic_source_latest = tokens.get("tk_input_elastic_source_latest");

                // This is not a Splunk form
                var tk_input_elastic_source_search_constraint = document.getElementById("modal_input_elastic_source_search_constraint").value
                // the token used by the search needs to have escaped double quotes, but not the value to be stored in the KV
                var tk_raw_input_elastic_source_search_constraint = document.getElementById("modal_input_elastic_source_search_constraint").value
                tk_input_elastic_source_search_constraint = escapeDoubleQuotes(tk_input_elastic_source_search_constraint);
                setToken("tk_input_elastic_source_search_constraint", tk_input_elastic_source_search_constraint);

                // disable the button once clicked
                document.getElementById('btn_modal_elastic_source_dedicated_add_new').disabled = true;

                if (start_simulation_elastic_sources && start_simulation_elastic_sources == 'true') {

                    // Create a unique name for the tracker
                    var tracker_name = "TrackMe - " + tk_input_elastic_source_data_name + " tracker " + uuid();
                    // Splunk limits report names to max 100 chars, and will refuse otherwise
                    tracker_name = tracker_name.substring(0, 100);
                    setToken("tk_tracker_name", tracker_name);


                    // define the alert search
                    if (tk_input_elastic_source_search_type == "tstats") {
                        tk_elastic_alert_root_search = "| `trackme_tstats` max(_indextime) as data_last_ingest, min(_time) as data_first_time_seen, max(_time) as data_last_time_seen, count as data_eventcount, dc(host) as dcount_host where " + tk_raw_input_elastic_source_search_constraint + " | eval data_name=\"" + tk_input_elastic_source_data_name + "\", data_index=\"" + tk_input_elastic_source_elastic_data_index + "\", data_sourcetype=\"" + tk_input_elastic_source_elastic_data_sourcetype + "\", data_last_ingestion_lag_seen=data_last_ingest-data_last_time_seen | `trackme_elastic_dedicated_tracker(\"" + tk_input_elastic_source_data_name + "\")` | stats c";

                    }
                    
                    else if (tk_input_elastic_source_search_type == "raw") {
                        tk_elastic_alert_root_search = tk_raw_input_elastic_source_search_constraint + " | stats max(_indextime) as data_last_ingest, min(_time) as data_first_time_seen, max(_time) as data_last_time_seen, count as data_eventcount, dc(host) as dcount_host | eval data_name=\"" + tk_input_elastic_source_data_name +"\", data_index=\"" + tk_input_elastic_source_elastic_data_index + "\", data_sourcetype=\"" + tk_input_elastic_source_elastic_data_sourcetype + "\", data_last_ingestion_lag_seen=data_last_ingest-data_last_time_seen | `trackme_elastic_dedicated_tracker(\"" + tk_input_elastic_source_data_name + "\")` | stats c";

                    } 
                    
                    else if (tk_input_elastic_source_search_type == "from") {
                        if (/datamodel:/i.test(tk_raw_input_elastic_source_search_constraint)) {
                            tk_elastic_alert_root_search = "| " + tk_input_elastic_source_search_type + " " + tk_raw_input_elastic_source_search_constraint + " | stats max(_indextime) as data_last_ingest, min(_time) as data_first_time_seen, max(_time) as data_last_time_seen, count as data_eventcount, dc(host) as dcount_host | eval data_name=\"" + tk_input_elastic_source_data_name + "\", data_index=\"" + tk_input_elastic_source_elastic_data_index + "\", data_sourcetype=\"" + tk_input_elastic_source_elastic_data_sourcetype + "\" | `trackme_elastic_dedicated_tracker(\"" + tk_input_elastic_source_data_name + "\")` | stats c";
                        }
                        else if (/lookup:/i.test(tk_raw_input_elastic_source_search_constraint)) {
                            tk_elastic_alert_root_search = "| " + tk_input_elastic_source_search_type + " " + tk_raw_input_elastic_source_search_constraint + " | eventstats max(_time) as indextime | eval _indextime=if(isnum(_indextime), _indextime, indextime) | fields - indextime | eval host=if(isnull(host), \"none\", host) | stats max(_indextime) as data_last_ingest, min(_time) as data_first_time_seen, max(_time) as data_last_time_seen, count as data_eventcount, dc(host) as dcount_host | eval data_name=\"" + tk_input_elastic_source_data_name + "\", data_index=\"" + tk_input_elastic_source_elastic_data_index + "\", data_sourcetype=\"" + tk_input_elastic_source_elastic_data_sourcetype + "\" | `trackme_elastic_dedicated_tracker(\"" + tk_input_elastic_source_data_name + "\")` | stats c";
                        }
                        else {
                            notification('ERROR: This from query is not supported, only datamodel and lookup based from queries are accepted.', 6000);
                            return;
                        }
                    }

                    else if (tk_input_elastic_source_search_type == "rest_tstats") {

                        // Extract amd replace
                        rest_matches = tk_raw_input_elastic_source_search_constraint.match(/((?:splunk_server|splunk_server_group)\=[^\|]*)\s{0,}\|\s{0,}(.*)/);
                        rest_target = rest_matches[1];
                        rest_constraint = rest_matches[2];
                        rest_constraint = rest_constraint.replace(/\"/g, "\\\"");
                        tk_elastic_alert_root_search = "| rest " + rest_target + " /servicesNS/admin/search/search/jobs/export search=\"| tstats max(_indextime) as data_last_ingest, min(_time) as data_first_time_seen, max(_time) as data_last_time_seen, count as data_eventcount, dc(host) as dcount_host where " + rest_constraint + " | eval data_name=\\\"" + tk_input_elastic_source_data_name + "\\\", data_index=\\\"" + tk_input_elastic_source_elastic_data_index + "\\\", data_sourcetype=\\\"" + tk_input_elastic_source_elastic_data_sourcetype + "\\\", data_last_ingestion_lag_seen=data_last_ingest-data_last_time_seen\"" + " output_mode=\"csv\"" + " earliest_time=\"" + tk_input_elastic_source_earliest + "\"" + " latest_time=\"" + tk_input_elastic_source_latest + "\"" + " | head 1 | table value | restextract " + " | `trackme_elastic_dedicated_tracker(\"" + tk_input_elastic_source_data_name + "\")` | stats c";

                    }

                    else if (tk_input_elastic_source_search_type == "rest_mstats") {

                        // Extract amd replace
                        rest_matches = tk_raw_input_elastic_source_search_constraint.match(/((?:splunk_server|splunk_server_group)\=[^\|]*)\s{0,}\|\s{0,}(.*)/);
                        rest_target = rest_matches[1];
                        rest_constraint = rest_matches[2];
                        rest_constraint = rest_constraint.replace(/\"/g, "\\\"");
                        tk_elastic_alert_root_search = "| rest " + rest_target + " /servicesNS/admin/search/search/jobs/export search=\"| mstats latest(_value) as value where " + rest_constraint + " by host, metric_name span=1s | stats min(_time) as data_first_time_seen, max(_time) as data_last_time_seen, dc(metric_name) as data_eventcount, dc(host) as dcount_host | eval data_last_ingest=data_last_time_seen | eval data_name=\\\"" + tk_input_elastic_source_data_name + "\\\", data_index=\\\"" + tk_input_elastic_source_elastic_data_index + "\\\", data_sourcetype=\\\"" + tk_input_elastic_source_elastic_data_sourcetype + "\\\", data_last_ingestion_lag_seen=data_last_ingest-data_last_time_seen\"" + " output_mode=\"csv\"" + " earliest_time=\"" + tk_input_elastic_source_earliest + "\"" + " latest_time=\"" + tk_input_elastic_source_latest + "\"" + " | head 1 | table value | restextract " + " | `trackme_elastic_dedicated_tracker(\"" + tk_input_elastic_source_data_name + "\")` | stats c";

                    }

                    else if (tk_input_elastic_source_search_type == "rest_raw") {

                        // Extract amd replace
                        rest_matches = tk_raw_input_elastic_source_search_constraint.match(/((?:splunk_server|splunk_server_group)\=[^\|]*)\s{0,}\|\s{0,}(.*)/);
                        rest_target = rest_matches[1];
                        rest_constraint = rest_matches[2];
                        rest_constraint = rest_constraint.replace(/\"/g, "\\\"");
                        tk_elastic_alert_root_search = "| rest " + rest_target + " /servicesNS/admin/search/search/jobs/export search=\"search " + rest_constraint + " | stats max(_indextime) as data_last_ingest, min(_time) as data_first_time_seen, max(_time) as data_last_time_seen, count as data_eventcount, dc(host) as dcount_host" + " | eval data_name=\\\"" + tk_input_elastic_source_data_name + "\\\", data_index=\\\"" + tk_input_elastic_source_elastic_data_index + "\\\", data_sourcetype=\\\"" + tk_input_elastic_source_elastic_data_sourcetype + "\\\", data_last_ingestion_lag_seen=data_last_ingest-data_last_time_seen\"" + " output_mode=\"csv\"" + " earliest_time=\"" + tk_input_elastic_source_earliest + "\"" + " latest_time=\"" + tk_input_elastic_source_latest + "\"" + " | head 1 | table value | restextract " + " | `trackme_elastic_dedicated_tracker(\"" + tk_input_elastic_source_data_name + "\")` | stats c";

                    }

                    else if (tk_input_elastic_source_search_type == "rest_from") {

                        if (/datamodel:/i.test(tk_raw_input_elastic_source_search_constraint)) {

                            // Extract amd replace
                            rest_matches = tk_raw_input_elastic_source_search_constraint.match(/((?:splunk_server|splunk_server_group)\=[^\|]*)\s{0,}\|\s{0,}(.*)/);
                            rest_target = rest_matches[1];
                            rest_constraint = rest_matches[2];
                            rest_constraint = rest_constraint.replace(/\"/g, "\\\"");
                            tk_elastic_alert_root_search = "| rest " + rest_target + " /servicesNS/admin/search/search/jobs/export search=\"| from " + rest_constraint + " | stats max(_indextime) as data_last_ingest, min(_time) as data_first_time_seen, max(_time) as data_last_time_seen, count as data_eventcount, dc(host) as dcount_host | eval data_name=\\\"" + tk_input_elastic_source_data_name + "\\\", data_index=\\\"" + tk_input_elastic_source_elastic_data_index + "\\\", data_sourcetype=\\\"" + tk_input_elastic_source_elastic_data_sourcetype + "\\\", data_last_ingestion_lag_seen=data_last_ingest-data_last_time_seen\"" + " output_mode=\"csv\" " + " earliest_time=\"" + tk_input_elastic_source_earliest + "\"" + " latest_time=\"" + tk_input_elastic_source_latest + "\"" + " | head 1 | table value | restextract " + " | `trackme_elastic_dedicated_tracker(\"" + tk_input_elastic_source_data_name + "\")` | stats c";

                        }
                        else if (/lookup:/i.test(tk_raw_input_elastic_source_search_constraint)) {

                            // Extract amd replace
                            rest_matches = tk_raw_input_elastic_source_search_constraint.match(/((?:splunk_server|splunk_server_group)\=[^\|]*)\s{0,}\|\s{0,}(.*)/);
                            rest_target = rest_matches[1];
                            rest_constraint = rest_matches[2];
                            rest_constraint = rest_constraint.replace(/\"/g, "\\\"");
                            tk_elastic_alert_root_search = "| rest " + rest_target + " /servicesNS/admin/search/search/jobs/export search=\"| from " + rest_constraint + " | eventstats max(_time) as indextime | eval _indextime=if(isnum(_indextime), _indextime, indextime) | fields - indextime | eval host=if(isnull(host), \\\"none\\\", host) | stats max(_indextime) as data_last_ingest, min(_time) as data_first_time_seen, max(_time) as data_last_time_seen, count as data_eventcount, dc(host) as dcount_host | eval data_name=\\\"" + tk_input_elastic_source_data_name + "\\\", data_index=\\\"" + tk_input_elastic_source_elastic_data_index + "\\\", data_sourcetype=\\\"" + tk_input_elastic_source_elastic_data_sourcetype + "\\\", data_last_ingestion_lag_seen=data_last_ingest-data_last_time_seen\"" + " output_mode=\"csv\" " + " earliest_time=\"" + tk_input_elastic_source_earliest + "\"" + " latest_time=\"" + tk_input_elastic_source_latest + "\"" + " | head 1 | table value | restextract " + " | `trackme_elastic_dedicated_tracker(\"" + tk_input_elastic_source_data_name + "\")` | stats c";

                        }
                        else {
                            notification('ERROR: This from query is not supported, only datamodel and lookup based from queries are accepted.', 6000);
                            return;
                        }
                    }

                    else if (tk_input_elastic_source_search_type == "mstats") {
                        tk_elastic_alert_root_search = "| mstats latest(_value) as value where " + tk_raw_input_elastic_source_search_constraint + " by host, metric_name span=1s | stats min(_time) as data_first_time_seen, max(_time) as data_last_time_seen, dc(metric_name) as data_eventcount, dc(host) as dcount_host | eval data_name=\"" + tk_input_elastic_source_data_name + "\", data_index=\"" + tk_input_elastic_source_elastic_data_index + "\", data_sourcetype=\"" + tk_input_elastic_source_elastic_data_sourcetype + "\", data_last_ingest=data_last_time_seen, data_last_ingestion_lag_seen=now()-data_last_time_seen | `trackme_elastic_dedicated_tracker(\"" + tk_input_elastic_source_data_name + "\")` | stats c" ;
                    }

                    function done(err) {
                        //error handling logic here
                    }

                    // Specify properties for the alert.
                    var alertOptions = {
                        name: tracker_name,
                        description: "Dedicated elastic tracker for data source",
                        search: tk_elastic_alert_root_search,
                        "dispatch.earliest_time": tk_input_elastic_source_earliest,
                        "dispatch.latest_time": tk_input_elastic_source_latest,
                        "is_scheduled": "1",
                        "cron_schedule": "*/5 * * * *"
                    };

                    // Create a saved search/report as an alert.
                    service.savedSearches().create(alertOptions, function(err, alert) {
                        // Error checking.
                        if (err && err.status === 409) {
                            msg = "ERROR: A saved search/report with the name " + alertOptions.name + " already exists";

                            // Audit
                            action = "failure";
                            change_type = "add elastic source tracker";
                            object = tracker_name;
                            object_category = "elastic_sources_tracker";
                            object_attrs = tk_elastic_alert_root_search;
                            result = msg;
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_elastic_source_alert_creation_error").find('.modal-error-message p').text(msg);
                            $("#add_elastic_sources").modal('hide');
                            $("#modal_elastic_source_alert_creation_error").modal()
                            done();
                            return;
                        }
                        else if (err) {
                            msg = "There was an error creating the saved search/report: error code " + err.status;

                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = "error code: " + err.status + " - " + err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify( "error code: " + err.status + " - " + err.data.messages);
                            }

                            // Audit
                            action = "failure";
                            change_type = "add elastic source tracker";
                            object = tracker_name;
                            object_category = "elastic_sources_tracker";
                            object_attrs = tk_elastic_alert_root_search;
                            result = errorStr;
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_elastic_source_alert_creation_error").find('.modal-error-message p').text(errorStr);
                            $("#add_elastic_sources").modal('hide');
                            $("#modal_elastic_source_alert_creation_error").modal()
                            done(err);
                            return;
                        }

                        else {

                            // clean status
                            unsetToken("start_simulation_elastic_sources");

                            // Confirmation message.

                            // Audit
                            action = "success";
                            change_type = "add elastic source tracker";
                            object = tracker_name;
                            object_category = "elastic_sources_tracker";
                            object_attrs = tk_elastic_alert_root_search;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            // Store in the KVstore for mapping purposes
                            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_elastic_sources_dedicated/"

                            // Create a dictionary to store the field names and values
                            var record = {
                                "data_name": tk_input_elastic_source_data_name,
                                "search_constraint": tk_raw_input_elastic_source_search_constraint,
                                "search_mode": tk_input_elastic_source_search_type,
                                "elastic_data_index": tk_input_elastic_source_elastic_data_index,
                                "elastic_data_sourcetype": tk_input_elastic_source_elastic_data_sourcetype,
                                "elastic_report": tracker_name
                            };
                            $.ajax({
                                url: myendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(record),
                                success: function(returneddata) {
                                    // house cleaning
                                    myendpoint_URl = undefined;
                                    delete(myendpoint_URl);
                                },
                                error: function(xhr, textStatus, error) {
                                    message = "Error Updating!" + xhr + textStatus + error;
                                }
                            });

                            msg = "Created saved search/report as alert: " + alert.name;
                            $("#modal_elastic_source_alert_creation_success").find('.modal-error-message p').text(msg);
                            $("#add_elastic_sources").modal('hide');
                            $("#modal_elastic_source_alert_creation_success").modal()

                            done();

                        }

                    });

                } else {
                    notification('ERROR: Please successfully run the simulation first.', 6000)
                }

            });

        });








        // run elastic shared tracker now
        $("#add_elastic_source_processed_run_tracker").click(function() {

            $("#add_elastic_source_processed").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - Elastic sources shared tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-4h",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Running the Elastic Shared Tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12, length: 18,
                                position: "relative", color: "#003b59"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                // Once the job is done, update all searches
                                searchDataSourcesMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        // run elastic shared tracker now
        $("#modal_elastic_source_alert_creation_success_run_tracker").click(function() {

            $("#modal_elastic_source_alert_creation_success").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the tracker name
            var tk_tracker_name = tokens.get("tk_tracker_name");

            // Define the query
            var searchQuery = "| savedsearch \"" + tk_tracker_name + "\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-4h",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Running the dedicated elastic tracker' +  tk_tracker_name + '...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12, length: 18,
                                position: "relative", color: "#003b59"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                // Once the job is done, update all searches
                                searchDataSourcesMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        // delete elastic source

        $("#btn_modal_elastic_sources_add_delete").click(function() {

            $("#modify_elastic_sources").modal('hide');
            $("#delete_elastic_source_main").modal();
            $("#modify_elastic_sources").modal('hide');

        });

        function foreachDeleteSharedElasticSource(item) {

        submitTokens();

        // When the Submit button is clicked, get all the form fields by accessing token values
        var tokens = mvc.Components.get("default");

        var tk_multi_table_array = tokens.get("removeElasticSourceShared");
        var tk_comment = tokens.get("tk_comment");


            if (item && item.length) {

                // Define the query
                var searchQuery = "| trackme url=\"/services/trackme/v1/elastic_sources/elastic_shared_del\" mode=\"delete\" body=\"{\\\"data_name\\\": \\\"" + item + "\\\", \\\"update_comment\\\": \\\"" + tk_comment + "\\\"}\"";

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-5m",
                    latest_time: "now"
                };

                // Run a normal search that immediately returns the job's SID
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        $("#loadingGray").remove()
                        $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Deleting shared elastic tracker...</p></div><div id="spinner"></div></div>')

                        require(["jquery",
                                "/static/app/trackme/spin.js"
                            ],
                            function($,
                                Spinner
                            ) {
                                new Spinner({
                                    lines: 12, length: 18,
                                    position: "relative", color: "#003b59"
                                }).spin(document.getElementById('spinner'));
                            })

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            $("#loadingGray").remove()
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {

                                    // Once the job is done, update all searches
                                    searchElasticSources.startSearch();
                                    searchDataSourcesMain.startSearch();

                                    $("#loadingGray").remove()

                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure").modal()
                                }
                            });
                        }
                    }
                );

            }

        }

        $("#btn_delete_elastic_source_confirm").click(function() {


            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeElasticSourceShared");
            tk_multi_table_array = tk_multi_table_array.split(',');

            // Retrieve update comment if any
            var tk_comment = document.getElementById("elastic_source_shared_delete_comment").value;

            // if is not defined, give it a value and override text box content
            if (tk_comment == "null") {
                setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                // replace the textarea for modification requests
                document.getElementById("elastic_source_shared_delete_comment").value = "update note";
            }
            else if (tk_comment == "update note") {
                tk_comment = "No comment for update.";
                document.getElementById("elastic_source_shared_delete_comment").value = "update note";
            }
            else {
                // replace the textarea for modification requests
                document.getElementById("elastic_source_shared_delete_comment").value = "update note";
            }
            setToken("tk_comment", tk_comment);

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachDeleteSharedElasticSource);

            // Hide main modal
            $("#delete_elastic_source_main").modal('hide');

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeElasticSourceShared");

            // Go back to modal
            $("#modify_elastic_sources").modal();

        });

        // delete elastic source

        $("#btn_modal_elastic_sources_dedicated_add_delete").click(function() {

            $("#modify_elastic_sources_dedicated").modal('hide');
            $("#delete_elastic_source_main_dedicated").modal();

        });

        function foreachDeleteDedicatedElasticSource(item) {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_multi_table_array = tokens.get("removeElasticSourceDedicated");
            var tk_comment = tokens.get("tk_comment");


            if (item && item.length) {

                // Define the query
                var searchQuery = "| trackme url=\"/services/trackme/v1/elastic_sources/elastic_dedicated_del\" mode=\"delete\" body=\"{\\\"data_name\\\": \\\"" + item + "\\\", \\\"update_comment\\\": \\\"" + tk_comment + "\\\"}\"";

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-5m",
                    latest_time: "now"
                };

                // Run a normal search that immediately returns the job's SID
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        $("#loadingGray").remove()
                        $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Deleting dedicated elastic tracker...</p></div><div id="spinner"></div></div>')

                        require(["jquery",
                                "/static/app/trackme/spin.js"
                            ],
                            function($,
                                Spinner
                            ) {
                                new Spinner({
                                    lines: 12, length: 18,
                                    position: "relative", color: "#003b59"
                                }).spin(document.getElementById('spinner'));
                            })

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            $("#loadingGray").remove()
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {

                                    // Once the job is done, update all searches
                                    searchElasticSourcesDedicated.startSearch();
                                    searchDataSourcesMain.startSearch();

                                    $("#loadingGray").remove()

                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure").modal()
                                }
                            });
                        }
                    }
                );

            }

        }

        $("#btn_delete_elastic_source_dedicated_confirm").click(function() {


            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeElasticSourceDedicated");
            tk_multi_table_array = tk_multi_table_array.split(',');

            // Retrieve update comment if any
            var tk_comment = document.getElementById("elastic_source_dedicated_delete_comment").value;

            // if is not defined, give it a value and override text box content
            if (tk_comment == "null") {
                setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                // replace the textarea for modification requests
                document.getElementById("elastic_source_dedicated_delete_comment").value = "update note";
            }
            else if (tk_comment == "update note") {
                tk_comment = "No comment for update.";
                document.getElementById("elastic_source_dedicated_delete_comment").value = "update note";
            }
            else {
                // replace the textarea for modification requests
                document.getElementById("elastic_source_dedicated_delete_comment").value = "update note";
            }
            setToken("tk_comment", tk_comment);

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachDeleteDedicatedElasticSource);

            // Hide main modal
            $("#delete_elastic_source_main_dedicated").modal('hide');

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeElasticSourceDedicated");
            
            // Go back to modal
            $("#modify_elastic_sources_dedicated").modal();

        });

        //
        // Custom lagging classes
        //

        $('.btn_modify_custom_lagging').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_custom_lagging", "true");
                // Show input modal
                $("#modify_custom_lagging").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_custom_lagging_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modify_custom_lagging").modal();

        });

        //
        // Metrics SLA policies in-modal editor
        //

        $('.btn_modify_metric_sla_policies').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_metric_sla_policies", "true");
                // Show input modal
                $("#modal_metric_sla_policies").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_metric_sla_policy_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_metric_sla_policies").modal();

        });

        //
        // allowlisting data source
        //

        $('.btn_modify_data_source_whitelist').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_source_whitelist", "true");
                // Show input modal
                $("#modal_modify_data_source_whitelist").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_source_whitelist_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_source_whitelist").modal();

        });

        //
        // allowlisting data host
        //

        $('.btn_modify_data_host_whitelist').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_host_whitelist", "true");
                // Show input modal
                $("#modal_modify_data_host_whitelist").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_host_whitelist_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_host_whitelist").modal();

        });

        //
        // Metrics hosts Search & Report
        //

        // Show modal
        $("#btn_search_metric_reports").click(function() {

            // Show input modal
            $("#metric_hosts_search_and_reports").modal();

        });

        // back button
        $("#btn_metric_host_search_and_report_back").click(function() {

            // Show input modal
            $("#modal_manage_metric_host").modal();

        });

        //
        // allowlisting metric host
        //

        $('.btn_modify_metric_host_whitelist').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_metric_host_whitelist", "true");
                // Show input modal
                $("#modal_modify_metric_host_whitelist").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_metric_host_whitelist_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_metric_host_whitelist").modal();

        });

        //
        // blacklisting data source
        //

        // host blacklist

        $('.btn_modify_data_source_blacklist_host').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_source_blacklist_host", "true");
                // Show input modal
                $("#modal_modify_data_source_blacklist_host").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_source_blacklist_host_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_source_blacklist_host").modal();

        });

        // indexe blacklist

        $('.btn_modify_data_source_blacklist_index').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_source_blacklist_index", "true");
                // Show input modal
                $("#modal_modify_data_source_blacklist_index").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_source_blacklist_index_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_source_blacklist_index").modal();

        });

        // sourcetype blacklist

        $('.btn_modify_data_source_blacklist_sourcetype').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_source_blacklist_sourcetype", "true");
                // Show input modal
                $("#modal_modify_data_source_blacklist_sourcetype").modal();
            });

        });

        // data_name blacklist

        $('.btn_modify_data_source_blacklist_data_name').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_source_blacklist_data_name", "true");
                // Show input modal
                $("#modal_modify_data_source_blacklist_data_name").modal();
            });

        });

        // blacklisting data host

        // host blacklist

        $('.btn_modify_data_host_blacklist_host').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_host_blacklist_host", "true");
                // Show input modal
                $("#modal_modify_data_host_blacklist_host").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_host_blacklist_host_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_host_blacklist_host").modal();

        });

        // indexe blacklist

        $('.btn_modify_data_host_blacklist_index').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_host_blacklist_index", "true");
                // Show input modal
                $("#modal_modify_data_host_blacklist_index").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_host_blacklist_index_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_host_blacklist_index").modal();

        });

        // sourcetype blacklist

        $('.btn_modify_data_host_blacklist_sourcetype').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_host_blacklist_sourcetype", "true");
                // Show input modal
                $("#modal_modify_data_host_blacklist_sourcetype").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_host_blacklist_sourcetype_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_host_blacklist_sourcetype").modal();

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_source_blacklist_sourcetype_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_source_blacklist_sourcetype").modal();

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_source_blacklist_data_name_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_source_blacklist_data_name").modal();

        });

        // metric_host blacklist

        // host blacklist

        $('.btn_modify_metric_host_blacklist_host').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_metric_host_blacklist_host", "true");
                // Show input modal
                $("#modal_modify_metric_host_blacklist_host").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_metric_host_blacklist_host_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_metric_host_blacklist_host").modal();

        });

        // indexe blacklist

        $('.btn_modify_metric_host_blacklist_index').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_metric_host_blacklist_index", "true");
                // Show input modal
                $("#modal_modify_metric_host_blacklist_index").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_metric_host_blacklist_index_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_metric_host_blacklist_index").modal();

        });

        // metric category
        $('.btn_modify_metric_host_blacklist_metric_category').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_metric_host_blacklist_metric_category", "true");
                // Show input modal
                $("#modal_modify_metric_host_blacklist_metric_category").modal();
            });

        });

        // Ops: Indexer queues
        $('.btn_ops_index_queue').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("tk_start_indexers_queues_searches", "true");

                // Show input modal
                $("#modal_queues").modal();
            });

        });

        // Unset token when bootstrap modal is closed properly
        $("#btn_ops_index_queue_close").click(function() {
            submitTokens();

            unsetToken("tk_start_indexers_queues_searches");

        });

        // Ops: Parsing issues

        $('.btn_ops_parsing_issues').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("tk_start_parsing_issues_searches", "true");
                var tk_hosts = tokens.get("inputHostParsing");

                // Show input modal
                $("#modal_parsing_issues").modal();
            });

        });

        $("#btn_search_parsing_issues_linebreaking").click(function() {

            submitTokens();
            setToken("tk_start_parsing_issues_searches", "true");
            var tk_earliest = tokens.get("inputLinkParsingIssuesTime.earliest");
            var tk_latest = tokens.get("inputLinkParsingIssuesTime.latest");
            var tk_hosts = tokens.get("inputHostParsing");

            // Define the history search
            var search_parsing_issues_linebreaking = 'search' + "?q=search%20" + encodeURI("index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=LineBreakingProcessor ") + encodeURI(tk_hosts) + "&earliest=" + encodeURI(tk_earliest) + "&latest=" + encodeURI(tk_latest);

            // Open
            window.open(search_parsing_issues_linebreaking,'_blank');

        });

        $("#btn_search_parsing_issues_aggregator").click(function() {

            submitTokens();
            setToken("tk_start_parsing_issues_searches", "true");
            var tk_earliest = tokens.get("inputLinkParsingIssuesTime.earliest");
            var tk_latest = tokens.get("inputLinkParsingIssuesTime.latest");
            var tk_hosts = tokens.get("inputHostParsing");

            // Define the history search
            var search_parsing_issues_aggregator = 'search' + "?q=search%20" + encodeURI("index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=AggregatorMiningProcessor ") + encodeURI(tk_hosts) + "&earliest=" + encodeURI(tk_earliest) + "&latest=" + encodeURI(tk_latest);

            // Open
            window.open(search_parsing_issues_aggregator,'_blank');

        });

        $("#btn_search_parsing_issues_dateparser").click(function() {
            
            submitTokens();
            setToken("tk_start_parsing_issues_searches", "true");
            var tk_earliest = tokens.get("inputLinkParsingIssuesTime.earliest");
            var tk_latest = tokens.get("inputLinkParsingIssuesTime.latest");
            var tk_hosts = tokens.get("inputHostParsing");

            // Define the history search
            var search_parsing_issues_dateparser = 'search' + "?q=search%20" + encodeURI("index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=DateParserVerbose ") + encodeURI(tk_hosts) + encodeURI(" | `trackme_rex_dateparserverbose`") + "&earliest=" + encodeURI(tk_earliest) + "&latest=" + encodeURI(tk_latest);

            // Open
            window.open(search_parsing_issues_dateparser,'_blank');

        });

        // Unset token when bootstrap modal is closed properly
        $("#btn_ops_parsing_issues_close").click(function() {
            submitTokens();

            unsetToken("tk_start_parsing_issues_searches");

        });

        //
        // RUN TRACKERS
        //

        $("#btn_run_trackers").click(function() {
                // Show input modal
                $("#modal_run_data_source_trackers").modal();
        });

        $("#btn_run_data_host_trackers").click(function() {
                // Show input modal
                $("#modal_run_data_host_trackers").modal();
        });

        //
        // UPDATE COLLECTION
        //

        // Call this function when the Update collection button is clicked

        $("#btn_run_tracker").click(function() {
            submitTokens();

            $("#modal_run_data_source_trackers").modal('hide');

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");


            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - Data sources availability short term tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-4h",
                latest_time: "+4h"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Running the data sources short term tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12, length: 18,
                                position: "relative", color: "#003b59"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                // Once the job is done, update all searches
                                searchDataSourcesMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        $("#btn_run_tracker_host").click(function() {
            submitTokens();

            $("#modal_run_data_host_trackers").modal('hide');

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");


            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - hosts availability short term tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-4h",
                latest_time: "+4h"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Running the host short term tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12, length: 18,
                                position: "relative", color: "#003b59"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                // Once the job is done, update all searches
                                searchDataHostsMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        // Call this function when the Update collection button is clicked

        $("#btn_run_tracker_longterm").click(function() {
            submitTokens();

            $("#modal_run_data_source_trackers").modal('hide');

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");


            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - Data sources availability long term tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-24h",
                latest_time: "-4h"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Running the data sources long term tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12, length: 18,
                                position: "relative", color: "#003b59"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                // Once the job is done, update all searches
                                searchDataSourcesMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        $("#btn_run_tracker_host_longterm").click(function() {
            submitTokens();

            $("#modal_run_data_host_trackers").modal('hide');

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");


            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - hosts availability long term tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-7d",
                latest_time: "+4h"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Running the host long term tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12, length: 18,
                                position: "relative", color: "#003b59"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                // Once the job is done, update all searches
                                searchDataHostsMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        // Elastic shared tracker

        $("#btn_run_tracker_shared_elastic").click(function() {
            submitTokens();

            $("#modal_run_data_source_trackers").modal('hide');

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");


            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - Elastic sources shared tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-4h",
                latest_time: "+4h"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Running the Elastic sources Shared tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12, length: 18,
                                position: "relative", color: "#003b59"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                // Once the job is done, update all searches
                                searchDataSourcesMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        // Data Sampling tracker

        $("#btn_run_tracker_data_sampling").click(function() {
            submitTokens();

            $("#modal_run_data_source_trackers").modal('hide');

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");


            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - Data sampling and format detection tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-24h",
                latest_time: "+4h"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Running the Data sampling & events format recognition tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12, length: 18,
                                position: "relative", color: "#003b59"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                // Once the job is done, update all searches
                                searchDataSourcesMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        // metric host

        $("#btn_run_tracker_metric_host").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");


            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - metric hosts availability tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-5m",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Running the metric tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12, length: 18,
                                position: "relative", color: "#003b59"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                // Once the job is done, update all searches
                                searchMetricHostsMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        // Show main

        // for data sources

        $("#btn_modify_data_source_blacklist_main").click(function() {
            // Show input modal
            $("#modal_manage_data_source_blacklists").modal();
        });

        // Cancel buttons

        $("#btn_modal_data_source_whitelist_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_source_blacklists").modal();
        });

        $("#btn_modal_data_source_blacklist_host_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_source_blacklists").modal();
        });

        $("#btn_modal_data_source_blacklist_index_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_source_blacklists").modal();
        });

        $("#btn_modal_data_source_blacklist_sourcetype_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_source_blacklists").modal();
        });

        $("#btn_modal_data_source_blacklist_data_name_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_source_blacklists").modal();
        });

        // for data hosts

        // for data sources

        $("#btn_modify_data_host_blacklist_main").click(function() {
            // Show input modal
            $("#modal_manage_data_host_blacklists").modal();
        });

        // for metric indexes
        $("#btn_modify_metric_host_blacklist_main").click(function() {
            // Show input modal
            $("#modal_manage_metric_host_blacklists").modal();
        });

        // Cancel buttons

        $("#btn_modal_data_host_whitelist_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_host_blacklists").modal();
        });

        $("#btn_modal_data_host_blacklist_index_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_host_blacklists").modal();
        });

        $("#btn_modal_metric_host_blacklist_index_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_metric_host_blacklists").modal();
        });

        $("#btn_modal_data_host_blacklist_sourcetype_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_host_blacklists").modal();
        });

        $("#btn_modal_data_host_blacklist_host_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_host_blacklists").modal();
        });

        $("#btn_modal_metric_host_blacklist_host_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_metric_host_blacklists").modal();
        });

        $("#btn_modal_metric_host_whitelist_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_metric_host_blacklists").modal();
        });

        $("#btn_modal_metric_host_blacklist_metric_category_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_metric_host_blacklists").modal();
        });

        //
        // MODIFY BUTTON
        //

        // data source monitoring

        $("#btn_modify_data_source").click(function() {
            submitTokens();

            // Hide main modal
            $("#modal_manage").modal('hide');

            // Show input modal
            $("#modal_modify_data_source_unified").modal();

        });

        // cancel button: returns to selected
        $("#btn_close_data_source_unified").click(function() {
            submitTokens();

            // Show modal
            $("#modal_manage").modal();

        });

        $("#btn_modal_modify_wdays").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_monitoring_wdays").modal();

        });

        $("#btn_modal_modify_monitoring_wdays_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/data_sources/ds_update_wdays";

            var tk_origin_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitoring_wdays = tokens.get("tk_input_wdays");

            if (!tk_data_monitoring_wdays || !tk_data_monitoring_wdays.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "data_name": tk_data_name,
                    "data_monitoring_wdays": tk_data_monitoring_wdays,
                    "update_comment": "N/A"
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    dataType: "text",
                    beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        // Run the search again to update the table
                        searchDataSourcesMain.startSearch();

                        // call update data source
                        updateDataSource(tk_keyid);

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);

                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "server response: " + xhr.responseText + "\n - http response: " + error;

                        // Audit
                        action = "failure";
                        change_type = "modify week days monitoring";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }

        });

        // priority
        $("#btn_modal_modify_priority_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_priority = tokens.get("tk_priority");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/data_sources/ds_update_priority";

            var tk_origin_priority = tk_priority;
            var tk_new_priority = tokens.get("tk_input_priority");

            if (!tk_new_priority || !tk_new_priority.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "object_category": "data_source",
                    "data_name": tk_data_name,
                    "priority": tk_new_priority,
                    "update_comment": "N/A"
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    dataType: "text",
                    beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        // Run the search again to update the table
                        searchDataSourcesMain.startSearch();

                        // call update data source
                        updateDataSource(tk_keyid);

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);

                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "server response: " + xhr.responseText + "\n - http response: " + error;

                        // Audit
                        action = "failure";
                        change_type = "modify priority";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = "priority changed from:" + tk_origin_priority + " to:" + tk_new_priority;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }

        });

        $("#btn_modal_modify_wdays_no").click(function() {

            // Show input modal
            $("#modal_modify_monitoring_wdays_no").modal();

        });

        $("#btn_modal_modify_monitoring_wdays_no_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/data_sources/ds_update_wdays";

            var tk_origin_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitoring_wdays_no = tokens.get("tk_input_wdays_no");

            if (!tk_data_monitoring_wdays_no || !tk_data_monitoring_wdays_no.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "data_name": tk_data_name,
                    "data_monitoring_wdays": tk_data_monitoring_wdays_no,
                    "update_comment": "N/A"
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    dataType: "text",
                    beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        // Run the search again to update the table
                        searchDataSourcesMain.startSearch();

                        $("#modal_modify_data_source_unified").modal();

                        // call update data source
                        updateDataSource(tk_keyid);

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "server response: " + xhr.responseText + "\n - http response: " + error;

                        // Audit
                        action = "failure";
                        change_type = "modify week days monitoring";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays_no;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        // cancel: returns to unified modal
        $("#btn_modal_modify_monitoring_wdays_no_cancel").click(function() {

            // Show input modal
            $("#modal_modify_data_source_unified").modal();

        });

        //
        // Modify monitoring level
        //

        $("#btn_modal_modify_level").click(function() {

            // Show input modal
            $("#modal_modify_monitoring_level").modal();

        });

        $("#btn_modal_modify_monitoring_level_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/data_sources/ds_update_monitoring_level";

            var tk_data_monitoring_level = tokens.get("tk_input_level");
            var tk_origin_data_monitoring_level = tokens.get("tk_data_monitoring_level");

            if (!tk_data_monitoring_level || !tk_data_monitoring_level.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "data_name": tk_data_name,
                    "data_monitoring_level": tk_data_monitoring_level,
                    "update_comment": "N/A"
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    dataType: "text",
                    beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        // Run the search again to update the table
                        searchDataSourcesMain.startSearch();

                        // call update data source
                        updateDataSource(tk_keyid);

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "server response: " + xhr.responseText + "\n - http response: " + error;

                        // Audit
                        action = "failure";
                        change_type = "modify monitoring level";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = "data_monitoring_level changed from:" + tk_origin_data_monitoring_level + " to:" + tk_data_monitoring_level;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        //
        // dcount host
        //

        $("#btn_modal_modify_dcount_host_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_min_dcount_host = tokens.get("tk_min_dcount_host");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/data_sources/ds_update_min_dcount_host";

            var tk_input_data_source_dcount_host = tokens.get("tk_input_data_source_dcount_host");
            var tk_origin_dcount_host = tokens.get("tk_min_dcount_host");

            if (!tk_input_data_source_dcount_host || !tk_input_data_source_dcount_host.length) {
                // Show an error notification
                notification('ERROR: the minimal distinct host count value needs to be a positive integer, or the string "any" to define any value.', 6000)
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "data_name": tk_data_name,
                    "min_dcount_host": tk_input_data_source_dcount_host,
                    "update_comment": "N/A"
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    dataType: "text",
                    beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        // Run the search again to update the table
                        searchDataSourcesMain.startSearch();

                        // call update data source
                        updateDataSource(tk_keyid);

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "server response: " + xhr.responseText + "\n - http response: " + error;

                        // Audit
                        action = "failure";
                        change_type = "modify minimal hosts distinct count number";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = "min_dcount_host changed from:" + tk_origin_dcount_host + " to:" + tk_input_data_source_dcount_host;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        //
        // Modify lag
        //

        $("#btn_modal_modify_lag").click(function() {

            // Show input modal
            $("#modal_modify_lag").modal();

        });

        $("#btn_modal_modify_lag_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/data_sources/ds_update_lag_policy";

            // max lag allowed
            var tk_data_max_lag_allowed = tokens.get("tk_input_lag");

            // alert over kpis
            var tk_data_lag_alert_kpis = tokens.get("tk_input_data_lag_alert_kpis");

            // lagging class override
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class");

            if (!tk_data_max_lag_allowed || !tk_data_max_lag_allowed.length || !isNumeric(tk_data_max_lag_allowed)) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "data_name": tk_data_name,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_lag_alert_kpis": tk_data_lag_alert_kpis,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "update_comment": "N/A"
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    dataType: "text",
                    beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        // Run the search again to update the table
                        searchDataSourcesMain.startSearch();
                        // call update data source
                        updateDataSource(tk_keyid);
                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "server response: " + xhr.responseText + "\n - http response: " + error;

                        // Audit
                        action = "failure";
                        change_type = "modify monitoring lag policy";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = "{\"data_max_lag_allowed\": \"" + tk_data_max_lag_allowed + "\", \"data_override_lagging_class\": \"" + tk_data_override_lagging_class + "\", \"data_lag_alert_kpis\": \"" + tk_data_lag_alert_kpis + "\"}";
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        // Show main modal
        $("#btn_modal_modify_lag_auto_main").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Free the searches
            setToken("show_data_source_autolagging", "true");

            // Show modal
            $("#modal_modify_data_source_autolag").modal();
        });

        // Show main modal back
        $("#btn_close_data_source_unified_autolag").click(function() {
            $("#modal_modify_data_source_unified").modal();
        });

        $("#btn_modal_modify_lag_auto_perc95").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class");


            // Define the query
            var searchQuery = "| `trackme_tstats` count latest(_indextime) as indextime where index=\"" + tk_data_index + "\" sourcetype=\"" + tk_data_sourcetype + "\"  by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats perc95(delta) as value | eval data_name=\"" + tk_data_name + "\", data_override_lagging_class=\"" + tk_data_override_lagging_class + "\" | lookup trackme_data_source_monitoring data_name OUTPUT _key as keyid | lookup trackme_data_source_monitoring data_name | eval data_max_lag_allowed=if(value>0, round(value, 0), data_max_lag_allowed), value=round(value, 0) | outputlookup trackme_data_source_monitoring key_field=keyid";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-7d",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    // hide the current modal
                    $("#modal_modify_data_source_autolag").modal('hide');

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Please wait while determining the entity lagging value...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12, length: 18,
                                position: "relative", color: "#003b59"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                $("#loadingGray").remove()

                                // if the action is very fast, the modal may fail, show up after 1 sec
                                setTimeout(function(){
                                  $("#modal_modify_data_source_unified").modal()
                                }, 1000);

                                // Get the results and display them
                                job.results({}, function(err, results) {
                                    var fields = results.fields;
                                    var rows = results.rows;
                                    for (var i = 0; i < rows.length; i++) {
                                        var values = rows[i];
                                        for (var j = 0; j < values.length; j++) {
                                            var field = fields[j];
                                            var value = values[j];

                                            if (field == "data_max_lag_allowed") {

                                                if (value === '0') {
                                                    notification('ERROR: No live data available for this entity, automatic lagging calculation cannot be performed for inactive entities.', 6000)
                                                } else {
                                                    // Run the search again to update the table
                                                    searchDataSourcesMain.startSearch();

                                                    // notify
                                                    notification('Modification has been registered successfully, max lagging value automatically defined to ' + value + ' seconds.', 6000)

                                                    setToken("tk_data_max_lag_allowed", value);
                                                    setToken("form.tk_input_lag", value);
                                                    tk_data_max_lag_allowed = value;

                                                    // Audit success change
                                                    action = "success";
                                                    change_type = "apply auto defined monitoring lag";
                                                    object = tk_data_name;
                                                    object_category = "data_source";
                                                    object_attrs = "{\"data_max_lag_allowed\": \"" + value + "\", \"data_override_lagging_class\": \"" + tk_data_override_lagging_class + "\"}";
                                                    result = "N/A";
                                                    comment = "N/A";
                                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                                }

                                            }

                                        }
                                    }
                                })

                                // call update data source
                                updateDataSource(tk_keyid);

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = errorStr;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = err;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);
                            }
                        });
                    }
                }
            );

        });

        $("#btn_modal_modify_lag_auto_average").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class");


            // Define the query
            var searchQuery = "| `trackme_tstats` count latest(_indextime) as indextime where index=\"" + tk_data_index + "\" sourcetype=\"" + tk_data_sourcetype + "\"  by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats avg(delta) as value | eval data_name=\"" + tk_data_name + "\", data_override_lagging_class=\"" + tk_data_override_lagging_class + "\" | lookup trackme_data_source_monitoring data_name OUTPUT _key as keyid | lookup trackme_data_source_monitoring data_name | eval data_max_lag_allowed=if(value>0, round(value, 0), data_max_lag_allowed), value=round(value, 0) | outputlookup trackme_data_source_monitoring key_field=keyid";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-7d",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    // hide the current modal
                    $("#modal_modify_data_source_autolag").modal('hide');

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Please wait while determining the entity lagging value...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12, length: 18,
                                position: "relative", color: "#003b59"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                $("#loadingGray").remove()

                                // if the action is very fast, the modal may fail, show up after 1 sec
                                setTimeout(function(){
                                  $("#modal_modify_data_source_unified").modal()
                                }, 1000);

                                // Get the results and display them
                                job.results({}, function(err, results) {
                                    var fields = results.fields;
                                    var rows = results.rows;
                                    for (var i = 0; i < rows.length; i++) {
                                        var values = rows[i];
                                        for (var j = 0; j < values.length; j++) {
                                            var field = fields[j];
                                            var value = values[j];

                                            if (field == "data_max_lag_allowed") {

                                                if (value === '0') {
                                                    notification('ERROR: No live data available for this entity, automatic lagging calculation cannot be performed for inactive entities.', 6000)
                                                } else {
                                                    // Run the search again to update the table
                                                    searchDataSourcesMain.startSearch();

                                                    // notify
                                                    notification('Modification has been registered successfully, max lagging value automatically defined to ' + value + ' seconds.', 6000)

                                                    setToken("tk_data_max_lag_allowed", value);
                                                    setToken("form.tk_input_lag", value);
                                                    tk_data_max_lag_allowed = value;

                                                    // Audit success change
                                                    action = "success";
                                                    change_type = "apply auto defined monitoring lag";
                                                    object = tk_data_name;
                                                    object_category = "data_source";
                                                    object_attrs = "{\"data_max_lag_allowed\": \"" + value + "\", \"data_override_lagging_class\": \"" + tk_data_override_lagging_class + "\"}";
                                                    result = "N/A";
                                                    comment = "N/A";
                                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                                }

                                            }

                                        }
                                    }
                                })

                                // call update data source
                                updateDataSource(tk_keyid);

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = errorStr;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = err;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }
                        });
                    }
                }
            );

        });

        $("#btn_modal_modify_lag_auto_perc95_30d").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class");


            // Define the query
            var searchQuery = "| `trackme_tstats` count latest(_indextime) as indextime where index=\"" + tk_data_index + "\" sourcetype=\"" + tk_data_sourcetype + "\"  by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats perc95(delta) as value | eval data_name=\"" + tk_data_name + "\", data_override_lagging_class=\"" + tk_data_override_lagging_class + "\" | lookup trackme_data_source_monitoring data_name OUTPUT _key as keyid | lookup trackme_data_source_monitoring data_name | eval data_max_lag_allowed=if(value>0, round(value, 0), data_max_lag_allowed), value=round(value, 0) | outputlookup trackme_data_source_monitoring key_field=keyid";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-30d",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    // hide the current modal
                    $("#modal_modify_data_source_autolag").modal('hide');

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Please wait while determining the entity lagging value...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12, length: 18,
                                position: "relative", color: "#003b59"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                $("#loadingGray").remove()

                                // if the action is very fast, the modal may fail, show up after 1 sec
                                setTimeout(function(){
                                  $("#modal_modify_data_source_unified").modal()
                                }, 1000);

                                // Get the results and display them
                                job.results({}, function(err, results) {
                                    var fields = results.fields;
                                    var rows = results.rows;
                                    for (var i = 0; i < rows.length; i++) {
                                        var values = rows[i];
                                        for (var j = 0; j < values.length; j++) {
                                            var field = fields[j];
                                            var value = values[j];

                                            if (field == "data_max_lag_allowed") {

                                                if (value === '0') {
                                                    notification('ERROR: No live data available for this entity, automatic lagging calculation cannot be performed for inactive entities.', 6000)
                                                } else {
                                                    // Run the search again to update the table
                                                    searchDataSourcesMain.startSearch();

                                                    // notify
                                                    notification('Modification has been registered successfully, max lagging value automatically defined to ' + value + ' seconds.', 6000)

                                                    setToken("tk_data_max_lag_allowed", value);
                                                    setToken("form.tk_input_lag", value);
                                                    tk_data_max_lag_allowed = value;

                                                    // Audit success change
                                                    action = "success";
                                                    change_type = "apply auto defined monitoring lag";
                                                    object = tk_data_name;
                                                    object_category = "data_source";
                                                    object_attrs = "{\"data_max_lag_allowed\": \"" + value + "\", \"data_override_lagging_class\": \"" + tk_data_override_lagging_class + "\"}";
                                                    result = "N/A";
                                                    comment = "N/A";
                                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                                }

                                            }

                                        }
                                    }
                                })

                                // call update data source
                                updateDataSource(tk_keyid);

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = errorStr;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = err;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }
                        });
                    }
                }
            );

        });

        $("#btn_modal_modify_lag_auto_average_30d").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class");


            // Define the query
            var searchQuery = "| `trackme_tstats` count latest(_indextime) as indextime where index=\"" + tk_data_index + "\" sourcetype=\"" + tk_data_sourcetype + "\"  by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats avg(delta) as value | eval data_name=\"" + tk_data_name + "\", data_override_lagging_class=\"" + tk_data_override_lagging_class + "\" | lookup trackme_data_source_monitoring data_name OUTPUT _key as keyid | lookup trackme_data_source_monitoring data_name | eval data_max_lag_allowed=if(value>0, round(value, 0), data_max_lag_allowed), value=round(value, 0) | outputlookup trackme_data_source_monitoring key_field=keyid";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-30d",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    // hide the current modal
                    $("#modal_modify_data_source_autolag").modal('hide');

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Please wait while determining the entity lagging value...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12, length: 18,
                                position: "relative", color: "#003b59"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                $("#loadingGray").remove()

                                // if the action is very fast, the modal may fail, show up after 1 sec
                                setTimeout(function(){
                                  $("#modal_modify_data_source_unified").modal()
                                }, 1000);

                                // Get the results and display them
                                job.results({}, function(err, results) {
                                    var fields = results.fields;
                                    var rows = results.rows;
                                    for (var i = 0; i < rows.length; i++) {
                                        var values = rows[i];
                                        for (var j = 0; j < values.length; j++) {
                                            var field = fields[j];
                                            var value = values[j];

                                            if (field == "data_max_lag_allowed") {

                                                if (value === '0') {
                                                    notification('ERROR: No live data available for this entity, automatic lagging calculation cannot be performed for inactive entities.', 6000)
                                                } else {
                                                    // Run the search again to update the table
                                                    searchDataSourcesMain.startSearch();

                                                    // notify
                                                    notification('Modification has been registered successfully, max lagging value automatically defined to ' + value + ' seconds.', 6000)

                                                    setToken("tk_data_max_lag_allowed", value);
                                                    setToken("form.tk_input_lag", value);
                                                    tk_data_max_lag_allowed = value;

                                                    // Audit success change
                                                    action = "success";
                                                    change_type = "apply auto defined monitoring lag";
                                                    object = tk_data_name;
                                                    object_category = "data_source";
                                                    object_attrs = "{\"data_max_lag_allowed\": \"" + value + "\", \"data_override_lagging_class\": \"" + tk_data_override_lagging_class + "\"}";
                                                    result = "N/A";
                                                    comment = "N/A";
                                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                                }

                                            }

                                        }
                                    }
                                })

                                // call update data source
                                updateDataSource(tk_keyid);

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = errorStr;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = err;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }
                        });
                    }
                }
            );

        });

        // metric host monitoring

        $("#btn_modify_metric_host").click(function() {

            // Hide main modal
            $("#modal_manage_metrichost").modal('hide');

            // Show input modal
            $("#modal_modify_metric_host_unified").modal();

        });

        // data host monitoring

        $("#btn_modify_data_host").click(function() {

            // Hide main modal
            $("#modal_manage_host").modal('hide');

            // Show input modal
            $("#modal_modify_data_host_unified").modal();

        });

        // cancel button: returns to selected
        $("#btn_close_data_host_unified").click(function() {
            submitTokens();

            // Show modal
            $("#modal_manage_host").modal();

        });

        //
        // Modify monitoring wdays
        //

        $("#btn_modal_modify_wdays_host").click(function() {

            // Show input modal
            $("#modal_modify_monitoring_wdays_host").modal();

        });

        $("#btn_modal_modify_monitoring_wdays_host_confirm").click(function() {

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/data_hosts/dh_update_wdays";

            var tk_origin_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitoring_wdays = tokens.get("tk_input_wdays_host");

            if (!tk_data_monitoring_wdays || !tk_data_monitoring_wdays.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "data_host": tk_data_host,
                    "data_monitoring_wdays": tk_data_monitoring_wdays,
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    dataType: "text",
                    beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        // Run the search again to update the table
                        searchDataHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // call update data source
                        updateDataHost(tk_keyid);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "server response: " + xhr.responseText + "\n - http response: " + error;

                        // Audit
                        action = "failure";
                        change_type = "modify week days monitoring";
                        object = tk_data_host;
                        object_category = "data_host";
                        object_attrs = "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        // host priority
        $("#btn_modal_modify_priority_host_confirm").click(function() {

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_priority = tokens.get("tk_priority");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/data_hosts/dh_update_priority";

            var tk_origin_priority = tk_priority;
            var tk_new_priority = tokens.get("tk_input_host_priority");

            if (!tk_new_priority || !tk_new_priority.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "data_host": tk_data_host,
                    "priority": tk_new_priority,
                    "update_comment": "N/A"
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    dataType: "text",
                    beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        // Run the search again to update the table
                        searchDataHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // call update data source
                        updateDataHost(tk_keyid);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "server response: " + xhr.responseText + "\n - http response: " + error;

                        // Audit
                        action = "failure";
                        change_type = "modify priority";
                        object = tk_data_host;
                        object_category = "data_host";
                        object_attrs = "priority changed from:" + tk_origin_priority + " to:" + tk_new_priority;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        $("#btn_modal_modify_wdays_host_no").click(function() {

            // Show input modal
            $("#modal_modify_monitoring_wdays_host_no").modal();

        });

        // Week days

        $("#btn_modal_modify_monitoring_wdays_host_no_confirm").click(function() {

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_host_st_summary = tokens.get("tk_data_host_st_summary");
            var tk_data_host_alerting_policy = tokens.get("tk_data_host_alerting_policy");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_lag_alert_kpis = tokens.get("tk_data_lag_alert_kpis");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_host_state = tokens.get("tk_data_host_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_host_state = tokens.get("tk_data_previous_host_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");


            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_host_monitoring/" + tk_keyid;

            var tk_origin_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitoring_wdays_no = tokens.get("tk_input_wdays_host_no");

            if (!tk_data_monitoring_wdays_no || !tk_data_monitoring_wdays_no.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "object_category": "data_host",
                    "data_host": tk_data_host,
                    "data_index": tk_data_index,
                    "data_sourcetype": tk_data_sourcetype,
                    "data_host_st_summary" : tk_data_host_st_summary,
                    "data_host_alerting_policy": tk_data_host_alerting_policy,
                    "data_last_lag_seen": tk_data_last_lag_seen,
                    "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                    "data_eventcount": tk_data_eventcount,
                    "data_first_time_seen": tk_data_first_time_seen,
                    "data_last_time_seen": tk_data_last_time_seen,
                    "data_last_ingest": tk_data_last_ingest,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_lag_alert_kpis": tk_data_lag_alert_kpis,
                    "data_monitored_state": tk_data_monitored_state,
                    "data_monitoring_wdays": tk_data_monitoring_wdays_no,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "data_host_state": tk_data_host_state,
                    "data_tracker_runtime": tk_data_tracker_runtime,
                    "data_previous_host_state": tk_data_previous_host_state,
                    "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                    "OutlierMinEventCount": tk_outliermineventcount,
                    "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                    "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                    "OutlierAlertOnUpper": tk_outlieralertonupper,
                    "OutlierTimePeriod": tk_outlier_period,
                    "OutlierSpan": tk_outlier_span,
                    "isOutlier": tk_isoutlier,
                    "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                    "latest_flip_state": tk_latest_flip_state,
                    "latest_flip_time": tk_latest_flip_time,
                    "priority": tk_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        // Run the search again to update the table
                        searchDataHostsMain.startSearch();

                        $("#modal_modify_data_host_unified").modal();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // call update data source
                        updateDataHost(tk_keyid);

                        // Audit
                        action = "success";
                        change_type = "modify week days monitorin";
                        object = tk_data_host;
                        object_category = "data_host";
                        object_attrs = "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays_no;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "modify week days monitorin";
                        object = tk_data_host;
                        object_category = "data_host";
                        object_attrs = "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays_no;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        // cancel: returns to unified modal
        $("#btn_modal_modify_monitoring_wdays_host_no_cancel").click(function() {

            // Show input modal
            $("#modal_modify_data_host_unified").modal();

        });

        //
        // data source id
        //


        //
        // Modify lag
        //

        $("#btn_modal_modify_lag_host").click(function() {

            // Show input modal
            $("#modal_modify_lag_host").modal();

        });

        $("#btn_modal_modify_lag_confirm_host").click(function() {

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/data_hosts/dh_update_lag_policy";

            // max lag allowed
            var tk_data_max_lag_allowed = tokens.get("tk_input_lag_host");

            // alert over kpis
            var tk_data_lag_alert_kpis = tokens.get("tk_input_data_lag_alert_kpis_host");

            // alerting policy
            var tk_data_host_alerting_policy = tokens.get("tk_input_host_alerting_policy");

            // lagging class override
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class_host");

            if (!tk_data_max_lag_allowed || !tk_data_max_lag_allowed.length || !isNumeric(tk_data_max_lag_allowed)) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "data_host": tk_data_host,
                    "data_host_alerting_policy": tk_data_host_alerting_policy,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_lag_alert_kpis": tk_data_lag_alert_kpis,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "update_comment": "N/A"
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    dataType: "text",
                    beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        // Run the search again to update the table
                        searchDataHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // call update data source
                        updateDataHost(tk_keyid);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "server response: " + xhr.responseText + "\n - http response: " + error;

                        // Audit
                        action = "failure";
                        change_type = "modify monitoring lag policy";
                        object = tk_data_host;
                        object_category = "data_host";
                        object_attrs = "{\"data_max_lag_allowed\": \"" + tk_data_max_lag_allowed + "\", \"data_override_lagging_class\": \"" + tk_data_override_lagging_class + "\", \"data_lag_alert_kpis\": " + tk_data_lag_alert_kpis + "\"}";
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        // Show main modal
        $("#btn_modal_modify_lag_auto_main_host").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Free the searches
            setToken("show_data_host_autolagging", "true");

            // Show modal
            $("#modal_modify_data_host_autolag").modal();
        });

        // Show main modal back
        $("#btn_close_data_host_unified_autolag").click(function() {
            $("#modal_modify_data_host_unified").modal();
        });

        $("#btn_modal_modify_lag_auto_perc95_host").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");


            // Define the query
            var searchQuery = "| `trackme_tstats` count latest(_indextime) as indextime where index=* host=\"" + tk_data_host + "\"  by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats perc95(delta) as value | eval data_host=\"" + tk_data_host + "\", data_override_lagging_class=\"" + tk_data_override_lagging_class + "\" | lookup trackme_host_monitoring data_host OUTPUT _key as keyid | lookup trackme_host_monitoring data_host | eval data_max_lag_allowed=if(value>0, round(value, 0), data_max_lag_allowed), value=round(value, 0) | outputlookup trackme_host_monitoring key_field=keyid";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-7d",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    // hide the current modal
                    $("#modal_modify_data_host_autolag").modal('hide');

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Please wait while determining the entity lagging value...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12, length: 18,
                                position: "relative", color: "#003b59"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                $("#loadingGray").remove()

                                // if the action is very fast, the modal may fail, show up after 1 sec
                                setTimeout(function(){
                                  $("#modal_modify_data_host_unified").modal()
                                }, 1000);

                                // Get the results and display them
                                job.results({}, function(err, results) {
                                    var fields = results.fields;
                                    var rows = results.rows;
                                    for (var i = 0; i < rows.length; i++) {
                                        var values = rows[i];
                                        for (var j = 0; j < values.length; j++) {
                                            var field = fields[j];
                                            var value = values[j];

                                            if (field == "value") {

                                                if (value === '0') {
                                                    notification('ERROR: No live data available for this entity, automatic lagging calculation cannot be performed for inactive entities.', 6000)
                                                } else {
                                                    // Run the search again to update the table
                                                    searchDataHostsMain.startSearch();

                                                    // notify
                                                    notification('Modification has been registered successfully, max lagging value automatically defined to ' + value + ' seconds.', 6000)

                                                    setToken("tk_data_max_lag_allowed", value);
                                                    setToken("form.tk_input_lag_host", value);
                                                    tk_data_max_lag_allowed = value;

                                                    // Audit success change
                                                    action = "success";
                                                    change_type = "apply auto defined monitoring lag";
                                                    object = tk_data_host;
                                                    object_category = "data_host";
                                                    object_attrs = "{\"data_max_lag_allowed\": \"" + value + "\", \"data_override_lagging_class\": \"" + tk_data_override_lagging_class + "\"}";
                                                    result = "N/A";
                                                    comment = "N/A";
                                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                                }
                                            }

                                        }
                                    }
                                })

                                // call update data source
                                updateDataHost(tk_keyid);

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = errorStr;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = err;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }
                        });
                    }
                }
            );

        });

        $("#btn_modal_modify_lag_auto_average_host").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");


            // Define the query
            var searchQuery = "| `trackme_tstats` count latest(_indextime) as indextime where index=* host=\"" + tk_data_host + "\"  by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats avg(delta) as value | eval data_host=\"" + tk_data_host + "\", data_override_lagging_class=\"" + tk_data_override_lagging_class + "\" | lookup trackme_host_monitoring data_host OUTPUT _key as keyid | lookup trackme_host_monitoring data_host | eval data_max_lag_allowed=if(value>0, round(value, 0), data_max_lag_allowed), value=round(value, 0) | outputlookup trackme_host_monitoring key_field=keyid";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-7d",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    // hide the current modal
                    $("#modal_modify_data_host_autolag").modal('hide');

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Please wait while determining the entity lagging value...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12, length: 18,
                                position: "relative", color: "#003b59"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                $("#loadingGray").remove()

                                // if the action is very fast, the modal may fail, show up after 1 sec
                                setTimeout(function(){
                                  $("#modal_modify_data_host_unified").modal()
                                }, 1000);

                                // Get the results and display them
                                job.results({}, function(err, results) {
                                    var fields = results.fields;
                                    var rows = results.rows;
                                    for (var i = 0; i < rows.length; i++) {
                                        var values = rows[i];
                                        for (var j = 0; j < values.length; j++) {
                                            var field = fields[j];
                                            var value = values[j];

                                            if (field == "value") {

                                                if (value === '0') {
                                                    notification('ERROR: No live data available for this entity, automatic lagging calculation cannot be performed for inactive entities.', 6000)
                                                } else {
                                                    // Run the search again to update the table
                                                    searchDataHostsMain.startSearch();

                                                    // notify
                                                    notification('Modification has been registered successfully, max lagging value automatically defined to ' + value + ' seconds.', 6000)

                                                    setToken("tk_data_max_lag_allowed", value);
                                                    setToken("form.tk_input_lag_host", value);

                                                    // Audit success change
                                                    action = "success";
                                                    change_type = "apply auto defined monitoring lag";
                                                    object = tk_data_host;
                                                    object_category = "data_host";
                                                    object_attrs = "{\"data_max_lag_allowed\": \"" + value + "\", \"data_override_lagging_class\": \"" + tk_data_override_lagging_class + "\"}";
                                                    result = "N/A";
                                                    comment = "N/A";
                                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                                }
                                            }

                                        }
                                    }
                                })

                                // call update data source
                                updateDataHost(tk_keyid);

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = errorStr;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = err;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }
                        });
                    }
                }
            );

        });

        $("#btn_modal_modify_lag_auto_perc95_30d_host").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");


            // Define the query
            var searchQuery = "| `trackme_tstats` count latest(_indextime) as indextime where index=* host=\"" + tk_data_host + "\"  by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats perc95(delta) as value | eval data_host=\"" + tk_data_host + "\", data_override_lagging_class=\"" + tk_data_override_lagging_class + "\" | lookup trackme_host_monitoring data_host OUTPUT _key as keyid | lookup trackme_host_monitoring data_host | eval data_max_lag_allowed=if(value>0, round(value, 0), data_max_lag_allowed), value=round(value, 0) | outputlookup trackme_host_monitoring key_field=keyid";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-30d",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    // hide the current modal
                    $("#modal_modify_data_host_autolag").modal('hide');

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Please wait while determining the entity lagging value...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12, length: 18,
                                position: "relative", color: "#003b59"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                $("#loadingGray").remove()

                                // if the action is very fast, the modal may fail, show up after 1 sec
                                setTimeout(function(){
                                  $("#modal_modify_data_host_unified").modal()
                                }, 1000);

                                // Get the results and display them
                                job.results({}, function(err, results) {
                                    var fields = results.fields;
                                    var rows = results.rows;
                                    for (var i = 0; i < rows.length; i++) {
                                        var values = rows[i];
                                        for (var j = 0; j < values.length; j++) {
                                            var field = fields[j];
                                            var value = values[j];

                                            if (field == "value") {

                                                if (value === '0') {
                                                    notification('ERROR: No live data available for this entity, automatic lagging calculation cannot be performed for inactive entities.', 6000)
                                                } else {
                                                    // Run the search again to update the table
                                                    searchDataHostsMain.startSearch();

                                                    // notify
                                                    notification('Modification has been registered successfully, max lagging value automatically defined to ' + value + ' seconds.', 6000)

                                                    setToken("tk_data_max_lag_allowed", value);
                                                    setToken("form.tk_input_lag_host", value);

                                                    // Audit success change
                                                    action = "success";
                                                    change_type = "apply auto defined monitoring lag";
                                                    object = tk_data_host;
                                                    object_category = "data_host";
                                                    object_attrs = "{\"data_max_lag_allowed\": \"" + value + "\", \"data_override_lagging_class\": \"" + tk_data_override_lagging_class + "\"}";
                                                    result = "N/A";
                                                    comment = "N/A";
                                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                                }
                                            }

                                        }
                                    }
                                })

                                // call update data source
                                updateDataHost(tk_keyid);

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = errorStr;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = err;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }
                        });
                    }
                }
            );

        });

        $("#btn_modal_modify_lag_auto_average_30d_host").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");


            // Define the query
            var searchQuery = "| `trackme_tstats` count latest(_indextime) as indextime where index=* host=\"" + tk_data_host + "\"  by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats avg(delta) as value | eval data_host=\"" + tk_data_host + "\", data_override_lagging_class=\"" + tk_data_override_lagging_class + "\" | lookup trackme_host_monitoring data_host OUTPUT _key as keyid | lookup trackme_host_monitoring data_host | eval data_max_lag_allowed=if(value>0, round(value, 0), data_max_lag_allowed), value=round(value, 0) | outputlookup trackme_host_monitoring key_field=keyid";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-30d",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    // hide the current modal
                    $("#modal_modify_data_host_autolag").modal('hide');

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Please wait while determining the entity lagging value...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12, length: 18,
                                position: "relative", color: "#003b59"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                $("#loadingGray").remove()

                                // if the action is very fast, the modal may fail, show up after 1 sec
                                setTimeout(function(){
                                  $("#modal_modify_data_host_unified").modal()
                                }, 1000);

                                // Get the results and display them
                                job.results({}, function(err, results) {
                                    var fields = results.fields;
                                    var rows = results.rows;
                                    for (var i = 0; i < rows.length; i++) {
                                        var values = rows[i];
                                        for (var j = 0; j < values.length; j++) {
                                            var field = fields[j];
                                            var value = values[j];

                                            if (field == "value") {

                                                if (value === '0') {
                                                    notification('ERROR: No live data available for this entity, automatic lagging calculation cannot be performed for inactive entities.', 6000)
                                                } else {
                                                    // Run the search again to update the table
                                                    searchDataHostsMain.startSearch();

                                                    // notify
                                                    notification('Modification has been registered successfully, max lagging value automatically defined to ' + value + ' seconds.', 6000)

                                                    setToken("tk_data_max_lag_allowed", value);
                                                    setToken("form.tk_input_lag_host", value);

                                                    // Audit success change
                                                    action = "success";
                                                    change_type = "apply auto defined monitoring lag";
                                                    object = tk_data_host;
                                                    object_category = "data_host";
                                                    object_attrs = "{\"data_max_lag_allowed\": \"" + value + "\", \"data_override_lagging_class\": \"" + tk_data_override_lagging_class + "\"}";
                                                    result = "N/A";
                                                    comment = "N/A";
                                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                                }
                                            }

                                        }
                                    }
                                })

                                // call update data source
                                updateDataHost(tk_keyid);

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = errorStr;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = err;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }
                        });
                    }
                }
            );

        });

        // Smart Status

        // Smart Status data source
        $("#btn_smart_status_data_source").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Free the search
            setToken("show_smart_status_data_source", "true");

            // get token
            var tk_data_name = tokens.get("tk_data_name");

            // Define the search button target
            var search_data_source_smart_status = 'search' + "?q=search" + encodeURI(' `trackme_idx` source=\"ds_smart_status\"' + ' raw.data_name=\"' + tk_data_name + '\" | rename raw.* as \"*\" | table _time smart_result') + '&earliest=-7d&latest=now'
            document.getElementById("btn_smart_status_data_source_history").href = search_data_source_smart_status;

            // Force search run every time the button is clicked
            searchSmartStatusDataSource.startSearch();

            // Show input modal
            $("#smart_status_data_source").modal();

        });

        // back
        $("#btn_smart_status_data_source_back").click(function() {

            // Show modal
            $("#modal_manage").modal();

        });

        // Smart Status data host
        $("#btn_smart_status_data_host").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Free the search
            setToken("show_smart_status_data_host", "true");

            // get token
            var tk_data_host = tokens.get("tk_data_host");

            // Force search run every time the button is clicked
            searchSmartStatusDataHost.startSearch();

            // Define the search button target
            var search_data_host_smart_status = 'search' + "?q=search" + encodeURI(' `trackme_idx` source=\"dh_smart_status\"' + ' raw.data_host=\"' + tk_data_host + '\" | rename raw.* as \"*\" | table _time smart_result') + '&earliest=-7d&latest=now'
            document.getElementById("btn_smart_status_data_host_history").href = search_data_host_smart_status;

            // Show input modal
            $("#smart_status_data_host").modal();

        });

        // back
        $("#btn_smart_status_data_host_back").click(function() {

            // Show modal
            $("#modal_manage_host").modal();

        });

        // Smart Status metric host
        $("#btn_smart_status_metric_host").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Free the search
            setToken("show_smart_status_metric_host", "true");

            // get token
            var tk_metric_host = tokens.get("tk_metric_host");

            // Force search run every time the button is clicked
            searchSmartStatusMetricHost.startSearch();

            // Define the search button target
            var search_metric_host_smart_status = 'search' + "?q=search" + encodeURI(' `trackme_idx` source=\"mh_smart_status\"' + ' raw.metric_host=\"' + tk_metric_host + '\" | rename raw.* as \"*\" | table _time smart_result') + '&earliest=-7d&latest=now'
            document.getElementById("btn_smart_status_metric_host_history").href = search_metric_host_smart_status;

            // Show input modal
            $("#smart_status_metric_host").modal();

        });

        // back
        $("#btn_smart_status_metric_host_back").click(function() {

            // Show modal
            $("#modal_manage_metric_host").modal();

        });

        // tags

        // tags policies main
        $('.btn_modify_tags_policies').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // Disable the add button for now
                document.getElementById('btn_modal_tags_policies_add').disabled = true; 
                // Free the search
                setToken("show_tags_policies", "true");

                // Show input modal
                $("#manage_tags_policies").modal();
            });

        });

        $("#btn_modal_tags_policies_simulate").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Retrieve the policy id
            var tk_tags_policies_policy_id = tokens.get("tk_tags_policies_policy_id");

            // Retrieve the regex rule
            var tk_tags_policies_regex = document.getElementById("modal_input_tags_policies_regex").value;

            // Retrieve the tags list
            var tk_tags_policies_tags = document.getElementById("modal_input_tags_policies_values").value;

            // if is not defined, give it a value and override text box content
            if (!tk_tags_policies_policy_id || !tk_tags_policies_policy_id.length || tk_tags_policies_regex == "Enter a valid regular expression to match data source names." || !tk_tags_policies_regex || !tk_tags_policies_regex.length || tk_tags_policies_tags == "Enter a list of tags to applied separeted by commas to specify multiple tags and click on \"Run policy simulation\"." || !tk_tags_policies_tags || !tk_tags_policies_tags.length) {

                // Show an error notification
                notification('ERROR: Entries are either incorrect or incomplete, please correct and try again.', 6000)

                // Disable the add button
                document.getElementById('btn_modal_tags_policies_add').disabled = true; 

            } else {

                notification('INFO: Starting tags policy simulation...', 6000)

                // Set the tokens
                setToken("tk_tags_policies_regex", tk_tags_policies_regex);
                setToken("tk_tags_policies_tags", tk_tags_policies_tags);

                // Unset the token and set to free the search
                unsetToken("start_simulation_tags_policies");
                setToken("start_simulation_tags_policies", "true");

                // Disable the add button
                document.getElementById('btn_modal_tags_policies_add').disabled = false;

            }

        });

        // add policy
        $("#btn_tags_policies_create").click(function() {
            // Show input modal
            $("#tags_policies_create_policy").modal();
        });

        // back button
        $("#btn_modal_tags_policies_add_back").click(function() {
            // Show input modal
            $("#manage_tags_policies").modal();
        });

        // add button
        $("#btn_modal_tags_policies_add").click(function() {
            // Show input modal
            $("#tags_policies_create_policy_confirm").modal();
        });

        // add policy
        $("#btn_modal_add_tags_policy_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Retrieve the policy id
            var tk_tags_policies_policy_id = tokens.get("tk_tags_policies_policy_id");

            // Retrieve the regex rule
            var tk_tags_policies_regex = document.getElementById("modal_input_tags_policies_regex").value;

            // Retrieve the tags list
            var tk_tags_policies_tags = document.getElementById("modal_input_tags_policies_values").value;

            // if is not defined, give it a value and override text box content - We should never reach this for the add function
            if (!tk_tags_policies_policy_id || !tk_tags_policies_policy_id.length || tk_tags_policies_regex == "Enter a valid regular expression to match data source names." || !tk_tags_policies_regex || !tk_tags_policies_regex.length || tk_tags_policies_tags == "Enter a list of tags to applied separeted by commas to specify multiple tags and click on \"Run policy simulation\"." || !tk_tags_policies_tags || !tk_tags_policies_tags.length) {

                // Show an error notification
                notification('ERROR: Entries are either incorrect or incomplete, please correct and try again.', 6000)

                // Disable the add button
                document.getElementById('btn_modal_tags_policies_add').disabled = true; 

            }
            else {

                // Retrieve update comment if any
                var tk_comment = document.getElementById("input_add_tags_policy_sampling_comment").value;

                // if is not defined, give it a value and override text box content
                if (tk_comment == "null") {
                    setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                    // replace the textarea for modification requests
                    document.getElementById("input_add_tags_policy_sampling_comment").value = "update note";
                }
                else if (tk_comment == "update note") {
                    tk_comment = "No comment for update.";
                    document.getElementById("input_add_tags_policy_sampling_comment").value = "update note";
                }
                else {
                    // replace the textarea for modification requests
                    document.getElementById("input_add_tags_policy_sampling_comment").value = "update note";
                }

                // Define the query
                var searchQuery = "| makeresults | eval tags_policy_id=\"" + tk_tags_policies_policy_id + "\", tags_policy_value=\"" + tk_tags_policies_tags + "\", tags_policy_regex=\"" + tk_tags_policies_regex + "\" | eval mtime=now() | outputlookup append=t trackme_tags_policies";

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add tags policy";
                            object = tk_tags_policies_policy_id;
                            object_category = "data_source";
                            object_attrs = "{\n" + "\t\"tags_policy_id\": \"" + tk_tags_policies_policy_id + "\",\n\t\"tags_policy_value\": \"" + tk_tags_policies_tags + "\",\n\t\"tags_policy_regex\": \"" + tk_tags_policies_regex + "\"\n}";
                            result = "N/A";
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {

                                    // Refresh the search
                                    setToken("show_tags_policies", "true");
                                    searchShowTagsPolicies.startSearch();

                                    // Return to modal
                                    $("#manage_tags_policies").modal();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add tags policy";
                                    object = tk_tags_policies_policy_id;
                                    object_category = "data_source";
                                    object_attrs = "{\n" + "\t\"tags_policy_id\": \"" + tk_tags_policies_policy_id + "\",\n\t\"tags_policy_value\": \"" + tk_tags_policies_tags + "\",\n\t\"tags_policy_regex\": \"" + tk_tags_policies_regex + "\"\n}";
                                    result = "N/A";
                                    comment = tk_comment;
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }

                );

            }
            
        });

        // delete tags policies
        $("#btn_modal_tags_policies_delete").click(function() {
            // Show input modal
            $("#tags_policies_delete_policy_confirm").modal();
        });

        function foreachRemoveTagsPolicies(item) {

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_tags_policies/" + item;


            if (item && item.length) {

                // Get the KV entry content first
                $.ajax({
                    url: myendpoint_URl,
                    type: "GET",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        var tags_policy_value = returneddata.tags_policy_value;
                        var tags_policy_regex = returneddata.tags_policy_regex;
                        var tags_policy_id = returneddata.tags_policy_id;
                        var mtime = returneddata.mtime;
                        var record = {
                        "tags_policy_value": tags_policy_value,
                        "tags_policy_regex": tags_policy_regex,
                        "tags_policy_id": tags_policy_id,
                        "mtime": mtime,
                        "_key": item
                        };

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("input_delete_tags_policy_sampling_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                        }

                        // Proceed to delete call
                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {


                                // Audit
                                action = "success";
                                change_type = "delete tags policies";
                                object = tags_policy_id;
                                object_category = "data_source";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);

                                // Return to modal
                                $("#manage_tags_policies").modal();

                                // Refresh the search
                                searchShowTagsPolicies.startSearch();

                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete tags policies";
                                object = tags_policy_id;
                                object_category = "data_source";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                        });

                    }

                });

            }

        }

        // delete tags policies confirm
        $("#btn_modal_delete_tags_policy_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeTagsPolicy");
            tk_multi_table_array = tk_multi_table_array.split(',');

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachRemoveTagsPolicies);

            // Hide main modal
            $("#tags_policies_delete_policy_confirm").modal('hide');

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeTagsPolicy");

        });

        // tags

        // back button
        $("#btn_back_manage_tags").click(function() {
            // Show input modal
            $("#modal_manage").modal();
        });

        // back button
        $("#btn_back_manage_tags").click(function() {
            // Show input modal
            $("#modal_manage").modal();
        });

        // back button
        $("#btn_back_update_tags").click(function() {
            // Show input modal
            $("#manage_tags").modal();
        });

        // update button
        $("#btn_modify_manage_tags").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Refresh the multiselect
            unsetToken("form.modal_input_tags_update");
            unsetToken("modal_input_tags_update");

            // Refresh the main search
            searchShowTags.startSearch();

            // Show input modal
            $("#update_tags").modal();

        });

        // add button
        $("#btn_modal_tags_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Retrieve input values
            var tk_tags_new = tokens.get("modal_input_tags_new");
            var tk_tags = tokens.get("tk_tags");
            var tk_tags_csv;

            // Combine current and new tag if relevant
            if (tk_tags !== "No tags defined, click on Update tags to define one or more tags to be associated with this data source.") {                    
                // form a csv tags list
                tk_tags_csv = tk_tags.replace(/ \/ /g, ",");
                tk_tags_new = tk_tags_csv + "," + tk_tags_new;
            }           

            // Get tk mains
            var tk_data_name = tokens.get("tk_data_name");
            var tk_keyid = tokens.get("tk_keyid");
            
            // Define the query
            var searchQuery = "| inputlookup trackme_data_source_monitoring where _key=\"" + tk_keyid + "\" | eval keyid=_key, tags=\"" + tk_tags_new + "\" | outputlookup trackme_data_source_monitoring append=t key_field=keyid";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            // Run a blocking search and get back a job
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    function audit_failure() {

                        // Audit
                        action = "failure";
                        change_type = "add tags";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = tk_tags_new;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                    }

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        audit_failure();
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                // show notify
                                notification('New tag successfully added.', 6000)

                                // Update the tags token
                                tk_tags_audit = tk_tags_new
                                tk_tags_new = tk_tags_new.replace(/,/g, " / ");
                                setToken("tk_tags", tk_tags_new);

                                // Refresh the multiselect
                                unsetToken("form.modal_input_tags_update");
                                unsetToken("modal_input_tags_update");

                                // Refresh the main search
                                searchShowTags.startSearch();
                                searchDataSourcesMain.startSearch();

                                var deps = [
                                    "splunkjs/ready!"
                                ];
                                require(deps, function(mvc) {

                                    var idSelectTags = mvc.Components.get('modal_input_tags_update');
                                    allValues = [];
                                    uniqueNames = [];

                                    var idSearchSelectTags = mvc.Components.get("searchShowTags");
                                    var idSearchSelectTags_results = idSearchSelectTags.data("preview");
                                    idSearchSelectTags_results.on("data", function() {
                                        $.each(idSearchSelectTags_results.data().rows, function( index, value ) {
                                            allValues.push(value[0]);
                                        });
                                        $.each(allValues, function(i, el){
                                        if($.inArray(el, uniqueNames) === -1) uniqueNames.push(el);
                                        });
                                    idSelectTags.settings.set("default",uniqueNames);
                                    });
                                });

                                // Make sure the link exposes Show tags
                                setToken("tk_tags_link_main", "Show tags");

                                // Audit
                                action = "success";
                                change_type = "add tags";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = tk_tags_audit;
                                result = "N/A";
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                audit_failure();
                                $("#modal_update_collection_failure_flush").modal()
                            }
                        });

                    }

                }
            );

        });

        // modify button
        $("#btn_modal_tags_save").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Retrieve input values

            var tk_tags_list = tokens.get("modal_input_tags_update");

            var tk_data_name = tokens.get("tk_data_name");
            var tk_keyid = tokens.get("tk_keyid");
            
            // Define the query
            var searchQuery = "| inputlookup trackme_data_source_monitoring where _key=\"" + tk_keyid + "\" | eval keyid=_key, tags=\"" + tk_tags_list + "\" | outputlookup trackme_data_source_monitoring append=t key_field=keyid";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            // Run a blocking search and get back a job
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    function audit_failure() {

                        // Audit
                        action = "failure";
                        change_type = "update tags";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = tk_tags_list;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                    }

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        audit_failure();
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                // show notify
                                notification('Tags list updated.', 6000)

                                // Audit
                                action = "success";
                                change_type = "update tags";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = tk_tags_list;
                                result = "N/A";
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // Update the tags token
                                tk_tags_list = tk_tags_list.replace(/,/g, " / ");
                                setToken("tk_tags", tk_tags_list);

                                // Refresh the main search
                                searchShowTags.startSearch();
                                searchDataSourcesMain.startSearch();

                                var deps = [
                                    "splunkjs/ready!"
                                ];
                                require(deps, function(mvc) {

                                    var idSelectTags = mvc.Components.get('modal_input_tags_update');
                                    allValues = [];
                                    uniqueNames = [];

                                    var idSearchSelectTags = mvc.Components.get("searchShowTags");
                                    var idSearchSelectTags_results = idSearchSelectTags.data("preview");
                                    idSearchSelectTags_results.on("data", function() {
                                        $.each(idSearchSelectTags_results.data().rows, function( index, value ) {
                                            allValues.push(value[0]);
                                        });
                                        $.each(allValues, function(i, el){
                                        if($.inArray(el, uniqueNames) === -1) uniqueNames.push(el);
                                        });
                                    idSelectTags.settings.set("default",uniqueNames);
                                    });
                                });

                                // Make sure the link exposes Show tags
                                setToken("tk_tags_link_main", "Show tags");

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                audit_failure();
                                $("#modal_update_collection_failure_flush").modal()
                            }
                        });

                    }

                }
            );

        });

        // clear button
        $("#btn_modal_tags_clear").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Retrieve input values

            var tk_tags_list = tokens.get("modal_input_tags_update");

            var tk_data_name = tokens.get("tk_data_name");
            var tk_keyid = tokens.get("tk_keyid");

            // Define the query
            var searchQuery = "| inputlookup trackme_data_source_monitoring where _key=\"" + tk_keyid + "\" | eval keyid=_key | fields - tags | outputlookup trackme_data_source_monitoring append=t key_field=keyid";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            // Run a blocking search and get back a job
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    function audit_failure() {

                        // Audit
                        action = "failure";
                        change_type = "clear tags";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = tk_tags_list;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                    }

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        audit_failure();
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                // show notify
                                notification('Tags list was cleared successfully.', 6000)

                                // Update the tags token
                                setToken("tk_tags", "No tags defined, click on Update tags to define one or more tags to be associated with this data source.");

                                // Refresh the multiselect
                                unsetToken("form.modal_input_tags_update");
                                unsetToken("modal_input_tags_update");
                                unsetToken("form.modal_input_tags_new");

                                // Refresh the main search
                                searchShowTags.startSearch();
                                searchDataSourcesMain.startSearch();

                                // Make sure the link exposes "Click here to define tags"
                                setToken("tk_tags_link_main", "Click here to define tags");

                                // Audit
                                action = "success";
                                change_type = "clear tags";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = tk_tags_list;
                                result = "N/A";
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                audit_failure();
                                $("#modal_update_collection_failure_flush").modal()
                            }
                        });

                    }

                }
            );

        });

        // data source identity documentation

        // back button
        $("#btn_back_manage_identity_card").click(function() {
            // Show input modal
            $("#modal_manage").modal();
        });

        $("#btn_close_define_identity_card").click(function() {
            // Show input modal
            $("#modal_manage").modal();
        });

        // update button
        $("#btn_modify_manage_identity_card").click(function() {
            // Show input modal
            $("#define_identity_card").modal();
        });

        // delete button
        $("#btn_delete_manage_identity_card").click(function() {
            // Show deletion modal
            $("#delete_identity_card").modal();
        });

        // identity card

        $('.btn_define_identity_card').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // Retrieve input values

                var input_doc_object = tokens.get("tk_data_name");
                var input_doc_note = document.getElementById("input_doc_note").value;

                // replace chars that would lead the operation to fail
                var input_doc_note = input_doc_note.replace(/\"/g, '\\"');
                var input_doc_link = document.getElementById("input_doc_link").value;

                // Define the query
                var searchQuery = "| trackme url=\"/services/trackme/v1/identity_cards/identity_cards_add_card\" mode=\"post\" body=\"{\\\"doc_link\\\": \\\"" + input_doc_link + "\\\", \\\"doc_note\\\": \\\"" + input_doc_note + "\\\", \\\"update_comment\\\": \\\"N/A\\\"}\" | spath | table key";

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                if (input_doc_link === "link to documentation" && input_doc_note === "documentation note") {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

                else if (input_doc_link && input_doc_link.length) {

                    // Create or update the card using the API endpoint
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            function audit_failure() {

                                // Audit
                                action = "failure";
                                change_type = "create or update identity card";
                                object = input_doc_object;
                                object_category = "data_source";
                                object_attrs = "object:" + input_doc_object + ", doc_link:" + input_doc_link + ", doc_note:" + input_doc_note;
                                result = "N/A";
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {

                                        // Get the results and display them
                                        job.results({}, function(err, results) {
                                            var fields = results.fields;
                                            var rows = results.rows;
                                            var cardkey;

                                            for (var i = 0; i < rows.length; i++) {
                                                var values = rows[i];
                                                for (var j = 0; j < values.length; j++) {
                                                    var field = fields[j];
                                                    var value = values[j];
                                                    var cardkey;
                                                    if (field == "key") {
                                                        var cardkey = value;
                                                    }
                                                }
                                            }

                                            // Associate the card using the API endpoint
                                            var searchQuery = "| trackme url=\"/services/trackme/v1/identity_cards/identity_cards_associate_card\" mode=\"post\" body=\"{\\\"key\\\": \\\"" + cardkey + "\\\", \\\"object\\\": \\\"" + input_doc_object + "\\\", \\\"update_comment\\\": \\\"N/A\\\"}\"";

                                            service.oneshotSearch(
                                                searchQuery,
                                                searchParams,
                                                function(err, results) {
                                                });

                                        })
                                        
                                        // Run the search again to update the table
                                        searchDataSourcesMain.startSearch();
                                        $("#update_achieved_identity_card").modal()

                                        // Audit
                                        action = "success";
                                        change_type = "create or update identity card";
                                        object = input_doc_object;
                                        object_category = "data_source";
                                        object_attrs = "object:" + input_doc_object + ", doc_link:" + input_doc_link + ", doc_note:" + input_doc_note;
                                        result = "N/A";
                                        comment = "N/A";
                                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        audit_failure();
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        audit_failure();
                                        $("#modal_update_collection_failure_flush").modal()
                                    }
                                });

                            }

                        }
                    );

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

            });

        });

        // back
        $("#btn_define_identity_card_back").click(function() {
            // Show modal
            $("#modal_manage").modal();
        });

        // delete button
        $("#btn_delete_identity_card_confirm").click(function() {

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // Retrieve input values

                var input_doc_object = tokens.get("tk_data_name");
                var input_doc_note = document.getElementById("input_doc_note").value;
                var input_doc_link = document.getElementById("input_doc_link").value;

                // Define the query
                var searchQuery = "| trackme url=\"/services/trackme/v1/identity_cards/identity_cards_unassociate\" mode=\"post\" body=\"{\\\"object\\\": \\\"" + input_doc_object + "\\\", \\\"update_comment\\\": \\\"N/A\\\"}\"";

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                if (input_doc_link && input_doc_link.length) {

                    // Run a blocking search and get back a job
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            function audit_failure() {

                                // Audit
                                action = "failure";
                                change_type = "delete identity card";
                                object = input_doc_object;
                                object_category = "data_source";
                                object_attrs = "object:" + input_doc_object + ", doc_link:" + input_doc_link + ", doc_note:" + input_doc_note;
                                result = "N/A";
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {
                                        // Run the search again to update the table
                                        searchDataSourcesMain.startSearch();
                                        // show deleted modal
                                        $("#delete_achieved_identity_card").modal()

                                        // Audit
                                        action = "success";
                                        change_type = "delete identity card";
                                        object = input_doc_object;
                                        object_category = "data_source";
                                        object_attrs = "object:" + input_doc_object + ", doc_link:" + input_doc_link + ", doc_note:" + input_doc_note;
                                        result = "N/A";
                                        comment = "N/A";
                                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        audit_failure();
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        audit_failure();
                                        $("#modal_update_collection_failure_flush").modal()
                                    }
                                });

                            }

                        }
                    );

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

        });

        // back button
        $("#btn_delete_identity_card_back").click(function() {
            // Show modal
            $("#define_identity_card").modal();
        });

        // associate identity card button

        $('.btn_associate_identity_card').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // if the token exists already, restart the search, otherwise allow the search to start
                var tk_start_associate_identity_card = tokens.get("tk_start_associate_identity_card");

                if (tk_start_associate_identity_card && tk_start_associate_identity_card.length) {
                    searchIdentityCardTable.startSearch();
                } else
                {
                    setToken("tk_start_associate_identity_card", "true");
                }

                // Show modal
                $("#associate_identity_card").modal();

            });

        });

        // confirm button
        $("#btn_associate_identity_card_confirm_valid").click(function() {

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // Retrieve input values

                var input_doc_keyid = tokens.get("tk_keyid");
                var input_doc_new_object = tokens.get("tk_data_name");
                var input_doc_origin_object = tokens.get("tk_object");
                var input_doc_link = tokens.get("tk_doc_link");
                var input_doc_note = tokens.get("tk_doc_note");
                var tk_doc_identity_card_is_global = tokens.get("doc_identity_card_is_global");

                // First unassociate using the API endpoint
                var searchQuery = "| trackme url=\"/services/trackme/v1/identity_cards/identity_cards_unassociate\" mode=\"post\" body=\"{\\\"object\\\": \\\"" + input_doc_new_object + "\\\", \\\"update_comment\\\": \\\"N/A\\\"}\"";

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                if (input_doc_keyid && input_doc_keyid.length) {

                    // Run a blocking search and get back a job
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            function audit_failure() {

                                // Audit
                                action = "failure";
                                change_type = "associate identity card";
                                object = input_doc_new_object;
                                object_category = "data_source";
                                object_attrs = "object:" + input_doc_new_object + " was associated with identity card keyid: " + input_doc_keyid + ", doc_link:" + input_doc_link + ", doc_note:" + input_doc_note;
                                result = "N/A";
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {

                                        // Associate using the endpoint
                                        var searchQuery = "| trackme url=\"/services/trackme/v1/identity_cards/identity_cards_associate_card\" mode=\"post\" body=\"{\\\"key\\\": \\\"" + input_doc_keyid + "\\\", \\\"object\\\": \\\"" + input_doc_new_object + "\\\", \\\"update_comment\\\": \\\"N/A\\\"}\"";

                                        service.oneshotSearch(
                                                searchQuery,
                                                searchParams,
                                                function(err, results) {
                                                });

                                        // Run the search again to update the table
                                        searchDataSourcesMain.startSearch();
                                        // show deleted modal
                                        $("#associate_achieved_identity_card").modal()

                                        // Audit
                                        action = "success";
                                        change_type = "associate identity card";
                                        object = input_doc_new_object;
                                        object_category = "data_source";
                                        object_attrs = "object:" + input_doc_new_object + " was associated with identity card keyid: " + input_doc_keyid + ", doc_link:" + input_doc_link + ", doc_note:" + input_doc_note;
                                        result = "N/A";
                                        comment = "N/A";
                                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        audit_failure();
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        audit_failure();
                                        $("#modal_update_collection_failure_flush").modal()
                                    }
                                });

                            }

                        }
                    );

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

        });

        // back button
        $("#btn_associate_identity_card_back").click(function() {
            // Show modal
            $("#define_identity_card").modal();
        });

        // back button
        $("#btn_associate_identity_card_confirm_back").click(function() {
            // Show modal
            $("#associate_identity_card").modal();
        });

        // Acknowledgment

        $('.btn_ack').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_name = tokens.get("tk_data_name");
                var tk_data_host = tokens.get("tk_data_host");
                var tk_metric_host = tokens.get("tk_metric_host");


                if (tk_data_name !== undefined) {
                    setToken("input_object", tk_data_name);
                    setToken("input_object_category", "data_source");
                } else if (tk_data_host !== undefined) {
                    setToken("input_object", tk_data_host);
                    setToken("input_object_category", "data_host");
                } else if (tk_metric_host !== undefined) {
                    setToken("input_object", tk_metric_host);
                    setToken("input_object_category", "metric_host");
                }

                var input_object = tokens.get("input_object");
                var input_object_category = tokens.get("input_object_category");


                // if the token exists already, restart the search, otherwise allow the search to start
                var tk_start_ack_get = tokens.get("tk_start_ack_get");

                if (tk_start_ack_get && tk_start_ack_get.length) {
                    searchAckGet.startSearch();
                } else
                {
                    setToken("tk_start_ack_get", "true");
                }

                // Show modal
                $("#confirm_ack").modal();

            });

        });

        // Add ack

        $('.btn_ack_confirm_valid').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // Retrieve input values
                var input_object = tokens.get("input_object");
                var input_object_category = tokens.get("input_object_category");
                var input_ack_duration = tokens.get("input_ack_duration");

                // Retrieve update comment if any
                var tk_comment = document.getElementById("input_ack_comment").value;

                // if is not defined, give it a value and override text box content
                if (tk_comment == "null") {
                    setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                    // replace the textarea for modification requests
                    document.getElementById("input_ack_comment").value = "update note";
                }
                else if (tk_comment == "update note") {
                    tk_comment = "No comment for update.";
                    document.getElementById("input_ack_comment").value = "update note";
                }
                else {
                    // replace the textarea for modification requests
                    document.getElementById("input_ack_comment").value = "update note";
                }

                if (input_object && input_object.length && input_ack_duration && input_ack_duration.length) {

                    // Create the endpoint URL
                    var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/ack/ack_enable";

                    // Create a dictionary to store the field names and values
                    var record = {
                        "object_category": input_object_category,
                        "object": input_object,
                        "ack_period": input_ack_duration,
                        "update_comment": tk_comment
                    };

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        dataType: "text",
                        beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                        data: JSON.stringify(record),
                        success: function(returneddata) {

                            // Refresh the main search
                            if (input_object_category == "data_source") {
                                searchDataSourcesMain.startSearch();
                            } else if (input_object_category == "data_host") {
                                searchDataHostsMain.startSearch();
                            } else if (input_object_category == "metric_host") {
                                searchMetricHostsMain.startSearch();
                            }

                            // show deleted modal
                            $("#ack_achieved").modal()

                        },
                        error: function(xhr, textStatus, error) {
                            message = "server response: " + xhr.responseText + "\n - http response: " + error;

                            // Audit
                            action = "failure";
                            change_type = "ack enable";
                            object = input_object;
                            object_category = input_object_category;
                            object_attrs = "object:" + input_object + " has been acknowledged for a period of " + input_ack_duration + " seconds, no more alerts will be generated until the acknowledge is expired.";
                            result = message;
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

            });

        });

        // Disable ack

        $('.btn_ack_disable_valid').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // Retrieve input values
                var keyid = tokens.get("keyid");
                var input_object = tokens.get("input_object");
                var input_object_category = tokens.get("input_object_category");
                var ack_expiration = tokens.get("ack_expiration");
                var ack_state = tokens.get("ack_state");

                // Retrieve update comment if any
                var tk_comment = document.getElementById("input_ack_comment").value;

                // if is not defined, give it a value and override text box content
                if (tk_comment == "null") {
                    setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                    // replace the textarea for modification requests
                    document.getElementById("input_ack_comment").value = "update note";
                }
                else if (tk_comment == "update note") {
                    tk_comment = "No comment for update.";
                    document.getElementById("input_ack_comment").value = "update note";
                }
                else {
                    // replace the textarea for modification requests
                    document.getElementById("input_ack_comment").value = "update note";
                }

                if (ack_state === "inactive") {
                    // show modal
                    $("#ack_disable_already").modal()
                }

                else if (input_object && input_object.length) {

                    // Create the endpoint URL
                    var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/ack/ack_disable";

                    // Create a dictionary to store the field names and values
                    var record = {
                        "object_category": input_object_category,
                        "object": input_object,
                        "update_comment": tk_comment
                    };

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        dataType: "text",
                        beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                        data: JSON.stringify(record),
                        success: function(returneddata) {

                            // Refresh the main search
                            if (input_object_category == "data_source") {
                                searchDataSourcesMain.startSearch();
                            } else if (input_object_category == "data_host") {
                                searchDataHostsMain.startSearch();
                            } else if (input_object_category == "metric_host") {
                                searchMetricHostsMain.startSearch();
                            }

                            // show deleted modal
                            $("#ack_achieved").modal()

                        },
                        error: function(xhr, textStatus, error) {
                            message = "server response: " + xhr.responseText + "\n - http response: " + error;

                            // Audit
                            action = "failure";
                            change_type = "ack disable";
                            object = input_object;
                            object_category = input_object_category;
                            object_attrs = "object:" + input_object + " acknowledge has been disabled (ack_expiration was: " + ack_expiration + "), alerts will be generated depending on state and rules. ";
                            result = message;
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });
                    
                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

            });

        });

        // Logical group

        // show modal
        $('.btn_logical_group').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // if the token exists already, restart the search, otherwise allow the search to start
                var tk_start_logical_member_get = tokens.get("tk_start_logical_member_get");

                if (tk_start_logical_member_get && tk_start_logical_member_get.length) {
                    searchLogicalGroupTable.startSearch();
                } else
                {
                    setToken("tk_start_logical_member_get", "true");
                }

                var tk_data_name = tokens.get("tk_data_name");
                var tk_data_host = tokens.get("tk_data_host");
                var tk_metric_host = tokens.get("tk_metric_host");


                if (tk_data_name !== undefined) {
                    setToken("input_object", tk_data_name);
                    setToken("input_object_category", "data_source");
                } else if (tk_data_host !== undefined) {
                    setToken("input_object", tk_data_host);
                    setToken("input_object_category", "data_host");
                } else if (tk_metric_host !== undefined) {
                    setToken("input_object", tk_metric_host);
                    setToken("input_object_category", "metric_host");
                }

                // show modal
                $("#logical_group").modal()

            });

        });

        // back
        $("#btn_associate_logical_group_back").click(function() {

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // retrieve token
                var input_object_category = tokens.get("input_object_category");

                // conditional modal target
                if (input_object_category === "data_source") {
                    $("#modal_modify_data_source_unified").modal()
                }
                else if (input_object_category === "data_host") {
                    $("#modal_modify_data_host_unified").modal()
                }
                else if (input_object_category === "metric_host") {
                    $("#modal_modify_metric_host_unified").modal()
                }

        });

        // back delete
        $("#confirm_remove_from_logical_group").click(function() {
                $("#logical_group").modal()
        });

        //
        $('.btn_logical_group_valid').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_name = tokens.get("tk_data_name");
                var tk_data_host = tokens.get("tk_data_host");
                var tk_metric_host = tokens.get("tk_metric_host");

                if (tk_data_name !== undefined) {
                    setToken("input_object", tk_data_name);
                    setToken("input_object_category", "data_source");
                } else if (tk_data_host !== undefined) {
                    setToken("input_object", tk_data_host);
                    setToken("input_object_category", "data_host");
                } else if (tk_metric_host !== undefined) {
                    setToken("input_object", tk_metric_host);
                    setToken("input_object_category", "metric_host");
                }


            });

        });

        // Remove from logical group
        $("#btn_remove_from_logical_group_confirm_valid").click(function() {

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var input_object = tokens.get("input_object");
                var input_object_category = tokens.get("input_object_category");
                var tk_keyid = tokens.get("tk_keyid");

                if (input_object && input_object.length) {

                    // Create the endpoint URL
                    var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/logical_groups/logical_groups_unassociate";

                    // Create a dictionary to store the field names and values
                    var record = {
                        "object": input_object,
                        "key": tk_keyid,
                        "update_comment": "N/A"
                    };

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        dataType: "text",
                        beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                        data: JSON.stringify(record),
                        success: function(returneddata) {

                            // show disabled modal
                            $("#logical_group_removal_achieved").modal()

                            if (input_object_category === "data_source") {
                                searchDataSourcesMain.startSearch();
                            }
                            else if (input_object_category === "data_host") {
                                searchDataHostsMain.startSearch();
                            }
                            else if (input_object_category === "metric_host") {
                                searchMetricHostsMain.startSearch();
                            }

                        },
                        error: function(xhr, textStatus, error) {
                            message = "server response: " + xhr.responseText + "\n - http response: " + error;

                            // Audit
                            action = "failure";
                            change_type = "Logical group removal";
                            object = input_object;
                            object_category = input_object_category;
                            object_attrs = "object:" + input_object + " has been removed from Logical group. ";
                            result = message;
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

        });

        // Add logical group member
        $("#btn_add_logical_group_member").click(function() {

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // if the token exists already, restart the search, otherwise allow the search to start
                var tk_start_logical_member_add = tokens.get("tk_start_logical_member_add");
                
                if (tk_start_logical_member_add && tk_start_logical_member_add.length) {
                    searchLogicalGroupTableAddMember.startSearch();
                } else
                {
                    setToken("tk_start_logical_member_add", "true");
                }

                $("#logical_group_add_member").modal()
        });

        // Add logical group member
        $("#btn_add_logical_group_member_confirm_valid").click(function() {

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var input_object = tokens.get("input_object");
                var input_object_category = tokens.get("input_object_category");

                // keyid is used to add to group
                var tk_keyid = tokens.get("tk_keyid");

                // from click
                var tk_object_group_name = tokens.get("tk_object_group_name");

                if (input_object && input_object.length) {

                    // Create the endpoint URL
                    var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/logical_groups/logical_groups_associate_group";

                    // Create a dictionary to store the field names and values
                    var record = {
                        "object": input_object,
                        "key": tk_keyid,
                        "update_comment": "N/A"
                    };

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        dataType: "text",
                        beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                        data: JSON.stringify(record),
                        success: function(returneddata) {

                            // show disabled modal
                            $("#logical_group_add_member_achieved").modal()

                            if (input_object_category === "data_source") {
                                searchDataSourcesMain.startSearch();
                            }
                            else if (input_object_category === "data_host") {
                                searchDataHostsMain.startSearch();
                            }
                            else if (input_object_category === "metric_host") {
                                searchMetricHostsMain.startSearch();
                            }

                        },
                        error: function(xhr, textStatus, error) {
                            message = "server response: " + xhr.responseText + "\n - http response: " + error;

                            // Audit
                            action = "failure";
                            change_type = "Logical group add membership";
                            object = input_object;
                            object_category = input_object_category;
                            object_attrs = "object:" + input_object + " has been added to the logical group " + tk_object_group_name + ".";
                            result = message;
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

        });

        // Add logical group member
        $("#btn_add_logical_group_new").click(function() {
                $("#logical_group_add_group").modal()
        });

        // back
        $("#btn_associate_logical_group_add_member_back").click(function() {
                $("#logical_group").modal()
        });

        // back
        $("#btn_associate_logical_group_add_group_back").click(function() {
                $("#logical_group").modal()
        });

        // back
        $("#btn_add_logical_group_member_confirm_back").click(function() {
                $("#logical_group").modal()
        });

        // Add logical group
        $("#btn_associate_logical_group_add_group").click(function() {

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var input_object = tokens.get("input_object");
                var input_object_category = tokens.get("input_object_category");

                // from input
                var tk_object_group_name = tokens.get("InputLogicalGroupName");
                var tk_object_group_green_percent = tokens.get("InputLogicalGroupNamePercent");

                if (tk_object_group_name && tk_object_group_name.length) {

                    // Create the endpoint URL
                    var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/logical_groups/logical_groups_add_grp";

                    // Create a dictionary to store the field names and values
                    var record = {
                        "object_group_name": tk_object_group_name,
                        "object_group_members": input_object,
                        "object_group_min_green_percent": tk_object_group_green_percent,
                        "update_comment": "N/A"
                    };

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        dataType: "text",
                        beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                        data: JSON.stringify(record),
                        success: function(returneddata) {

                            // show disabled modal
                            $("#logical_group_add_achieved").modal()

                            if (input_object_category === "data_source") {
                                searchDataSourcesMain.startSearch();
                            }
                            else if (input_object_category === "data_host") {
                                searchDataHostsMain.startSearch();
                            }
                            else if (input_object_category === "metric_host") {
                                searchMetricHostsMain.startSearch();
                            }

                        },
                        error: function(xhr, textStatus, error) {
                            message = "server response: " + xhr.responseText + "\n - http response: " + error;

                            // Audit
                            action = "failure";
                            change_type = "Logical group add";
                            object = tk_object_group_name;
                            object_category = input_object_category;
                            object_attrs = "new logical group " + tk_object_group_name + " has been created for object:" + input_object + " with a minimal logical group green percentage of " + tk_object_group_green_percent + ".";
                            result = message;
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

        });

        // object tags

        // return to unified modify when clicking on back
        $("#btn_back_data_host_tags").click(function() {
                $("#modal_manage_host").modal()
        });

        // return to unified modify when clicking on back
        $("#btn_back_metric_host_tags").click(function() {
                $("#modal_manage_metric_host").modal()
        });

        // Outliers simulation

        // data source run simulation
        $("#btn_outlier_config_data_source_simulate").click(function() {

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // get the object name
                var tk_data_name = tokens.get("tk_data_name");

                // set the token the search depends on
                setToken("start_outliers_simulation_data_source", "true");

                // explicitly start the search
                searchOutlierDetectionChartSimulation.startSearch();

                // notify
                notification('Outliers simulation started for data source ' + tk_data_name + '.', 6000)

        });

        $("#btn_outlier_config_data_source_save").unbind('click').click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");            
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");

            // get inputs tokens

            var tk_input_data_source_enable_outlier = tokens.get("tk_input_data_source_enable_outlier");
            var tk_input_data_source_outlier_min_eventcount_mode = tokens.get("tk_input_data_source_outlier_min_eventcount_mode");
            var tk_input_data_source_outlier_alert_on_upper = tokens.get("tk_input_data_source_outlier_alert_on_upper");
            var tk_input_data_source_outlier_min_eventcount = tokens.get("tk_input_data_source_outlier_min_eventcount");
            var tk_input_data_source_outlier_lower_threshold_multiplier = tokens.get("tk_input_data_source_outlier_lower_threshold_multiplier");
            var tk_input_data_source_outlier_upper_threshold_multiplier = tokens.get("tk_input_data_source_outlier_upper_threshold_multiplier");
            var tk_input_data_source_outlier_span = tokens.get("tk_input_data_source_outlier_span");

            // OutlierTimePeriod equals to the earliest LinkInput
            var tk_input_data_source_outlier_period = tokens.get("tk_input_data_source_outlier_period");

            // Conditionally define record values for Outliers
            if (tk_enable_behaviour_analytic != tk_input_data_source_enable_outlier) {
                tk_enable_behaviour_analytic = tk_input_data_source_enable_outlier;
            }

            if (tk_outlieralertonupper != tk_input_data_source_outlier_alert_on_upper) {
                tk_outlieralertonupper = tk_input_data_source_outlier_alert_on_upper;
            }

            tk_source_outlier_period = tk_outlier_period;
            if (tk_outlier_period != tk_input_data_source_outlier_period) {
                tk_outlier_period = tk_input_data_source_outlier_period;
            }

            if (tk_outlier_span != tk_input_data_source_outlier_span) {
                tk_outlier_span = tk_input_data_source_outlier_span;
                // refresh the token for current view usage
                setToken("tk_outlier_span", tk_input_data_source_outlier_span);
            }

            if (tk_outlierlowerthresholdmultiplier != tk_input_data_source_outlier_lower_threshold_multiplier && isNumeric(tk_input_data_source_outlier_lower_threshold_multiplier)) {
                tk_outlierlowerthresholdmultiplier = tk_input_data_source_outlier_lower_threshold_multiplier;
            }

            if (tk_outlierupperthresholdmultiplier != tk_input_data_source_outlier_upper_threshold_multiplier && isNumeric(tk_input_data_source_outlier_upper_threshold_multiplier)) {
                tk_outlierupperthresholdmultiplier = tk_input_data_source_outlier_upper_threshold_multiplier;
            }

            if (tk_input_data_source_outlier_min_eventcount_mode === "static" && isNumeric(tk_input_data_source_outlier_min_eventcount) && tk_input_data_source_outlier_min_eventcount > 0) {
                tk_outliermineventcount = tk_input_data_source_outlier_min_eventcount;
            } else {
                tk_outliermineventcount = "0";
                tk_input_data_source_outlier_min_eventcount_mode = "dynamic";
            }

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/data_sources/ds_update_outliers";

            // Create a dictionary to store the field names and values
            var record = {
                "data_name": tk_data_name,
                "OutlierMinEventCount": tk_outliermineventcount,
                "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                "OutlierAlertOnUpper": tk_outlieralertonupper,
                "OutlierTimePeriod": tk_outlier_period,
                "OutlierSpan": tk_outlier_span,
                "enable_behaviour_analytic": tk_enable_behaviour_analytic,
                "update_comment": "N/A"
            };

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    dataType: "text",
                    beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                    data: JSON.stringify(record),
                    success: function(returneddata) {

                        // notify
                        var tk_data_name = tokens.get("tk_data_name");
                        var tk_data_index = tokens.get("tk_data_index");
                        var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
                        notification('Outliers configuration updated, please wait a few seconds while statistics are generated, click on refresh in the Outliers tab if statistics are not yet available.', 6000)

                        // Generate metrics if outlier period was changed
                        if (tk_source_outlier_period != tk_input_data_source_outlier_span) {
                            metricOutliersGen("data_source", tk_data_name, tk_input_data_source_outlier_period);
                        }

                        // call update summary investigator for that entity only
                        updateDataSourceEntity(tk_data_name, tk_data_index, tk_data_sourcetype);

                        searchSingleLag.startSearch();
                        searchSingleByMetricsLag.startSearch();
                        searchChartLag.startSearch();
                        searchSingleSLApct.startSearch();
                        searchOutlierDetectionChart.startSearch();
                        searchOutlierDetectionTable.startSearch();

                        // call update data source
                        var tk_keyid = tokens.get("tk_keyid");
                        updateDataSource(tk_keyid);

                        // Run the search again to update the table
                        searchDataSourcesMain.startSearch();

                    },
                    error: function(xhr, textStatus, error) {
                        message = "server response: " + xhr.responseText + "\n - http response: " + error;

                        // Audit
                        action = "failure";
                        change_type = "modify outliers";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = JSON.stringify(record, null, '\t');
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }

        });

        // Data sampling
        $('.btn_data_sampling_manage').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // Built the search URI
                var tk_data_name = tokens.get("tk_data_name");
                var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
                var search_latest_sample = 'search' + "?q=" + encodeURI("| inputlookup trackme_data_sampling where data_name=\"" + tk_data_name + "\" | fields raw_sample | mvexpand raw_sample | eval data_sourcetype=\"" + tk_data_sourcetype + "\" | `trackme_data_sampling_abstract_detect_events_format` | lookup trackme_data_sampling_custom_models model_name as current_detected_format output model_type | eval model_type=if(isnull(model_type) AND isnotnull(current_detected_format), \"inclusive\", model_type)");

                // Verify the current data sampling obfuscation mode, if enabled we change the search target

                // Define the query
                var searchQuery = "| rest /servicesNS/nobody/trackme/admin/macros/trackme_data_sampling_obfuscation_mode splunk_server=local | fields definition | rex field=definition mode=sed \"s/\`//g\" | rename definition as current_mode";

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-5m",
                    latest_time: "now"
                };

                // Run a oneshot search that returns the job's results
                service.oneshotSearch(
                    searchQuery,
                    searchParams,
                    function(err, results) {

                        // Display the results
                        var fields = results.fields;
                        var rows = results.rows;
                        var current_mode;

                        for (var i = 0; i < rows.length; i++) {
                            var values = rows[i];

                            for (var j = 0; j < values.length; j++) {
                                var field = fields[j];

                                if (fields[j] == "current_mode") {
                                    current_mode = values[j];
                                }
                            }
                        }


                        if (!current_mode) {
                            // Define the URL target
                            document.getElementById("btn_data_sampling_latest_sample").href = search_latest_sample;
                            return;
                        }

                        // Dynamically manage buttons states
                        if (current_mode == "trackme_data_sampling_obfuscation_mode_enabled") {
                            search_latest_sample = 'search' + "?q=" + encodeURI("| inputlookup trackme_data_sampling where data_name=\"" + tk_data_name + "\" | fields raw_sample");
                            // Define the URL target
                            document.getElementById("btn_data_sampling_latest_sample").href = search_latest_sample;
                        } else if (current_mode == "trackme_data_sampling_obfuscation_mode_disabled") {
                            // Define the URL target
                            document.getElementById("btn_data_sampling_latest_sample").href = search_latest_sample;
                        } else {
                            // Define the URL target
                            document.getElementById("btn_data_sampling_latest_sample").href = search_latest_sample;
                        }

                    });

                // Run engine should not be granted when an anomaly was found at first discovery
                var data_sample_anomaly_reason = tokens.get("tk_data_sample_anomaly_reason");
                if (data_sample_anomaly_reason == "multiformat_at_discovery") {
                    document.getElementById('btn_run_data_sampling').disabled = true;
                } else {
                    document.getElementById('btn_run_data_sampling').disabled = false;
                }

                $("#modal_manage").modal('hide')
                $("#data_sampling_manage").modal()
            });
        });

        // Back button
        $('.btn_data_sampling_back').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);
                $("#modal_manage").modal()
            });
        });

        // Show builtin rules
        $('.btn_data_sampling_builtin_rules').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);
                $("#data_sampling_show_builtin_rules").modal()
            });
        });

        // Back button
        $('.btn_data_sampling_builtin_rules_back').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);
                $("#data_sampling_manage").modal()
            });
        });

        // Show custom rules from data source
        $("#btn_data_sampling_custom_rules_view").unbind('click').click(function() {

            // Hide the back button
            var btn_back = document.getElementById("btn_data_sampling_custom_rules_back");
            btn_back.style.display = "inline-block"

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // free searches
            setToken("show_data_sampling_custom_rules", "true");

            // force re-run the search each time the button is clicked
            searchDataSamplingShowCustomRules.startSearch();

            $("#data_sampling_show_custom_rules").modal()

        });

        // Show custom rules from main
        $("#btn_modify_data_sampling_rules").unbind('click').click(function() {

            // Hide the back button
            var btn_back = document.getElementById("btn_data_sampling_custom_rules_back");
            btn_back.style.display = "none"

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // free searches
            setToken("show_data_sampling_custom_rules", "true");

            // define a token that will be used to determine where in the UI we came from
            setToken("show_data_sampling_custom_rules_from_home", "true");

            // force re-run the search each time the button is clicked
            searchDataSamplingShowCustomRules.startSearch();

            $("#data_sampling_show_custom_rules").modal()

        });

        // Back button
        $('.btn_data_sampling_custom_rules_back').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                // target
                $("#data_sampling_manage").modal()
                
            });
        });

        // Remove custom rule
        $("#btn_modal_data_sampling_custom_rule_delete").click(function() {
                $("#data_sampling_show_custom_rules").modal('hide');
                $("#modal_remove_custom_rule_data_sampling").modal();
        });

        function foreachRemoveDataSamplingCustomRule(item) {

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_sampling_custom_models/" + item;


            if (item && item.length) {

                // Get the KV entry content first
                $.ajax({
                    url: myendpoint_URl,
                    type: "GET",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        var model_name = returneddata.model_name;
                        var model_id = returneddata.model_id;
                        var model_regex = returneddata.model_regex;
                        var sourcetype_scope = returneddata.sourcetype_scope
                        var mtime = returneddata.mtime;
                        var record = {
                        "model_name": model_name,
                        "model_id": model_id,
                        "model_regex": model_regex,
                        "sourcetype_scope": sourcetype_scope,
                        "mtime": mtime,
                        "_key": item
                        };

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("input_remove_custom_rule_data_sampling_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                        }

                        // Proceed to delete call
                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {


                                // Audit
                                action = "success";
                                change_type = "delete data parsing custom rule";
                                object = model_name;
                                object_category = "data_source";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);

                                // Return to modal
                                $("#data_sampling_show_custom_rules").modal();

                                // Refresh the search
                                searchDataSamplingShowCustomRules.startSearch();

                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete data parsing custom rule";
                                object = model_name;
                                object_category = "data_source";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                        });

                    }

                });

            }

        }

        $("#btn_modal_remove_custom_rule_confirm").click(function() {


            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeDataSamplingCustomRule");
            tk_multi_table_array = tk_multi_table_array.split(',');

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachRemoveDataSamplingCustomRule);

            // Hide main modal
            $("#modal_remove_custom_rule_data_sampling").modal('hide');

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeDataSamplingCustomRule");

        });

        // Run data sampling engine
        $("#btn_run_data_sampling").click(function() {            

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Built the search URI
            var tk_keyid = tokens.get("tk_keyid");            

            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - Data sampling engine for target\" key=\"" + tk_keyid + "\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-7d",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Running the data sampling and format recognition engine...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12, length: 18,
                                position: "relative", color: "#003b59"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                // Once the job is done, update all searches
                                searchDataSamplingTable1.startSearch();

                                $("#loadingGray").remove()
                                $("#data_sampling_manage").modal();

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        // Disable action
        $("#btn_data_sampling_disable").click(function() {
            $("#modal_disable_data_sampling").modal()
        });

        $("#btn_modal_data_sampling_disable_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Built the search URI
            var tk_data_name = tokens.get("tk_data_name");
            var tk_keyid = tokens.get("tk_keyid");            

            // Endpoint URI
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_sampling/" + tk_keyid;

            // Retrieve update comment if any
            var tk_comment = document.getElementById("input_clear_state_data_sampling_comment").value;

            // if is not defined, give it a value and override text box content
            if (tk_comment == "null") {
                setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                // replace the textarea for modification requests
                document.getElementById("input_clear_state_data_sampling_comment").value = "update note";
            }
            else if (tk_comment == "update note") {
                tk_comment = "No comment for update.";
                document.getElementById("input_clear_state_data_sampling_comment").value = "update note";
            }
            else {
                // replace the textarea for modification requests
                document.getElementById("input_clear_state_data_sampling_comment").value = "update note";
            }

            // Get the KV entry content first
            $.ajax({
                url: myendpoint_URl,
                type: "GET",
                async: true,
                contentType: "application/json",
                success: function(returneddata) {

                    var removedObject = returneddata;

                    var data_sample_mtime = returneddata.data_sample_mtime;
                    var data_sample_feature = returneddata.data_sample_feature;
                    var data_sample_iteration = returneddata.data_sample_iteration;
                    var data_sample_anomaly_reason = returneddata.data_sample_anomaly_reason;
                    var data_sample_status_colour = returneddata.data_sample_status_colour;
                    var data_sample_anomaly_ack_status = returneddata.data_sample_anomaly_ack_status;
                    var data_sample_anomaly_ack_mtime = returneddata.data_sample_anomaly_ack_mtime;
                    var data_sample_anomaly_detected = returneddata.data_sample_anomaly_detected;
                    var data_sample_status_message = returneddata.data_sample_status_message;
                    var multiformat_detected = returneddata.multiformat_detected;
                    var current_detected_format = returneddata.current_detected_format;
                    var current_detected_format_id = returneddata.current_detected_format_id;
                    var current_detected_format_dcount = returneddata.current_detected_format_dcount;
                    var previous_detected_format = returneddata.previous_detected_format;
                    var previous_detected_format_id = returneddata.previous_detected_format_id;
                    var previous_detected_format_dcount = returneddata.previous_detected_format_dcount;

                    var record = {
                        "data_sample_mtime": data_sample_mtime,
                        "data_sample_feature": data_sample_feature,
                        "data_sample_iteration": data_sample_iteration,
                        "data_sample_anomaly_reason": data_sample_anomaly_reason,
                        "data_sample_status_colour": data_sample_status_colour,
                        "data_sample_anomaly_ack_status": data_sample_anomaly_ack_status,
                        "data_sample_anomaly_ack_mtime": data_sample_anomaly_ack_mtime,
                        "data_sample_anomaly_detected": data_sample_anomaly_detected,
                        "data_sample_status_message": data_sample_status_message,
                        "multiformat_detected": multiformat_detected,
                        "current_detected_format": current_detected_format,
                        "current_detected_format_id": current_detected_format_id,
                        "current_detected_format_dcount": current_detected_format_dcount,
                        "previous_detected_format": previous_detected_format,
                        "previous_detected_format_id": previous_detected_format_id,
                        "previous_detected_format_dcount": previous_detected_format_dcount
                    };


                    // Define the query
                    var searchQuery = "| inputlookup trackme_data_sampling where _key=\"" + tk_keyid + "\" | eval keyid=_key | eval data_sample_feature=\"disabled\", data_sample_mtime=now(), data_sample_status_message=\"WARNING: The data sample feature was manually disabled, to re-enable the feature, click on the button Manage data sampling then Clear state and run sampling.\", data_sample_status_colour=\"orange\" | foreach current_detected_format, current_detected_format_dcount, current_detected_format_id, data_sample_anomaly_ack_mtime, data_sample_anomaly_ack_status, data_sample_anomaly_detected, data_sample_anomaly_reason, data_sample_iteration, multiformat_detected, previous_detected_format, previous_detected_format_dcount, previous_detected_format_id, raw_sample [ eval <<FIELD>> = \"N/A\" ] | outputlookup append=t key_field=keyid trackme_data_sampling";

                    // Set the search parameters--specify a time range
                    var searchParams = {
                        earliest_time: "-4h",
                        latest_time: "now"
                    };

                    // Run a normal search that immediately returns the job's SID
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            $("#loadingGray").remove()
                            $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Clearing the data source state and disabling the data sampling feature...</p></div><div id="spinner"></div></div>')

                            require(["jquery",
                                    "/static/app/trackme/spin.js"
                                ],
                                function($,
                                    Spinner
                                ) {
                                    new Spinner({
                                        lines: 12, length: 18,
                                        position: "relative", color: "#003b59"
                                    }).spin(document.getElementById('spinner'));
                                })

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {

                                        // Once the job is done, update all searches
                                        searchDataSamplingTable1.startSearch();

                                        $("#loadingGray").remove()
                                        $("#data_sampling_manage").modal();

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        $("#loadingGray").remove()
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        $("#loadingGray").remove()
                                        $("#modal_update_collection_failure").modal()
                                    }
                                });
                            }
                        }
                    );

                }

            });

        });

        // Update number of records per sample
        $("#btn_data_sampling_edit_records_nr").click(function() {
            $("#modal_update_records_nr_data_sampling").modal()
        });

        $("#btn_update_records_nr_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get tokens
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_sampling_nr = tokens.get("tk_input_data_sampling_records_nr");

            // Define the query
            var searchQuery = "| inputlookup trackme_data_sampling where data_name=\"" + tk_data_name + "\" | eval keyid=_key | eval data_sampling_nr=\"" + tk_data_sampling_nr + "\" | outputlookup append=t key_field=keyid trackme_data_sampling";

            // record for auditing
            var record = {
                        "data_name": tk_data_name,
                        "data_sampling_nr": tk_data_sampling_nr
                        };

            // Retrieve update comment if any
            var tk_comment = document.getElementById("input_update_records_nr_data_sampling_comment").value;

            // if is not defined, give it a value and override text box content
            if (tk_comment == "null") {
                setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                // replace the textarea for modification requests
                document.getElementById("input_clear_state_data_sampling_comment").value = "update note";
            }
            else if (tk_comment == "update note") {
                tk_comment = "No comment for update.";
                document.getElementById("input_clear_state_data_sampling_comment").value = "update note";
            }
            else {
                // replace the textarea for modification requests
                document.getElementById("input_clear_state_data_sampling_comment").value = "update note";
            }

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-5m",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {

                                // Audit
                                action = "success";
                                change_type = "update data sampling records_nr";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = JSON.stringify(record, null, '\t');
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                notification('Update was successful.', 6000)

                                // Update search
                                searchDataSamplingTable1.startSearch();

                                // Return to modal
                                $("#data_sampling_manage").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }

                                // Audit
                                action = "failure";
                                change_type = "update data sampling records_nr";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = JSON.stringify(record, null, '\t');
                                result = errorStr;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);

                                // Audit
                                action = "failure";
                                change_type = "update data sampling records_nr";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = JSON.stringify(record, null, '\t');
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        $("#btn_update_records_nr_confirm_back").click(function() {
            // Return to modal
            $("#data_sampling_manage").modal()
        });

        // Clear state action
        $("#btn_data_sampling_clear_now").click(function() {
            $("#modal_clear_state_data_sampling").modal()
        });

        // Back button
        $("#btn_modal_clear_state_confirm_back").click(function() {
            // Return to modal
            $("#data_sampling_manage").modal()
        });

        // Clear state action button is confirmed
        $("#btn_modal_clear_state_confirm").click(function() {

            //var that = $(this);
            //that.off('click'); // remove handler

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Built the search URI
            var tk_data_name = tokens.get("tk_data_name");
            var tk_keyid = tokens.get("tk_keyid");            

            // Endpoint URI
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_sampling/" + tk_keyid;

            // Retrieve update comment if any
            var tk_comment = document.getElementById("input_clear_state_data_sampling_comment").value;

            // if is not defined, give it a value and override text box content
            if (tk_comment == "null") {
                setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                // replace the textarea for modification requests
                document.getElementById("input_clear_state_data_sampling_comment").value = "update note";
            }
            else if (tk_comment == "update note") {
                tk_comment = "No comment for update.";
                document.getElementById("input_clear_state_data_sampling_comment").value = "update note";
            }
            else {
                // replace the textarea for modification requests
                document.getElementById("input_clear_state_data_sampling_comment").value = "update note";
            }

            // Get the KV entry content first
            $.ajax({
                url: myendpoint_URl,
                type: "GET",
                async: true,
                contentType: "application/json",
                success: function(returneddata) {

                    var removedObject = returneddata;

                    var data_sample_mtime = returneddata.data_sample_mtime;
                    var data_sample_feature = returneddata.data_sample_feature;
                    var data_sample_iteration = returneddata.data_sample_iteration;
                    var data_sample_anomaly_reason = returneddata.data_sample_anomaly_reason;
                    var data_sample_status_colour = returneddata.data_sample_status_colour;
                    var data_sample_anomaly_ack_status = returneddata.data_sample_anomaly_ack_status;
                    var data_sample_anomaly_ack_mtime = returneddata.data_sample_anomaly_ack_mtime;
                    var data_sample_anomaly_detected = returneddata.data_sample_anomaly_detected;
                    var data_sample_status_message = returneddata.data_sample_status_message;
                    var data_sampling_nr = returneddata.data_sampling_nr;
                    var multiformat_detected = returneddata.multiformat_detected;
                    var current_detected_format = returneddata.current_detected_format;
                    var current_detected_format_id = returneddata.current_detected_format_id;
                    var current_detected_format_dcount = returneddata.current_detected_format_dcount;
                    var previous_detected_format = returneddata.previous_detected_format;
                    var previous_detected_format_id = returneddata.previous_detected_format_id;
                    var previous_detected_format_dcount = returneddata.previous_detected_format_dcount;

                    var record = {
                        "data_sample_mtime": data_sample_mtime,
                        "data_sample_feature": data_sample_feature,
                        "data_sample_iteration": data_sample_iteration,
                        "data_sample_anomaly_reason": data_sample_anomaly_reason,
                        "data_sample_status_colour": data_sample_status_colour,
                        "data_sample_anomaly_ack_status": data_sample_anomaly_ack_status,
                        "data_sample_anomaly_ack_mtime": data_sample_anomaly_ack_mtime,
                        "data_sample_anomaly_detected": data_sample_anomaly_detected,
                        "data_sample_status_message": data_sample_status_message,
                        "data_sampling_nr": data_sampling_nr,
                        "multiformat_detected": multiformat_detected,
                        "current_detected_format": current_detected_format,
                        "current_detected_format_id": current_detected_format_id,
                        "current_detected_format_dcount": current_detected_format_dcount,
                        "previous_detected_format": previous_detected_format,
                        "previous_detected_format_id": previous_detected_format_id,
                        "previous_detected_format_dcount": previous_detected_format_dcount
                    };

                    // create a new record and preserve information that need to be preserved
                    var new_record = {
                        "data_sampling_nr": data_sampling_nr
                    };

                    // Proceed to post call
                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        data: JSON.stringify(new_record),
                        contentType: "application/json",
                        success: function(returneddata) {


                            // Audit
                            action = "success";
                            change_type = "data sampling clear state";
                            object = tk_data_name;
                            object_category = "data_source";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = "N/A";
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);


                            // Define the query
                            var searchQuery = "| savedsearch \"TrackMe - Data sampling engine for target\" key=\"" + tk_keyid + "\"";

                            // Set the search parameters--specify a time range
                            var searchParams = {
                                earliest_time: "-7d",
                                latest_time: "now"
                            };

                            // Run a normal search that immediately returns the job's SID
                            service.search(
                                searchQuery,
                                searchParams,
                                function(err, job) {

                                    $("#loadingGray").remove()
                                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Clearing the data source state and running the data sampling and format recognition engine...</p></div><div id="spinner"></div></div>')

                                    require(["jquery",
                                            "/static/app/trackme/spin.js"
                                        ],
                                        function($,
                                            Spinner
                                        ) {
                                            new Spinner({
                                                lines: 12, length: 18,
                                                position: "relative", color: "#003b59"
                                            }).spin(document.getElementById('spinner'));
                                        })

                                    // Shall the search fail before we can get properties
                                    if (job == null) {
                                        let errorStr = "Unknown Error!";
                                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                            errorStr = err.data.messages[0]['text'];
                                        } else if (err && err.data && err.data.messages) {
                                            errorStr = JSON.stringify(err.data.messages);
                                        }
                                        $("#loadingGray").remove()
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    } else {

                                        // Poll the status of the search job
                                        job.track({
                                            period: 200
                                        }, {
                                            done: function(job) {

                                                // Once the job is done, update all searches
                                                searchDataSamplingTable1.startSearch();

                                                $("#loadingGray").remove()
                                                $("#data_sampling_manage").modal();

                                            },
                                            failed: function(properties) {
                                                let errorStr = "Unknown Error!";
                                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                                    errorStr = properties._properties.messages[0]['text'];
                                                } else if (properties && properties._properties && properties._properties.messages) {
                                                    errorStr = JSON.stringify(properties._properties.messages);
                                                }
                                                $("#loadingGray").remove()
                                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                                $("#modal_update_collection_failure_return").modal()
                                            },
                                            error: function(err) {
                                                done(err);
                                                $("#loadingGray").remove()
                                                $("#modal_update_collection_failure").modal()
                                            }
                                        });
                                    }
                                }
                            );

                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit
                            action = "failure";
                            change_type = "data sampling clear state";
                            object = tk_data_name;
                            object_category = "data_source";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = message;
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                    });

                },

                error: function(xhr, textStatus, error) {

                    // Define the query
                    var searchQuery = "| savedsearch \"TrackMe - Data sampling engine for target\" key=\"" + tk_keyid + "\"";

                    // Set the search parameters--specify a time range
                    var searchParams = {
                        earliest_time: "-7d",
                        latest_time: "now"
                    };

                    // Run a normal search that immediately returns the job's SID
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            $("#loadingGray").remove()
                            $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder; color: #003b59;">Clearing the data source state and running the data sampling and format recognition engine...</p></div><div id="spinner"></div></div>')

                            require(["jquery",
                                    "/static/app/trackme/spin.js"
                                ],
                                function($,
                                    Spinner
                                ) {
                                    new Spinner({
                                        lines: 12, length: 18,
                                        position: "relative", color: "#003b59"
                                    }).spin(document.getElementById('spinner'));
                                })

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {

                                        // Once the job is done, update all searches
                                        searchDataSamplingTable1.startSearch();

                                        $("#loadingGray").remove()
                                        $("#data_sampling_manage").modal();

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        $("#loadingGray").remove()
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        $("#loadingGray").remove()
                                        $("#modal_update_collection_failure").modal()
                                    }
                                });
                            }
                        }
                    );

                }

            });

        });

        // Back button
        $("#btn_modal_data_sampling_disable_confirm_back").click(function() {
            // Return to modal
            $("#data_sampling_manage").modal()
        });

        // Data sampling custom rules
        $("#btn_data_sampling_custom_rules").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the current data source
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");

            // Apply to the form inputs
            setToken("form.tk_input_data_sampling_dropdown", tk_data_name);
            setToken("form.tk_data_sampling_custom_st_value", tk_data_sourcetype);

            // Unset action tokens
            unsetToken("start_simulation_data_sampling_custom_rule_show_events");
            unsetToken("start_simulation_data_sampling_custom_rule");

            // Disable the button results
            document.getElementById('btn_modal_data_sampling_custom_rule_simulate_show_details').disabled = true;
            document.getElementById('btn_data_sampling_custom_rule_add').disabled = true;

            // Free the dropdown populating search
            setToken("start_search_input_data_sampling_dropdown", "true");

            // force re-run the search each time the button is clicked
            searchPopulateDataSampling.startSearch();

            // Open modal
            $("#data_sampling_create_custom_rules").modal()
        });

        // Back button
        $("#btn_modal_data_sampling_custom_rule_add_new_back").click(function() {
            $("#data_sampling_show_custom_rules").modal()
        });

        // Data sampling custom rule simulation
        $("#btn_modal_data_sampling_custom_rule_show_sample").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Unset the token and set to free the search
            unsetToken("start_simulation_data_sampling_custom_rule_show_events");
            setToken("start_simulation_data_sampling_custom_rule_show_events", "true");

        });

        // Data sampling custom rule simulation
        $("#btn_modal_data_sampling_custom_rule_simulate").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Retrieve the regex rule
            var tk_data_sampling_custom_rule_regex = document.getElementById("modal_input_data_sampling_custom_rule_regex").value;

            // Retrieve the rule name
            var tk_data_sampling_custom_rule_name = tokens.get("tk_data_sampling_custom_rule_name");

            // Retriebe the key id
            var tk_keyid = tokens.get("tk_keyid");

            // if is not defined, give it a value and override text box content
            if (tk_data_sampling_custom_rule_regex == "Enter a valid regular expression and click on the button \"Run model simulation\"." || !tk_data_sampling_custom_rule_name || !tk_data_sampling_custom_rule_name.length) {

                // Show an error notification
                notification('ERROR: Entries are either incorrect or incomplete, please correct and try again.', 6000)

                // Disable the add button
                document.getElementById('btn_data_sampling_custom_rule_add').disabled = true; 

            }
            else {
                // replace the textarea for modification requests
                notification('INFO: running new data sampling model...', 6000)
                unsetToken("tk_data_sampling_custom_rule_regex");
                setToken("tk_data_sampling_custom_rule_regex", tk_data_sampling_custom_rule_regex);
                // Free the simulation search
                setToken("start_simulation_data_sampling_custom_rule", "true");

                // Define the URL target
                document.getElementById('btn_modal_data_sampling_custom_rule_simulate_show_details').disabled = false;

                // Enable the button results
                document.getElementById('btn_modal_data_sampling_custom_rule_simulate_show_details').disabled = false;

                // Disable the add button
                document.getElementById('btn_data_sampling_custom_rule_add').disabled = false;

            }
            
        });

        // Data sampling add custom rule
        $("#btn_data_sampling_custom_rule_add").click(function() {
            $("#modal_add_custom_rule_data_sampling").modal();
        });

        // Data sampling add custom rule
        $("#btn_modal_add_custom_rule_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Retrieve the regex rule
            var tk_data_sampling_custom_rule_regex = document.getElementById("modal_input_data_sampling_custom_rule_regex").value;

            // Retrieve the rule name
            var tk_data_sampling_custom_rule_name = tokens.get("tk_data_sampling_custom_rule_name");

            // Retrieve the rule type
            var tk_data_sampling_custom_rule_type = tokens.get("tk_data_sampling_custom_rule_type");

            // Retrieve the sourcetype scope
            var tk_data_sampling_custom_sourcetype_scope = tokens.get("tk_data_sampling_custom_sourcetype_scope");

            // if is not defined, give it a value and override text box content - We should never reach this for the add function
            if (tk_data_sampling_custom_rule_regex == "Enter a valid regular expression and click on the button \"Run model simulation\"." || !tk_data_sampling_custom_rule_name || !tk_data_sampling_custom_rule_name.length) {

                // Show an error notification
                notification('ERROR: Entries are either incorrect or incomplete, please correct and try again.', 6000)

                // Disable the add button
                document.getElementById('btn_data_sampling_custom_rule_add').disabled = true; 

            }
            else {


                // Retrieve update comment if any
                var tk_comment = document.getElementById("input_add_custom_rule_data_sampling_comment").value;

                // if is not defined, give it a value and override text box content
                if (tk_comment == "null") {
                    setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                    // replace the textarea for modification requests
                    document.getElementById("input_add_custom_rule_data_sampling_comment").value = "update note";
                }
                else if (tk_comment == "update note") {
                    tk_comment = "No comment for update.";
                    document.getElementById("input_add_custom_rule_data_sampling_comment").value = "update note";
                }
                else {
                    // replace the textarea for modification requests
                    document.getElementById("input_add_custom_rule_data_sampling_comment").value = "update note";
                }

                // Define the query
                var searchQuery = "| makeresults | eval model_name=\"" + tk_data_sampling_custom_rule_name + "\", model_type=\"" + tk_data_sampling_custom_rule_type + "\", model_regex=\"" + tk_data_sampling_custom_rule_regex + "\", sourcetype_scope=\"" + tk_data_sampling_custom_sourcetype_scope + "\" | eval _key=md5(model_name), model_id=md5(model_name), mtime=now() | outputlookup trackme_data_sampling_custom_models append=t key_field=_key";

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add data parsing custom rule";
                            object = tk_data_sampling_custom_rule_name;
                            object_category = "data_source";
                            object_attrs = "{\n" + "\t\"model_name\": \"" + tk_data_sampling_custom_rule_name + "\",\n\t\"model_regex\": \"" + tk_data_sampling_custom_rule_regex + "\",\n\t\"sourcetype_scope\": \"" + tk_data_sampling_custom_sourcetype_scope + "\"\n}";
                            result = "N/A";
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataSourceHost.startSearch();
                                    searchSingleBlackListDataSourceHost.startSearch();
                                    searchDataSourcesMain.startSearch();
                                    searchDataSamplingShowCustomRules.startSearch();
                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add data parsing custom rule";
                                    object = tk_data_sampling_custom_rule_name;
                                    object_category = "data_source";
                                    object_attrs = "{\n" + "\t\"model_name\": \"" + tk_data_sampling_custom_rule_name + "\",\n\t\"model_regex\": \"" + tk_data_sampling_custom_rule_regex + "\",\n\t\"sourcetype_scope\": \"" + tk_data_sampling_custom_sourcetype_scope + "\"\n}";
                                    result = "N/A";
                                    comment = tk_comment;
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    // Take a decision depending on where we come from
                                    var tk_data_sampling_custom_rule_name = tokens.get("show_data_sampling_custom_rules_from_home");

                                    if ( tk_data_sampling_custom_rule_name == "true") {
                                        $("#data_sampling_show_custom_rules").modal();
                                    }
                                    else {
                                        $("#data_sampling_manage").modal();
                                    }

                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }

                );

            }
            
        });

        $("#btn_modal_data_sampling_custom_rule_simulate_show_details").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Retrieve the regex rule
            var tk_data_sampling_custom_rule_regex = document.getElementById("modal_input_data_sampling_custom_rule_regex").value;

            // Retrieve the rule name
            var tk_data_sampling_custom_rule_name = tokens.get("tk_data_sampling_custom_rule_name");

            // Retrieve the sourcetype scope
            var tk_data_sampling_custom_sourcetype_scope = tokens.get("tk_data_sampling_custom_sourcetype_scope");

            // Retrieve the key id
            var tk_keyid = tokens.get("tk_keyid");

            // Retrieve the key id
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");

            // Built the search URI
            var similation_events_detail = 'search' + "?q=" + encodeURIComponent("| `trackme_data_sampling_return_live_sample(\"" + tk_keyid + "\")` | fields raw_sample | mvexpand raw_sample | eval sourcetype=\"" + tk_data_sourcetype + "\", sourcetype_scope=\"" + tk_data_sampling_custom_sourcetype_scope + "\" | eval detected_format = case((sourcetype_scope==\"*\"), case(match(raw_sample, \"" + tk_data_sampling_custom_rule_regex + "\"), \"" + tk_data_sampling_custom_rule_name + "\"), in(sourcetype, `trackme_data_sampling_custom_models_simulate_genlist(\"" + tk_data_sampling_custom_sourcetype_scope + "\")`), case(match(raw_sample, \"" + tk_data_sampling_custom_rule_regex + "\"), \"" + tk_data_sampling_custom_rule_name + "\")) | eval detected_format_id=md5(detected_format)");

            // Open
            window.open(similation_events_detail,'_blank');

        });

        // Outliers simulation

        // data source run simulation
        $("#btn_outlier_config_data_host_simulate").click(function() {

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // get the object name
                var tk_data_host = tokens.get("tk_data_host");

                // set the token the search depends on
                setToken("start_outliers_simulation_data_host", "true");

                // explicitly start the search
                searchOutlierDetectionChartSimulationDataHost.startSearch();

                // notify
                notification('Outliers simulation started for data host ' + tk_data_host + '.', 6000)

        });

        $("#btn_outlier_config_data_host_save").click(function(mode) {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");

            // get inputs tokens

            var tk_input_data_host_enable_outlier = tokens.get("tk_input_data_host_enable_outlier");
            var tk_input_data_host_outlier_min_eventcount_mode = tokens.get("tk_input_data_host_outlier_min_eventcount_mode");
            var tk_input_data_host_outlier_alert_on_upper = tokens.get("tk_input_data_host_outlier_alert_on_upper");
            var tk_input_data_host_outlier_min_eventcount = tokens.get("tk_input_data_host_outlier_min_eventcount");
            var tk_input_data_host_outlier_lower_threshold_multiplier = tokens.get("tk_input_data_host_outlier_lower_threshold_multiplier");
            var tk_input_data_host_outlier_upper_threshold_multiplier = tokens.get("tk_input_data_host_outlier_upper_threshold_multiplier");
            var tk_input_data_host_outlier_period = tokens.get("tk_input_data_host_outlier_period");
            var tk_input_data_host_outlier_span = tokens.get("tk_input_data_host_outlier_span");

            // Conditionally define record values for Outliers
            if (tk_enable_behaviour_analytic != tk_input_data_host_enable_outlier) {
                tk_enable_behaviour_analytic = tk_input_data_host_enable_outlier;
            }

            if (tk_outlieralertonupper != tk_input_data_host_outlier_alert_on_upper) {
                tk_outlieralertonupper = tk_input_data_host_outlier_alert_on_upper;
            }

            tk_source_outlier_period = tk_outlier_period;
            if (tk_outlier_period != tk_input_data_host_outlier_period) {
                tk_outlier_period = tk_input_data_host_outlier_period;
            }

            if (tk_outlier_span != tk_input_data_host_outlier_span) {
                tk_outlier_span = tk_input_data_host_outlier_span;
                // refresh the token for current view usage
                setToken("tk_outlier_span", tk_input_data_host_outlier_span);
            }

            if (tk_outlierlowerthresholdmultiplier != tk_input_data_host_outlier_lower_threshold_multiplier && isNumeric(tk_input_data_host_outlier_lower_threshold_multiplier)) {
                tk_outlierlowerthresholdmultiplier = tk_input_data_host_outlier_lower_threshold_multiplier;
            }

            if (tk_outlierupperthresholdmultiplier != tk_input_data_host_outlier_upper_threshold_multiplier && isNumeric(tk_input_data_host_outlier_upper_threshold_multiplier)) {
                tk_outlierupperthresholdmultiplier = tk_input_data_host_outlier_upper_threshold_multiplier;
            }

            if (tk_input_data_host_outlier_min_eventcount_mode === "static" && isNumeric(tk_input_data_host_outlier_min_eventcount) && tk_input_data_host_outlier_min_eventcount > 0) {
                tk_outliermineventcount = tk_input_data_host_outlier_min_eventcount;
            } else {
                tk_outliermineventcount = "0";
                tk_input_data_host_outlier_min_eventcount_mode = "dynamic";
            }

            // Create the endpoint URL
            var myendpoint_URl = "{{SPLUNKWEB_URL_PREFIX}}/splunkd/__raw/services/trackme/v1/data_hosts/dh_update_outliers";

            // Create a dictionary to store the field names and values
            var record = {
                "data_host": tk_data_host,
                "OutlierMinEventCount": tk_outliermineventcount,
                "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                "OutlierAlertOnUpper": tk_outlieralertonupper,
                "OutlierTimePeriod": tk_outlier_period,
                "OutlierSpan": tk_outlier_span,
                "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                "update_comment": "N/A"
            };

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    dataType: "text",
                    beforeSend: function(xhr){  xhr.overrideMimeType( "text/plain; charset=x-user-defined" );},
                    data: JSON.stringify(record),
                    success: function(returneddata) {

                        // notify
                        var tk_data_host = tokens.get("tk_data_host");
                        notification('Outliers configuration updated, please wait a few seconds while statistics are generated, click on refresh in the Outliers tab if statistics are not yet available.', 6000)

                        // Generate metrics if outlier period was changed
                        if (tk_source_outlier_period != tk_input_data_host_outlier_span) {
                            metricOutliersGen("data_host", tk_data_host, tk_input_data_host_outlier_period);
                        }

                        // call update summary investigator for that entity only
                        updateDataHostEntity("trackme_datahost_tracker_shorterm", tk_data_host);

                        searchSingleLagHost.startSearch();
                        searchSingleLagByMetricsHost.startSearch();
                        searchChartHostBaseSearch.startSearch();
                        searchChartLagHostOverTime.startSearch();
                        searchSingleSLAHostpct.startSearch();
                        searchOutlierDetectionChartDataHost.startSearch();
                        searchOutlierDetectionTableDataHost.startSearch();

                        // call update data host
                        var tk_keyid = tokens.get("tk_keyid");
                        updateDataHost(tk_keyid);

                        // Run the search again to update the table
                        searchDataHostsMain.startSearch();

                    },
                    error: function(xhr, textStatus, error) {
                        message = "server response: " + xhr.responseText + "\n - http response: " + error;

                        // Audit
                        action = "failure";
                        change_type = "modify outliers";
                        object = tk_data_host;
                        object_category = "data_host";
                        object_attrs = JSON.stringify(record, null, '\t');
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }

        });

        // END

        DashboardController.onReady(function() {
            if (!submittedTokenModel.has('earliest') && !submittedTokenModel.has('latest')) {
                submittedTokenModel.set({
                    earliest: '0',
                    latest: ''
                });
            }
        });

        // Initialize time tokens to default
        if (!defaultTokenModel.has('earliest') && !defaultTokenModel.has('latest')) {
            defaultTokenModel.set({
                earliest: '0',
                latest: ''
            });
        }

        if (!_.isEmpty(urlTokenModel.toJSON())) {
            submitTokens();
        }

        //
        // DASHBOARD READY
        //

        DashboardController.ready();
        pageLoading = false;

    }
);
// ]]>
</script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/trackme/table.js" type="text/javascript"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/trackme/checkbox_tablev3.js" type="text/javascript"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/trackme/checkbox_table_data_sampling.js" type="text/javascript"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/trackme/checkbox_table_tags_policies.js" type="text/javascript"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/trackme/table_raw.js" type="text/javascript"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/trackme/multiselect_all.js" type="text/javascript"></script>
<script>
$(".btn").mouseup(function(){
    $(this).blur();
})
</script>
<script>
$('.modal').on('show.bs.modal', function () {
    $('.modal').not($(this)).each(function () {
        $(this).modal('hide');
    });
});
</script>
<script>
function notification(s, time) {

  $("<p>" + s + "</p>").appendTo('#boxnotify-data-source').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-data-host').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-metric-host').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-unified-data-source').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-unified-data-source-autolag').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-unified-data-host').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-unified-data-host-autolag').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-unified-metric-host').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_source_whitelist').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_host_whitelist').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_metric_host_whitelist').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_source_blacklist_host').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_source_blacklist_index').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_source_blacklist_sourcetype').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_source_blacklist_data_name').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_host_blacklist_host').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_host_blacklist_index').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_metric_host_blacklist_host').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_metric_host_blacklist_index').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_host_blacklist_sourcetype').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_metric_host_blacklist_metric_category').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modify_custom_lagging').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-data-source-outliers-update').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-data-host-outliers-update').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-add_elastic_source').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-add_data_sampling_custom_rule').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });  

  $("<p>" + s + "</p>").appendTo('#boxnotify-view_data_sampling_custom_rule').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-manage_data_sampling').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-manage_tags').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-add_tags_policies').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modify_elastic_sources').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modify_elastic_sources_dedicated').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

}
</script>
</body>
</html>
