# props.conf

# search_telemetry
# Splunk generates date time parsing erros with the search telemetry due to a timestamp missing in the second json payload of a same json generated
# This seems to be a Splunk core issue with telemetry and the root cause was not idenfitied
# however, this can be workaround with a source based stanza forcing the a date time config

[source::.../var/run/splunk/search_telemetry/...trackme...telemetry.json]
TRUNCATE = 99999
DATETIME_CONFIG = CURRENT

# alert actions
[source::...trackme_smart_status_modalert.log]
sourcetype = modular_alerts:trackme_smart_status
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}\,\d*
CHARSET=UTF-8
TIME_PREFIX=^
TIME_FORMAT=%Y-%m-%d %H:%M:%S,%3N
TRUNCATE=0

[source::...trackme_auto_ack_modalert.log]
sourcetype = modular_alerts:trackme_auto_ack
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}\,\d*
CHARSET=UTF-8
TIME_PREFIX=^
TIME_FORMAT=%Y-%m-%d %H:%M:%S,%3N
TRUNCATE=0

[source::...trackme_free_style_rest_call_modalert.log]
sourcetype = modular_alerts:trackme_free_style_rest_call
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}\,\d*
CHARSET=UTF-8
TIME_PREFIX=^
TIME_FORMAT=%Y-%m-%d %H:%M:%S,%3N
TRUNCATE=0

[trackme_smart_status]
KV_MODE = json

[trackme_alert_action]
KV_MODE = json

# TrackMe internal logs, these logs are produced by the various backend tools in TrackMe

[source::...trackme.log]
sourcetype = trackme:custom_commands:trackme
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}
CHARSET=UTF-8
TIME_PREFIX=^
TIME_FORMAT=%Y-%m-%d %H:%M:%S,%3N
TRUNCATE=0

[source::...trackme_splunkremotesearch.log]
sourcetype = trackme:custom_commands:splunkremotesearch
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}
CHARSET=UTF-8
TIME_PREFIX=^
TIME_FORMAT=%Y-%m-%d %H:%M:%S,%3N
TRUNCATE=0

[source::...trackme_rest_handler_ack.log]
sourcetype = trackme:rest_api:trackme_rest_handler_ack
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}
CHARSET=UTF-8
TIME_PREFIX=^
TIME_FORMAT=%Y-%m-%d %H:%M:%S,%3N
TRUNCATE=0

[source::...trackme_rest_handler_allowlist.log]
sourcetype = trackme:rest_api:trackme_rest_handler_allowlist
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}
CHARSET=UTF-8
TIME_PREFIX=^
TIME_FORMAT=%Y-%m-%d %H:%M:%S,%3N
TRUNCATE=0

[source::...trackme_rest_handler_backup_and_restore.log]
sourcetype = trackme:rest_api:trackme_rest_handler_backup_and_restore
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}
CHARSET=UTF-8
TIME_PREFIX=^
TIME_FORMAT=%Y-%m-%d %H:%M:%S,%3N
TRUNCATE=0

[source::...trackme_rest_handler_blocklist.log]
sourcetype = trackme:rest_api:trackme_rest_handler_blocklist
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}
CHARSET=UTF-8
TIME_PREFIX=^
TIME_FORMAT=%Y-%m-%d %H:%M:%S,%3N
TRUNCATE=0

[source::...trackme_rest_handler_smart_status.log]
sourcetype = trackme:rest_api:trackme_rest_handler_smart_status
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}
CHARSET=UTF-8
TIME_PREFIX=^
TIME_FORMAT=%Y-%m-%d %H:%M:%S,%3N
TRUNCATE=0

[source::...trackme_rest_handler_data_hosts.log]
sourcetype = trackme:rest_api:trackme_rest_handler_data_hosts
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}
CHARSET=UTF-8
TIME_PREFIX=^
TIME_FORMAT=%Y-%m-%d %H:%M:%S,%3N
TRUNCATE=0

[source::...trackme_rest_handler_data_sampling.log]
sourcetype = trackme:rest_api:trackme_rest_handler_data_sampling
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}
CHARSET=UTF-8
TIME_PREFIX=^
TIME_FORMAT=%Y-%m-%d %H:%M:%S,%3N
TRUNCATE=0

[source::...trackme_rest_handler_data_sources.log]
sourcetype = trackme:rest_api:trackme_rest_handler_data_sources
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}
CHARSET=UTF-8
TIME_PREFIX=^
TIME_FORMAT=%Y-%m-%d %H:%M:%S,%3N
TRUNCATE=0

[source::...trackme_rest_handler_elastic_sources.log]
sourcetype = trackme:rest_api:trackme_rest_handler_elastic_sources
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}
CHARSET=UTF-8
TIME_PREFIX=^
TIME_FORMAT=%Y-%m-%d %H:%M:%S,%3N
TRUNCATE=0

[source::...trackme_rest_handler_hybrid_trackers.log]
sourcetype = trackme:rest_api:trackme_rest_handler_hybrid_trackers
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}
CHARSET=UTF-8
TIME_PREFIX=^
TIME_FORMAT=%Y-%m-%d %H:%M:%S,%3N
TRUNCATE=0

[source::...trackme_rest_handler_identity_cards.log]
sourcetype = trackme:rest_api:trackme_rest_handler_identity_cards
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}
CHARSET=UTF-8
TIME_PREFIX=^
TIME_FORMAT=%Y-%m-%d %H:%M:%S,%3N
TRUNCATE=0

[source::...trackme_rest_handler_lagging_classes_metrics.log]
sourcetype = trackme:rest_api:trackme_rest_handler_lagging_classes_metrics
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}
CHARSET=UTF-8
TIME_PREFIX=^
TIME_FORMAT=%Y-%m-%d %H:%M:%S,%3N
TRUNCATE=0

[source::...trackme_rest_handler_lagging_classes.log]
sourcetype = trackme:rest_api:trackme_rest_handler_lagging_classes
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}
CHARSET=UTF-8
TIME_PREFIX=^
TIME_FORMAT=%Y-%m-%d %H:%M:%S,%3N
TRUNCATE=0
