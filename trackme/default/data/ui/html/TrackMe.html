<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>TrackMe - Data tracking system</title>
    <link rel="shortcut icon" href="/en-US/static/@E0748683B67CEA4FEB581C608314742274902FE131518C73E0D443740659785A.7/img/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="{{SPLUNKWEB_URL_PREFIX}}/static/build/css/bootstrap-enterprise.css" />
    <link rel="stylesheet" type="text/css" href="{{SPLUNKWEB_URL_PREFIX}}/static/css/build/pages/dashboard-simple-bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" media="all" href="{{SPLUNKWEB_URL_PREFIX}}/static/app/trackme/common.css" />
    <link rel="stylesheet" type="text/css" media="all" href="{{SPLUNKWEB_URL_PREFIX}}/static/app/trackme/checkbox_table.css" />

    <meta name="referrer" content="never" />
    <meta name="referrer" content="no-referrer" />

    <script>
        window._splunk_metrics_events = {
            push : function() {},
            active: false,
        }
    </script>
    <style>
        /* Bootstrap btns */
        .btn-primary{color:#fff;background-color:#337ab7;border-color:#2e6da4}.btn-primary.focus,.btn-primary:focus{color:#fff;background-color:#286090;border-color:#122b40}.btn-primary:hover{color:#fff;background-color:#286090;border-color:#204d74}.btn-primary.active,.btn-primary:active,.open>.dropdown-toggle.btn-primary{color:#fff;background-color:#286090;border-color:#204d74}.btn-primary.active.focus,.btn-primary.active:focus,.btn-primary.active:hover,.btn-primary:active.focus,.btn-primary:active:focus,.btn-primary:active:hover,.open>.dropdown-toggle.btn-primary.focus,.open>.dropdown-toggle.btn-primary:focus,.open>.dropdown-toggle.btn-primary:hover{color:#fff;background-color:#204d74;border-color:#122b40}.btn-primary.active,.btn-primary:active,.open>.dropdown-toggle.btn-primary{background-image:none}.btn-primary.disabled.focus,.btn-primary.disabled:focus,.btn-primary.disabled:hover,.btn-primary[disabled].focus,.btn-primary[disabled]:focus,.btn-primary[disabled]:hover,fieldset[disabled] .btn-primary.focus,fieldset[disabled] .btn-primary:focus,fieldset[disabled] .btn-primary:hover{background-color:#337ab7;border-color:#2e6da4}.btn-primary .badge{color:#337ab7;background-color:#fff}

        .btn-danger{color:#fff;background-color:#d9534f;border-color:#d43f3a}.btn-danger.focus,.btn-danger:focus{color:#fff;background-color:#c9302c;border-color:#761c19}.btn-danger:hover{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger.active,.btn-danger:active,.open>.dropdown-toggle.btn-danger{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger.active.focus,.btn-danger.active:focus,.btn-danger.active:hover,.btn-danger:active.focus,.btn-danger:active:focus,.btn-danger:active:hover,.open>.dropdown-toggle.btn-danger.focus,.open>.dropdown-toggle.btn-danger:focus,.open>.dropdown-toggle.btn-danger:hover{color:#fff;background-color:#ac2925;border-color:#761c19}.btn-danger.active,.btn-danger:active,.open>.dropdown-toggle.btn-danger{background-image:none}.btn-danger.disabled.focus,.btn-danger.disabled:focus,.btn-danger.disabled:hover,.btn-danger[disabled].focus,.btn-danger[disabled]:focus,.btn-danger[disabled]:hover,fieldset[disabled] .btn-danger.focus,fieldset[disabled] .btn-danger:focus,fieldset[disabled] .btn-danger:hover{background-color:#d9534f;border-color:#d43f3a}.btn-danger .badge{color:#d9534f;background-color:#fff}

        .btn-info{color:#fff;background-color:#5bc0de;border-color:#46b8da}.btn-info.focus,.btn-info:focus{color:#fff;background-color:#31b0d5;border-color:#1b6d85}.btn-info:hover{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info.active,.btn-info:active,.open>.dropdown-toggle.btn-info{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info.active.focus,.btn-info.active:focus,.btn-info.active:hover,.btn-info:active.focus,.btn-info:active:focus,.btn-info:active:hover,.open>.dropdown-toggle.btn-info.focus,.open>.dropdown-toggle.btn-info:focus,.open>.dropdown-toggle.btn-info:hover{color:#fff;background-color:#269abc;border-color:#1b6d85}.btn-info.active,.btn-info:active,.open>.dropdown-toggle.btn-info{background-image:none}.btn-info.disabled.focus,.btn-info.disabled:focus,.btn-info.disabled:hover,.btn-info[disabled].focus,.btn-info[disabled]:focus,.btn-info[disabled]:hover,fieldset[disabled] .btn-info.focus,fieldset[disabled] .btn-info:focus,fieldset[disabled] .btn-info:hover{background-color:#5bc0de;border-color:#46b8da}.btn-info .badge{color:#5bc0de;background-color:#fff}

        .btn-warning{color:#fff;background-color:#f0ad4e;border-color:#eea236}.btn-warning.focus,.btn-warning:focus{color:#fff;background-color:#ec971f;border-color:#985f0d}.btn-warning:hover{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning.active,.btn-warning:active,.open>.dropdown-toggle.btn-warning{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning.active.focus,.btn-warning.active:focus,.btn-warning.active:hover,.btn-warning:active.focus,.btn-warning:active:focus,.btn-warning:active:hover,.open>.dropdown-toggle.btn-warning.focus,.open>.dropdown-toggle.btn-warning:focus,.open>.dropdown-toggle.btn-warning:hover{color:#fff;background-color:#d58512;border-color:#985f0d}.btn-warning.active,.btn-warning:active,.open>.dropdown-toggle.btn-warning{background-image:none}.btn-warning.disabled.focus,.btn-warning.disabled:focus,.btn-warning.disabled:hover,.btn-warning[disabled].focus,.btn-warning[disabled]:focus,.btn-warning[disabled]:hover,fieldset[disabled] .btn-warning.focus,fieldset[disabled] .btn-warning:focus,fieldset[disabled] .btn-warning:hover{background-color:#f0ad4e;border-color:#eea236}.btn-warning .badge{color:#f0ad4e;background-color:#fff}

        .btn-success{color:#fff;background-color:#5cb85c;border-color:#4cae4c}.btn-success.focus,.btn-success:focus{color:#fff;background-color:#449d44;border-color:#255625}.btn-success:hover{color:#fff;background-color:#449d44;border-color:#398439}.btn-success.active,.btn-success:active,.open>.dropdown-toggle.btn-success{color:#fff;background-color:#449d44;border-color:#398439}.btn-success.active.focus,.btn-success.active:focus,.btn-success.active:hover,.btn-success:active.focus,.btn-success:active:focus,.btn-success:active:hover,.open>.dropdown-toggle.btn-success.focus,.open>.dropdown-toggle.btn-success:focus,.open>.dropdown-toggle.btn-success:hover{color:#fff;background-color:#398439;border-color:#255625}.btn-success.active,.btn-success:active,.open>.dropdown-toggle.btn-success{background-image:none}.btn-success.disabled.focus,.btn-success.disabled:focus,.btn-success.disabled:hover,.btn-success[disabled].focus,.btn-success[disabled]:focus,.btn-success[disabled]:hover,fieldset[disabled] .btn-success.focus,fieldset[disabled] .btn-success:focus,fieldset[disabled] .btn-success:hover{background-color:#5cb85c;border-color:#4cae4c}.btn-success .badge{color:#5cb85c;background-color:#fff}

        /* Prevents green disabled button */
        .btn-primary[disabled] {
            background-color: #337ab7;
            opacity: .40;
        }
        /* Manage modal hidden properly */
        .modal {
            display: none;
        }
        /* Increase modal width */
        .custom-modal-50 {
            width: 50%;
            margin-left: -25%;
        }
        .custom-modal-60 {
            width: 60%;
            margin-left: -30%;
        }
        .custom-modal-80 {
            width: 80%;
            margin-left: -40%;
        }

        .modal-big {
          height: 800px;
          max-height: 400%;
          width: 80%;
          margin-left: -40%;
        }

        .modal-guts {

          /* For Splunk 7.0.x */
          margin-top: 30px;

          /* other stuff we already covered */

          /* cover the modal */
          position: absolute;

          width: 90%;
          min-height: 50px;
          max-height: 600px;
          height: 100%;

          /* spacing as needed */
          padding: 20px 50px 20px 20px;

          /* let it scroll */
          overflow: auto;

        }

        /* fix some issues with long modals within Splunk 7.0.x */
        .modal-body {
            max-height: 700px !important;
        }

        /* Fix link input object align */
        .input-linklist {
          display: inline !important;
        }

        /* Fix link input object align for Splunk 6.5 */
        .input-link {
          display: inline !important;
        }

        /* reduce size of the token input panel */
        .input-link label{
          display: none !important;
        }

        .splunk-choice-input-message{
          display: none !important;
        }

        /* Increase the default max-width for links */
        .btn-pill {
          max-width: 600px !important;
        }

        .custom-btn {
            float: left;
            margin-top:15px;
        }

        /*Notification alerts*/

        [class^="boxnotify"] {
          position: fixed;
          bottom: 1em;
          left: 1em;
          z-index: 999999;
        }

        [class^="boxnotify"] p {
          background-color: rgba(0, 0, 0, .7);
          width: 600px;
          border-radius: 5px;
          padding: .7em;
          margin: .5em;
          color: white;
          font-size: 1.6em;
          display: none;
        }

        span.title_yellow {
            background: #ffd700;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_orange {
            background: #ffb347;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_blue {
            background: #89cff0;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_green {
            background: #77dd77;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_red {
            background: #ff6961;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_grey {
            background: #808080;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_low_priority {
            background: #cce5ff;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_medium_priority {
            background: #7fbfff;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_high_priority {
            background: #3298ff;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        .status_message_orange {
            background-color: #ffd394;
            margin: 30px 0;
            padding: 10px;
            border-radius: 3px 3px 3px 3px;
            margin-bottom: 80px;
        }

        .status_message_blue {
            background-color: #cfebf9;
            margin: 30px 0;
            padding: 10px;
            border-radius: 3px 3px 3px 3px;
            margin-bottom: 80px;
        }

        .status_message_green {
            background-color: #b6edb6;
            margin: 30px 0;
            padding: 10px;
            border-radius: 3px 3px 3px 3px;
            margin-bottom: 80px;
        }

        .status_message_red {
            background-color: #FFBABA;
            margin: 30px 0;
            padding: 10px;
            border-radius: 3px 3px 3px 3px;
            margin-bottom: 80px;
        }

        .imgheader {
           margin-top: 10px;
           margin-bottom: 40px;
        }

        .imgheader img {
            float: left;
            width: 48px;
            height: 48px;
        }

        .imgheader h1 {
            color: lightslategrey;
            text-align: left;
            position: relative;
            top: 9px;
            left: 10px;
        }

        .imgheader h3 {
            position: relative;
            top: 14px;
            left: -10px;
        }

        .imgheader {
           margin-top: 10px;
           margin-bottom: 40px;
        }

        .imgheader36 img {
            float: left;
            width: 36px;
            height: 36px;
        }

        .imgheader36 h1 {
            color: lightslategrey;
            text-align: left;
            position: relative;
            top: 9px;
            left: 10px;
        }

        .imgheader36 h3 {
            position: relative;
            top: 8px;
            left: -10px;
        }

        .imgminiheader img {
            position: relative;
            top: -4px;
        }

        /* Table icons */

        .ico_good,
        .ico_warn,
        .ico_error,
        .ico_ack,
        .ico_unknown {
            display:inline-block;
            text-align: center;
            width: 30px;
            height: 30px;
            line-height: 30px;
            position:relative;
        }

        .ico_good {
            color: white;
            background-color: #39ba23;
            border-radius: 50%;
            font-size: 24px;
        }
        .ico_good .icon-check {
            color: #ffffff !important;
        }
        .ico_warn {
            color: #ffa500;
            font-size: 39px;
        }
        .ico_error {
            color: white;
            background-color: #d54642;
            border-radius: 10%;
            font-size: 25px;
        }
        .ico_unknown  {
            color: white;
            background-color: rgb(26, 150, 240);
            border-radius: 50%;
            font-size: 24px;
        }
        .ico_ack {
            color: #d54642;
            font-size: 39px;
        }

        .ico_small.ico_good,
        .ico_small.ico_warn,
        .ico_small.ico_ack,
        .ico_small.ico_error,
        .ico_small.ico_unknown {
            width: 18px;
            height: 18px;
            line-height: 18px;
        }
        .ico_small.ico_good {
            font-size: 15px;
        }
        .ico_small.ico_warn {
            font-size: 26px;
            width: 20px;
        }
        .ico_small.ico_ack {
            font-size: 35px;
            width: 20px;
        }
        .ico_small.ico_error {
            font-size: 15px;
        }
        .ico_small.ico_unknown  {
            font-size: 15px;
        }

        </style>
</head>
<body class="simplexml preload locale-en" data-splunk-version="" data-splunk-product="enterprise">
<!--
BEGIN LAYOUT
This section contains the layout for the dashboard. Splunk uses proprietary
styles in <div> tags, similar to Bootstrap's grid system.
-->
<header>
    <a class="navSkip" href="#navSkip" tabindex="1">Screen reader users, click here to skip the navigation bar</a>
    <div class="header splunk-header">
        <div id="placeholder-splunk-bar">
            <a href="{{SPLUNKWEB_URL_PREFIX}}/app/launcher/home" class="brand" title="splunk &gt; listen to your data">splunk<strong>&gt;</strong></a>
        </div>
        <div id="placeholder-app-bar"></div>
    </div>
    <a id="navSkip"></a>
</header>
<div class="dashboard-body container-fluid main-section-body" data-role="main">
    <div class="dashboard-header clearfix">
        <h2>TrackMe - Data tracking system</h2>
         <p>Monitoring your Splunk data availability made easy</p>
    </div>

    <div style="display: none;" class="fieldset">
    </div>

    <!--
    Object tags
    -->

    <!-- Modal window define for identity card association -->
    <div class="modal fade custom-modal-80" id="modal_data_host_tags" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                <div class="dashboard-element html" id="body_data_host_tags">
                    <div class="panel-body html">

                        <div class="modal-header">
                            <h3 style="font-size: 18px;">Enrichment tags: <span style="color: steelblue">$tk_data_host$</span></h3>
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                        </div>
                    </div>
                </div>
                <div class="modal-body">
                    <div id="rowGetTagsDataHost" class="dashboard-row dashboard-row1">
                        <div id="panelGetTagsDataHost" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div class="imgheader36">
                                        <img style="float: left; margin: 0px 15px 15px 0px;" src="../../static/app/trackme/icons/tags.png"/></span>
                                        <h3>Object tags:</h3>
                                        <br />
                                    </div>
                                </div>

                                <div class="panel-element-row">
                                    <div id="elementGetTagsDataHost" class="dashboard-element table" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_back_data_host_tags" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window define for identity card association -->
    <div class="modal fade custom-modal-80" id="modal_metric_host_tags" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                <div class="dashboard-element html" id="body_metric_host_tags">
                    <div class="panel-body html">

                        <div class="modal-header">
                            <h3 style="font-size: 18px;">Enrichment tags: <span style="color: steelblue">$tk_metric_host$</span></h3>
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                        </div>
                    </div>
                </div>
                <div class="modal-body">
                    <div id="rowGetTagsMetricHost" class="dashboard-row dashboard-row1">
                        <div id="panelGetTagsMetricHost" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div class="imgheader36">
                                        <img style="float: left; margin: 0px 15px 15px 0px;" src="../../static/app/trackme/icons/tags.png"/></span>
                                        <h3>Object tags:</h3>
                                        <br />
                                    </div>
                                </div>

                                <div class="panel-element-row">
                                    <div id="elementGetTagsMetricHost" class="dashboard-element table" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_back_metric_host_tags" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                </div>
            </div>
        </div>
    </div>

    <!--
    identity card
    -->

    <!-- Modal drilldown context for identity card -->
    <div id="main_manage_identity_card" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade custom-modal-50" id="manage_identity_card" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_manage_identity_card">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3 style="font-size: 18px;">Identity card for data source: <span style="color: steelblue">$tk_data_name$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div style="margin-top:10px; margin-left: 20px;">

                                    <div class="imgheader">
                                        <img style="float: left; margin: 0px 15px 15px 0px;" src="../../static/app/trackme/icons/identity_card.png"/></span>
                                        <h3>Identity card note:</h3>
                                        <br />
                                    </div>

                                    <div>
                                      $tk_doc_note$
                                    </div>

                                    <div style="margin-bottom: 20px;">
                                        <h3>Link to documentation: </h3><a target="_blank" href="$tk_doc_link$">$tk_doc_link$</a>
                                    </div>
                                </div>

                            </div>
                        </div>
                    <div class="modal-footer">
                        <button type="submit" id="btn_delete_manage_identity_card" class="btn btn-default btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Delete card</button>
                        <button type="submit" id="btn_modify_manage_identity_card" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Update card</button>
                        <button type="submit" id="btn_back_manage_identity_card" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                        <button type="submit" id="btn_close_manage_identity_card" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                    </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window define for identity card -->
    <div class="modal fade custom-modal-60" id="define_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <form>
                                <fieldset>
                                    <legend>Define a link and a note to document this data source</legend>
                                    <p>
                                        <label>Optional: enter the documentation link, this will be made available in the source identity card:</label>
                                        <input type = "text"
                                               id = "input_doc_link"
                                               value = "link to documentation"
                                               style="width: 900px;"
                                               onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;"/>
                                    </p>

                                    <p>
                                        <label>Optional: enter a documentation note:</label>
                                        <textarea
                                                id = "input_doc_note"
                                                rows = "10"
                                                cols = "160" style="width: 900px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">documentation note</textarea>
                                    </p>

                                </fieldset>
                            </form>

                            <div style="float: left;">

                                <div class="btn_define_identity_card custom-btn" style="margin-right: 15px;">
                                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Create or update this record </button>
                                </div>

                                <div class="btn_associate_identity_card custom-btn" style="margin-right: 15px;">
                                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Or associate with an existing record </button>
                                </div>

                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_define_identity_card_back" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window define for identity card association -->
    <div class="modal fade custom-modal-80" id="associate_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h3>
                </div>
                <div class="modal-body">
                    <b>Associate with an existing identity card:</b>
                    <br /><br />

                    <div id="rowAssociateIdentityCard" class="dashboard-row dashboard-row3">
                        <div id="panelAssociateIdentityCard" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">

                                        <div class="input input-text" id="FilterIdentityCardTable" style="margin-bottom: 10px;">
                                            <label>Filter:</label>
                                        </div>

                                        <div id="elementIdentityCardTable" class="dashboard-element table" style="width: 100%">
                                            <label>Click on a table entry to associate with an existing identity card:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_associate_identity_card_back" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window association confirmation for identity card -->
    <div class="modal fade" id="confirm_associate_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Please confirm the association of the identity card records?</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_associate_identity_card_confirm_valid" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Confirm association </button>
                    <button type="submit" id="btn_associate_identity_card_confirm_back" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window deletion for identity card -->
    <div class="modal fade" id="delete_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Please confirm the deletion of the identity card records?</h4>
                                <p>If this record is the last associated with the identity card, this identity card will be permanently removed.</p>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_delete_identity_card_confirm" class="btn btn-default btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Delete this record </button>
                    <button type="submit" id="btn_delete_identity_card_back" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window confirmation of association for identity card -->
    <div class="modal fade" id="associate_achieved_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>The identity card record was successfully associated with this source.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window confirmation of deletion for identity card -->
    <div class="modal fade" id="update_achieved_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>The identity card record was successfully created or updated.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window confirmation of deletion for identity card -->
    <div class="modal fade" id="delete_achieved_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>The identity card record was successfully deleted.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window for ack -->
    <div class="modal fade custom-modal-80" id="confirm_ack" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Acknowledge active alert </h3>
                </div>

                <div class="modal-body">

                    <div id="rowAckGet" class="dashboard-row dashboard-row3">
                        <div id="panelAckGet" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div>
                                        <h4>Do you want to acknowledge this alert?</h4>

                                        <p>When an active alert is acknowledged, it remains visible in the user interface and monitored, therefore no more
                                        alerts will be generated based on the builtin alerting for that source.
                                        <br /><br />
                                        An acknowledgment is valid for a period of time, and will be disabled automatically once its expiration time has been reached.
                                        <br />
                                        If an active acknowledgment is acknowledged again, its expiration is extended for a new cycle.
                                        <br /><br />
                                        An acknowledgment is automatically disabled when the source flips again to a green state.
                                        <br /><br />
                                        <b>Click on Confirm Ack to acknowledge this alert (if Ack is inactive), or click on the table entry if the Ack is active and you wish to disable it now.</b>
                                        </p>

                                    </div>

                                    <div class="fieldset">

                                        <div id="elementAckGet" class="dashboard-element table" style="width: 100%">
                                            <label>Current Ack status:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                        <br />
                                        <br />

                                        <div class="input input-dropdown" id="input_ack_duration">
                                            <label>Ack duration:</label>
                                        </div>

                                        <br />
                                        <br />

                                        <div>
                                            <p>
                                                <label>Optional: enter a note of this acknowledgment. <br />
                                                    This note will be logged and made available for notification.</label>
                                                <textarea
                                                        id = "input_ack_comment"
                                                        rows = "6"
                                                        cols = "160" style="width: 500px;"
                                                        onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                            </p>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <div style="margin-right: 15px; float: right;">
                        <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                    </div>
                    <div class="btn_ack_confirm_valid" style="margin-right: 15px; float: right;">
                        <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Confirm Ack </button>
                    </div>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window confirmation of association for identity card -->
    <div class="modal fade" id="ack_achieved" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Acknowledge active alert </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Alert acknowledgment was successfully created.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <div class="modal fade" id="ack_disable_achieved" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Acknowledge active alert </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Alert acknowledgment was successfully disabled.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <div class="modal fade" id="ack_disable_already" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Acknowledge active alert </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Alert acknowledgment is already inactive.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window for ack -->
    <div class="modal fade" id="disable_ack" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Acknowledge active alert </h3>
                </div>

                <div class="modal-body">

                    <div id="rowAckDelete" class="dashboard-row dashboard-row3">
                        <div id="panelAckDelete" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div>
                                        <h4>Do you want to disable this acknowledge ?</h4>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <div style="margin-right: 15px; float: right;">
                        <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                    </div>
                    <div class="btn_ack_disable_valid" style="margin-right: 15px; float: right;">
                        <button type="submit" class="btn btn-default btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Disable Ack </button>
                    </div>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window for logical group association -->
    <div class="modal fade custom-modal-80" id="logical_group" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Logical group </h3>
                </div>
                <div class="modal-body">
                    <b>Entities logical group management</b>
                    <br /><br />

                    <div id="rowAddLogicalGroup" class="dashboard-row dashboard-row" data-depends="$show_add_logical_group$">
                        <div id="panelAddLogicalGroup" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">This entity is not currently associated to a logical group, choose one of the following options:</h3>

                                        <div style="margin-top: 20px;">
                                            <div style="float: left; margin-right: 20px;">
                                                <button type="submit" id="btn_add_logical_group_new" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Create a new group </button>
                                            </div>
                                            <div style="float: left; margin-right: 20px;">
                                                <button type="submit" id="btn_add_logical_group_member" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add to an existing group </button>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowTableLogicalGroup" class="dashboard-row dashboard-row3" data-depends="$show_table_logical_group$">
                        <div id="panelTableLogicalGroup" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">This entity is currently associated with the following logical group, if you wish to remove this
                                            membership, click on the table entry bellow:</h3>
                                    </div>

                                    <div class="fieldset">

                                        <div id="elementLogicalGroupTable" class="dashboard-element table" style="width: 100%">
                                            <label></label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_associate_logical_group_back" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window for logical group association -->
    <div class="modal fade custom-modal-80" id="logical_group_add_member" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Logical group </h3>
                </div>
                <div class="modal-body">
                    <b>Entities logical group management</b>
                    <br /><br />

                    <div id="rowTableLogicalGroupAddMember" class="dashboard-row dashboard-row3">
                        <div id="panelTableLogicalGroupAddMember" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">Click on a logical group in the table bellow to make this entity part of the group.
                                        Optionally use the filter input to search in existing groups.</h3>
                                    </div>

                                    <div class="fieldset">

                                        <div class="input input-text" id="FilterLogicalGroupTable" style="margin-bottom: 10px;">
                                            <label>Filter:</label>
                                        </div>

                                        <div id="elementLogicalGroupTableAddMember" class="dashboard-element table" style="width: 100%">
                                            <label></label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_associate_logical_group_add_member_back" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window for logical group association -->
    <div class="modal fade custom-modal-50" id="logical_group_add_group" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Logical group </h3>
                </div>
                <div class="modal-body">
                    <b>Entities logical group management</b>
                    <br /><br />

                    <div id="rowTableLogicalGroupAddGroup" class="dashboard-row dashboard-row3">
                        <div id="panelTableLogicalGroupAddGroup" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">Create a new logical group, once created the current entity will automatically member of it.
                                            You can then add as many members as you need to form the logical group entity.
                                        </h3>
                                    </div>

                                    <div class="fieldset">
                                        <div class="input input-text" id="InputLogicalGroupName" style="margin-bottom: 10px;">
                                            <label>Enter the logical group name:</label>
                                        </div>
                                    </div>
                                    <div class="fieldset">
                                        <div class="input input-dropdown" id="InputLogicalGroupNamePercent" style="margin-bottom: 10px;">
                                            <label>Minimal percent of members in green state:</label>
                                        </div>
                                        <div style="margin-top: 10px;">
                                            <p>A logical group of 2 members with a minimal 50% green state means one member actively generating data will not trigger alerts.</p>
                                        </div>
                                    </div>

                                    <div class="modal-body" style="margin-top: 20px;">
                                        <button type="submit" id="btn_associate_logical_group_add_group" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Create new logical group </button>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer" style="margin-top: 20px;">
                    <button type="submit" id="btn_associate_logical_group_add_group_back" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window Logical group removal -->
    <div class="modal fade" id="confirm_remove_from_logical_group" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Logical group </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Do you want to remove this entity from the logical group?</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_remove_from_logical_group_confirm_valid" class="btn btn-default btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove association </button>
                    <button type="submit" id="btn_remove_from_logical_group_confirm_back" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back </button>
                </div>

            </div>

        </div>
    </div>

    <div class="modal fade" id="logical_group_removal_achieved" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Logical group </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Logical group membership was successfully removed.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window Logical group removal -->
    <div class="modal fade" id="confirm_add_member_logical_group" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Logical group </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Do you want to add the entity in the logical group?</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_add_logical_group_member_confirm_valid" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Confirm membership </button>
                    <button type="submit" id="btn_add_logical_group_member_confirm_back" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back </button>
                </div>

            </div>

        </div>
    </div>

    <div class="modal fade" id="logical_group_add_member_achieved" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Logical group </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Logical group membership was successfully achieved.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <div class="modal fade" id="logical_group_add_achieved" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Logical group </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Logical group has been successfully created, and entity associated.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal drilldown context for Alerts -->
    <div id="main_modal_manage" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade custom-modal-80" id="modal_manage" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3 style="font-size: 18px;">Actions for data source: <span style="color: steelblue">$tk_data_name$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div style="line-height: 1.1; margin-left: 20px;">
                                    <div style="float:left;width:33%;">
                                        <p><b>data_index:</b> $tk_data_index$</p>
                                        <p><b>data_sourcetype:</b> $tk_data_sourcetype$</p>
                                        <p><b>lag event / lag ingestion: ([D+]HH:MM:SS)</b> $tk_data_lag_summary$</p>
                                        <p><b>data_last_time_seen:</b> $tk_data_last_time_seen_human$</p>
                                    </div>
                                    <div style="float:left;width:33%;">
                                        <p><b>data_last_ingest:</b> $tk_data_last_ingest_human$</p>
                                        <p><b>data_max_lag_allowed:</b> $tk_data_max_lag_allowed$</p>
                                        <p><b>data_monitored_state:</b> <span class="$tk_data_monitored_state_class$">$tk_data_monitored_state$</span></p>
                                        <p><b>data_monitoring_level:</b> $tk_data_monitoring_level$</p>
                                    </div>
                                    <div style="float:left;width:33%;">
                                        <p><b>latest_flip_time:</b> $tk_latest_flip_time_human$</p>
                                        <p><b>latest_flip_state:</b> $tk_latest_flip_state$</p>
                                        <p><b>state:</b> <span class="$tk_data_source_state_class$">$tk_data_source_state$</span></p>
                                        <p><b>priority:</b> <span class="$tk_priority_class$">$tk_priority$</span></p>
                                    </div>
                                </div>

                                <div style="margin-left: 10px;">
                                    <div class="imgheader">
                                        <img style="float: left; margin: 0px 15px 15px 0px;" src="../../static/app/trackme/icons/identity_card.png"/>
                                        <h3><a id="doc_link_data_source" data-toggle="modal" data-target="#$tk_doc_modal_target$">$tk_doc_link_main$</a></h3>
                                    </div>
                                </div>

                            </div>
                        </div>

                        <div>
                            <hr width="100%" size="8" align="center">
                        </div>

                        <div class="boxnotify" id="boxnotify-data-source">
                        </div>

                        <div id="rowLinkMain" class="dashboard-row dashboard-row1" style="margin-left: 15px; margin-top: -20px;">
                            <div id="panelLinktMain" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="input input-linklist" id="inputLinkDataSource">
                                            <label>&nbsp;</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowSingleLag" class="dashboard-row dashboard-row1" data-depends="$show_data_source_overview$">
                            <div id="panelSingleLag2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementSingleLagPerc95" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                        <div id="elementSingleLagAvg" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                        <div id="elementSingleSLApct" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartLag" class="dashboard-row dashboard-row1" data-depends="$show_data_source_overview$">
                            <div id="panelChartLag2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementChartLag" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartOutlier" class="dashboard-row dashboard-row1" data-depends="$show_data_source_outlier$">
                            <div id="panelChartOutlier2" class="dashboard-cell" style="width: 100%; max-height: 350px;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementOutlier" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowTableOutlier" class="dashboard-row dashboard-row1" data-depends="$show_data_source_outlier$">
                            <div id="panelTableOutlier2" class="dashboard-cell" style="width: 100%; max-height: 90px;">
                                <div class="dashboard-panel clearfix">

                                    <div class="panel-element-row">
                                        <div id="elementOutlierTable" class="dashboard-element table" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowOutlierConfig" class="dashboard-row dashboard-row1" data-depends="$show_data_source_outlier_configuration$">
                            <div id="panelOutlierConfig" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">

                                    <div style="margin-left: 30px;" class="fieldset">
                                        <div class="input input-dropdown" id="inputDataSourceConfigOutlierEnableOutlier">
                                            <label>Enable Outlier Detection:</label>
                                        </div>
                                        <div class="input input-dropdown" id="inputDataSourceConfigOutlierAlertOnUpper">
                                            <label>Enable alert on upper Outlier:</label>
                                        </div>
                                        <div class="input input-dropdown" id="inputDataSourceConfigOutlierOutlierMinEventCountMode">
                                            <label>OutlierMinEventCount mode:</label>
                                        </div>
                                        <div style="max-width: 165px;" class="input input-text" id="inputDataSourceConfigOutlierOutlierMinEventCount">
                                            <label>OutlierMinEventCount:</label>
                                        </div>
                                        <div style="max-width: 165px;" class="input input-text" id="inputDataSourceConfigOutlierOutlierLowerThresholdMultiplier">
                                            <label>Lower threshold multiplier:</label>
                                        </div>
                                        <div style="max-width: 165px;" class="input input-text" id="inputDataSourceConfigOutlierOutlierUpperThresholdMultiplier">
                                            <label>Upper threshold multiplier:</label>
                                        </div>
                                    </div>

                                    <div style="margin-left: 42px; margin-right: 42px;">
                                        <button type="submit" id="btn_outlier_config_data_source_save" role="button" style="margin-right: 15px;" class="btn btn-primary btn-default pull-right"><span class="glyphicon glyphicon-remove"></span>Save Outliers settings</button>
                                        <button type="submit" id="btn_outlier_config_data_source_simulate" role="button" style="margin-right: 15px;" class="btn btn-primary btn-default pull-right"><span class="glyphicon glyphicon-remove"></span>Simulate Outliers settings</button>
                                    </div>

                                    <div class="boxnotify" id="boxnotify-data-source-outliers-update">
                                    </div>

                                </div>
                            </div>
                        </div>

                        <div id="rowOutlierConfigChartSimulation" class="dashboard-row dashboard-row1" data-depends="$show_data_source_outlier_configuration$, $start_outliers_simulation_data_source$">
                            <div id="panelOutlierConfigChartSimulation" class="dashboard-cell" style="width: 100%; max-height: 350px;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementOutlierSimulation" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowSingleParsingQuality" class="dashboard-row dashboard-row1" data-depends="$show_data_quality$,$show_data_quality_no_results$">
                            <div id="panelSingleParsingQuality" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementSearchDataSourceParsingQualitySingle" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartParsingQuality" class="dashboard-row dashboard-row1" data-depends="$show_data_quality$,$show_data_quality_no_results$">
                            <div id="panelChartParsingQuality" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="panel-head">
                                            <h3>CAUTION: Indexing time parsing errors happen on the sourcetype level, if this sourcetype is indexing to more than one index, these errors may not apply to this index / sourcetype combination</h3>
                                        </div>
                                        <div id="elementSearchDataSourceParsingQualityChart" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartParsingQualityNoResults" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_data_quality$" data-rejects="$show_data_quality_no_results$">
                            <div id="panelChartParsingQualityNoResults" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div class="dashboard-element html" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="status_message_green">
                                                    <h2 style="font-weight: bold;">No indexing parsing errors detected within the period</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowLaggingMetricsDataSource" class="dashboard-row dashboard-row1" data-original-id="rowAuditChangesDataSourceTop" data-depends="$show_data_source_lagging_metrics$">
                            <div id="panelLaggingMetricsDataSourceChart" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="chartLaggingMetricDataSourceOverTime" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-head">
                                                <h3>lag_ingestion_sec: delta between index time and latest event timestamp, lag_event_sec: delta between now when the measure is taken, and the latest event timestamp</h3>
                                            </div>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditFlipDataSource" class="dashboard-row dashboard-row1" data-original-id="rowAuditFlipDataSourceTop" data-depends="$show_flipping_status$,$show_flipping_status_no_results$">
                            <div id="panelAuditFlipDataSourceChart" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="chartAuditFlipDataSourceOverTime" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-head">
                                                <h3>Flip over time</h3>
                                            </div>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditFlipDataSourceTable" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_flipping_status$,$show_flipping_status_no_results$">
                            <div id="panelAuditFlipDataSourceTable" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div id="elementMainTableAuditFlipDataSource" class="dashboard-element table" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditFlipDataSourceNoResults" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_flipping_status$" data-rejects="$show_flipping_status_no_results$">
                            <div id="panelAuditFlipDataSourceNoResults" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div class="dashboard-element html" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="status_message_green">
                                                    <h2 style="font-weight: bold;">No flipping status detected within the period</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowStatusMessageDataSource" class="dashboard-row dashboard-row2" data-depends="$show_data_source_status_message$">
                            <div id="panelStatusMessageDataSource" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">

                                    <div class="panel-element-row">
                                        <div class="dashboard-element html" id="body_data_source_status_message" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="$tk_data_source_status_message_class$">
                                                    <h2 style="font-weight: bold;">$tk_status_message$</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditChangesDataSource" class="dashboard-row dashboard-row1" data-original-id="rowAuditChangesDataSourceTop" data-depends="$show_data_source_audit_changes$,$show_data_source_audit_changes_no_results$">
                            <div id="panelAuditChangesDataSourceChart" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="chartAuditChangesDataSourceOverTime" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-head">
                                                <h3>Changes over time</h3>
                                            </div>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditChangesDataSourceTable" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_data_source_audit_changes$,$show_data_source_audit_changes_no_results$">
                            <div id="panelAuditChangesDataSourceTable" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div id="elementMainTableAuditChangesDataSource" class="dashboard-element table" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditChangesDataSourceNoResults" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_data_source_audit_changes$" data-rejects="$show_data_source_audit_changes_no_results$">
                            <div id="panelAuditChangesDataSourceNoResults" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div class="dashboard-element html" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="status_message_green">
                                                    <h2 style="font-weight: bold;">No audit changes detected within the period</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowLinkLag" class="dashboard-row dashboard-row1" style="margin-left: 15px;" data-rejects="$show_data_source_status_message$,$show_data_source_outlier_configuration$">
                            <div id="panelLinktLag2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="input input-linklist" id="inputLinkTime">
                                            <label>&nbsp;</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowLinkInputsOutlierConfigurationDataSource" class="dashboard-row dashboard-row1" style="margin-left: 15px;" data-depends="$show_data_source_outlier_configuration$">
                            <div id="panelLinkInputsOutlierConfigurationDataSource1" class="dashboard-cell" style="width: 50%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="fieldset">

                                        <div class="input input-linklist" id="LinkTimeOutlierConfigurationDataSource">
                                            <label>Select the time period for outliers detection, this period will be saved and used to restrict the calculations</label>
                                        </div>

                                    </div>

                                </div>
                            </div>
                            <div id="panelLinkInputsOutlierConfigurationDataSource2" class="dashboard-cell" style="width: 50%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="fieldset">

                                        <div class="input input-linklist" id="LinkTimeOutlierConfigurationDataSourceSpan">
                                            <label>Select the span for outliers rendering, this value will be saved and used for rendering purposes</label>
                                        </div>

                                    </div>

                                </div>
                            </div>
                        </div>

                        <div class="modal-footer">
                            <div style="margin-right: 15px; float: left;">
                                <button type="submit" id="btn_refresh_data_source" role="button" class="btn btn-primary btn-default pull-left"><span class="glyphicon glyphicon-remove"></span>Refresh</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <a class="btn btn-primary" id="btn_search_data_source" target="_blank" href="search_data_source_url" role="button">Search</a>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_modify_data_source" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Modify</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_delete_data_source" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_disable_monitoring" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Disable</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_enable_monitoring" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Enable</button>
                            </div>
                            <div class="btn_ack" style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_ack_data_source" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Acknowledge alert</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Alerts -->
    <div id="main_modal_manage_host" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade custom-modal-80" id="modal_manage_host" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_host">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3 style="font-size: 18px;">Actions for data host: <span style="color: steelblue">$tk_data_host$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div style="line-height: 1.1; margin-left: 20px;">
                                    <div style="float:left;width:33%;">
                                        <p><b>lag event / lag ingestion: ([D+]HH:MM:SS)</b> $tk_data_lag_summary$</p>
                                        <p><b>data_last_time_seen:</b> $tk_data_last_time_seen_human$</p>
                                        <p><b>data_last_ingest:</b> $tk_data_last_ingest_human$</p>
                                    </div>
                                    <div style="float:left;width:33%;">
                                        <p><b>data_max_lag_allowed:</b> $tk_data_max_lag_allowed$</p>
                                        <p><b>data_monitored_state:</b> <span class="$tk_data_monitored_state_class$">$tk_data_monitored_state$</span></p>
                                        <p><b>data_host_state:</b> <span class="$tk_data_host_state_class$">$tk_data_host_state$</span></p>
                                    </div>
                                    <div style="float:left;width:33%;">
                                        <p><b>latest_flip_time:</b> $tk_latest_flip_time_human$</p>
                                        <p><b>latest_flip_state:</b> $tk_latest_flip_state$</p>
                                        <p><b>priority:</b> <span class="$tk_priority_class$">$tk_priority$</span></p>
                                    </div>
                                </div>
                                <div style="margin-left: 10px;">
                                    <div class="imgheader36">
                                        <img style="float: left; margin: 0px 15px 15px 0px;" src="../../static/app/trackme/icons/tags.png"/>
                                        <h3><a id="link_data_host_tags" data-toggle="modal" data-target="#modal_data_host_tags">Show object tags</a></h3>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <hr width="100%" size="8" align="center">
                        </div>

                        <div class="boxnotify" id="boxnotify-data-host">
                        </div>

                        <div id="rowLinkMainHost" class="dashboard-row dashboard-row1" style="margin-left: 15px; margin-top: -20px;">
                            <div id="panelLinktMainHost" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="input input-linklist" id="inputLinkDataHost">
                                            <label>&nbsp;</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowSingleLagHost" class="dashboard-row dashboard-row1" data-depends="$show_data_host_overview$">
                            <div id="panelSingleLagHost2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementSingleLagHostPerc95" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                        <div id="elementSingleLagHostAvg" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                        <div id="elementSingleSLAHostpct" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartLagHost" class="dashboard-row dashboard-row1" data-depends="$show_data_host_overview$">
                            <div id="panelChartLagHost2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementChartHostIndexes" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="panelChartLagHost3" class="dashboard-cell" style="width: 100%;" data-depends="$show_data_host_overview$">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementChartHostSourcetypes" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartLagHostOverTime" class="dashboard-row dashboard-row1" data-depends="$show_data_host_overview$">
                            <div id="panelChartLagHostOverTime2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementChartLagHostOverTime" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartOutlierDataHost" class="dashboard-row dashboard-row1" data-depends="$show_data_host_outlier$">
                            <div id="panelChartOutlierDataHost2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementOutlierDataHost" class="dashboard-element chart" style="width: 100%; max-height: 350px;">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowTableOutlierDataHost" class="dashboard-row dashboard-row1" data-depends="$show_data_host_outlier$">
                            <div id="panelTableOutlierDataHost2" class="dashboard-cell" style="width: 100%; max-height: 90px;">
                                <div class="dashboard-panel clearfix">

                                    <div class="panel-element-row">
                                        <div id="elementOutlierTableDataHost" class="dashboard-element table" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowOutlierConfigDataHost" class="dashboard-row dashboard-row1" data-depends="$show_data_host_outlier_configuration$">
                            <div id="panelOutlierConfigDataHost" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">

                                    <div style="margin-left: 30px;" class="fieldset">
                                        <div class="input input-dropdown" id="inputDataHostConfigOutlierEnableOutlier">
                                            <label>Enable Outlier Detection:</label>
                                        </div>
                                        <div class="input input-dropdown" id="inputDataHostConfigOutlierAlertOnUpper">
                                            <label>Enable alert on upper Outlier:</label>
                                        </div>
                                        <div class="input input-dropdown" id="inputDataHostConfigOutlierOutlierMinEventCountMode">
                                            <label>OutlierMinEventCount mode:</label>
                                        </div>
                                        <div style="max-width: 165px;" class="input input-text" id="inputDataHostConfigOutlierOutlierMinEventCount">
                                            <label>OutlierMinEventCount:</label>
                                        </div>
                                        <div style="max-width: 165px;" class="input input-text" id="inputDataHostConfigOutlierOutlierLowerThresholdMultiplier">
                                            <label>Lower threshold multiplier:</label>
                                        </div>
                                        <div style="max-width: 165px;" class="input input-text" id="inputDataHostConfigOutlierOutlierUpperThresholdMultiplier">
                                            <label>Upper threshold multiplier:</label>
                                        </div>
                                    </div>

                                    <div style="margin-left: 42px; margin-right: 42px;">
                                        <button type="submit" id="btn_outlier_config_data_host_save" role="button" style="margin-right: 15px;" class="btn btn-primary btn-default pull-right"><span class="glyphicon glyphicon-remove"></span>Save Outliers settings</button>
                                        <button type="submit" id="btn_outlier_config_data_host_simulate" role="button" style="margin-right: 15px;" class="btn btn-primary btn-default pull-right"><span class="glyphicon glyphicon-remove"></span>Simulate Outliers settings</button>
                                    </div>

                                    <div class="boxnotify" id="boxnotify-data-host-outliers-update">
                                    </div>

                                </div>
                            </div>
                        </div>

                        <div id="rowOutlierConfigChartSimulationDataHost" class="dashboard-row dashboard-row1" data-depends="$show_data_host_outlier_configuration$, $start_outliers_simulation_data_host$">
                            <div id="panelOutlierConfigChartSimulationDataHost" class="dashboard-cell" style="width: 100%; max-height: 350px;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementOutlierSimulationDataHost" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowSingleParsingQualityDataHost" class="dashboard-row dashboard-row1" data-depends="$show_data_host_quality$,$show_data_host_quality_no_results$">
                            <div id="panelSingleParsingQualityDataHost" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementSearchDataHostParsingQualitySingle" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartParsingQualityDataHost" class="dashboard-row dashboard-row1" data-depends="$show_data_host_quality$,$show_data_host_quality_no_results$">
                            <div id="panelChartParsingQualityDataHost" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="panel-head">
                                        </div>
                                        <div id="elementSearchDataHostParsingQualityChart" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartParsingQualityDataHostNoResults" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_data_host_quality$" data-rejects="$show_data_host_quality_no_results$">
                            <div id="panelChartParsingQualityDataHostNoResults" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div class="dashboard-element html" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="status_message_green">
                                                    <h2 style="font-weight: bold;">No indexing parsing errors detected within the period</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowLaggingMetricsDataHost" class="dashboard-row dashboard-row1" data-original-id="rowLaggingMetricsDataHost" data-depends="$show_data_host_lagging_metrics$">
                            <div id="panelLaggingMetricsDataHostChart" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="chartLaggingMetricDataHostOverTime" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-head">
                                                <h3>lag_ingestion_sec: delta between index time and latest event timestamp, lag_event_sec: delta between now when the measure is taken, and the latest event timestamp</h3>
                                            </div>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditFlipDataHost" class="dashboard-row dashboard-row1" data-original-id="rowAuditFlipDataHostTop" data-depends="$show_data_host_flipping_status$,$show_data_host_flipping_status_no_results$">
                            <div id="panelAuditFlipDataHostChart" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="chartAuditFlipDataHostOverTime" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-head">
                                                <h3>Flip over time</h3>
                                            </div>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditFlipDataHostTable" class="dashboard-row dashboard-rowDataHostsTable" data-depends="$show_data_host_flipping_status$,$show_data_host_flipping_status_no_results$">
                            <div id="panelAuditFlipDataHostTable" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div id="elementMainTableAuditFlipDataHost" class="dashboard-element table" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditFlipDataHostNoResults" class="dashboard-row dashboard-rowDataHostsTable" data-depends="$show_data_host_flipping_status$" data-rejects="$show_data_host_flipping_status_no_results$">
                            <div id="panelAuditFlipDataHostNoResults" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div class="dashboard-element html" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="status_message_green">
                                                    <h2 style="font-weight: bold;">No flipping status detected within the period</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowStatusMessageDataHost" class="dashboard-row dashboard-row2" data-depends="$show_data_host_status_message$">
                            <div id="panelStatusMessageDataHost" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">

                                    <div class="panel-element-row">
                                        <div class="dashboard-element html" id="body_data_host_status_message" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="$tk_data_host_status_message_class$">
                                                    <h2 style="font-weight: bold;">$tk_status_message$</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditChangesDataHost" class="dashboard-row dashboard-row1" data-original-id="rowAuditChangesDataHostTop" data-depends="$show_data_host_audit_changes$,$show_data_host_audit_changes_no_results$">
                            <div id="panelAuditChangesDataHostChart" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="chartAuditChangesDataHostOverTime" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-head">
                                                <h3>Changes over time</h3>
                                            </div>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditChangesDataHostTable" class="dashboard-row dashboard-rowDataHostsTable" data-depends="$show_data_host_audit_changes$,$show_data_host_audit_changes_no_results$">
                            <div id="panelAuditChangesDataHostTable" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div id="elementMainTableAuditChangesDataHost" class="dashboard-element table" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditChangesDataHostNoResults" class="dashboard-row dashboard-rowDataHostsTable" data-depends="$show_data_host_audit_changes$" data-rejects="$show_data_host_audit_changes_no_results$">
                            <div id="panelAuditChangesDataHostNoResults" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div class="dashboard-element html" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="status_message_green">
                                                    <h2 style="font-weight: bold;">No audit changes detected within the period</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowLinkLagHost" class="dashboard-row dashboard-row1" style="margin-left: 15px;" data-rejects="$show_data_host_status_message$,$show_data_host_outlier_configuration$">
                            <div id="panelLinktLagHost2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="input input-linklist" id="inputLinkTimeHost">
                                            <label>&nbsp;</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowLinkInputsOutlierConfigurationDataHost" class="dashboard-row dashboard-row1" style="margin-left: 15px;" data-depends="$show_data_host_outlier_configuration$">
                            <div id="panelLinkInputsOutlierConfigurationDataHost1" class="dashboard-cell" style="width: 50%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="fieldset">

                                        <div class="input input-linklist" id="LinkTimeOutlierConfigurationDataHost">
                                            <label>Select the time period for outliers detection, this period will be saved and used to restrict the calculations</label>
                                        </div>

                                    </div>

                                </div>
                            </div>
                            <div id="panelLinkInputsOutlierConfigurationDataHost2" class="dashboard-cell" style="width: 50%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="fieldset">

                                        <div class="input input-linklist" id="LinkTimeOutlierConfigurationDataHostSpan">
                                            <label>Select the span for outliers rendering, this value will be saved and used for rendering purposes</label>
                                        </div>

                                    </div>

                                </div>
                            </div>
                        </div>

                        <div class="modal-footer">
                            <div style="margin-right: 15px; float: left;">
                                <button type="submit" id="btn_refresh_data_host" role="button" class="btn btn-primary btn-default pull-left"><span class="glyphicon glyphicon-remove"></span>Refresh</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <a class="btn btn-primary" id="btn_search_data_host" target="_blank" href="search_data_source_url" role="button">Search</a>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_modify_data_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Modify</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_delete_data_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_disable_monitoring_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Disable</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_enable_monitoring_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Enable</button>
                            </div>
                            <div class="btn_ack" style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_ack_data_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Acknowledge alert</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Alerts -->
    <div id="main_modal_manage_metric_host" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade custom-modal-80" id="modal_manage_metric_host" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_metric_host">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3 style="font-size: 18px;">Actions for metric host: <span style="color: steelblue">$tk_metric_host$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div style="line-height: 1.1; margin-left: 20px;">
                                    <div style="float:left;width:25%;">
                                        <p><b>metric_last_lag_seen:</b> $tk_metric_last_lag_seen$</p>
                                        <p><b>metric_last_time_seen:</b> $tk_metric_last_time_seen_human$</p>
                                    </div>
                                    <div style="float:left;width:25%;">
                                        <p><b>metric_monitored_state:</b> <span class="$tk_metric_monitored_state_class$">$tk_metric_monitored_state$</span></p>
                                        <p><b>metric_host_state:</b> <span class="$tk_metric_host_state_class$">$tk_metric_host_state$</span></p>
                                    </div>
                                    <div style="float:left;width:25%;">
                                        <p><b>latest_flip_time:</b> $tk_latest_flip_time_human$</p>
                                        <p><b>latest_flip_state:</b> $tk_latest_flip_state$</p>
                                    </div>
                                    <div style="float:left;width:25%;">
                                        <p><b>priority:</b> <span class="$tk_priority_class$">$tk_priority$</span></p>
                                    </div>
                                </div>
                                <div style="margin-left: 10px;">
                                    <div class="imgheader36">
                                        <img style="float: left; margin: 0px 15px 15px 0px;" src="../../static/app/trackme/icons/tags.png"/>
                                        <h3><a id="link_metric_host_tags" data-toggle="modal" data-target="#modal_metric_host_tags">Show object tags</a></h3>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <hr width="100%" size="8" align="center">
                        </div>

                        <div class="boxnotify" id="boxnotify-metric-host">
                        </div>

                        <div id="rowLinkMainMetricHost" class="dashboard-row dashboard-row1" style="margin-left: 15px; margin-top: -20px;">
                            <div id="panelLinktMainMetricHost" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="input input-linklist" id="inputLinkMetricHost">
                                            <label>&nbsp;</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowHostMetricChart" class="dashboard-row dashboard-row1" data-depends="$show_metric_host_overview$">
                            <div id="panelHostMetricSingle" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementHostSingleMetricHost" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="panelHostMetricChart" class="dashboard-cell" style="width: 100%;" data-depends="$show_metric_host_overview$">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementHostChartMetricHost" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="panelHostMetricSLApct" class="dashboard-cell" style="width: 100%;" data-depends="$show_metric_host_overview$">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementSingleSLAMetricHostpct" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowHostMetricTable" class="dashboard-row dashboard-row3" data-depends="$show_metric_host_overview$">
                            <div id="panelHostMetricTable" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="fieldset">
                                            <div id="elementHostTableMetricHost" class="dashboard-element table" style="width: 100%">
                                                <label>Metrics availability table:</label>
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditFlipMetricHost" class="dashboard-row dashboard-row1" data-original-id="rowAuditFlipMetricHostTop" data-depends="$show_metric_host_flipping_status$,$show_metric_host_flipping_status_no_results$">
                            <div id="panelAuditFlipMetricHostChart" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="chartAuditFlipMetricHostOverTime" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-head">
                                                <h3>Flip over time</h3>
                                            </div>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditFlipMetricHostTable" class="dashboard-row dashboard-rowMetricHostsTable" data-depends="$show_metric_host_flipping_status$,$show_metric_host_flipping_status_no_results$">
                            <div id="panelAuditFlipMetricHostTable" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div id="elementMainTableAuditFlipMetricHost" class="dashboard-element table" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditFlipMetricHostNoResults" class="dashboard-row dashboard-rowMetricHostsTable" data-depends="$show_metric_host_flipping_status$" data-rejects="$show_metric_host_flipping_status_no_results$">
                            <div id="panelAuditFlipMetricHostNoResults" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div class="dashboard-element html" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="status_message_green">
                                                    <h2 style="font-weight: bold;">No flipping status detected within the period</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowStatusMessageMetricHost" class="dashboard-row dashboard-row2" data-depends="$show_metric_host_status_message$">
                            <div id="panelStatusMessageMetricHost" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">

                                    <div class="panel-element-row">
                                        <div class="dashboard-element html" id="body_metric_host_status_message" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="$tk_metric_host_status_message_class$">
                                                    <h2 style="font-weight: bold;">$tk_status_message$</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditChangesMetricHost" class="dashboard-row dashboard-row1" data-original-id="rowAuditChangesMetricHostTop" data-depends="$show_metric_host_audit_changes$,$show_metric_host_audit_changes_no_results$">
                            <div id="panelAuditChangesMetricHostChart" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="chartAuditChangesMetricHostOverTime" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-head">
                                                <h3>Changes over time</h3>
                                            </div>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditChangesMetricHostTable" class="dashboard-row dashboard-rowMetricHostsTable" data-depends="$show_metric_host_audit_changes$,$show_metric_host_audit_changes_no_results$">
                            <div id="panelAuditChangesMetricHostTable" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div id="elementMainTableAuditChangesMetricHost" class="dashboard-element table" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowAuditChangesMetricHostNoResults" class="dashboard-row dashboard-rowMetricHostsTable" data-depends="$show_metric_host_audit_changes$" data-rejects="$show_metric_host_audit_changes_no_results$">
                            <div id="panelAuditChangesMetricHostNoResults" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">

                                        <div class="dashboard-element html" style="width: 100%">
                                            <div class="panel-body html">
                                                <div class="status_message_green">
                                                    <h2 style="font-weight: bold;">No audit changes detected within the period</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowLinkTimeMetricHost" class="dashboard-row dashboard-row1" style="margin-left: 15px;" data-rejects="$show_metric_host_overview$,$show_metric_host_status_message$">
                            <div id="panelLinkTimeMetricHost" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="input input-linklist" id="inputLinkTimeMetricHost">
                                            <label>&nbsp;</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <hr width="100%" size="8" align="center">
                        </div>

                        <div class="modal-footer">
                            <div style="margin-right: 15px; float: left;">
                                <button type="submit" id="btn_refresh_metric_host" role="button" class="btn btn-primary btn-default pull-left"><span class="glyphicon glyphicon-remove"></span>Refresh</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <a class="btn btn-primary" id="btn_search_metric_host_live_report" target="_blank" href="search_metric_source_live_report_url" role="button">Metrics live report</a>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <a class="btn btn-primary" id="btn_search_metric_host" target="_blank" href="search_metric_source_url" role="button">Metrics mcatalog report</a>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <a class="btn btn-primary" id="btn_msearch_metric_host" target="_blank" href="search_data_source_url" role="button">Search (msearch)</a>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_modify_metric_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Modify</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_delete_metric_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_disable_monitoring_metric_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Disable</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_enable_monitoring_metric_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Enable</button>
                            </div>
                            <div class="btn_ack" style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_ack_metric_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Acknowledge alert</button>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Indexers Queues -->
    <div id="main_modal_queues" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade modal-big" id="modal_queues" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_queues">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3 style="font-size: 18px;">Splunk indexers queues:</h3>
                                    <button type="button" id="btn_ops_index_queue_close" class="close" data-dismiss="modal">&times;</button>
                                </div>
                            </div>
                        </div>
                        <div class="modal-guts">
                            <div id="rowLinkQueues" class="dashboard-row dashboard-row1" style="margin-left: 15px;">
                                <div id="panelLinkQueues" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div class="input input-linklist" id="inputLinkQueuesTime">
                                                <label>&nbsp;</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowChartQueues1" class="dashboard-row dashboard-row1">
                                <div id="panelChartQueues1" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div id="elementChartQueue1" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-head">
                                                    <h3>1 - Splunk Tcpin Queue</h3>
                                                </div>
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowChartQueues2" class="dashboard-row dashboard-row1">
                                <div id="panelChartQueues2" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div id="elementChartQueue2" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-head">
                                                    <h3>2 - Parsing Queue</h3>
                                                </div>
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowChartQueues3" class="dashboard-row dashboard-row1">
                                <div id="panelChartQueues3" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div id="elementChartQueue3" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-head">
                                                    <h3>3 - Aggregation Queue</h3>
                                                </div>
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowChartQueues4" class="dashboard-row dashboard-row1">
                                <div id="panelChartQueues4" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div id="elementChartQueue4" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-head">
                                                    <h3>4 - Typing Queue</h3>
                                                </div>
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowChartQueues5" class="dashboard-row dashboard-row1">
                                <div id="panelChartQueues5" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div id="elementChartQueue5" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-head">
                                                    <h3>5 - Indexing Queue</h3>
                                                </div>
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer" style="margin-top: 700px;">
                            <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Parsing issues -->
    <div id="main_modal_parsing_issues" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade modal-big" id="modal_parsing_issues" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_parsing_issues">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3 style="font-size: 18px;">Splunk indexing time failures and warnings:</h3>
                                    <button type="button" id="btn_ops_parsing_issues_close" class="close" data-dismiss="modal">&times;</button>
                                </div>
                            </div>
                        </div>

                        <div class="modal-guts">
                            <div id="rowLinkParsingIssues" class="dashboard-row dashboard-row1" style="margin-left: 15px;">
                                <div id="panelLinkParsingIssues" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div class="input input-linklist" id="inputLinkParsingIssuesTime">
                                                <label>&nbsp;</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowSingleParsingIssues" class="dashboard-row dashboard-row1">
                                <div id="panelSingleParsingIssues" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div id="elementSingleParsingIssues" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowChartParsingIssues" class="dashboard-row dashboard-row1">
                                <div id="panelChartParsingIssues" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div id="elementChartParsingIssues" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer" style="margin-top: 700px;">
                            <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                            <a class="btn btn-primary" id="btn_search_parsing_issues_linebreaking" target="_blank" href="search_data_source_url" role="button">Search line breaking issues</a>
                            <a class="btn btn-primary" id="btn_search_parsing_issues_aggregator" target="_blank" href="search_data_source_url" role="button">Search aggregator mining issues</a>
                            <a class="btn btn-primary" id="btn_search_parsing_issues_dateparser" target="_blank" href="search_data_source_url" role="button">Search date parser issues</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Generic deletion -->
    <div class="modal custom-modal-50 fade" id="modal_entry_deletion" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>KVstore entry deletion</h3>
                </div>
                <div class="modal-body">
                    <p><b>Confirm deletion of this entry?</b><br /><br />
                        You may want to delete a data source entry if the data source has been discontinued, or if the target index or sourcetype was changed.
                        <br /><br />

                        <b>Two options are available:</b>
                        <lu>
                            <li><b>Delete temporary:</b> removes the entity and its settings, shall the data source or host be active in the past 7 days, it will be re-created automatically by the trackers</li>
                            <li><b>Delete permanently:</b> removes the entity and its settings, in addition it prevents the data source or host from being re-created automatically by the trackers</li>
                            <br />
                        </lu>

                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_entry_deletion_temporary" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Delete temporary</button>
                    <button type="submit" id="btn_modal_entry_deletion" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Delete permanently</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Error or failure during KVstore collection update -->
    <div class="modal fade" id="modal_update_collection_failure_return" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>Oops!</h3>
                </div>
                <div class="modal-body">
                    <p>Sorry but it looks like an error occurred while attempting to perform the KVstore collection update.<br /><br />
                        <b>You might not have the permission to write to the collection</b>, or an unexpected failure was encountered.<br /><br />
                        <b>The server returned the following error message:</b>
                    </p>
                    <div class="modal-error-message" style="margin: 10px 0; padding: 10px; border-radius: 3px 3px 3px 3px; color: #D8000C; background-color: #FFBABA;">
                        <p>error return message</p>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- elastic source simulation -->
    <div class="modal fade" id="modal_generic_search_error" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>Oops!</h3>
                </div>
                <div class="modal-body">
                    <p>Sorry but the simulation of the search has failed due to a syntax error or another failure.<br /><br />
                        <b>Verify your syntax and try again.</b><br /><br />
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" id="btn_modal_generic_search_error_back" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                </div>
            </div>
        </div>
    </div>

    <!-- elastic source creation is successful -->
    <div class="modal fade" id="modal_elastic_source_alert_creation_success" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>New tracker successfully created.</h3>
                </div>
                <div class="modal-body">
                    <p>Congratulations, the new elastic source tracker was successfully created.<br /><br />
                        <b>The following new tracker was created:</b>
                    </p>
                    <div class="modal-error-message" style="margin: 10px 0; padding: 10px; border-radius: 3px 3px 3px 3px; color: #059; background-color: #BEF;">
                        <p>success return message</p>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" id="modal_elastic_source_alert_creation_success_run_tracker" class="btn btn-default btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Run this Elastic dedicated tracker now</button>
                    <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Error or failure during elastic source creation -->
    <div class="modal fade" id="modal_elastic_source_alert_creation_error" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>Oops!</h3>
                </div>
                <div class="modal-body">
                    <p>Sorry but it looks like an error occurred while attempting to perform the creation of the new elastic source tracker.<br /><br />
                        <b>You might not have the permission to perform this operation</b>, or an unexpected failure was encountered.<br /><br />
                        <b>The server returned the following error message:</b>
                    </p>
                    <div class="modal-error-message" style="margin: 10px 0; padding: 10px; border-radius: 3px 3px 3px 3px; color: #D8000C; background-color: #FFBABA;">
                        <p>error return message</p>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window for lag value modification -->

    <!-- data source monitoring -->

    <div class="modal fade custom-modal-50" id="modal_modify_main" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify data source monitoring</h3>
                </div>
                <div class="modal-body">
                    <p>You can modify different parameters regarding the monitoring of this data source:</p>

                    <b>monitoring_wdays: modify the week days rules for monitoring</b>
                    <br />

                    <lu>
                        <li>all_days: monitor the data source every days of the week</li>
                        <li>monday-to-friday: monitor the data source only during working days from Monday to Friday</li>
                        <li>monday-to-saturday: monitor the data source only during working days from Monday to Saturday</li>
                        <li>Or enter the manual mode where you can select each days of the week to be monitored</li>
                    </lu>

                    <br />

                    <b>monitoring_level:</b>
                    <br />

                    <lu>
                        <li>sourcetype: monitor data source availability on a per sourcetype basis</li>
                        <li>index: monitor data source availability on a per index basis, ignoring the sourcetype value</li>
                    </lu>

                    <br />

                    <b>maximal lag value:</b>
                    <br />

                    <lu>
                        <li>the maximal value in seconds of unavailability of the data source before it is declared in red state</li>
                    </lu>

                    <br />

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_modify_cancel" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button id="btn_modal_modify_wdays" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Modify monitoring wdays</button>
                    <button id="btn_modal_modify_level" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Modify monitoring level</button>
                    <button id="btn_modal_modify_lag" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Modify monitoring lagging</button>
                </div>
            </div>
        </div>
    </div>

    <!-- data host monitoring -->

    <div class="modal fade custom-modal-50" id="modal_modify_main_host" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify data host monitoring</h3>
                </div>
                <div class="modal-body">
                    <p>You can modify different parameters regarding the monitoring of this data host:</p>

                    <b>monitoring_wdays: modify the week days rules for monitoring</b>
                    <br />

                    <lu>
                        <li>all_days: monitor the data source every days of the week</li>
                        <li>monday-to-friday: monitor the data source only during working days from Monday to Friday</li>
                        <li>monday-to-saturday: monitor the data source only during working days from Monday to Saturday</li>
                        <li>Or enter the manual mode where you can select each days of the week to be monitored</li>
                    </lu>

                    <br />

                    <b>maximal lag value:</b>
                    <br />

                    <lu>
                        <li>the maximal value in seconds of unavailability of the data host before it is declared in red state</li>
                    </lu>

                    <br />

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_modify_host_cancel" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button id="btn_modal_modify_wdays_host" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Modify monitoring wdays</button>
                    <button id="btn_modal_modify_lag_host" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Modify monitoring lagging</button>
                </div>
            </div>
        </div>
    </div>

    <!--
    Custom lagging
    -->

    <div class="modal fade custom-modal-80" id="modify_custom_lagging" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Lagging classes definition </h3>
                </div>
                <div class="modal-body">
                    <b>Use this interface to define a default lagging value per class:</b>
                    <lu>
                        <li>Per index</li>
                        <li>Per sourcetype</li>
                    </lu>
                    <br />
                    <b>Conflict resolution:</b>
                    <lu>
                        <li><b>For data sources:</b> index based lagging class wins over sourcetype based lagging class</li>
                        <li><b>For data hosts:</b> if multiple lagging class match, the highest lagging value wins</li>
                    </lu>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modify_custom_lagging">
                    </div>

                    <div id="rowCustomLagging1a" class="dashboard-row dashboard-row3">
                        <div id="panelCustomLagging1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-dropdown" id="modal_input_custom_lagging_type" style="margin-bottom: 10px;">
                                            <label>Applies to:</label>
                                        </div>

                                        <div class="input input-text" id="modal_input_custom_lagging_name" style="margin-bottom: 10px;">
                                            <label>Name:</label>
                                        </div>

                                        <div class="input input-text" id="modal_input_custom_lagging_value" style="margin-bottom: 10px;">
                                            <label>Lagging value:</label>
                                        </div>

                                        <br /><br />

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_custom_lagging_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this lagging class</button>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowCustomLagging1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="SingleCustomLagging" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowCustomLaggingTable" class="dashboard-row dashboard-row3">
                        <div id="panelCustomLaggingTable" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_custom_lagging_search" style="margin-bottom: 10px;">
                                            <label>Search for lagging class:</label>
                                        </div>
                                        <div id="tableCustomLagging" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!--
    Elastic sources
    -->

    <div class="modal fade custom-modal-80" id="modify_elastic_sources_main" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> TrackMe Elastic sources - Manage and create</h3>
                </div>
                <div class="modal-body">
                    <b>Use this interface to create and manage elastic sources:</b>
                    <br /><br />

                    <lu>
                        <li>Elastic sources are custom flexible data sources entities, which can be searches based on regular raw events searches, tstats searches, from command based searches and metric indexes using the mstats command</li>
                        <li>Elastic sources should be used when the default concept of trackMe (statement by index/sourcetype) does not comply with your requirements, or does not provide the level of flexibility requested</li>
                    </lu>

                    <br />

                    <b>Elastic sources can be added to the shared tracker, or created as dedicated trackers:</b>

                    <br /><br />

                    <lu>
                        <li>The shared elastic tracker loads the content of the lookup trackme_elastic_sources, and performs all the searches in a single execution</li>
                        <li>A dedicated elastic tracker is a scheduled report created in the UI to manage, automatically integrated with TrackMe workflow</li>
                        <li>For large volume source or advanced use cases such as mapping with third party lookups, the usage of a dedicated elastic tracker is recommended and it can be edited in Splunk Web upon its creation</li>
                        <li>The shared elastic tracker should be reserved for high performing searches, ideally tstats based searches relying on indexed fields</li>
                        <li>Dedicated elastic trackers information are as well stored in the trackme_elastic_sources_dedicated lookup for mapping purposes in the UI</li>
                    </lu>

                    <br />

                    <style type="text/css">
                    .tg  {border-collapse:collapse;border-spacing:0;}
                    .tg td{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
                      overflow:hidden;padding:10px 5px;word-break:normal;}
                    .tg th{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
                      font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}
                    .tg .tg-p1nr{border-color:inherit;font-size:12px;text-align:left;vertical-align:top}
                    .tg .tg-f4iu{border-color:inherit;font-size:13px;text-align:center;vertical-align:top}
                    </style>
                    <table class="tg">
                        <thead>
                        <tr>
                            <th class="tg-f4iu"><span style="font-weight:bold">FIELD</span></th>
                            <th class="tg-f4iu"><span style="font-weight:bold">DEFINITION</span></th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td class="tg-p1nr"><span style="font-weight:bold">data_name</span></td>
                            <td class="tg-p1nr">This is the main identifier for a data source, and needs to be unique within the entire collection</td>
                        </tr>
                        <tr>
                            <td class="tg-p1nr"><span style="font-weight:bold">search_mode</span></td>
                            <td class="tg-p1nr">The type of search, valid options are: <strong>tstats</strong> / <strong>raw</strong> / <strong>from</strong> / <strong>mstats</strong></td>
                        </tr>
                        <tr>
                            <td class="tg-p1nr"><span style="font-weight:bold">search_constraint</span></td>
                            <td class="tg-p1nr">The constraint of the search:<br>- <strong>tstats</strong>: this represents the where part of a tstats search, as: <span><code>index=my_index source=my_source</code></span><br>- <strong>raw</strong>: Any filter that is before stats calculation, as: <span><code>index=my_index tag=authentication app=my_application</code></span><br>- <strong>from</strong>: a search using from is in 2 parts with a pipe separation, where the 1st segment is the object and the 2nd a search constraint, as: <span><code>datamodel:"Authentication" | search user="*" action="success" app="my_application"</code></span> <br>- <strong>mstats</strong>: Allows monitoring metric indexes according to your constraints including dimensions, as: <span><code>index="k8s_metrics" metric_name="k8s.*" cluster_name="production"</code></span> <br />Filters can include a time range which will override the default 4 hours time range of the wrapper tracker, as: <span><code>earliest="-15m" latest="+15m"</code></span></td>
                        </tr>
                        <tr>
                            <td class="tg-p1nr"><span style="font-weight:bold">elastic _data_index</span></td>
                            <td class="tg-p1nr">Optional, this value will be used in the UI but has no impacts on the search, default to the data_name if unset</td>
                        </tr>
                        <tr>
                            <td class="tg-p1nr"><span style="font-weight:bold">elastic_data_sourcetype</span></td>
                            <td class="tg-p1nr"><span style="font-weight:400;font-style:normal">Optional, this value will be used in the UI but has no impacts on the search, default to the data_name if unset</span></td>
                        </tr>
                        </tbody>
                    </table>
                </div>

                <div class="modal-footer">
                    <button id="btn_modal_elastic_sources_manage" type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage existing shared elastic sources</button>
                    <button id="btn_modal_elastic_sources_add" type="submit" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Create a new elastic source</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade custom-modal-80" id="add_elastic_sources" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Elastic sources definition </h3>
                </div>
                <div class="modal-body">
                    <b>Use this interface to create and manage elastic sources:</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-add_elastic_source">
                    </div>

                    <div id="rowElasticSourcesAdd1a" class="dashboard-row dashboard-row3">

                        <div id="rowElasticSourcesAdd1b" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">

                                    <div class="input input-text" id="modal_input_elastic_source_data_name" style="margin-bottom: 10px; max-width: 300px;">
                                        <label>Enter the unique identifier of the elastic source:</label>
                                    </div>

                                    <div class="input input-dropdown" id="modal_input_elastic_source_search_type" style="margin-bottom: 10px;">
                                        <label>Choose the type of search:</label>
                                    </div>

                                    <form>
                                        <fieldset>
                                            <legend>Fill the search constraint according to the type of search:</legend>
                                            <p>
                                                <label>Enter the constraint for the search:</label>
                                                <textarea
                                                        id = "modal_input_elastic_source_search_constraint"
                                                        rows = "3"
                                                        cols = "80" style="width: 1100px;"
                                                        onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">Enter the Splunk search constraint chain according to the type of search selected</textarea>
                                            </p>

                                        </fieldset>
                                    </form>

                                    <div class="fieldset">

                                        <div class="input input-text" id="modal_input_elastic_source_elastic_data_index" style="margin-bottom: 10px; max-width: 300px;">
                                            <label>Optional: index value visible in the UI (white|blacklist applies)</label>
                                        </div>

                                        <div class="input input-text" id="modal_input_elastic_source_elastic_data_sourcetype" style="margin-bottom: 10px; max-width: 300px;">
                                            <label>Optional: sourcetype visible in the UI (white|blacklist applies)</label>
                                        </div>

                                        <div class="input input-text" id="modal_input_elastic_source_earliest" style="margin-bottom: 10px; max-width: 300px;">
                                            <label>Earliest, for dedicated trackers only (shared tracker uses -4h)</label>
                                        </div>

                                        <div class="input input-text" id="modal_input_elastic_source_latest" style="margin-bottom: 10px; max-width: 300px;">
                                            <label>Latest, for dedicated trackers only (shared tracker uses +4h)</label>
                                        </div>

                                    </div>

                                    <div style="margin-top: 15x;">
                                        <h4 style="color: red;">Caution: whitelist indexes and blacklists apply to elastic trackers, make sure to configure these accordingly or use valid index and sourcetype values</h4>
                                        <br />
                                        <button type="submit" id="btn_modal_elastic_source_add_simulate" style="margin-right: 15px;" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Simulate the search</button>
                                        <button type="submit" id="btn_modal_elastic_source_add_new" style="margin-right: 15px;" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Add to the shared tracker</button>
                                        <button type="submit" id="btn_modal_elastic_source_dedicated_add_new" style="margin-right: 15px;" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Add as a new dedicated tracker</button>
                                    </div>

                                </div>

                                <br />
                                <br />

                            </div>

                        </div>

                    </div>

                    <div id="rowElasticSourcesAdd1c" class="dashboard-row dashboard-row1" data-depends="$start_simulation_elastic_sources$">
                        <div id="panelElasticSourcesAdd1c" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div id="tableElasticSourcesTest" class="dashboard-element table" style="width: 100%; max-height: 140px;">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_elastic_sources_add_new_back" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window confirmation of association for identity card -->
    <div class="modal fade" id="add_elastic_source_processed" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>New elastic source successfully added.</h3>
                </div>
                <div class="modal-body">
                    <p>Congratulations, the new elastic source was successfully added to the shared tracker collection.<br /><br />
                        <b>The following new configuration was created:</b>
                    </p>
                    <div class="modal-error-message" style="margin: 10px 0; padding: 10px; border-radius: 3px 3px 3px 3px; color: #059; background-color: #BEF;">
                        <p>success return message</p>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" id="add_elastic_source_processed_run_tracker" class="btn btn-default btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Run Elastic Shared tracker now</button>
                    <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>

        </div>
    </div>

    <div class="modal fade custom-modal-80" id="modify_elastic_sources" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Elastic sources definition </h3>
                </div>
                <div class="modal-body">
                    <b>Use this interface to create and manage elastic sources:</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modify_elastic_sources">
                    </div>

                    <div id="rowElasticSources1a" class="dashboard-row dashboard-row3">

                        <div id="rowElasticSources1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="SingleElasticSources" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowElasticSourcesTable" class="dashboard-row dashboard-row3">
                        <div id="panelElasticSourcesTable" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_elastic_sources_search" style="margin-bottom: 10px;">
                                            <label>Search for elastic source:</label>
                                        </div>
                                        <div id="tableElasticSources" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_elastic_sources_add_back" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                </div>
            </div>
        </div>
    </div>

    <!-- elastic sources deletion -->
    <div id="delete_elastic_source" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="delete_elastic_source_main" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_delete_elastic_source">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for elastic source: <span style="color: steelblue">$tk_elastic_source_data_name$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>data_name:</b> $tk_elastic_source_data_name$</p>
                                    <p><b>search_mode:</b> $tk_elastic_source_search_mode$</p>
                                    <p><b>search_constraint:</b> $tk_elastic_source_search_constraint$</p>
                                    <p><b>elastic_data_index:</b> $tk_elastic_source_elastic_data_index$</p>
                                    <p><b>elastic_data_sourcetype:</b> $tk_elastic_source_elastic_data_sourcetype$</p>
                                    <br />
                                    <br />
                                    <p>Deleting a elastic source from the elastic source does not delete the data source from the data sources collection.</p>
                                </div>


                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_elastic_source_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_elastic_source_confirm" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Custom lagging -->
    <div id="main_manage_custom_lagging" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="manage_custom_lagging" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_manage_custom_lagging">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for lagging class: <span style="color: steelblue">$tk_input_custom_lagging_name$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>level:</b> $tk_input_custom_lagging_level$</p>
                                    <p><b>name:</b> $tk_input_custom_lagging_name$</p>
                                    <p><b>value:</b> $tk_input_custom_lagging_value$</p>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_custom_lagging_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_custom_lagging" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for metric SLA policy -->
    <div id="main_manage_metric_sla_policy" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="manage_metric_sla_policy" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_manage_metric_sla_policy">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for metric category: <span style="color: steelblue">$tk_input_metric_policy_metric_category$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>metric_category:</b> $tk_input_metric_policy_metric_category$</p>
                                    <p><b>metric_max_lag_allowed:</b> $tk_input_metric_max_lag_allowed$</p>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_metric_sla_policy_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_metric_sla_policy" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--

    Whitelist management

    -->

    <!-- whitelist data_source -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_source_whitelist" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify index allowlisting</h3>
                </div>
                <div class="modal-body">
                    <b>If no indexes are in allowlist, TrackMe will use all available indexes, otherwise only the indexes in allowlist will be taken in charge</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_source_whitelist">
                    </div>

                    <div id="rowWhiteListDataSource1a" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListDataSource1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">

                                        <div class="input input-linklist" id="inputLinkTimeWhiteListDataSource">
                                            <label>&nbsp;</label>
                                        </div>

                                        <div class="input input-dropdown" id="modal_input_data_source_whitelist" style="margin-bottom: 10px;">
                                            <label>index name:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_source_whitelist_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this index</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowWhiteListDataSource1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleWhiteListDataSource" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowWhiteListDataSourceEmpty" class="dashboard-row dashboard-row" data-rejects="$show_table_data_source_whitelist$">
                        <div id="panelWhiteListDataSourceEmpty" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">All indexes are currently allowed in the data discovery.</h3>
                                        <br /><br />
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowWhiteListDataSource2" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListDataSource2" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_whitelist_search" style="margin-bottom: 10px;">
                                            <label>Search for index name:</label>
                                        </div>

                                        <div id="tableWhiteListDataSource" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_source_whitelist_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" id="btn_modal_data_source_whitelist_add_delete" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove selected</button>
                </div>
            </div>
        </div>
    </div>

    <!-- whitelist data_host -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_host_whitelist" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify index allowlisting</h3>
                </div>
                <div class="modal-body">
                    <b>If no indexes are in allowlist, TrackMe will use all available indexes, otherwise only the indexes in allowlist will be taken in charge</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_host_whitelist">
                    </div>

                    <div id="rowWhiteListDataHost1a" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListDataHost1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">

                                        <div class="input input-linklist" id="inputLinkTimeWhiteListDataHost">
                                            <label>&nbsp;</label>
                                        </div>

                                        <div class="input input-dropdown" id="modal_input_data_host_whitelist" style="margin-bottom: 10px;">
                                            <label>index name:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_host_whitelist_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this index</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowWhiteListDataHost1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleWhiteListDataHost" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowWhiteListDataHostEmpty" class="dashboard-row dashboard-row" data-rejects="$show_table_data_host_whitelist$">
                        <div id="panelWhiteListDataHostEmpty" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">All indexes are currently allowed in the data discovery.</h3>
                                        <br /><br />
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowWhiteListDataHost2" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListDataHost2" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_whitelist_search" style="margin-bottom: 10px;">
                                            <label>Search for index name:</label>
                                        </div>

                                        <div id="tableWhiteListDataHost" class="dashboard-element table" style="width: 100%">
                                            <label>Select entries and click on remove:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_host_whitelist_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" id="btn_modal_data_host_whitelist_add_delete" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove</button>
                </div>
            </div>
        </div>
    </div>

    <!-- whitelist metric_host -->
    <div class="modal fade custom-modal-50" id="modal_modify_metric_host_whitelist" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify index allowlisting</h3>
                </div>
                <div class="modal-body">
                    <b>If no indexes are in allowlist, TrackMe will use all available indexes, otherwise only the indexes in allowlist will be taken in charge</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_metric_host_whitelist">
                    </div>

                    <div id="rowWhiteListMetricHost1a" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListMetricHost1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">

                                        <div class="input input-linklist" id="inputLinkTimeWhiteListMetricHost">
                                            <label>&nbsp;</label>
                                        </div>

                                        <div class="input input-dropdown" id="modal_input_metric_host_whitelist" style="margin-bottom: 10px;">
                                            <label>index name:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_metric_host_whitelist_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this index</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowWhiteListMetricHost1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleWhiteListMetricHost" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowWhiteListMetricHostEmpty" class="dashboard-row dashboard-row" data-rejects="$show_table_metric_host_whitelist$">
                        <div id="panelWhiteListMetricHostEmpty" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">All indexes are currently allowed in the data discovery.</h3>
                                        <br /><br />
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowWhiteListMetricHost2" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListMetricHost2" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_metric_host_whitelist_search" style="margin-bottom: 10px;">
                                            <label>Search for index name:</label>
                                        </div>

                                        <div id="tableWhiteListMetricHost" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_metric_host_whitelist_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!--

    Blacklist management

    -->

    <!-- blacklist host -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_source_blacklist_host" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify host blacklisting</h3>
                </div>
                <div class="modal-body">
                    <b>Hosts that have been blocklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_source_blacklist_host">
                    </div>

                    <b>Blacklist entries support the following types:</b>
                    <br /><br />

                    <lu>
                        <li>explicit names, example: <code>dev001</code></li>
                        <li>wildcards, example: <code>dev-*</code></li>
                        <li>regular expressions, example: <code>(?i)dev-.*</code></li>
                    </lu>

                    <br />

                    <div id="rowBlackListDataSourceHost1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceHost1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_host" style="margin-bottom: 10px;">
                                            <label>host name or expression:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_source_blacklist_host_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this entry</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListDataSourceHost1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListDataSourceHost" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListDataSourceHost2" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceHost2" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_host_search" style="margin-bottom: 10px;">
                                            <label>Search for host name:</label>
                                        </div>
                                        <div id="tableBlackListDataSourceHost" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_source_blacklist_host_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist index -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_source_blacklist_index" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify index blacklisting</h3>
                </div>
                <div class="modal-body">
                    <b>Indexes that have been blocklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_source_blacklist_index">
                    </div>

                    <b>Blacklist entries support the following types:</b>
                    <br /><br />

                    <lu>
                        <li>explicit names, example: <code>dev001</code></li>
                        <li>wildcards, example: <code>dev-*</code></li>
                        <li>regular expressions, example: <code>(?i)dev-.*</code></li>
                    </lu>

                    <br />

                    <div id="rowBlackListDataSourceIndex1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceIndex1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_index" style="margin-bottom: 10px;">
                                            <label>index name or expression:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_source_blacklist_index_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this entry</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListDataSourceIndex1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListDataSourceIndex" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListDataSourceIndex2" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceIndex2" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_index_search" style="margin-bottom: 10px;">
                                            <label>Search for index name:</label>
                                        </div>

                                        <div id="tableBlackListDataSourceIndex" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_source_blacklist_index_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist sourcetype -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_source_blacklist_sourcetype" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify sourcetype blacklisting</h3>
                </div>
                <div class="modal-body">
                    <b>Sourcetypes that have been blocklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_source_blacklist_sourcetype">
                    </div>

                    <b>Blacklist entries support the following types:</b>
                    <br /><br />

                    <lu>
                        <li>explicit names, example: <code>dev001</code></li>
                        <li>wildcards, example: <code>dev-*</code></li>
                        <li>regular expressions, example: <code>(?i)dev-.*</code></li>
                    </lu>

                    <br />

                    <div id="rowBlackListDataSourceSourcetype1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceSourcetype1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_sourcetype" style="margin-bottom: 10px;">
                                            <label>sourcetype name or expression:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_source_blacklist_sourcetype_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this entry</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListDataSourceSourcetype1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListDataSourceSourcetype" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListDataSourceSourcetype2" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceSourcetype2" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_sourcetype_search" style="margin-bottom: 10px;">
                                            <label>Search for sourcetype name:</label>
                                        </div>

                                        <div id="tableBlackListDataSourceSourcetype" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_source_blacklist_sourcetype_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!--
    blacklist data host
    -->

    <!-- blacklist host -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_host_blacklist_host" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify host blacklisting</h3>
                </div>
                <div class="modal-body">
                    <b>Hosts that have been blocklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_host_blacklist_host">
                    </div>

                    <b>Blacklist entries support the following types:</b>
                    <br /><br />

                    <lu>
                        <li>explicit names, example: <code>dev001</code></li>
                        <li>wildcards, example: <code>dev-*</code></li>
                        <li>regular expressions, example: <code>(?i)dev-.*</code></li>
                    </lu>

                    <br />

                    <div id="rowBlackListDataHostHost1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostHost1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_blacklist_host" style="margin-bottom: 10px;">
                                            <label>host name or expression:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_host_blacklist_host_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this entry</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListDataHostHost1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListDataHostHost" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListDataHostHost2" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostHost2" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_blacklist_host_search" style="margin-bottom: 10px;">
                                            <label>Search for host name:</label>
                                        </div>
                                        <div id="tableBlackListDataHostHost" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_host_blacklist_host_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Added message -->
    <div class="modal fade" id="modal_blacklist_added" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: steelblue;"><span class="glyphicon glyphicon-lock"></span>Black list host updated</h3>
                </div>
                <div class="modal-body">
                    <p><b>The host was successfully added to the blacklist host collection. the host will be permanently excluded from the data sources discovery.</b><br /><br />
                        <br /><br />
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- data source monitoring -->

    <!-- Modal window for data source unified -->
    <div class="modal fade custom-modal-80" id="modal_modify_data_source_unified" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Data source unified update </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <h4>Data source lagging value:</h4>

                            <div style="margin-left: 15px;">
                                <lu>
                                    <li>The maximal allowed lagging value defines the maximal value in seconds before a data source / host would be considered as red</li>
                                    <li>Override lagging classes allows bypassing any lagging classes configuration that would apply to this data source or host</li>
                                    <li>If a lagging class matches index(es) or sourcetype(es) for this data source or host and the option is unchecked, it will bypass this value unless override is true</li>
                                </lu>
                            </div>

                            <br />

                            <div class="fieldset">
                                <div class="input input-text" id="modal_input_lag">
                                    <label>Maximal allowed lagging value:</label>
                                </div>
                            </div>
                            <div class="fieldset">
                                <div class="input input-dropdown" id="modal_input_lag_override_class">
                                    <label>Override lagging classes:</label>
                                </div>
                            </div>

                            <button id="btn_modal_modify_lag_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply manual lagging rule</button>
                            <button id="btn_modal_modify_lag_auto_main" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Or choose an auto lagging</button>

                            <div class="boxnotify" id="boxnotify-unified-data-source">
                            </div>

                        </div>

                        <hr>

                        <div style="margin-bottom: 10px; width: 50%; float:left">

                            <h4>Data source priority:</h4>

                            <p>Define the priority of the data source for granular level of SLA alerting:</p>

                            <p>
                                <span class="title_low_priority">low</span>
                                <span class="title_medium_priority">medium</span>
                                <span class="title_high_priority">high</span>
                            </p>

                            <div class="fieldset">
                                <div class="input input-text" id="modal_input_priority">
                                    <label></label>
                                </div>
                            </div>

                            <div>
                                <button id="btn_modal_modify_priority_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply priority</button>
                            </div>

                        </div>

                        <div style="margin-bottom: 10px; width: 50%; float:right">

                            <h4>Data source week days monitoring:</h4>

                            <p>Monitor source on a all days basis, apply a builtin rule, or explicitly select week days:</p>

                            <div class="fieldset">
                                <div class="input input-text" id="modal_input_wdays">
                                    <label></label>
                                </div>
                            </div>

                            <div>
                                <button id="btn_modal_modify_monitoring_wdays_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply wdays builtin rule</button>
                                <button id="btn_modal_modify_wdays_no" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Or select days of the week</button>
                            </div>

                        </div>

                        <div style="margin-top: 240px; margin-bottom: 10px;">

                            <hr>

                            <h4>Data source monitoring level:</h4>

                            <p>Choose to monitor the data source based on the index and sourcetype association (default), or based on the latest data available in the index where the data source is stored:</p>

                            <div class="fieldset">
                                <div class="input input-text" id="modal_input_level">
                                    <label></label>
                                </div>
                            </div>

                            <button id="btn_modal_modify_monitoring_level_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply monitoring level rule</button>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_close_data_source_unified" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window for data source unified autolag -->
    <div class="modal fade custom-modal-80" id="modal_modify_data_source_autolag" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Data source unified update </h3>
                </div>

                <div class="modal-body">

                    <div id="rowSingleLagAutoLagging" class="dashboard-row dashboard-row1">
                        <div id="panelSingleLagAutoLagging" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div id="elementDataSourceAutoLaggingDataSourceSingleLagPerc95" class="dashboard-element chart" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                    <div id="elementDataSourceAutoLaggingDataSourceSingleLagAvg" class="dashboard-element chart" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                    <div id="elementDataSourceAutoLaggingDataSourceSingleLagPerc95Last30d" class="dashboard-element chart" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                    <div id="elementDataSourceAutoLaggingDataSourceSingleLagAvgLast30d" class="dashboard-element chart" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div>

                        <div style="margin-bottom: 10px;">

                            <h4>Choose one option to be applied:</h4>

                            <button id="btn_modal_modify_lag_auto_perc95" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply auto percentile lag (7d)</button>
                            <button id="btn_modal_modify_lag_auto_perc95_30d" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Or Apply auto percentile lag (30d)</button>
                            <button id="btn_modal_modify_lag_auto_average" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Or Apply auto average lag (7d)</button>
                            <button id="btn_modal_modify_lag_auto_average_30d" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Or Apply auto average lag (30d)</button>

                            <div class="boxnotify" id="boxnotify-unified-data-source-autolag">
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_close_data_source_unified_autolag" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>

            </div>

        </div>
    </div>

    <!-- data host monitoring -->

    <!-- Modal window for data source unified -->
    <div class="modal fade custom-modal-80" id="modal_modify_data_host_unified" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Data host unified update </h3>
                </div>

                <div class="modal-body">

                    <h4>Data host lagging value:</h4>

                    <div style="margin-left: 15px;">
                        <lu>
                            <li>The maximal allowed lagging value defines the maximal value in seconds before a data source / host would be considered as red</li>
                            <li>Override lagging classes allows bypassing any lagging classes configuration that would apply to this data source or host</li>
                            <li>If a lagging class matches index(es) or sourcetype(es) for this data source or host and the option is unchecked, it will bypass this value unless override is true</li>
                        </lu>
                    </div>

                    <br />

                    <div class="fieldset">
                        <div class="input input-text" id="modal_input_lag_host">
                            <label>Maximal allowed lagging value:</label>
                        </div>
                    </div>
                    <div class="fieldset">
                        <div class="input input-dropdown" id="modal_input_lag_override_class_host">
                            <label>Override lagging classes:</label>
                        </div>
                    </div>

                    <button id="btn_modal_modify_lag_confirm_host" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply manual lagging rule</button>
                    <button id="btn_modal_modify_lag_auto_main_host" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Or choose an auto lagging</button>

                    <div class="boxnotify" id="boxnotify-unified-data-host">
                    </div>

                    <hr>

                    <div style="margin-bottom: 10px; width: 50%; float:left">

                        <h4>Data host priority:</h4>

                        <p>Define the priority of the data host for granular level of SLA alerting:</p>

                        <p>
                            <span class="title_low_priority">low</span>
                            <span class="title_medium_priority">medium</span>
                            <span class="title_high_priority">high</span>
                        </p>

                        <div class="fieldset">
                            <div class="input input-text" id="modal_input_host_priority">
                                <label></label>
                            </div>
                        </div>

                        <div>
                            <button id="btn_modal_modify_priority_host_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply priority</button>
                        </div>

                    </div>

                    <div style="margin-bottom: 10px; width: 50%; float:right">

                        <h4>Associate to a Logical group:</h4>

                        <p>Logical groups are groups of entities that will be considered as an ensemble for monitoring purposes.
                            <br />
                            A typical use case is a couple of active / passive appliances, where only the active member generates data.
                            <br /><br />
                            When associated in a Logical group, the entity status relies on the minimal green percentage configured during the group creation versus
                            the current green percentage of the group. (percentages of members green)
                        </p>

                        <div style="margin-bottom: 20px;" class="btn_logical_group">
                            <button type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Manage in a Logical group </button>
                        </div>

                    </div>

                    <div style="margin-top: 240px; margin-bottom: 10px;">

                        <hr>
                        
                        <h4>Data host week days monitoring:</h4>

                        <p>Monitor source on a all days basis, apply a builtin rule, or explicitly select week days:</p>

                        <div class="fieldset">
                            <div class="input input-text" id="modal_input_wdays_host">
                                <label></label>
                            </div>
                        </div>

                        <div>
                            <button id="btn_modal_modify_monitoring_wdays_host_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply wdays builtin rule</button>
                            <button id="btn_modal_modify_wdays_host_no" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Or select days of the week</button>
                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_close_data_host_unified" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>

        </div>
    </div>

    <!-- Modal window for data source unified autolag -->
    <div class="modal fade custom-modal-80" id="modal_modify_data_host_autolag" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Data host unified update </h3>
                </div>

                <div class="modal-body">

                    <div id="rowSingleLagAutoLaggingHost" class="dashboard-row dashboard-row1">
                        <div id="panelSingleLagAutoLaggingHost" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div id="elementDataHostAutoLaggingDataHostSingleLagPerc95" class="dashboard-element chart" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                    <div id="elementDataHostAutoLaggingDataHostSingleLagAvg" class="dashboard-element chart" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                    <div id="elementDataHostAutoLaggingDataHostSingleLagPerc95Last30d" class="dashboard-element chart" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                    <div id="elementDataHostAutoLaggingDataHostSingleLagAvgLast30d" class="dashboard-element chart" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div>

                        <div style="margin-bottom: 10px;">

                            <h4>Choose one option to be applied:</h4>

		                    <button id="btn_modal_modify_lag_auto_perc95_host" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply auto percentile lag (7d)</button>
		                    <button id="btn_modal_modify_lag_auto_perc95_30d_host" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Or Apply auto percentile lag (30d)</button>
		                    <button id="btn_modal_modify_lag_auto_average_host" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Or Apply auto average lag (7d)</button>
		                    <button id="btn_modal_modify_lag_auto_average_30d_host" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Or Apply auto average lag (30d)</button>

                            <div class="boxnotify" id="boxnotify-unified-data-host-autolag">
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_close_data_host_unified_autolag" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>

            </div>

        </div>
    </div>

    <!-- metric host monitoring -->

    <!-- Modal window for data source unified -->
    <div class="modal fade custom-modal-80" id="modal_modify_metric_host_unified" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Metric host unified update </h3>
                </div>

                <div class="modal-body">

                    <div style="margin-bottom: 10px; width: 50%; float: left;">

                        <h4>Metric host priority:</h4>

                        <div class="boxnotify" id="boxnotify-unified-metric-host">
                        </div>

                        <p>Define the priority of the metric host for granular level of SLA alerting:</p>

                        <p>
                            <span class="title_low_priority">low</span>
                            <span class="title_medium_priority">medium</span>
                            <span class="title_high_priority">high</span>
                        </p>

                        <div class="fieldset">
                            <div class="input input-text" id="modal_input_metric_host_priority">
                                <label></label>
                            </div>
                        </div>

                        <div>
                            <button id="btn_modal_modify_priority_metric_host_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply priority</button>
                        </div>

                    </div>

                    <div style="margin-bottom: 10px; width: 50%; float: right;">

                        <h4>Associate to a Logical group:</h4>

                        <p>Logical groups are groups of entities that will be considered as an ensemble for monitoring purposes.
                            <br />
                            A typical use case is a couple of active / passive appliances, where only the active member generates data.
                            <br /><br />
                            When associated in a Logical group, the entity status relies on the minimal green percentage configured during the group creation versus
                            the current green percentage of the group. (percentages of members green)
                        </p>

                        <div style="margin-bottom: 20px;" class="btn_logical_group">
                            <button type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Manage in a Logical group </button>
                        </div>

                    </div>

                </div>

                <div style="margin-top: 260px;" class="modal-footer">
                    <button type="submit" id="btn_close_metric_host_unified" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>

        </div>
    </div>

    <!-- Modal window for monitoring level modification -->
    <div class="modal fade" id="modal_modify_monitoring_wdays_no" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Monitoring week days update </h3>
                </div>
                <div class="modal-body">
                    <p>
                        Select the days of the week where will be applied the monitoring rules.
                        <br /><br />
                        If the data source is not available during a week day that is not selected, no alert will be given.
                        <br /><br />
                    </p>

                    <div class="fieldset">
                        <div class="input input-checkboxgroup" id="modal_input_wdays_no">
                            <label></label>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button id="btn_modal_modify_monitoring_wdays_no_cancel" type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button id="btn_modal_modify_monitoring_wdays_no_confirm" type="submit" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- data host monitoring -->

    <!-- Modal window for monitoring level modification -->
    <div class="modal fade" id="modal_modify_monitoring_wdays_host_no" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Monitoring week days update </h3>
                </div>
                <div class="modal-body">
                    <p>
                        Select the days of the week where will be applied the monitoring rules.
                        <br /><br />
                        If the data source is not available during a week day that is not selected, no alert will be given.
                        <br /><br />
                    </p>

                    <div class="fieldset">
                        <div class="input input-checkboxgroup" id="modal_input_wdays_host_no">
                            <label></label>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button id="btn_modal_modify_monitoring_wdays_host_no_cancel" type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button id="btn_modal_modify_monitoring_wdays_host_no_confirm" type="submit" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!--

    Metrics SLA policies editor

    -->

    <div class="modal fade custom-modal-80" id="modal_metric_sla_policies" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Metrics SLA policies editor </h3>
                </div>
                <div class="modal-body">
                    <b>Use this interface to SLA policies for metric categories:</b>
                    <lu>
                        <li>A metric category is extracted automatically from the first segment of the metric path (ex: cpu for cpu.cpu_idle)</li>
                        <li>A default value is defined as above if the metric category is not listed here</li>
                        <li>Each metric category is taken in consideration individually based on these rules</li>
                    </lu>
                    <br />

                    <div class="boxnotify" id="boxnotify-btn_modify_metric_sla_policies">
                    </div>

                    <div id="rowMetricsPolicies1a" class="dashboard-row dashboard-row3">
                        <div id="panelMetricsPolicies1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">

                                         <div class="input input-dropdown" id="inputMetricPolicySLA_category" style="margin-bottom: 10px;">
                                        <label>metric_category:</label>
                                        </div>

                                        <div class="input input-text" id="inputMetricPolicySLA_value" style="margin-bottom: 10px;">
                                        <label>metric_max_lag_allowed:</label>
                                        </div>

                                        <br /><br />

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_metric_policy_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this metric SLA policy</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowMetricPolicy1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="SingleMetricPolicies" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowMetricPolicyTable" class="dashboard-row dashboard-row3">
                        <div id="panelMetricPolicyTable" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_metric_policy_search" style="margin-bottom: 10px;">
                                            <label>Search for lagging class:</label>
                                        </div>
                                        <div id="tableMetricPolicies" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!--

    whitelist

    -->

    <!-- whitelist data_source -->

    <!-- Modal drilldown context for WhiteList -->
    <div id="main_modal_manage_data_source_whitelist" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_source_whitelist" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_source_whitelist">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for index in whitelist: </h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <p><b>Confirm modification ?</b><br />
                                    </p>
                                    <p>
                                        <label>Optional: enter a note of this update. <br />
                                            This note will be logged and made available for notification.</label>
                                        <textarea
                                                id = "data_source_whitelist_index_delete_comment"
                                                rows = "6"
                                                cols = "160" style="width: 500px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                    </p>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_source_whitelist_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_source_whitelist" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- whitelist metric_host -->

    <!-- Modal drilldown context for WhiteList -->
    <div id="main_modal_manage_metric_host_whitelist" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_metric_host_whitelist" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_metric_host_whitelist">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for index in whitelist: <span style="color: steelblue">$tk_metric_index$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>metric_index:</b> $tk_metric_index$</p>
                                    <br />
                                    <b>This index is currently included in the data discovery.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_metric_host_whitelist_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_metric_host_whitelist" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- whitelist data_host -->

    <!-- whitelist data_source -->

    <!-- Modal drilldown context for WhiteList -->
    <div id="main_modal_manage_data_host_whitelist" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_host_whitelist" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_host_whitelist">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for index in whitelist: </h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <p><b>Confirm modification ?</b><br />
                                    </p>
                                    <p>
                                        <label>Optional: enter a note of this update. <br />
                                            This note will be logged and made available for notification.</label>
                                        <textarea
                                                id = "data_host_whitelist_index_delete_comment"
                                                rows = "6"
                                                cols = "160" style="width: 500px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                                    </p>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_host_whitelist_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_host_whitelist" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--

    blacklist

    -->

    <!-- blacklist -->

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_data_source_blacklist_host" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_source_blacklist_host" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_source_blacklist_host">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for host in blacklist: <span style="color: steelblue">$tk_data_host$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>data_host:</b> $tk_data_host$</p>
                                    <p><b>data_blacklist_state:</b> $tk_data_blacklist_state$</p>
                                    <br />
                                    <b>This host or expression is currently excluded from data discovery.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_source_blacklist_host_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_source_blacklist_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist -->

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_data_source_blacklist_index" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_source_blacklist_index" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_source_blacklist_index">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for index in blacklist: <span style="color: steelblue">$tk_data_index$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>data_index:</b> $tk_data_index$</p>
                                    <p><b>data_blacklist_state:</b> $tk_data_blacklist_state$</p>
                                    <br />
                                    <b>This index or expression is currently excluded from data discovery and alerting.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_source_blacklist_index_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_source_blacklist_index" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_data_source_blacklist_sourcetype" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_source_blacklist_sourcetype" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_source_blacklist_sourcetype">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for sourcetype in blacklist: <span style="color: steelblue">$tk_data_sourcetype$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>data_sourcetype:</b> $tk_data_sourcetype$</p>
                                    <p><b>data_blacklist_state:</b> $tk_data_blacklist_state$</p>
                                    <br />
                                    <b>This sourcetype or expression is currently excluded from data discovery and alerting.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_source_blacklist_sourcetype_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_source_blacklist_sourcetype" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist -->

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_data_host_blacklist_host" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_host_blacklist_host" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_host_blacklist_host">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for host in blacklist: <span style="color: steelblue">$tk_data_host$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>data_host:</b> $tk_data_host$</p>
                                    <p><b>data_blacklist_state:</b> $tk_data_blacklist_state$</p>
                                    <br />
                                    <b>This host or expression is currently excluded from data discovery.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_host_blacklist_host_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_host_blacklist_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_metric_host_blacklist_host" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_metric_host_blacklist_host" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_metric_host_blacklist_host">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for host in blacklist: <span style="color: steelblue">$tk_metric_host$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>metric_host:</b> $tk_metric_host$</p>
                                    <p><b>metric_blacklist_state:</b> $tk_metric_blacklist_state$</p>
                                    <br />
                                    <b>This host or expression is currently excluded from data discovery.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_metric_host_blacklist_host_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_metric_host_blacklist_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- whitelist & blacklist -->

    <!-- Modal main -->
    <div id="main_modal_manage_data_source_blacklists" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal custom-modal-50 fade" id="modal_manage_data_source_blacklists" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_source_blacklists">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Manage allowlists & blocklists for: <span style="color: steelblue">data sources</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div class="modal-body" style="margin-bottom: 10px;">
                                    <span class="title_green">Allowlist</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <b>Allowlist of indexes at data discovery and search time:</b>
                                    <br />
                                    <lu>
                                        <li>By default, trackMe searches for entities in all available indexes</li>
                                        <li>You can restrict at any time the list of indexes allowed by editing the content of the allowlist collections</li>
                                        <li>Indexes allowlisting is applied at discovery and search time, but can require the collection to be reset or previously discovered entities to be removed manually</li>
                                    </lu>
                                </div>

                                <br />

                                <div class="modal-body" style="margin-bottom: 10px;">
                                    <span class="title_red">Blocklist</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <b>Blocklists: use these features to blacklist hosts, indexes or sourcetypes at data discovery and search time.</b>
                                    <br />
                                    <lu>
                                        <li>Hosts that have been blocklisted are excluded from the data discovery</li>
                                        <li>Indexes that have been blocklisted are excluded from the data discovery, and from alerting results at search time</li>
                                        <li>Sourcetypes that have been blocklisted are excluded from the data discovery, and from alerting results at search time</li>
                                    </lu>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <div class="btn_modify_data_source_whitelist custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: allowlist indexes</button>
                            </div>
                            <div class="btn_modify_data_source_blacklist_host custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blocklist hosts</button>
                            </div>
                            <div class="btn_modify_data_source_blacklist_index custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blocklist indexes</button>
                            </div>
                            <div class="btn_modify_data_source_blacklist_sourcetype custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blocklist sourcetypes</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal main -->
    <div id="main_modal_manage_data_host_blacklists" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal custom-modal-50 fade" id="modal_manage_data_host_blacklists" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_host_blacklists">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Manage allowlists & blocklists for: <span style="color: steelblue">data hosts</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div class="modal-body" style="margin-bottom: 10px;">
                                    <span class="title_green">Allowlist</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <b>Allowlist of indexes at data discovery and search time:</b>
                                    <br />
                                    <lu>
                                        <li>By default, trackMe searches for entities in all available indexes</li>
                                        <li>You can restrict at any time the list of indexes allowed by editing the content of the allowlist collections</li>
                                        <li>Indexes allowlisting is applied at discovery and search time, but can require the collection to be reset or previously discovered entities to be removed manually</li>
                                    </lu>
                                </div>

                                <br />

                                <div class="modal-body" style="margin-bottom: 10px;">
                                    <span class="title_red">Blocklist</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <b>Use these features to blocklist hosts, indexes or sourcetypes at data discovery and search time.</b>
                                    <br />
                                    <lu>
                                        <li>Hosts that have been blocklisted are excluded from the data discovery, and from alerting results at search time</li>
                                        <li>Indexes that have been blocklisted are excluded from the data discovery, and from alerting results at search time</li>
                                        <li>Sourcetypes that have been blocklisted are excluded from the data discovery, and from alerting results at search time</li>
                                    </lu>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <div class="btn_modify_data_host_whitelist custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: allowlist indexes</button>
                            </div>
                            <div class="btn_modify_data_host_blacklist_host custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blocklist hosts</button>
                            </div>
                            <div class="btn_modify_data_host_blacklist_index custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blocklist indexes</button>
                            </div>
                            <div class="btn_modify_data_host_blacklist_sourcetype custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blocklist sourcetypes</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal main -->
    <div id="main_modal_manage_metric_host_blacklists" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal custom-modal-50 fade" id="modal_manage_metric_host_blacklists" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_metric_host_blacklists">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Manage allowlists & blocklists for: <span style="color: steelblue">metric hosts</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div class="modal-body" style="margin-bottom: 10px;">
                                    <span class="title_green">Allowlist</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <b>Allowlist of indexes at data discovery and search time:</b>
                                    <br />
                                    <lu>
                                        <li>By default, trackMe searches for entities in all available indexes</li>
                                        <li>You can restrict at any time the list of indexes allowed by editing the content of the allowlist collections</li>
                                        <li>Indexes allowlisting is applied at discovery and search time, but can require the collection to be reset or previously discovered entities to be removed manually</li>
                                    </lu>
                                </div>

                                <br />

                                <div class="modal-body" style="margin-bottom: 10px;">
                                    <span class="title_red">Blocklist</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <b>Blocklist: use this feature to globally exclude one of more type of metrics at data discovery and search time.</b>
                                    <br />
                                    <lu>
                                        <li>So called metric category represents the first part of the metric name, and is extracted while discovering the metrics available</li>
                                        <li>For example, metric_category=cpu would exclude any metric_name=cpu.*</li>
                                        <li>You can add or remove metric categories in blacklist at any time</li>
                                    </lu>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <div class="btn_modify_metric_host_whitelist custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: allowlist indexes</button>
                            </div>
                            <div class="btn_modify_metric_host_blacklist_host custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blocklist hosts</button>
                            </div>
                            <div class="btn_modify_metric_host_blacklist_index custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blocklist indexes</button>
                            </div>
                            <div class="btn_modify_metric_host_blacklist_metric_category custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blocklist metric_category</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_data_host_blacklist_index" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_host_blacklist_index" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_host_blacklist_index">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for index in blacklist: <span style="color: steelblue">$tk_data_index$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>data_index:</b> $tk_data_index$</p>
                                    <p><b>data_blacklist_state:</b> $tk_data_blacklist_state$</p>
                                    <br />
                                    <b>This index or expression is currently excluded from data discovery and alerting.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_host_blacklist_index_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_host_blacklist_index" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_metric_host_blacklist_index" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_metric_host_blacklist_index" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_metric_host_blacklist_index">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for index in blacklist: <span style="color: steelblue">$tk_metric_index$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>metric_index:</b> $tk_metric_index$</p>
                                    <p><b>metric_blacklist_state:</b> $tk_metric_blacklist_state$</p>
                                    <br />
                                    <b>This index or expression is currently excluded from data discovery and alerting.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_metric_host_blacklist_index_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_metric_host_blacklist_index" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_data_host_blacklist_sourcetype" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_host_blacklist_sourcetype" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_host_blacklist_sourcetype">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for sourcetype in blacklist: <span style="color: steelblue">$tk_data_sourcetype$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>data_sourcetype:</b> $tk_data_sourcetype$</p>
                                    <p><b>data_blacklist_state:</b> $tk_data_blacklist_state$</p>
                                    <br />
                                    <b>This sourcetype or expression is currently excluded from data discovery and alerting.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_host_blacklist_sourcetype_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_host_blacklist_sourcetype" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_metric_host_blacklist_metric_category" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_metric_host_blacklist_metric_category" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_metric_host_blacklist_metric_category">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for metric categories in blacklist: <span style="color: steelblue">$tk_metric_category$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>metric_category:</b> $tk_metric_category$</p>
                                    <p><b>blacklist_state:</b> $tk_metric_blacklist_state$</p>
                                    <br />
                                    <b>This metric_category is currently excluded from data discovery and alerting.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_metric_host_blacklist_metric_category_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_metric_host_blacklist_metric_category" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist index -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_host_blacklist_index" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify index blacklisting</h3>
                </div>
                <div class="modal-body">
                    <b>Indexes that have been blocklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_host_blacklist_index">
                    </div>

                    <b>Blacklist entries support the following types:</b>
                    <br /><br />

                    <lu>
                        <li>explicit names, example: <code>dev001</code></li>
                        <li>wildcards, example: <code>dev-*</code></li>
                        <li>regular expressions, example: <code>(?i)dev-.*</code></li>
                    </lu>

                    <br />

                    <div id="rowBlackListDataHostIndex1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostIndex1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_blacklist_index" style="margin-bottom: 10px;">
                                            <label>index name or expression:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_host_blacklist_index_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this entry</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListDataHostIndex1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListDataHostIndex" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListDataHostIndex2" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostIndex2" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_blacklist_index_search" style="margin-bottom: 10px;">
                                            <label>Search for index name:</label>
                                        </div>

                                        <div id="tableBlackListDataHostIndex" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_host_blacklist_index_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist index -->
    <div class="modal fade custom-modal-50" id="modal_modify_metric_host_blacklist_index" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify index blacklisting</h3>
                </div>
                <div class="modal-body">
                    <b>Indexes that have been blocklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_metric_host_blacklist_index">
                    </div>

                    <b>Blacklist entries support the following types:</b>
                    <br /><br />

                    <lu>
                        <li>explicit names, example: <code>dev001</code></li>
                        <li>wildcards, example: <code>dev-*</code></li>
                        <li>regular expressions, example: <code>(?i)dev-.*</code></li>
                    </lu>

                    <br />

                    <div id="rowBlackListMetricHostIndex1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListMetricHostIndex1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_metric_host_blacklist_index" style="margin-bottom: 10px;">
                                            <label>index name or expression:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_metric_host_blacklist_index_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this entry</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListMetricHostIndex1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListMetricHostIndex" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListMetricHostIndex2" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListMetricHostIndex2" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_metric_host_blacklist_index_search" style="margin-bottom: 10px;">
                                            <label>Search for index name:</label>
                                        </div>

                                        <div id="tableBlackListMetricHostIndex" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_metric_host_blacklist_index_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist sourcetype -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_host_blacklist_sourcetype" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify sourcetype blacklisting</h3>
                </div>
                <div class="modal-body">
                    <b>Sourcetypes that have been blocklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_host_blacklist_sourcetype">
                    </div>

                    <b>Blacklist entries support the following types:</b>
                    <br /><br />

                    <lu>
                        <li>explicit names, example: <code>dev001</code></li>
                        <li>wildcards, example: <code>dev-*</code></li>
                        <li>regular expressions, example: <code>(?i)dev-.*</code></li>
                    </lu>

                    <br />

                    <div id="rowBlackListDataHostSourcetype1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostSourcetype1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_blacklist_sourcetype" style="margin-bottom: 10px;">
                                            <label>sourcetype name or expression:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_host_blacklist_sourcetype_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this entry</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListDataHostSourcetype1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListDataHostSourcetype" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListDataHostSourcetype2" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostSourcetype2" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_blacklist_sourcetype_search" style="margin-bottom: 10px;">
                                            <label>Search for sourcetype name:</label>
                                        </div>

                                        <div id="tableBlackListDataHostSourcetype" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_host_blacklist_sourcetype_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist host -->
    <div class="modal fade custom-modal-50" id="modal_modify_metric_host_blacklist_host" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify host blacklisting</h3>
                </div>
                <div class="modal-body">
                    <b>Hosts that have been blocklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_metric_host_blacklist_host">
                    </div>

                    <b>Blacklist entries support the following types:</b>
                    <br /><br />

                    <lu>
                        <li>explicit names, example: <code>dev001</code></li>
                        <li>wildcards, example: <code>dev-*</code></li>
                        <li>regular expressions, example: <code>(?i)dev-.*</code></li>
                    </lu>

                    <br />

                    <div id="rowBlackListMetricHostHost1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListMetricHostHost1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_metric_host_blacklist_host" style="margin-bottom: 10px;">
                                            <label>host name or expression:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_metric_host_blacklist_host_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this entry</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListMetricHostHost1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListMetricHostHost" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListMetricHostHost2" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListMetricHostHost2" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_metric_host_blacklist_host_search" style="margin-bottom: 10px;">
                                            <label>Search for host name:</label>
                                        </div>
                                        <div id="tableBlackListMetricHostHost" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_metric_host_blacklist_host_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist metric_category -->
    <div class="modal fade custom-modal-50" id="modal_modify_metric_host_blacklist_metric_category" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify metric category blacklisting</h3>
                </div>
                <div class="modal-body">
                    <b>metric_category that have been blocklisted are excluded from the metric discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_metric_host_blacklist_metric_category">
                    </div>

                    <lu>
                        <li>TrackMe - metric hosts availability tracker</li>
                    </lu>

                    <br />

                    <div id="rowBlackListMetricHostMetricCategory1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListMetricHostMetricCategory1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">

                                        <div class="input input-linklist" id="inputLinkTimeBlackListMetricHost">
                                            <label>&nbsp;</label>
                                        </div>

                                        <div class="input input-dropdown" id="modal_input_metric_host_blacklist_metric_category" style="margin-bottom: 10px;">
                                            <label>metric category:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_metric_host_blacklist_metric_category_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this metric category</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListMetricHostMetricCategory1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListMetricHostMetricCategory" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListMetricHostMetricCategory2" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListMetricHostMetricCategory2" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_metric_host_blacklist_metric_category_search" style="margin-bottom: 10px;">
                                            <label>Search for metric category:</label>
                                        </div>

                                        <div id="tableBlackListMetricHostMetricCategory" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_metric_host_blacklist_metric_category_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Generic invalid selection -->
    <div class="modal fade" id="modal_entry_update_invalid" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>KVstore entry selection is invalid</h3>
                </div>
                <div class="modal-body">
                    <p>The selection you have made or the modification you have requested is invalid.<br /><br />
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" id="btn_modal_entry_update_invalid" class="btn btn-primary btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Generic modification -->
    <div class="modal fade" id="modal_entry_modification" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>KVstore entry update</h3>
                </div>
                <div class="modal-body">
                    <p><b>Confirm modification for this entry?</b><br />
                    </p>

                    <p>
                        <label>Optional: enter a note of this update. <br />
                            This note will be logged and made available for notification.</label>
                        <textarea
                                id = "input_update_comment"
                                rows = "6"
                                cols = "160" style="width: 500px;"
                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">update note</textarea>
                    </p>

                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_entry_modification" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <div id="row1" class="dashboard-row dashboard-row1">
        <div id="panel1" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="fieldset">
                    <div class="input input-linklist" id="link1">
                        <label>&nbsp;</label>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div id="rowDonutsDataSource" class="dashboard-row dashboard-rowSingleFormsDataSource" data-depends="$show_data_source_tracker$">
        <div id="DonutDataSource1" class="dashboard-row dashboard-row1" data-original-id="SingleFormsDataSource">
            <div id="DonutDataSourcePanel1" class="dashboard-cell" style="width: 50%;" data-original-id="DonutDataSourcePanel1">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="DonutDataSourceCountByPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                            <div style="text-align: center;">
                                <h3 style="font-size: 14px;">Monitored data sources count by priority</h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="DonutDataSourcePanel2" class="dashboard-cell" style="width: 50%;" data-original-id="DonutDataSourcePanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="DonutDataSourceCountByStateAndPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                            <div style="text-align: center;">
                                <h3 style="font-size: 14px;">Monitored data sources count by state and priority</h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowSingleFormsDataSource" class="dashboard-row dashboard-rowSingleFormsDataSource" data-depends="$show_data_source_tracker$">
        <div id="SingleFormsDataSource" class="dashboard-row dashboard-row1" data-original-id="SingleFormsDataSource">
            <div id="SingleFormsDataSourcePanel1" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataSourcePanel1">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataSource" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsDataSourcePanel2" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataSourcePanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataSourceAlerts" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsDataSourcePanelHighPriority" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataSourcePanelHighPriority">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataSourceAlertsHighPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsDataSourcePanel3" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataSourcePanel3">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataSourceDisabled" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowDonutsDataHost" class="dashboard-row dashboard-rowSingleFormsDataHost" data-depends="$show_data_host_tracker$">
        <div id="DonutDataHost1" class="dashboard-row dashboard-row1" data-original-id="SingleFormsDataHost">
            <div id="DonutDataHostPanel1" class="dashboard-cell" style="width: 50%;" data-original-id="DonutDataHostPanel1">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="DonutDataHostCountByStateAndPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                            <div style="text-align: center;">
                                <h3 style="font-size: 14px;">Monitored data hosts count by priority</h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="DonutDataHostPanel2" class="dashboard-cell" style="width: 50%;" data-original-id="DonutDataHostPanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="DonutDataHostCountByPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                            <div style="text-align: center;">
                                <h3 style="font-size: 14px;">Monitored data hosts count by state and priority</h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowSingleFormsDataHost" class="dashboard-row dashboard-rowSingleFormsDataHost" data-depends="$show_data_host_tracker$">
        <div id="SingleFormsDataHost" class="dashboard-row dashboard-row1" data-original-id="SingleFormsDataHost">
            <div id="SingleFormsDataHostPanel1" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataHostPanel1">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataHost" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsDataHostPanel2" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataHostPanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataHostAlerts" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsDataHostPanelHighPriority" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataHostPanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataHostAlertsHighPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsDataHostPanel3" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataHostPanel3">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataHostDisabled" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowDonutsMetricHost" class="dashboard-row dashboard-rowSingleFormsMetricHost" data-depends="$show_metric_host_tracker$">
        <div id="DonutMetricHost1" class="dashboard-row dashboard-row1" data-original-id="SingleFormsMetricHost">
            <div id="DonutMetricHostPanel1" class="dashboard-cell" style="width: 50%;" data-original-id="DonutMetricHostPanel1">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="DonutMetricHostCountByStateAndPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                            <div style="text-align: center;">
                                <h3 style="font-size: 14px;">Monitored metric hosts count by priority</h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="DonutMetricHostPanel2" class="dashboard-cell" style="width: 50%;" data-original-id="DonutMetricHostPanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="DonutMetricHostCountByPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                            <div style="text-align: center;">
                                <h3 style="font-size: 14px;">Monitored metric hosts count by state and priority</h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowSingleFormsMetricHost" class="dashboard-row dashboard-rowSingleFormsDataHost" data-depends="$show_metric_host_tracker$">
        <div id="SingleForms<Metric>Host" class="dashboard-row dashboard-row1" data-original-id="SingleFormsMetricHost">
            <div id="SingleFormsMetricHostPanel1" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsMetricHostPanel1">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalMetricHost" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsMetricHostPanel2" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsMetricHostPanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalMetricHostAlerts" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsMetricHostPanelHighPriority" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsMetricHostPanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalMetricHostAlertsHighPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsMetricHostPanel3" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsMetricHostPanel3">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalMetricHostDisabled" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row2a" class="dashboard-row dashboard-row2" data-depends="$show_data_source_tracker$">
        <div id="panel2a" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Click on any entry of the table to open interactive actions for this entity, use inputs to filter out the selection: (restricted to the first thousand results, use the key world filter input for large scale selections)</h2>
                <div class="fieldset">
                    <div class="input input-text" id="inputDataNameFilter">
                        <label>Keyword filter name:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataName">
                        <label>Name (use keyword filter):</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataIndex">
                        <label>Index:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataSourcetype">
                        <label>Sourcetype(s):</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataSourceState">
                        <label>Filter state:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataMonitoredState">
                        <label>Filter monitored_state:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataPriority">
                        <label>Filter priority:</label>
                    </div>
                    <div class="input input-dropdown" id="refreshForm">
                        <label>Auto refresh:</label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row2b" class="dashboard-row dashboard-row2" data-depends="$show_data_host_tracker$">
        <div id="panel2b" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Click on any entry of the table to open interactive actions for this entity, use inputs to filter out the selection: (restricted to the first thousand results, use the key world filter input for large scale selections)</h2>
                <div class="fieldset">
                    <div class="input input-dropdown" id="inputDataHostIndexes">
                        <label>Index(es):</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataHostSourcetypes">
                        <label>Sourcetype(s):</label>
                    </div>
                    <div class="input input-text" id="inputDataHostFilter">
                        <label>Keyword filter hosts:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataHost">
                        <label>Host(s) (use keyword filter):</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataHostState">
                        <label>Filter state:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataHostMonitoredState">
                        <label>Filter monitored_state:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataHostPriority">
                        <label>Filter priority:</label>
                    </div>
                    <div class="input input-dropdown" id="refreshHostForm">
                        <label>Auto refresh:</label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row2c" class="dashboard-row dashboard-row2" data-depends="$show_metric_host_tracker$">
        <div id="panel2c" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Click on any entry of the table to open interactive actions for this entity, use inputs to filter out the selection: (restricted to the first thousand results, use the key world filter input for large scale selections):</h2>
                <div class="fieldset">
                    <div class="input input-dropdown" id="inputMetricHostIndexes">
                        <label>Index(es):</label>
                    </div>
                    <div class="input input-dropdown" id="inputMetricHostCategories">
                        <label>Metic categorie(s):</label>
                    </div>
                    <div class="input input-dropdown" id="inputMetricHostFilter">
                        <label>Keyword filter host:</label>
                    </div>
                    <div class="input input-dropdown" id="inputMetricHost">
                        <label>Host(s) (use keyword filter):</label>
                    </div>
                    <div class="input input-dropdown" id="inputMetricHostState">
                        <label>Filter state:</label>
                    </div>
                    <div class="input input-dropdown" id="inputMetricHostMonitoredState">
                        <label>Filter monitored_state:</label>
                    </div>
                    <div class="input input-dropdown" id="inputMetricHostPriority">
                        <label>Filter priority:</label>
                    </div>
                    <div class="input input-dropdown" id="refreshMetricHostForm">
                        <label>Auto refresh:</label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowDataSourcesBtns" class="dashboard-row dashboard-rowDataSourcesBtns" data-depends="$show_data_source_tracker$">
        <div id="panelDataSourcesBtns" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementBtns" class="dashboard-element html" style="width: 100%">
                        <div class="panel-body html">
                            <div>
                                <div class="btn_modify_elastic_sources_main custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: elastic sources</button>
                                </div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_modify_data_source_blacklist_main" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: allowlists &amp; blocklists</button>
                                </div>
                                <div class="btn_modify_custom_lagging custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: define lagging classes</button>
                                </div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_run_tracker" style="margin-right: 15px;" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Manage: run short term tracker now</button>
                                </div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_run_tracker_longterm" style="margin-right: 15px;" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Manage: run long term tracker now</button>
                                </div>
                            </div>
                            <div style="float: left;">
                                <div class="btn_ops_index_queue custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ops: Indexers queues</button>
                                </div>
                                <div class="btn_ops_parsing_issues custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ops: Parsing issues</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div id="rowDataMetricHostsBtns" class="dashboard-row dashboard-rowMetricHostsBtns" data-depends="$show_metric_host_tracker$">
        <div id="panelMetricHostsBtns" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementBtnsMetricHosts" class="dashboard-element html" style="width: 100%">
                        <div class="panel-body html">
                            <div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_modify_metric_host_blacklist_main" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: allowlists &amp; blocklists</button>
                                </div>
                                <div class="btn_modify_metric_sla_policies custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: metric SLA policies</button>
                                </div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_run_tracker_metric_host" style="margin-right: 15px;" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Manage: run metric tracker now</button>
                                </div>
                            </div>
                            <div style="float: left;">
                                <div class="btn_ops_index_queue custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ops: Indexers queues</button>
                                </div>
                                <div class="btn_ops_parsing_issues custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ops: Parsing issues</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div id="rowDataSourcesTable" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_data_source_tracker$">
        <div id="panelDataSourcesTable" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementMainTable" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowDataHostsBtns" class="dashboard-row dashboard-rowDataSourcesBtns" data-depends="$show_data_host_tracker$">
        <div id="panelDataHostsBtns" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementBtnsHosts" class="dashboard-element html" style="width: 100%">
                        <div class="panel-body html">
                            <div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_modify_data_host_blacklist_main" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: allowlists &amp; blocklists</button>
                                </div>
                                <div class="btn_modify_custom_lagging custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: define lagging classes</button>
                                </div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_run_tracker_host" style="margin-right: 15px;" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Manage: run short term tracker now</button>
                                </div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_run_tracker_host_longterm" style="margin-right: 15px;" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Manage: run long term tracker now</button>
                                </div>
                            </div>
                            <div style="float: left;">
                                <div class="btn_ops_index_queue custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ops: Indexers queues</button>
                                </div>
                                <div class="btn_ops_parsing_issues custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ops: Parsing issues</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div id="rowDataHostsTable" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_data_host_tracker$">
        <div id="panelDataHostsTable" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementMainTableHost" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowMetricHostsTable" class="dashboard-row dashboard-rowMetricSourcesTable" data-depends="$show_metric_host_tracker$">
        <div id="panelMetricHostsTable" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementMainTableMetricHost" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAuditChangesTop" class="dashboard-row dashboard-row1" data-original-id="rowAuditChangesTop" data-depends="$show_audit_changes$">
        <div id="panelAuditChangesTop1" class="dashboard-cell" style="width: 33.33%;">
            <div class="dashboard-panel clearfix">

                <div class="panel-element-row">
                    <div id="chartAuditChangesTopAction" class="dashboard-element chart" style="width: 100%">
                        <div class="panel-head">
                            <h3>TOP Actions</h3>
                        </div>
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
        <div id="panelAuditChangesTop2" class="dashboard-cell" style="width: 33.33%;">
            <div class="dashboard-panel clearfix">

                <div class="panel-element-row">
                    <div id="chartAuditChangesTopUser" class="dashboard-element chart" style="width: 100%">
                        <div class="panel-head">
                            <h3>TOP Users</h3>
                        </div>
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
        <div id="panelAuditChangesTop3" class="dashboard-cell" style="width: 33.33%;">
            <div class="dashboard-panel clearfix">

                <div class="panel-element-row">
                    <div id="chartAuditChangesTopChangeType" class="dashboard-element chart" style="width: 100%">
                        <div class="panel-head">
                            <h3>TOP Change Types</h3>
                        </div>
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAuditFlipTop" class="dashboard-row dashboard-row1" data-original-id="rowAuditFlipTop" data-depends="$show_audit_flip$">
        <div id="panelAuditFlipChart1" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">
                    <div id="chartAuditFlipTopObject" class="dashboard-element chart" style="width: 100%">
                        <div class="panel-head">
                            <h3>TOP Object</h3>
                        </div>
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
        <div id="panelAuditFlipChart2" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">
                    <div id="chartAuditFlipOverTime" class="dashboard-element chart" style="width: 100%">
                        <div class="panel-head">
                            <h3>Flip over time</h3>
                        </div>
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAuditFlipFilters" class="dashboard-row dashboard-AuditChangesFilters" data-depends="$show_audit_flip$">
        <div id="panelAuditFlipFilters" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Search for alert state flipping:</h2>
                <div class="fieldset">
                    <div class="input input-timerangepicker" id="input_timerange_audit_flip">
                        <label>time period:</label>
                    </div>
                    <div class="input input-text" id="inputAuditFlipObjectFilter">
                        <label>Keyword filter object:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditFlipObjectCategory">
                        <label>object_category:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditFlipObject">
                        <label>object(s) (use keyword filter):</label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAuditFlipTable" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_audit_flip$">
        <div id="panelAuditFlipTable" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementMainTableAuditFlip" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAuditChangesFilters" class="dashboard-row dashboard-AuditChangesFilters" data-depends="$show_audit_changes$">
        <div id="panelAuditChangesFilters" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Search for audit changes:</h2>
                <div class="fieldset">
                    <div class="input input-timerangepicker" id="input_timerange_audit_changes">
                        <label>time period:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditChangesAction">
                        <label>action:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditChangesUser">
                        <label>user:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditChangesObjectCategory">
                        <label>object_category:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditChangesChangeType">
                        <label>change_type:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditChangesObject">
                        <label>object:</label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAuditChangesTable" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_audit_changes$">
        <div id="panelAuditChangesTable" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementMainTableAuditChanges" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

</div>
</div>

<!--
END LAYOUT
-->

<script src="{{SPLUNKWEB_URL_PREFIX}}/config?autoload=1" crossorigin="use-credentials"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/js/i18n.js"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/i18ncatalog?autoload=1"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/build/simplexml/index.js"></script>
<script type="text/javascript">
// <![CDATA[
// <![CDATA[
//
// LIBRARY REQUIREMENTS
//
// In the require function, we include the necessary libraries and modules for
// the HTML dashboard. Then, we pass variable names for these libraries and
// modules as function parameters, in order.
//
// When you add libraries or modules, remember to retain this mapping order
// between the library or module and its function parameter. You can do this by
// adding to the end of these lists, as shown in the commented examples below.
require([
        "splunkjs/mvc",
        "splunkjs/mvc/utils",
        "splunkjs/mvc/tokenutils",
        "underscore",
        "jquery",
        "splunkjs/mvc/simplexml",
        "splunkjs/mvc/layoutview",
        "splunkjs/mvc/simplexml/dashboardview",
        "splunkjs/mvc/simplexml/dashboard/panelref",
        "splunkjs/mvc/simplexml/element/chart",
        "splunkjs/mvc/simplexml/element/event",
        "splunkjs/mvc/simplexml/element/html",
        "splunkjs/mvc/simplexml/element/list",
        "splunkjs/mvc/simplexml/element/map",
        "splunkjs/mvc/simplexml/element/single",
        "splunkjs/mvc/simplexml/element/table",
        "splunkjs/mvc/simplexml/element/visualization",
        "splunkjs/mvc/simpleform/formutils",
        "splunkjs/mvc/simplexml/eventhandler",
        "splunkjs/mvc/simplexml/searcheventhandler",
        "splunkjs/mvc/simpleform/input/dropdown",
        "splunkjs/mvc/simpleform/input/radiogroup",
        "splunkjs/mvc/simpleform/input/linklist",
        "splunkjs/mvc/simpleform/input/multiselect",
        "splunkjs/mvc/simpleform/input/checkboxgroup",
        "splunkjs/mvc/simpleform/input/text",
        "splunkjs/mvc/simpleform/input/timerange",
        "splunkjs/mvc/simpleform/input/submit",
        "splunkjs/mvc/searchmanager",
        "splunkjs/mvc/savedsearchmanager",
        "splunkjs/mvc/postprocessmanager",
        "splunkjs/mvc/simplexml/urltokenmodel"
        // Add comma-separated libraries and modules manually here, for example:
        // ..."splunkjs/mvc/simplexml/urltokenmodel",
        // "splunkjs/mvc/tokenforwarder"
    ],
    function(
        mvc,
        utils,
        TokenUtils,
        _,
        $,
        DashboardController,
        LayoutView,
        Dashboard,
        PanelRef,
        ChartElement,
        EventElement,
        HtmlElement,
        ListElement,
        MapElement,
        SingleElement,
        TableElement,
        VisualizationElement,
        FormUtils,
        EventHandler,
        SearchEventHandler,
        DropdownInput,
        RadioGroupInput,
        LinkListInput,
        MultiSelectInput,
        CheckboxGroupInput,
        TextInput,
        TimeRangeInput,
        SubmitButton,
        SearchManager,
        SavedSearchManager,
        PostProcessManager,
        UrlTokenModel

        // Add comma-separated parameter names here, for example:
        // ...UrlTokenModel,
        // TokenForwarder
    ) {

        var pageLoading = true;

        //
        // FUNCTIONS
        //

        // Returns true if numeric
        function isNumeric(n) {
            return !isNaN(parseFloat(n)) && isFinite(n) && n > 0;
        }

        // Escape double quotes
        function escapeDoubleQuotes(str) {
            return str.replace(/\\([\s\S])|(")/g,"\\$1$2"); // thanks @slevithan!
        }

        // generate a unique ID
        function uuid() {
          return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
            var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
          });
        }

        // Audit record
        function auditRecord(action, change_type, object, object_category, object_attrs, result, comment) {

            // Audit changes
            var tokens = mvc.Components.get("default");
            var currentUser = Splunk.util.getConfigValue("USERNAME");
            tokens.set("currentUser", currentUser);
            var auditendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_audit_changes/"

            var time = (new Date).getTime();
            var audit_record = {
                "time": time,
                "action": action,
                "user": currentUser,
                "change_type": change_type,
                "object": object,
                "object_category": object_category,
                "object_attrs": object_attrs,
                "result": result,
                "comment": comment
            };
            $.ajax({
                url: auditendpoint_URl,
                type: "POST",
                async: true,
                contentType: "application/json",
                data: JSON.stringify(audit_record),
                success: function(returneddata) {
                    //console.log("Updated!", returneddata)
                    // Run the search again to update the table
                }
            });

        }

        //
        // TOKENS
        //

        // Create token namespaces
        var urlTokenModel = new UrlTokenModel();
        mvc.Components.registerInstance('url', urlTokenModel);
        var defaultTokenModel = mvc.Components.getInstance('default', {
            create: true
        });
        var submittedTokenModel = mvc.Components.getInstance('submitted', {
            create: true
        });

        urlTokenModel.on('url:navigate', function() {
            defaultTokenModel.set(urlTokenModel.toJSON());
            if (!_.isEmpty(urlTokenModel.toJSON()) && !_.all(urlTokenModel.toJSON(), _.isUndefined)) {
                submitTokens();
            } else {
                submittedTokenModel.clear();
            }
        });

        // Initialize tokens
        defaultTokenModel.set(urlTokenModel.toJSON());

        function submitTokens() {
            // Copy the contents of the defaultTokenModel to the submittedTokenModel and urlTokenModel
            FormUtils.submitForm({
                replaceState: pageLoading
            });
        }

        function setToken(name, value) {
            defaultTokenModel.set(name, value);
            submittedTokenModel.set(name, value);
        }

        function unsetToken(name) {
            defaultTokenModel.unset(name);
            submittedTokenModel.unset(name);
        }

        //
        // VARIOUS
        //

        //console.log("Splunk version is " + $C.VERSION_LABEL);

        //
        // SEARCH MANAGERS
        //

        // whitelist

        // whitelist data_source

        var searchPopulateIndexesForWhiteListDataSource = new SearchManager({
            "id": "searchPopulateIndexesForWhiteListDataSource",
            "earliest_time": "$modalTimeWhiteListDataSource.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTimeWhiteListDataSource.latest$",
            "search": "| `trackme_tstats` count where index=* by index | lookup trackme_data_source_monitoring_whitelist_index data_index as index OUTPUT data_index as FOUND | where isnull(FOUND) | sort limit=0 index | fields index",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$",
                "depends": "$start_modify_data_source_whitelist$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist metric_category

        var searchPopulateMetricCategoriesForBlackListMetricHost = new SearchManager({
            "id": "searchPopulateMetricCategoriesForBlackListMetricHost",
            "earliest_time": "$modalTimeBlackListMetricHost.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTimeBlackListMetricHost.latest$",
            "search": "| mcatalog values(metric_name) as metrics where index=* `trackme_mstats_main_filter` | rename metrics as metric_name | mvexpand metric_name | rex field=metric_name \"(?<metric_category>[^\.]*)\.{0,1}\"  | stats count by metric_category | fields metric_category | lookup trackme_metric_host_monitoring_blacklist_metric_category metric_category | where isnull(metric_blacklist_state) | sort limit=0 metric_category",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$",
                "depends": "$start_modify_metric_host_blacklist_metric_category$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // whitelist data_host

        var searchPopulateIndexesForWhiteListDataHost = new SearchManager({
            "id": "searchPopulateIndexesForWhiteListDataHost",
            "earliest_time": "$modalTimeWhiteListDataHost.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTimeWhiteListDataHost.latest$",
            "search": "| `trackme_tstats` count where index=* by index | lookup trackme_data_host_monitoring_whitelist_index data_index as index OUTPUT data_index as FOUND | where isnull(FOUND) | sort limit=0 index | fields index",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$",
                "depends": "$start_modify_data_host_whitelist$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // whitelist metric_host

        var searchPopulateIndexesForWhiteListMetricHost = new SearchManager({
            "id": "searchPopulateIndexesForWhiteListMetricHost",
            "earliest_time": "$modalTimeWhiteListMetricHost.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTimeWhiteListMetricHost.latest$",
            "search": "| mcatalog values(metric_name) as metrics where index=* by index | rename metrics as metric_name | stats values(index) as index | mvexpand index | lookup trackme_metric_host_monitoring_whitelist_index metric_index as index OUTPUT metric_index as FOUND | where isnull(FOUND) | sort limit=0 index | fields index",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$",
                "depends": "$start_modify_metric_host_whitelist$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // data sources monitoring

        var searchDataSourcesMain = new SearchManager({
            "id": "searchDataSourcesMain",
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "refreshType": "delay",
            "refresh": "$refresh$",
            "latest_time": "+5m",
            "search": "| inputlookup trackme_data_source_monitoring\n| eval keyid=_key\n| `apply_data_source_blacklists`\n| search `trackme_get_idx_whitelist_searchtime(trackme_data_source_monitoring_whitelist_index, data_index)`\n| `trackme_eval_data_source_state`\n| `trackme_default_priority`\n| `trackme_date_format(data_last_time_seen)`\n| `trackme_date_format(data_last_time_seen_idx)`\n| `trackme_date_format(data_last_ingest)`\n| fillnull value=\"red\" data_source_state\n| sort 0 data_source\n| `trackme_eval_icons`\n| search $inputDataNameFilter$\n| search `trackme_get_idx_whitelist_searchtime(trackme_data_source_monitoring_whitelist_index, data_index)`\n| `apply_data_source_blacklists`\n",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchDataSourcesPostTable = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputDataName$ $inputDataIndex$ $inputDataSourcetype$ $data_source_state$ $data_monitored_state$ $inputDataPriority$\n| fillnull data_last_lag_seen, data_last_ingestion_lag_seen\n| eval data_last_lag_seen=round(data_last_lag_seen, 0) | eval data_last_ingestion_lag_seen=round(data_last_ingestion_lag_seen, 0) | fillnull value=\"N/A\" data_last_lag_seen, data_last_ingestion_lag_seen\n| eval \"lag summary (lag event / lag ingestion)\" = if(data_last_lag_seen>60, tostring(data_last_lag_seen, \"duration\"), data_last_lag_seen . \" sec\") . \" / \" . if(data_last_ingestion_lag_seen>60, tostring(data_last_ingestion_lag_seen, \"duration\"), data_last_ingestion_lag_seen . \" sec\")\n| rename \"data_last_time_seen (translated)\" as \"last time\", \"data_last_ingest (translated)\" as \"last ingest\", \"data_last_time_seen_idx (translated)\" as \"last time idx\"\n| eval data_tracker_runtime=now()\n| `trackme_date_format(\"latest_flip_time\")`\n| fillnull value=\"N/A\" latest_flip_state, latest_flip_time, \"latest_flip_time (translated)\"\n| `trackme_get_identity_card(data_name)`\n| `trackme_lookup_elastic_sources`\n|`trackme_ack_lookup_main(data_name)`\n| sort limit=10000 data_name",
            "managerid": "searchDataSourcesMain",
            "id": "searchDataSourcesPostTable"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchDataSourcesMainStats = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputDataName$ $inputDataIndex$ $inputDataSourcetype$ | stats count as total, count(eval(data_monitored_state=\"disabled\")) as total_disabled, count(eval(data_source_state!=\"green\" AND data_source_state!=\"info\" AND data_monitored_state=\"enabled\")) as total_in_alert, count(eval(data_source_state=\"red\" AND priority=\"high\" AND data_monitored_state=\"enabled\")) as total_high_priority_red, count(eval(data_monitored_state=\"enabled\" AND priority=\"low\")) as low_enabled, count(eval(data_monitored_state=\"enabled\" AND priority=\"medium\")) as medium_enabled, count(eval(data_monitored_state=\"enabled\" AND priority=\"high\")) as high_enabled, count(eval(data_source_state=\"blue\" AND data_monitored_state=\"enabled\")) as \"blue\", count(eval(data_source_state=\"orange\" AND data_monitored_state=\"enabled\")) as \"orange\", count(eval(data_source_state=\"green\" AND data_monitored_state=\"enabled\")) as \"green\", count(eval(data_source_state=\"red\" AND data_monitored_state=\"enabled\" AND priority=\"high\")) as \"red - high priority\", count(eval(data_source_state=\"red\" AND data_monitored_state=\"enabled\" AND priority!=\"high\")) as \"red - other priority\"",
            "managerid": "searchDataSourcesMain",
            "id": "searchDataSourcesMainStats"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateDataSources = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputDataIndex$ $inputDataSourcetype$ | stats values(data_name) as data_name | mvexpand data_name | dedup data_name | sort limit=1000 data_name",
            "managerid": "searchDataSourcesMain",
            "id": "searchPopulateDataSources"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateDataSourcesIndexes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputDataName$ $inputDataSourcetype$ | stats values(data_index) as data_index | mvexpand data_index | dedup data_index | sort limit=1000 data_index",
            "managerid": "searchDataSourcesMain",
            "id": "searchPopulateDataSourcesIndexes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateDataSourcesSourcetypes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputDataName$ $inputDataIndex$ | stats values(data_sourcetype) as data_sourcetype | mvexpand data_sourcetype | dedup data_sourcetype | sort limit=1000 data_sourcetype",
            "managerid": "searchDataSourcesMain",
            "id": "searchPopulateDataSourcesSourcetypes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Audit Flip
        var searchMainAuditFlip = new SearchManager({
            "id": "searchMainAuditFlip",
            "earliest_time": "$timerange_audit_flip.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$timerange_audit_flip.latest$",
            "search": "`trackme_idx` source=\"flip_state_change_tracking\" $audit_flip_object_category$ $audit_flip_object$ $inputAuditFlipObjectFilter$ | eval separator = \"-->\" | dedup _time object object_category object_previous_state object_state | table _time object object_category object_previous_state separator object_state result | rename separator as \" \" | `trackme_eval_icons_flip`",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_audit_flip$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchMainAuditFlipTable = new PostProcessManager({
            "tokenDependencies": {},
            "search": "sort limit=10000 - _time",
            "managerid": "searchMainAuditFlip",
            "id": "searchMainAuditFlipTable"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchMainAuditFlipPopulate = new SearchManager({
            "id": "searchMainAuditFlipPopulate",
            "earliest_time": "$timerange_audit_flip.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$timerange_audit_flip.latest$",
            "search": "`trackme_idx` source=\"flip_state_change_tracking\" | stats count by object_category, object",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_audit_flip$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditFlipObjectCategory = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count by object_category | sort limit=0 object_category",
            "managerid": "searchMainAuditFlipPopulate",
            "id": "searchAuditFlipObjectCategory"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditFlipObject = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $audit_flip_object_category$ $inputAuditFlipObjectFilter$ | stats count by object | sort limit=1000 object",
            "managerid": "searchMainAuditFlipPopulate",
            "id": "searchAuditFlipObject"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditFlipTopObject = new PostProcessManager({
            "tokenDependencies": {},
            "search": "top object",
            "managerid": "searchMainAuditFlip",
            "id": "searchAuditFlipTopObject"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditFlipOverTime = new PostProcessManager({
            "tokenDependencies": {},
            "search": "timechart limit=40 useother=t minspan=1h bins=1000 count by object",
            "managerid": "searchMainAuditFlip",
            "id": "searchAuditFlipOverTime"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Audit Changes Data Source
        var searchDataSourceMainAuditChanges = new SearchManager({
            "id": "searchDataSourceMainAuditChanges",
            "earliest_time": "$modalTime.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTime.latest$",
            "search": "| inputlookup trackme_audit_changes where (object=\"$tk_data_name$\" AND object_category=\"data_source\") | sort limit=0 - time | eval _time=time/1000 | fields - time | addinfo | where _time>=info_min_time AND (_time<=info_max_time OR info_max_time=\"+Infinity\") | `trackme_eval_icons_audit_changes` | rename action_icon as \" \" | fields _time user action \" \" change_type comment",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_audit_changes$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchDataSourceMainAuditChanges",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_data_source_audit_changes_no_results"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_data_source_audit_changes_no_results",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchMainDataSourceAuditChangesTable = new PostProcessManager({
            "tokenDependencies": {},
            "search": "sort - limit=10000 _time",
            "managerid": "searchDataSourceMainAuditChanges",
            "id": "searchMainDataSourceAuditChangesTable"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditDataSourceAuditChangesOverTime = new PostProcessManager({
            "tokenDependencies": {},
            "search": "timechart limit=40 useother=t minspan=1h bins=1000 count by action",
            "managerid": "searchDataSourceMainAuditChanges",
            "id": "searchAuditDataSourceAuditChangesOverTime"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Lagging performance metrics
        var searchLaggingMetricDataSource = new SearchManager({
            "id": "searchLaggingMetricDataSource",
            "earliest_time": "$modalTime.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTime.latest$",
            "search": "| mstats max(trackme.lag_event_sec) as lag_event_sec, max(trackme.lag_ingestion_sec) as lag_ingestion_sec where `trackme_metrics_idx` object_category=\"data_source\" object=\"$tk_data_name$\" by object span=5m | timechart span=$modalTime.span$ avg(lag_event_sec) as lag_event_sec, avg(lag_ingestion_sec) as lag_ingestion_sec",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_lagging_metrics$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchLaggingMetricDataHost = new SearchManager({
            "id": "searchLaggingMetricDataHost",
            "earliest_time": "$modalTimeHost.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTimeHost.latest$",
            "search": "| mstats max(trackme.lag_event_sec) as lag_event_sec, max(trackme.lag_ingestion_sec) as lag_ingestion_sec where `trackme_metrics_idx` object_category=\"data_host\" object=\"$tk_data_host$\" by object span=5m | timechart span=$modalTimeHost.span$ avg(lag_event_sec) as lag_event_sec, avg(lag_ingestion_sec) as lag_ingestion_sec",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_lagging_metrics$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Audit Changes Data Host
        var searchDataHostMainAuditChanges = new SearchManager({
            "id": "searchDataHostMainAuditChanges",
            "earliest_time": "$modalTime.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTime.latest$",
            "search": "| inputlookup trackme_audit_changes where (object=\"$tk_data_host$\" AND object_category=\"data_host\") | sort limit=0 - time | eval _time=time/1000 | fields - time | addinfo | where _time>=info_min_time AND (_time<=info_max_time OR info_max_time=\"+Infinity\") | `trackme_eval_icons_audit_changes` | rename action_icon as \" \" | fields _time user action \" \" change_type comment",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_audit_changes$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchDataHostMainAuditChanges",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_data_host_audit_changes_no_results"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_data_host_audit_changes_no_results",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchMainDataHostAuditChangesTable = new PostProcessManager({
            "tokenDependencies": {},
            "search": "sort - limit=10000 _time",
            "managerid": "searchDataHostMainAuditChanges",
            "id": "searchMainDataHostAuditChangesTable"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditDataHostAuditChangesOverTime = new PostProcessManager({
            "tokenDependencies": {},
            "search": "timechart limit=40 useother=t minspan=1h bins=1000 count by action",
            "managerid": "searchDataHostMainAuditChanges",
            "id": "searchAuditDataHostAuditChangesOverTime"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Audit Changes Metric Host
        var searchMetricHostMainAuditChanges = new SearchManager({
            "id": "searchMetricHostMainAuditChanges",
            "earliest_time": "$modalTime.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTime.latest$",
            "search": "| inputlookup trackme_audit_changes where (object=\"$tk_metric_host$\" AND object_category=\"metric_host\") | sort limit=0 - time | eval _time=time/1000 | fields - time | addinfo | where _time>=info_min_time AND (_time<=info_max_time OR info_max_time=\"+Infinity\") | `trackme_eval_icons_audit_changes` | rename action_icon as \" \" | fields _time user action \" \" change_type comment",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_audit_changes$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchMetricHostMainAuditChanges",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_metric_host_audit_changes_no_results"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_metric_host_audit_changes_no_results",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchMainMetricHostAuditChangesTable = new PostProcessManager({
            "tokenDependencies": {},
            "search": "sort - limit=10000 _time",
            "managerid": "searchMetricHostMainAuditChanges",
            "id": "searchMainMetricHostAuditChangesTable"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditMetricHostAuditChangesOverTime = new PostProcessManager({
            "tokenDependencies": {},
            "search": "timechart limit=40 useother=t minspan=1h bins=1000 count by action",
            "managerid": "searchMetricHostMainAuditChanges",
            "id": "searchAuditMetricHostAuditChangesOverTime"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Audit Flip
        var searchDataSourceMainAuditFlip = new SearchManager({
            "id": "searchDataSourceMainAuditFlip",
            "earliest_time": "$modalTime.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTime.latest$",
            "search": "`trackme_idx` source=\"flip_state_change_tracking\" object_category=\"data_source\" object=\"$tk_data_name$\" | eval separator = \"-->\" | dedup _time object object_category object_previous_state object_state | table _time object object_category object_previous_state separator object_state result",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_flipping_status$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchDataSourceMainAuditFlip",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_flipping_status_no_results"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_flipping_status_no_results",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchMainDataSourceAuditFlipTable = new PostProcessManager({
            "tokenDependencies": {},
            "search": "rename separator as \" \" | `trackme_eval_icons_flip` | fields _time	object object_category object_previous_state \" \" object_state | sort - limit=10000 _time",
            "managerid": "searchDataSourceMainAuditFlip",
            "id": "searchMainDataSourceAuditFlipTable"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditDataSourceFlipOverTime = new PostProcessManager({
            "tokenDependencies": {},
            "search": "timechart limit=40 useother=t minspan=1h bins=1000 count by object_state",
            "managerid": "searchDataSourceMainAuditFlip",
            "id": "searchAuditDataSourceFlipOverTime"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchDataHostMainAuditFlip = new SearchManager({
            "id": "searchDataHostMainAuditFlip",
            "earliest_time": "$modalTimeHost.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTimeHost.latest$",
            "search": "`trackme_idx` source=\"flip_state_change_tracking\" object_category=\"data_host\" object=\"$tk_data_host$\" | eval separator = \"-->\" | dedup _time object object_category object_previous_state object_state | table _time object object_category object_previous_state separator object_state result",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_flipping_status$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchDataHostMainAuditFlip",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_data_host_flipping_status_no_results"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_data_host_flipping_status_no_results",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchMainDataHostAuditFlipTable = new PostProcessManager({
            "tokenDependencies": {},
            "search": "rename separator as \" \" | `trackme_eval_icons_flip` | fields _time	object object_category object_previous_state \" \" object_state | sort - limit=10000 _time",
            "managerid": "searchDataHostMainAuditFlip",
            "id": "searchMainDataHostAuditFlipTable"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditDataHostFlipOverTime = new PostProcessManager({
            "tokenDependencies": {},
            "search": "timechart limit=40 useother=t minspan=1h bins=1000 count by object_state",
            "managerid": "searchDataHostMainAuditFlip",
            "id": "searchAuditDataHostFlipOverTime"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchMetricHostMainAuditFlip = new SearchManager({
            "id": "searchMetricHostMainAuditFlip",
            "earliest_time": "$modalTimeMetricHost.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTimeMetricHost.latest$",
            "search": "`trackme_idx` source=\"flip_state_change_tracking\" object_category=\"metric_host\" object=\"$tk_metric_host$\" | eval separator = \"-->\" | dedup _time object object_category object_previous_state object_state | table _time object object_category object_previous_state separator object_state result",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_flipping_status$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchMetricHostMainAuditFlip",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_metric_host_flipping_status_no_results"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_metric_host_flipping_status_no_results",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchMainMetricHostAuditFlipTable = new PostProcessManager({
            "tokenDependencies": {},
            "search": "rename separator as \" \" | `trackme_eval_icons_flip` | fields _time	object object_category object_previous_state \" \" object_state | sort - limit=10000 _time",
            "managerid": "searchMetricHostMainAuditFlip",
            "id": "searchMainMetricHostAuditFlipTable"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditmetricHostFlipOverTime = new PostProcessManager({
            "tokenDependencies": {},
            "search": "timechart limit=40 useother=t minspan=1h bins=1000 count by object_state",
            "managerid": "searchMetricHostMainAuditFlip",
            "id": "searchAuditmetricHostFlipOverTime"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Audit Changes
        var searchMainAuditChanges = new SearchManager({
            "id": "searchMainAuditChanges",
            "earliest_time": "$timerange_audit_changes.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$timerange_audit_changes.latest$",
            "search": "| inputlookup trackme_audit_changes | sort limit=0 - time | eval _time=time/1000 | fields - time | addinfo | where _time>=info_min_time AND (_time<=info_max_time OR info_max_time=\"+Infinity\") | search $audit_changes_action$ $audit_changes_object_category$ $audit_changes_change_type$ $audit_changes_user$ $audit_changes_object$ | `trackme_eval_icons_audit_changes` | rename action_icon as \" \" | fields _time user action \" \" change_type object_category object object_attrs comment",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchMainAuditChangesPopulate = new SearchManager({
            "id": "searchMainAuditChangesPopulate",
            "earliest_time": "$timerange_audit_changes.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$timerange_audit_changes.latest$",
            "search": "| inputlookup trackme_audit_changes | sort limit=0 - time | eval _time=time/1000 | addinfo | where _time>=info_min_time AND (_time<=info_max_time OR info_max_time=\"+Infinity\")",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesAction = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count by action | sort limit=0 action",
            "managerid": "searchMainAuditChangesPopulate",
            "id": "searchAuditChangesAction"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesUser = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $audit_changes_action$ | stats count by user | sort limit=0 user",
            "managerid": "searchMainAuditChangesPopulate",
            "id": "searchAuditChangesUser"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesObjectCategory = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $audit_changes_action$ $audit_changes_user$ | stats count by object_category | sort limit=0 object_category",
            "managerid": "searchMainAuditChangesPopulate",
            "id": "searchAuditChangesObjectCategory"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesChangeType = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $audit_changes_action$ $audit_changes_user$ $audit_changes_object_category$ | stats count by change_type | sort limit=0 change_type",
            "managerid": "searchMainAuditChangesPopulate",
            "id": "searchAuditChangesChangeType"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesObject = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $audit_changes_action$ $audit_changes_user$ $audit_changes_object_category$ $audit_changes_change_type$ | stats count by object | sort limit=0 object",
            "managerid": "searchMainAuditChangesPopulate",
            "id": "searchAuditChangesObject"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesTopAction = new PostProcessManager({
            "tokenDependencies": {},
            "search": "top action",
            "managerid": "searchMainAuditChanges",
            "id": "searchAuditChangesTopAction"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesTopUser = new PostProcessManager({
            "tokenDependencies": {},
            "search": "top user",
            "managerid": "searchMainAuditChanges",
            "id": "searchAuditChangesTopUser"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesTopChangeType = new PostProcessManager({
            "tokenDependencies": {},
            "search": "top change_type",
            "managerid": "searchMainAuditChanges",
            "id": "searchAuditChangesTopChangeType"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // metric hosts monitoring
        var searchMetricHostsMain = new SearchManager({
            "id": "searchMetricHostsMain",
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "refreshType": "delay",
            "refresh": "$refresh$",
            "latest_time": "now",
            "search": "| savedsearch \"TrackMe - metric hosts collection based table report\"\n| `trackme_date_format(\"metric_last_time_seen\")`\n| rename \"metric_last_time_seen (translated)\" as \"last time\"\n| `trackme_eval_metric_host_state`\n| `trackme_metric_host_group_lookup`\n|`trackme_eval_icons_metric_host`\n|`trackme_date_format(\"latest_flip_time\")`\n| fillnull value=\"N/A\" latest_flip_state, latest_flip_time, \"latest_flip_time (translated)\"\n| search $inputMetricHostFilter$\n|`trackme_ack_lookup_main(metric_host)`",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchMainTableMetricHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputMetricHostIndexes$ $inputMetricHostCategories$ $inputMetricHost$ $inputMetricHostPriority$ $metric_host_state$ $metric_monitored_state$ | sort limit=10000 metric_host",
            "managerid": "searchMetricHostsMain",
            "id": "searchMainTableMetricHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchMetricHostsMainStats = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputMetricHostIndexes$ $inputMetricHostCategories$ $inputMetricHost$ | stats count as total, count(eval(metric_monitored_state=\"disabled\")) as total_disabled, count(eval(metric_host_state!=\"green\" AND metric_host_state!=\"info\" AND metric_monitored_state=\"enabled\")) as total_in_alert, count(eval(metric_host_state=\"red\" AND priority=\"high\" AND metric_monitored_state=\"enabled\")) as total_high_priority_red, count(eval(metric_monitored_state=\"enabled\" AND priority=\"low\")) as low_enabled, count(eval(metric_monitored_state=\"enabled\" AND priority=\"medium\")) as medium_enabled, count(eval(metric_monitored_state=\"enabled\" AND priority=\"high\")) as high_enabled, count(eval(metric_host_state=\"blue\" AND metric_monitored_state=\"enabled\")) as \"blue\", count(eval(metric_host_state=\"orange\" AND metric_monitored_state=\"enabled\")) as \"orange\", count(eval(metric_host_state=\"green\" AND metric_monitored_state=\"enabled\")) as \"green\", count(eval(metric_host_state=\"red\" AND metric_monitored_state=\"enabled\" AND priority=\"high\")) as \"red - high priority\", count(eval(metric_host_state=\"red\" AND metric_monitored_state=\"enabled\" AND priority!=\"high\")) as \"red - other priority\"",
            "managerid": "searchMetricHostsMain",
            "id": "searchMetricHostsMainStats"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateMetricHostsIndexes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputMetricHostCategories$ $inputMetricHost$ | stats values(metric_index) as metric_index | mvexpand metric_index | dedup metric_index | sort limit=0 metric_index",
            "managerid": "searchMetricHostsMain",
            "id": "searchPopulateMetricHostsIndexes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateMetricHosts = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputMetricHostIndexes$ $inputMetricHostCategories$ | stats count by metric_host | sort limit=1000 metric_host",
            "managerid": "searchMetricHostsMain",
            "id": "searchPopulateMetricHosts"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateMetricHostsCategories = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputMetricHostIndexes$ $inputMetricHost$ | stats values(metric_category) as metric_category | mvexpand metric_category | dedup metric_category | search NOT [ | inputlookup trackme_metric_lagging_definition | table metric_category ] | sort limit=1000 metric_category",
            "managerid": "searchMetricHostsMain",
            "id": "searchPopulateMetricHostsCategories"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchHostTableMetricHost = new SearchManager({
            "id": "searchHostTableMetricHost",
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "refreshType": "delay",
            "refresh": "$refresh$",
            "latest_time": "now",
            "search": "| savedsearch \"trackMe - metric per host table report\" host=\"$tk_metric_host$\"",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$",
                "depends": "$tk_metric_host$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchHostSingleMetricHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count as count_metric_category, count(eval(metric_host_state=\"green\")) as count_green, count(eval(metric_host_state!=\"green\")) as count_non_green | eval summary=\" metric categories: \" . count_metric_category .  \", \" . \"green state: \" . count_green . \", \" . \"red state: \" . count_non_green | fields summary",
            "managerid": "searchHostTableMetricHost",
            "id": "searchHostSingleMetricHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchHostChartMetricHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "top metric_host_state",
            "managerid": "searchHostTableMetricHost",
            "id": "searchHostChartMetricHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleSLAMetricHostpct = new SearchManager({
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "search": "`trackme_get_sla_pct_per_entity(metric_host,$tk_metric_host$,trackme_metric_host_monitoring,metric_host,metric_first_time_seen)`",
            "id": "searchSingleSLAMetricHostpct",
            "sample_ratio": 1,
            "status_buckets": 0,
            "earliest_time": "-90d@d",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // hosts monitoring

        var searchDataHostsMain = new SearchManager({
            "id": "searchDataHostsMain",
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "refreshType": "delay",
            "refresh": "$refresh$",
            "latest_time": "+5m",
            "search": "| inputlookup trackme_host_monitoring\n| eval keyid=_key\n| sort limit=0 - data_last_time_seen\n| dedup data_host\n| eval data_index_raw=data_index, data_sourcetype_raw=data_sourcetype\n| makemv delim=\",\" data_index\n| makemv delim=\",\" data_sourcetype\n| `apply_data_host_blacklists`\n| search `trackme_get_idx_whitelist_searchtime(trackme_data_host_monitoring_whitelist_index, data_index)`\n| `trackme_eval_data_host_state`\n| `trackme_default_priority`\n| `trackme_data_host_group_lookup`\n| `trackme_date_format(data_last_time_seen)`\n| `trackme_date_format(data_last_time_seen_idx)`\n| `trackme_date_format(data_last_ingest)`\n| `trackme_eval_icons_host`\n| rename \"data_last_ingest (translated)\" as \"last ingest\", \"data_last_time_seen (translated)\" as \"last time\"\n| `trackme_date_format(\"latest_flip_time\")`\n| fillnull value=\"N/A\" latest_flip_state, latest_flip_time, \"latest_flip_time (translated)\"\n| sort limit=0 data_host\n| search $inputDataHostFilter$\n|`trackme_ack_lookup_main(data_host)`",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchMainTableHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputDataHostFilter$ $inputDataHost$ $inputDataHostIndexes$ $inputDataHostSourcetypes$ $data_host_state$ $data_monitored_state$ $inputDataHostPriority$ | fillnull data_last_lag_seen, data_last_ingestion_lag_seen | eval data_last_lag_seen=round(data_last_lag_seen, 0) | eval data_last_ingestion_lag_seen=round(data_last_ingestion_lag_seen, 0) | fillnull value=\"N/A\" data_last_lag_seen, data_last_ingestion_lag_seen\n| eval \"lag summary (lag event / lag ingestion)\" = if(data_last_lag_seen>60, tostring(data_last_lag_seen, \"duration\"), data_last_lag_seen . \" sec\") . \" / \" . if(data_last_ingestion_lag_seen>60, tostring(data_last_ingestion_lag_seen, \"duration\"), data_last_ingestion_lag_seen . \" sec\") | sort limit=10000 data_host",
            "managerid": "searchDataHostsMain",
            "id": "searchMainTableHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchDataHostsMainStats = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputDataHost$ $inputDataHostIndexes$ $inputDataHostSourcetypes$ | stats count as total, count(eval(data_monitored_state=\"disabled\")) as total_disabled, count(eval(data_host_state!=\"green\" AND data_host_state!=\"info\" AND data_monitored_state=\"enabled\")) as total_in_alert, count(eval(data_host_state=\"red\" AND priority=\"high\" AND data_monitored_state=\"enabled\")) as total_high_priority_red, count(eval(data_monitored_state=\"enabled\" AND priority=\"low\")) as low_enabled, count(eval(data_monitored_state=\"enabled\" AND priority=\"medium\")) as medium_enabled, count(eval(data_monitored_state=\"enabled\" AND priority=\"high\")) as high_enabled, count(eval(data_host_state=\"blue\" AND data_monitored_state=\"enabled\")) as \"blue\", count(eval(data_host_state=\"orange\" AND data_monitored_state=\"enabled\")) as \"orange\", count(eval(data_host_state=\"green\" AND data_monitored_state=\"enabled\")) as \"green\", count(eval(data_host_state=\"red\" AND data_monitored_state=\"enabled\" AND priority=\"high\")) as \"red - high priority\", count(eval(data_host_state=\"red\" AND data_monitored_state=\"enabled\" AND priority!=\"high\")) as \"red - other priority\"",
            "managerid": "searchDataHostsMain",
            "id": "searchDataHostsMainStats"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateDataHostsIndexes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "makemv data_index delim=\",\" | search $inputDataHost$ $inputDataHostSourcetypes$ | stats values(data_index) as data_index | mvexpand data_index | dedup data_index | sort limit=1000 data_index",
            "managerid": "searchDataHostsMain",
            "id": "searchPopulateDataHostsIndexes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateDataHostsSourcetypes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "makemv data_index delim=\",\" | makemv data_sourcetype delim=\",\" | search $inputDataHost$ $inputDataHostIndexes$ | stats values(data_sourcetype) as data_sourcetype | mvexpand data_sourcetype | dedup data_sourcetype | sort limit=1000 data_sourcetype",
            "managerid": "searchDataHostsMain",
            "id": "searchPopulateDataHostsSourcetypes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateDataHosts = new PostProcessManager({
            "tokenDependencies": {},
            "search": "makemv data_index delim=\",\" | makemv data_sourcetype delim=\",\" | search $inputDataHostIndexes$ $inputDataHostSourcetypes$ | stats values(data_host) as data_host | mvexpand data_host | dedup data_host | sort limit=1000 data_host",
            "managerid": "searchDataHostsMain",
            "id": "searchPopulateDataHosts"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleNoDataSources = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count by data_name | sort limit=0 data_name",
            "managerid": "searchDataSourcesMain",
            "id": "searchSingleNoDataSources"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleNoDataIndexes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count by data_index | sort limit=0 data_index",
            "managerid": "searchDataSourcesMain",
            "id": "searchSingleNoDataIndexes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleNoDataSourcetypes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count by data_sourcetype | sort limit=0 data_sourcetype",
            "managerid": "searchDataSourcesMain",
            "id": "searchSingleNoDataSourcetypes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleNoDataHosts = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count by data_host | sort limit=0 data_host",
            "managerid": "searchDataHostsMain",
            "id": "searchSingleNoDataHosts"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataSourceDonutAlerts = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields blue, orange, green, \"red - high priority\", \"red - other priority\"\n| transpose | rename column as state, \"row 1\" as count | `trackme_donut_alert_by_type(state)`",
            "managerid": "searchDataSourcesMainStats",
            "id": "searchSingleDataSourceDonutAlerts"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataSourceDonutPriorities = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields low_enabled, medium_enabled, high_enabled | rename low_enabled as low, medium_enabled as medium, high_enabled as high | transpose | rename column as priority, \"row 1\" as count | `trackme_donut_alert_by_priority`",
            "managerid": "searchDataSourcesMainStats",
            "id": "searchSingleDataSourceDonutPriorities"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataSource1 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total",
            "managerid": "searchDataSourcesMainStats",
            "id": "searchSingleDataSource1"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataSourceInAlert = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total_in_alert",
            "managerid": "searchDataSourcesMainStats",
            "id": "searchSingleDataSourceInAlert"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataSourceHighPriority = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total_high_priority_red",
            "managerid": "searchDataSourcesMainStats",
            "id": "searchSingleDataSourceHighPriority"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataSourceNotMonitored = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total_disabled",
            "managerid": "searchDataSourcesMainStats",
            "id": "searchSingleDataSourceNotMonitored"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataHostDonutAlerts = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields blue, orange, green, \"red - high priority\", \"red - other priority\"\n| transpose | rename column as state, \"row 1\" as count | `trackme_donut_alert_by_type(state)`",
            "managerid": "searchDataHostsMainStats",
            "id": "searchSingleDataHostDonutAlerts"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataHostDonutPriorities = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields low_enabled, medium_enabled, high_enabled | rename low_enabled as low, medium_enabled as medium, high_enabled as high | transpose | rename column as priority, \"row 1\" as count | `trackme_donut_alert_by_priority`",
            "managerid": "searchDataHostsMainStats",
            "id": "searchSingleDataHostDonutPriorities"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataHost1 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total",
            "managerid": "searchDataHostsMainStats",
            "id": "searchSingleDataHost1"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataHostInAlert = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total_in_alert",
            "managerid": "searchDataHostsMainStats",
            "id": "searchSingleDataHostInAlert"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataHostNotMonitored = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total_disabled",
            "managerid": "searchDataHostsMainStats",
            "id": "searchSingleDataHostNotMonitored"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataHostHighPriority = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total_high_priority_red",
            "managerid": "searchDataHostsMainStats",
            "id": "searchSingleDataHostHighPriority"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchGetDataHostTags = new SearchManager({
            "id": "searchGetDataHostTags",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| makeresults | eval data_host=\"$tk_data_host$\" | fields - _time | `trackme_get_data_host_tags` | fields - data_host",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // metric_host

        var searchSingleMetricHostDonutAlerts = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields blue, orange, green, \"red - high priority\", \"red - other priority\"\n| transpose | rename column as state, \"row 1\" as count | `trackme_donut_alert_by_type(state)`",
            "managerid": "searchMetricHostsMainStats",
            "id": "searchSingleMetricHostDonutAlerts"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleMetricHostDonutPriorities = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields low_enabled, medium_enabled, high_enabled | rename low_enabled as low, medium_enabled as medium, high_enabled as high | transpose | rename column as priority, \"row 1\" as count | `trackme_donut_alert_by_priority`",
            "managerid": "searchMetricHostsMainStats",
            "id": "searchSingleMetricHostDonutPriorities"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleMetricHost1 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total",
            "managerid": "searchMetricHostsMainStats",
            "id": "searchSingleMetricHost1"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleMetricHostInAlert = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total_in_alert",
            "managerid": "searchMetricHostsMainStats",
            "id": "searchSingleMetricHostInAlert"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleMetricHostHighPriority = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total_high_priority_red",
            "managerid": "searchMetricHostsMainStats",
            "id": "searchSingleMetricHostHighPriority"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleMetricHostNotMonitored = new PostProcessManager({
            "tokenDependencies": {},
            "search": "fields total_disabled",
            "managerid": "searchMetricHostsMainStats",
            "id": "searchSingleMetricHostNotMonitored"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchGetMetricHostTags = new SearchManager({
            "id": "searchGetMetricHostTags",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| makeresults | eval metric_host=\"$tk_metric_host$\" | fields - _time | `trackme_get_metric_host_tags` | fields - metric_host",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchGetMetricHostTags",
            event: "progress",
            conditions: [{
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "tk_metric_host_tags",
                        "value": "$result.metric_host_tags$"
                    }]
                }
            ]
        });

        var searchChartLag = new SearchManager({
            "id": "searchChartLag",
            "sample_ratio": 1,
            "search": "$tk_data_source_overview_root_search$ | timechart span=$modalTime.span$ sum(count) as events_count, avg(delta) as avg_lag_sec",
            "status_buckets": 0,
            "earliest_time": "$modalTime.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTime.latest$",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // data source monitoring

        // Data parsing quality
        var SearchDataSourceParsingQualityMain = new SearchManager({
            "id": "SearchDataSourceParsingQualityMain",
            "tokenDependencies": {
                "depends": "$show_data_quality$"
            },
            "sample_ratio": 1,
            "earliest_time": "$modalTime.earliest$",
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` (component=LineBreakingProcessor OR component=AggregatorMiningProcessor OR component=DateParserVerbose) | `trackme_data_quality_parse` | search data_sourcetype=\"$tk_data_sourcetype$\"",
            "latest_time": "$modalTime.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "SearchDataSourceParsingQualityMain",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_data_quality_no_results"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_data_quality_no_results",
                        "value": "True"
                    }]
                }
            ]
        });

        var SearchDataSourceParsingQualityChart = new PostProcessManager({
            "tokenDependencies": {},
            "search": "timechart span=$modalTime.span$ count by component",
            "managerid": "SearchDataSourceParsingQualityMain",
            "id": "SearchDataSourceParsingQualityChart"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var SearchDataSourceParsingQualitySingle = new PostProcessManager({
            "tokenDependencies": {},
            "search": "top limit=0 component | eval percent=round(percent, 2) | eval summary=component . \": \" . percent . \" %\" | fields summary | stats values(summary) as summary",
            "managerid": "SearchDataSourceParsingQualityMain",
            "id": "SearchDataSourceParsingQualitySingle"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Outlier detection
        var searchOutlierDetectionChart = new SearchManager({
            "id": "searchOutlierDetectionChart",
            "sample_ratio": 1,
            "search": "| `trackme_outlier_chart(data_source, \"$tk_data_name$\", data_name, $tk_outlier_span$)`",
            "status_buckets": 0,
            "earliest_time": "$modalTime.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTime.latest$",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$",
                "depends": "$show_data_source_outlier$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchOutlierDetectionChartSimulation = new SearchManager({
            "id": "searchOutlierDetectionChartSimulation",
            "sample_ratio": 1,
            "search": "| `trackme_outlier_chart_simulate(data_source, \"$tk_data_name$\", data_name, $tk_input_data_source_outlier_lower_threshold_multiplier$, $tk_input_data_source_outlier_upper_threshold_multiplier$, $tk_input_data_source_outlier_min_eventcount$, $tk_input_data_source_outlier_span$)`",
            "status_buckets": 0,
            "earliest_time": "$tk_input_data_source_outlier_period$",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$",
                "depends": "$show_data_source_outlier_configuration$",
                "depends": "$start_outliers_simulation_data_source$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchOutlierDetectionTable = new SearchManager({
            "id": "searchOutlierDetectionTable",
            "sample_ratio": 1,
            "search": "| `trackme_outlier_table(trackme_data_source_monitoring, data_name, $tk_data_name$)`",
            "status_buckets": 0,
            "earliest_time": "-24h",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$",
                "depends": "$show_data_source_outlier$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataSource7d = new SearchManager({
            "id": "searchSingleLagAutoLaggingDataSource7d",
            "sample_ratio": 1,
            "search": "$tk_data_source_overview_root_search$ | stats perc95(delta) as perc95_lag, avg(delta) as avg_lag | eval perc95_lag=round(perc95_lag, 0), avg_lag=round(avg_lag, 0)",
            "status_buckets": 0,
            "earliest_time": "-7d",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_autolagging$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataSource7dSingleLagPerc95 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields perc95_lag | eval perc95_lag = round(perc95_lag, 0) . \" sec (\" . tostring(perc95_lag, \"duration\") . \")\"",
            "managerid": "searchSingleLagAutoLaggingDataSource7d",
            "id": "searchSingleLagAutoLaggingDataSource7dSingleLagPerc95"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataSource7dSingleLagAvg = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields avg_lag | eval avg_lag = round(avg_lag, 0) . \" sec (\" . tostring(avg_lag, \"duration\") . \")\"",
            "managerid": "searchSingleLagAutoLaggingDataSource7d",
            "id": "searchSingleLagAutoLaggingDataSource7dSingleLagAvg"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLag30dAutoLagging = new SearchManager({
            "id": "searchSingleLag30dAutoLagging",
            "sample_ratio": 1,
            "search": "$tk_data_source_overview_root_search$ | stats perc95(delta) as perc95_lag, avg(delta) as avg_lag | eval perc95_lag=round(perc95_lag, 0), avg_lag=round(avg_lag, 0)",
            "status_buckets": 0,
            "earliest_time": "-30d",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_autolagging$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataSource30dSingleLagPerc95 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields perc95_lag | eval perc95_lag = round(perc95_lag, 0) . \" sec (\" . tostring(perc95_lag, \"duration\") . \")\"",
            "managerid": "searchSingleLag30dAutoLagging",
            "id": "searchSingleLagAutoLaggingDataSource30dSingleLagPerc95"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataSource30dSingleLagAvg = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields avg_lag | eval avg_lag = round(avg_lag, 0) . \" sec (\" . tostring(avg_lag, \"duration\") . \")\"",
            "managerid": "searchSingleLag30dAutoLagging",
            "id": "searchSingleLagAutoLaggingDataSource30dSingleLagAvg"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataHost7d = new SearchManager({
            "id": "searchSingleLagAutoLaggingDataHost7d",
            "sample_ratio": 1,
            "search": "| tstats count latest(_indextime) as indextime where index=* host=\"$tk_data_host$\" `trackme_tstats_main_filter` `trackme_get_idx_whitelist(trackme_data_host_monitoring_whitelist_index, data_index)` `apply_data_host_blacklists_data_retrieve` by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats perc95(delta) as perc95_lag, avg(delta) as avg_lag | eval perc95_lag=round(perc95_lag, 0), avg_lag=round(avg_lag, 0)",
            "status_buckets": 0,
            "earliest_time": "-7d",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_autolagging$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataHost7dSingleLagPerc95 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields perc95_lag | eval perc95_lag = round(perc95_lag, 0) . \" sec (\" . tostring(perc95_lag, \"duration\") . \")\"",
            "managerid": "searchSingleLagAutoLaggingDataHost7d",
            "id": "searchSingleLagAutoLaggingDataHost7dSingleLagPerc95"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataHost7dSingleLagAvg = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields avg_lag | eval avg_lag = round(avg_lag, 0) . \" sec (\" . tostring(avg_lag, \"duration\") . \")\"",
            "managerid": "searchSingleLagAutoLaggingDataHost7d",
            "id": "searchSingleLagAutoLaggingDataHost7dSingleLagAvg"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLag30dAutoLaggingDataHost = new SearchManager({
            "id": "searchSingleLag30dAutoLaggingDataHost",
            "sample_ratio": 1,
            "search": "| tstats count latest(_indextime) as indextime where index=* host=\"$tk_data_host$\" `trackme_tstats_main_filter` `trackme_get_idx_whitelist(trackme_data_host_monitoring_whitelist_index, data_index)` `apply_data_host_blacklists_data_retrieve` by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats perc95(delta) as perc95_lag, avg(delta) as avg_lag | eval perc95_lag=round(perc95_lag, 0), avg_lag=round(avg_lag, 0)",
            "status_buckets": 0,
            "earliest_time": "-30d",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_autolagging$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataHost30dSingleLagPerc95 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields perc95_lag | eval perc95_lag = round(perc95_lag, 0) . \" sec (\" . tostring(perc95_lag, \"duration\") . \")\"",
            "managerid": "searchSingleLag30dAutoLaggingDataHost",
            "id": "searchSingleLagAutoLaggingDataHost30dSingleLagPerc95"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAutoLaggingDataHost30dSingleLagAvg = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields avg_lag | eval avg_lag = round(avg_lag, 0) . \" sec (\" . tostring(avg_lag, \"duration\") . \")\"",
            "managerid": "searchSingleLag30dAutoLaggingDataHost",
            "id": "searchSingleLagAutoLaggingDataHost30dSingleLagAvg"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLag = new SearchManager({
            "id": "searchSingleLag",
            "sample_ratio": 1,
            "search": "$tk_data_source_overview_root_search$ | stats perc95(delta) as perc95_lag, avg(delta) as avg_lag",
            "status_buckets": 0,
            "earliest_time": "$modalTime.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTime.latest$",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagPerc95 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields perc95_lag",
            "managerid": "searchSingleLag",
            "id": "searchSingleLagPerc95"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAvg = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields avg_lag",
            "managerid": "searchSingleLag",
            "id": "searchSingleLagAvg"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleSLApct = new SearchManager({
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "search": "`trackme_get_sla_pct_per_entity(data_source,$tk_data_name$,trackme_data_source_monitoring,data_name,data_first_time_seen)`",
            "id": "searchSingleSLApct",
            "sample_ratio": 1,
            "status_buckets": 0,
            "earliest_time": "-90d@d",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // data host monitoring

        // Data parsing quality
        var SearchDataHostParsingQualityMain = new SearchManager({
            "id": "SearchDataHostParsingQualityMain",
            "tokenDependencies": {
                "depends": "$show_data_host_quality$"
            },
            "sample_ratio": 1,
            "earliest_time": "$modalTimeHost.earliest$",
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=LineBreakingProcessor OR component=AggregatorMiningProcessor OR component=DateParserVerbose | `trackme_data_quality_parse` | search data_host=\"$tk_data_host$\"",
            "latest_time": "$modalTimeHost.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "SearchDataHostParsingQualityMain",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_data_host_quality_no_results"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_data_host_quality_no_results",
                        "value": "True"
                    }]
                }
            ]
        });

        var SearchDataHostParsingQualityChart = new PostProcessManager({
            "tokenDependencies": {},
            "search": "timechart span=$modalTimeHost.span$ count by component",
            "managerid": "SearchDataHostParsingQualityMain",
            "id": "SearchDataHostParsingQualityChart"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var SearchDataHostParsingQualitySingle = new PostProcessManager({
            "tokenDependencies": {},
            "search": "top limit=0 component | eval percent=round(percent, 2) | eval summary=component . \": \" . percent . \" %\" | fields summary | stats values(summary) as summary",
            "managerid": "SearchDataHostParsingQualityMain",
            "id": "SearchDataHostParsingQualitySingle"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Outlier detection
        var searchOutlierDetectionChartDataHost = new SearchManager({
            "id": "searchOutlierDetectionChartDataHost",
            "sample_ratio": 1,
            "search": "| `trackme_outlier_chart(data_host, \"$tk_data_host$\", data_host, $tk_outlier_span$)`",
            "status_buckets": 0,
            "earliest_time": "$modalTimeHost.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTimeHost.latest$",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$",
                "depends": "$show_data_host_outlier$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchOutlierDetectionChartSimulationDataHost = new SearchManager({
            "id": "searchOutlierDetectionChartSimulationDataHost",
            "sample_ratio": 1,
            "search": "| `trackme_outlier_chart_simulate(data_host, \"$tk_data_host$\", data_host, $tk_input_data_host_outlier_lower_threshold_multiplier$, $tk_input_data_host_outlier_upper_threshold_multiplier$, $tk_input_data_host_outlier_min_eventcount$, $tk_input_data_host_outlier_span$)`",
            "status_buckets": 0,
            "earliest_time": "$tk_input_data_host_outlier_period$",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$",
                "depends": "$show_data_host_outlier_configuration$",
                "depends": "$start_outliers_simulation_data_host$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchOutlierDetectionTableDataHost = new SearchManager({
            "id": "searchOutlierDetectionTableDataHost",
            "sample_ratio": 1,
            "search": "| `trackme_outlier_table(trackme_host_monitoring, data_host, $tk_data_host$)`",
            "status_buckets": 0,
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$",
                "depends": "$show_data_host_outlier$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagHost = new SearchManager({
            "id": "searchSingleLagHost",
            "sample_ratio": 1,
            "search": "| tstats count latest(_indextime) as indextime where index=* host=\"$tk_data_host$\" `trackme_tstats_main_filter` `trackme_get_idx_whitelist(trackme_data_host_monitoring_whitelist_index, data_index)` `apply_data_host_blacklists_data_retrieve` by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats perc95(delta) as perc95_lag, avg(delta) as avg_lag",
            "status_buckets": 0,
            "earliest_time": "$modalTimeHost.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTimeHost.latest$",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagHostPerc95 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields perc95_lag",
            "managerid": "searchSingleLagHost",
            "id": "searchSingleLagHostPerc95"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagHostAvg = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields avg_lag",
            "managerid": "searchSingleLagHost",
            "id": "searchSingleLagHostAvg"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleSLAHostpct = new SearchManager({
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "search": "`trackme_get_sla_pct_per_entity(data_host,$tk_data_host$,trackme_host_monitoring,data_host,data_first_time_seen)`",
            "id": "searchSingleSLAHostpct",
            "sample_ratio": 1,
            "status_buckets": 0,
            "earliest_time": "-90d@d",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchChartHostBaseSearch = new SearchManager({
            "id": "searchChartHostBaseSearch",
            "earliest_time": "$modalTimeHost.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTimeHost.latest$",
            "sample_ratio": 1,
            "search": "| tstats count where index=* host=\"$tk_data_host$\" `trackme_tstats_main_filter` `trackme_get_idx_whitelist(trackme_data_host_monitoring_whitelist_index, data_index)` `apply_data_host_blacklists_data_retrieve` by index, sourcetype",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchChartHostIndexes = new PostProcessManager({
            "tokenDependencies": {},
            "managerid": "searchChartHostBaseSearch",
            "search": "stats sum(count) as count by index | sort - count",
            "id": "searchChartHostIndexes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchChartHostSourcetypes = new PostProcessManager({
            "tokenDependencies": {},
            "managerid": "searchChartHostBaseSearch",
            "search": "stats sum(count) as count by sourcetype | sort - count",
            "id": "searchChartHostSourcetypes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchChartLagHostOverTime = new SearchManager({
            "id": "searchChartLagHostOverTime",
            "earliest_time": "$modalTimeHost.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTimeHost.latest$",
            "sample_ratio": 1,
            "search": "| tstats count max(_indextime) as indextime where index=* host=\"$tk_data_host$\" `trackme_tstats_main_filter` `trackme_get_idx_whitelist(trackme_data_host_monitoring_whitelist_index, data_index)` `apply_data_host_blacklists_data_retrieve` by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | timechart span=$modalTimeHost.span$ sum(count) as events_count, avg(delta) as avg_lag_sec",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Metric SLA policies

        var searchMetricPolicies = new SearchManager({
            "id": "searchMetricPolicies",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_metric_lagging_definition | eval keyid=_key",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_metric_sla_policies$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchMetricPolicies",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_metric_policies"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_metric_policies",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleMetricPolicies = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchMetricPolicies",
            "id": "searchSingleMetricPolicies"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Custom lagging

        var searchCustomLagging = new SearchManager({
            "id": "searchCustomLagging",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_custom_lagging_definition | eval keyid=_key | search name=$tk_input_custom_lagging_search$",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_custom_lagging$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchCustomLagging",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_custom_lagging"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_custom_lagging",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleCustomLagging = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchCustomLagging",
            "id": "searchSingleCustomLagging"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Elastic Sources

        var searchElasticSources = new SearchManager({
            "id": "searchElasticSources",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_elastic_sources | eval keyid=_key | search data_name=$tk_input_elastic_sources_search$",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_elastic_sources$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchElasticSources",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_elastic_sources"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_elastic_sources",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleElasticSources = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchElasticSources",
            "id": "searchSingleElasticSources"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchElasticSourcesTest = new SearchManager({
            "id": "searchElasticSourcesTest",
            "earliest_time": "$tk_input_elastic_source_earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$tk_input_elastic_source_latest$",
            "search": "| savedsearch runSPL [ | makeresults | eval data_name=\"$tk_input_elastic_source_data_name$\", search_mode=\"$form.tk_input_elastic_source_search_type$\", search_constraint=\"$tk_input_elastic_source_search_constraint$\", elastic_data_index=\"$tk_input_elastic_source_elastic_data_index$\", elastic_data_sourcetype=\"$tk_input_elastic_source_elastic_data_sourcetype$\" | `trackme_elastic_sources_simulate(\"$tk_input_elastic_source_data_name$\")`",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_simulation_elastic_sources$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // whitelist

        // whitelist data_source

        var searchWhiteListDataSource = new SearchManager({
            "id": "searchWhiteListDataSource",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_source_monitoring_whitelist_index | eval keyid=_key | search data_index=\"$form.tk_input_data_source_whitelist_search$\" | sort limit=0 data_index | eval select=keyid | fields data_index, keyid, select",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$",
                "depends": "$start_modify_data_source_whitelist$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchWhiteListDataSource",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_source_whitelist"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_source_whitelist",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleWhiteListDataSource = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchWhiteListDataSource",
            "id": "searchSingleWhiteListDataSource"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // whitelist metric_host

        var searchWhiteListMetricHost = new SearchManager({
            "id": "searchWhiteListMetricHost",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_metric_host_monitoring_whitelist_index | eval keyid=_key | search metric_index=\"$form.tk_input_metric_host_whitelist_search$\" | sort limit=0 metric_index",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$",
                "depends": "$start_modify_metric_host_whitelist$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchWhiteListMetricHost",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_metric_host_whitelist"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_metric_host_whitelist",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleWhiteListMetricHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchWhiteListMetricHost",
            "id": "searchSingleWhiteListMetricHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // whitelist data_host

        var searchWhiteListDataHost = new SearchManager({
            "id": "searchWhiteListDataHost",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_host_monitoring_whitelist_index | eval keyid=_key | search data_index=\"$form.tk_input_data_host_whitelist_search$\" | eval select=keyid | sort limit=0 data_index",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$",
                "depends": "$start_modify_data_host_whitelist$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchWhiteListDataHost",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_host_whitelist"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_host_whitelist",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleWhiteListDataHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchWhiteListDataHost",
            "id": "searchSingleWhiteListDataHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist

        // blacklist host

        var searchBlackListDataSourceHost = new SearchManager({
            "id": "searchBlackListDataSourceHost",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_source_monitoring_blacklist_host | eval keyid=_key | `detect_rex(data_host)` | search data_host=\"$form.tk_input_data_source_blacklist_host_search$\"",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$",
                "depends": "$start_modify_data_source_blacklist_host$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListDataSourceHost",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_source_blacklist_host"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_source_blacklist_host",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleBlackListDataSourceHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListDataSourceHost",
            "id": "searchSingleBlackListDataSourceHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist index

        var searchBlackListDataSourceIndex = new SearchManager({
            "id": "searchBlackListDataSourceIndex",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_source_monitoring_blacklist_index | eval keyid=_key | `detect_rex(data_index)` | search data_index=\"$form.tk_input_data_source_blacklist_index_search$\"",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_data_source_blacklist_index$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListDataSourceIndex",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_source_blacklist_index"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_source_blacklist_index",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleBlackListDataSourceIndex = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListDataSourceIndex",
            "id": "searchSingleBlackListDataSourceIndex"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist sourcetype

        var searchBlackListDataSourceSourcetype = new SearchManager({
            "id": "searchBlackListDataSourceSourcetype",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_source_monitoring_blacklist_sourcetype | eval keyid=_key | `detect_rex(data_sourcetype)` | search data_sourcetype=\"$form.tk_input_data_source_blacklist_sourcetype_search$\"",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_data_source_blacklist_sourcetype$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListDataSourceSourcetype",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_source_blacklist_sourcetype"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_source_blacklist_sourcetype",
                        "value": "True"
                    }]
                }
            ]
        });

        // blacklist host

        var searchBlackListDataHostHost = new SearchManager({
            "id": "searchBlackListDataHostHost",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_host_monitoring_blacklist_host | eval keyid=_key | `detect_rex(data_host)` | search data_host=\"$form.tk_input_data_host_blacklist_host_search$\"",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_data_host_blacklist_host$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListDataHostHost",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_host_blacklist_host"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_host_blacklist_host",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleBlackListDataHostHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListDataHostHost",
            "id": "searchSingleBlackListDataHostHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist host

        var searchBlackListMetricHostHost = new SearchManager({
            "id": "searchBlackListMetricHostHost",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_metric_host_monitoring_blacklist_host | eval keyid=_key | `detect_rex(metric_host)` | search metric_host=\"$form.tk_input_metric_host_blacklist_host_search$\"",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_metric_host_blacklist_host$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListMetricHostHost",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_metric_host_blacklist_host"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_metric_host_blacklist_host",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleBlackListMetricHostHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListMetricHostHost",
            "id": "searchSingleBlackListMetricHostHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist index

        var searchBlackListDataHostIndex = new SearchManager({
            "id": "searchBlackListDataHostIndex",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_host_monitoring_blacklist_index | eval keyid=_key | `detect_rex(data_index)` | search data_index=\"$form.tk_input_data_host_blacklist_index_search$\"",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_data_host_blacklist_index$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListDataHostIndex",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_host_blacklist_index"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_host_blacklist_index",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleBlackListDataHostIndex = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListDataHostIndex",
            "id": "searchSingleBlackListDataHostIndex"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist metric index
        var searchBlackListMetricHostIndex = new SearchManager({
            "id": "searchBlackListMetricHostIndex",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_metric_host_monitoring_blacklist_index | eval keyid=_key | `detect_rex(metric_index)` | search metric_index=\"$form.tk_input_metric_host_blacklist_index_search$\"",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_metric_host_blacklist_index$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListMetricHostIndex",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_metric_host_blacklist_index"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_metric_host_blacklist_index",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleBlackListMetricHostIndex = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListMetricHostIndex",
            "id": "searchSingleBlackListMetricHostIndex"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist sourcetype

        var searchBlackListDataHostSourcetype = new SearchManager({
            "id": "searchBlackListDataHostSourcetype",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_host_monitoring_blacklist_sourcetype | eval keyid=_key | `detect_rex(data_sourcetype)` | search data_sourcetype=\"$form.tk_input_data_host_blacklist_sourcetype_search$\"",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_data_host_blacklist_sourcetype$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListDataHostSourcetype",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_host_blacklist_sourcetype"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_host_blacklist_sourcetype",
                        "value": "True"
                    }]
                }
            ]
        });

        // blacklist metric_category

        var searchBlackListMetricHostMetricCategory = new SearchManager({
            "id": "searchBlackListMetricHostMetricCategory",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_metric_host_monitoring_blacklist_metric_category | eval keyid=_key | `detect_rex(metric_category)` | search metric_category=\"$form.tk_input_metric_host_blacklist_metric_category_search$\"",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_metric_host_blacklist_metric_category$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListMetricHostMetricCategory",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_metric_host_blacklist_metric_category"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_metric_host_blacklist_metric_category",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleBlackListDataSourceSourcetype = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListDataSourceSourcetype",
            "id": "searchSingleBlackListDataSourceSourcetype"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleBlackListDataHostSourcetype = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListDataHostSourcetype",
            "id": "searchSingleBlackListDataHostSourcetype"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleBlackListMetricHostMetricCategory = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListMetricHostMetricCategory",
            "id": "searchSingleBlackListMetricHostMetricCategory"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Indexer queues
        var searchQueue1 = new SearchManager({
            "id": "searchQueue1",
            "tokenDependencies": {
                "depends": "$tk_start_indexers_queues_searches$"
            },
            "sample_ratio": 1,
            "earliest_time": "$inputLinkQueuesTime.earliest$",
            "search": "(index=_internal `trackme_idx_filter` source=*metrics.log sourcetype=splunkd group=queue name IN(\"splunktcpin\")) | eval nhost=replace(host,\"\\\\..*\",\"\")  | eval ingest_pipe=if(isnotnull(ingest_pipe),ingest_pipe,\"none\")  | search ingest_pipe=* | eval max=coalesce(max_size_kb, max_size) | eval curr=coalesce(current_size_kb, current_size) | eval fill_perc=round(((curr / max) * 100), 2) | timechart span=$inputLinkQueuesTime.span$ max(fill_perc) as avg_fill by nhost useother=false limit=0",
            "latest_time": "$inputLinkQueuesTime.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchQueue2 = new SearchManager({
            "id": "searchQueue2",
            "tokenDependencies": {
                "depends": "$tk_start_indexers_queues_searches$"
            },
            "sample_ratio": 1,
            "earliest_time": "$inputLinkQueuesTime.earliest$",
            "search": "(index=_internal `trackme_idx_filter` source=*metrics.log sourcetype=splunkd group=queue name IN(\"parsingqueue\")) | eval nhost=replace(host,\"\\\\..*\",\"\")  | eval ingest_pipe=if(isnotnull(ingest_pipe),ingest_pipe,\"none\")  | search ingest_pipe=* | eval max=coalesce(max_size_kb, max_size) | eval curr=coalesce(current_size_kb, current_size) | eval fill_perc=round(((curr / max) * 100), 2) | timechart span=$inputLinkQueuesTime.span$ max(fill_perc) as avg_fill by nhost useother=false limit=0",
            "latest_time": "$inputLinkQueuesTime.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchQueue3 = new SearchManager({
            "id": "searchQueue3",
            "tokenDependencies": {
                "depends": "$tk_start_indexers_queues_searches$"
            },
            "sample_ratio": 1,
            "earliest_time": "$inputLinkQueuesTime.earliest$",
            "search": "(index=_internal `trackme_idx_filter` source=*metrics.log sourcetype=splunkd group=queue name IN(\"aggqueue\")) | eval nhost=replace(host,\"\\\\..*\",\"\")  | eval ingest_pipe=if(isnotnull(ingest_pipe),ingest_pipe,\"none\")  | search ingest_pipe=* | eval max=coalesce(max_size_kb, max_size) | eval curr=coalesce(current_size_kb, current_size) | eval fill_perc=round(((curr / max) * 100), 2) | timechart span=$inputLinkQueuesTime.span$ max(fill_perc) as avg_fill by nhost useother=false limit=0",
            "latest_time": "$inputLinkQueuesTime.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchQueue4 = new SearchManager({
            "id": "searchQueue4",
            "tokenDependencies": {
                "depends": "$tk_start_indexers_queues_searches$"
            },
            "sample_ratio": 1,
            "earliest_time": "$inputLinkQueuesTime.earliest$",
            "search": "(index=_internal `trackme_idx_filter` source=*metrics.log sourcetype=splunkd group=queue name IN(\"typingqueue\")) | eval nhost=replace(host,\"\\\\..*\",\"\")  | eval ingest_pipe=if(isnotnull(ingest_pipe),ingest_pipe,\"none\")  | search ingest_pipe=* | eval max=coalesce(max_size_kb, max_size) | eval curr=coalesce(current_size_kb, current_size) | eval fill_perc=round(((curr / max) * 100), 2) | timechart span=$inputLinkQueuesTime.span$ max(fill_perc) as avg_fill by nhost useother=false limit=0",
            "latest_time": "$inputLinkQueuesTime.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchQueue5 = new SearchManager({
            "id": "searchQueue5",
            "tokenDependencies": {
                "depends": "$tk_start_indexers_queues_searches$"
            },
            "sample_ratio": 1,
            "earliest_time": "$inputLinkQueuesTime.earliest$",
            "search": "(index=_internal `trackme_idx_filter` source=*metrics.log sourcetype=splunkd group=queue name IN(\"indexqueue\")) | eval nhost=replace(host,\"\\\\..*\",\"\")  | eval ingest_pipe=if(isnotnull(ingest_pipe),ingest_pipe,\"none\")  | search ingest_pipe=* | eval max=coalesce(max_size_kb, max_size) | eval curr=coalesce(current_size_kb, current_size) | eval fill_perc=round(((curr / max) * 100), 2) | timechart span=$inputLinkQueuesTime.span$ max(fill_perc) as avg_fill by nhost useother=false limit=0",
            "latest_time": "$inputLinkQueuesTime.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Parsing issues
        var searchParsingIssuesChart = new SearchManager({
            "id": "searchParsingIssuesChart",
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "sample_ratio": 1,
            "earliest_time": "$inputLinkParsingIssuesTime.earliest$",
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=LineBreakingProcessor OR component=AggregatorMiningProcessor OR component=DateParserVerbose | timechart span=$inputLinkParsingIssuesTime.span$ count by component",
            "latest_time": "$inputLinkParsingIssuesTime.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchParsingIssuesSingle = new SearchManager({
            "id": "searchParsingIssuesSingle",
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "sample_ratio": 1,
            "earliest_time": "$inputLinkParsingIssuesTime.earliest$",
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=LineBreakingProcessor OR component=AggregatorMiningProcessor OR component=DateParserVerbose | top limit=0 component | eval percent=round(percent, 2) | eval summary=component . \": \" . percent . \" %\" | fields summary | stats values(summary) as summary",
            "latest_time": "$inputLinkParsingIssuesTime.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Identity card

        var searchIdentityCardTable = new SearchManager({
            "id": "searchIdentityCardTable",
            "tokenDependencies": {
                "depends": "$tk_start_associate_identity_card$"
            },
            "sample_ratio": 1,
            "search": "| inputlookup trackme_sources_knowledge | eval keyid=_key | search object=*$FilterIdentityCardTable$* OR doc_link=*$FilterIdentityCardTable$ OR doc_note=*$FilterIdentityCardTable$* | table keyid, object, doc_link, doc_note",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Logical group

        var searchLogicalGroupTable = new SearchManager({
            "id": "searchLogicalGroupTable",
            "tokenDependencies": {
                "depends": "$tk_start_logical_member_get$"
            },
            "sample_ratio": 1,
            "search": "| inputlookup trackme_logical_group | eval keyid=_key | search object_group_members=\"$input_object$\" | eval object_group_mtime=strftime(object_group_mtime, \"%c\") | table keyid, object_group_name, object_group_members, object_group_min_green_percent, object_group_mtime",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchLogicalGroupTable",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "set",
                        "token": "show_add_logical_group",
                        "value": "True"
                    },
                    {
                        "type": "unset",
                        "token": "show_table_logical_group"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_logical_group",
                        "value": "True"
                    },
                    {
                        "type": "unset",
                        "token": "show_add_logical_group"
                    }
                    ]
                }
            ]
        });

        // Logical group add member

        var searchLogicalGroupTableAddMember = new SearchManager({
            "id": "searchLogicalGroupTableAddMember",
            "tokenDependencies": {
                "depends": "$tk_start_logical_member_add$"
            },
            "sample_ratio": 1,
            "search": "| inputlookup trackme_logical_group | eval keyid=_key | search object_group_name=*$FilterLogicalGroupTable$* OR object_group_members=*$FilterLogicalGroupTable$* | eval object_group_mtime=strftime(object_group_mtime, \"%c\") | table keyid, object_group_name, object_group_members, object_group_min_green_percent, object_group_mtime",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Ack

        var searchAckGet = new SearchManager({
            "id": "searchAckGet",
            "tokenDependencies": {
                "depends": "$tk_start_ack_get$"
            },
            "sample_ratio": 1,
            "search": "| `trackme_ack_get(\"$input_object$\", \"$input_object_category$\")`",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAckDuration = new SearchManager({
            "id": "searchAckDuration",
            "tokenDependencies": {
                "depends": "$tk_start_ack_get$"
            },
            "earliest_time": "-5m",
            "latest_time": "now",
            "sample_ratio": null,
            "search": "| makeresults | eval duration=`trackme_ack_default_duration` | eval label=\"default\" | eval label=tostring(duration, \"duration\"), priority=1 | fields - _time | append [ | makeresults | eval duration=2*24*60*60 | eval label=\"default\" | eval label=tostring(duration, \"duration\"), priority=2 | fields - _time ] | append [ | makeresults | eval duration=7*24*60*60 | eval label=\"default\" | eval label=tostring(duration, \"duration\"), priority=3 | fields - _time ] | append [ | makeresults | eval duration=15*24*60*60 | eval label=\"default\" | eval label=tostring(duration, \"duration\"), priority=4 | fields - _time ] | append [ | makeresults | eval duration=30*24*60*60 | eval label=\"default\" | eval label=tostring(duration, \"duration\"), priority=5 | fields - _time ] | sort priority | fields duration, label",
            "status_buckets": 0,
            "cancelOnUnload": true,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
            },
            "runWhenTimeIsUndefined": false
        }, {tokens: true});

        // whitelist

        // whitelist data_source
        // input link selection for modal window
        var inputLinkTimeWhiteListDataSource = new LinkListInput({
            "id": "inputLinkTimeWhiteListDataSource",
            "choices": [{
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.LinkTimeWhiteListDataSource$",
            "el": $('#inputLinkTimeWhiteListDataSource')
        }, {
            tokens: true
        }).render();

        inputLinkTimeWhiteListDataSource.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkTimeWhiteListDataSource.on("valueChange", function(e) {
            if (e.value === "24h") {
                EventHandler.setToken("modalTimeWhiteListDataSource.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataSource.latest", "now", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTimeWhiteListDataSource.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataSource.latest", "now", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTimeWhiteListDataSource.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataSource.latest", "now", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTimeWhiteListDataSource.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataSource.latest", "now", {}, e.data);
            }
        });

        // whitelist data_host
        // input link selection for modal window
        var inputLinkTimeWhiteListDataHost = new LinkListInput({
            "id": "inputLinkTimeWhiteListDataHost",
            "choices": [
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.LinkTimeWhiteListDataHost$",
            "el": $('#inputLinkTimeWhiteListDataHost')
        }, {
            tokens: true
        }).render();

        inputLinkTimeWhiteListDataHost.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkTimeWhiteListDataHost.on("valueChange", function(e) {
            if (e.value === "24h") {
                EventHandler.setToken("modalTimeWhiteListDataHost.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataHost.latest", "now", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTimeWhiteListDataHost.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataHost.latest", "now", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTimeWhiteListDataHost.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataHost.latest", "now", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTimeWhiteListDataHost.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataHost.latest", "now", {}, e.data);
            }
        });

        // whitelist metric_host
        // input link selection for modal window
        var inputLinkTimeWhiteListMetricHost = new LinkListInput({
            "id": "inputLinkTimeWhiteListMetricHost",
            "choices": [
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.LinkTimeWhiteListMetricHost$",
            "el": $('#inputLinkTimeWhiteListMetricHost')
        }, {
            tokens: true
        }).render();

        inputLinkTimeWhiteListMetricHost.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkTimeWhiteListMetricHost.on("valueChange", function(e) {
            if (e.value === "24h") {
                EventHandler.setToken("modalTimeWhiteListMetricHost.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListMetricHost.latest", "now", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTimeWhiteListMetricHost.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListMetricHost.latest", "now", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTimeWhiteListMetricHost.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListMetricHost.latest", "now", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTimeWhiteListMetricHost.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListMetricHost.latest", "now", {}, e.data);
            }
        });

        // blacklist metric_host
        // input link selection for modal window
        var inputLinkTimeBlackListMetricHost = new LinkListInput({
            "id": "inputLinkTimeBlackListMetricHost",
            "choices": [
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.LinkTimeBlackListMetricHost$",
            "el": $('#inputLinkTimeBlackListMetricHost')
        }, {
            tokens: true
        }).render();

        inputLinkTimeBlackListMetricHost.on("change", function(newValue) {
            FormUtils.handleValueChange(inputLinkTimeBlackListMetricHost);
        });

        inputLinkTimeBlackListMetricHost.on("valueChange", function(e) {
            if (e.value === "24h") {
                EventHandler.setToken("modalTimeBlackListMetricHost.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTimeBlackListMetricHost.latest", "now", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTimeBlackListMetricHost.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTimeBlackListMetricHost.latest", "now", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTimeBlackListMetricHost.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTimeBlackListMetricHost.latest", "now", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTimeBlackListMetricHost.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTimeBlackListMetricHost.latest", "now", {}, e.data);
            }
        });

        // data source monitoring

        // main data_source link input for modal window
        var inputLinkDataSource = new LinkListInput({
            "id": "inputLinkDataSource",
            "choices": [{
                    "value": "overview",
                    "label": "Overview data source"
                },
                {
                    "value": "outlier",
                    "label": "Outlier detection overview"
                },
                {
                    "value": "outlier_configuration",
                    "label": "Outlier detection configuration"
                },
                {
                    "value": "data_quality",
                    "label": "Data parsing quality"
                },
                {
                    "value": "lagging_metrics",
                    "label": "Lagging performances"
                },
                {
                    "value": "flipping_status",
                    "label": "Status flipping"
                },
                {
                    "value": "status_message",
                    "label": "Status message"
                },
                {
                    "value": "data_source_audit_changes",
                    "label": "Audit changes"
                }                
            ],
            "default": "overview",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "overview",
            "value": "$form.inputLinkDataSource$",
            "el": $('#inputLinkDataSource')
        }, {
            tokens: true
        }).render();

        inputLinkDataSource.on("change", function(newValue) {
            FormUtils.handleValueChange(inputLinkDataSource);
        });

        inputLinkDataSource.on("valueChange", function(e) {
            if (e.value === "overview") {
                EventHandler.setToken("show_data_source_overview", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_outlier");
                EventHandler.unsetToken("show_data_source_outlier_configuration");
                EventHandler.unsetToken("show_data_source_status_message");
                EventHandler.unsetToken("show_data_quality");
                EventHandler.unsetToken("show_flipping_status");
                EventHandler.unsetToken("show_data_source_audit_changes");
                EventHandler.unsetToken("show_data_source_lagging_metrics");
            } else if (e.value === "outlier") {
                EventHandler.setToken("show_data_source_outlier", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_overview");
                EventHandler.unsetToken("show_data_source_outlier_configuration");
                EventHandler.unsetToken("show_data_source_status_message");
                EventHandler.unsetToken("show_data_quality");
                EventHandler.unsetToken("show_flipping_status");
                EventHandler.unsetToken("show_data_source_audit_changes");
                EventHandler.unsetToken("show_data_source_lagging_metrics");
            } else if (e.value === "outlier_configuration") {
                EventHandler.setToken("show_data_source_outlier_configuration", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_overview");
                EventHandler.unsetToken("show_data_source_outlier");
                EventHandler.unsetToken("show_data_source_status_message");
                EventHandler.unsetToken("show_data_quality");
                EventHandler.unsetToken("show_flipping_status");
                EventHandler.unsetToken("show_data_source_audit_changes");
                EventHandler.unsetToken("show_data_source_lagging_metrics");
            } else if (e.value === "data_quality") {
                EventHandler.setToken("show_data_quality", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_overview");
                EventHandler.unsetToken("show_data_source_outlier");
                EventHandler.unsetToken("show_data_source_outlier_configuration");
                EventHandler.unsetToken("show_data_source_status_message");
                EventHandler.unsetToken("show_flipping_status");
                EventHandler.unsetToken("show_data_source_audit_changes");
                EventHandler.unsetToken("show_data_source_lagging_metrics");
            } else if (e.value === "lagging_metrics") {
                EventHandler.setToken("show_data_source_lagging_metrics", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_overview");
                EventHandler.unsetToken("show_data_source_outlier");
                EventHandler.unsetToken("show_data_source_outlier_configuration");
                EventHandler.unsetToken("show_data_source_status_message");
                EventHandler.unsetToken("show_flipping_status");
                EventHandler.unsetToken("show_data_source_audit_changes");
                EventHandler.unsetToken("show_data_quality");
            } else if (e.value === "flipping_status") {
                EventHandler.setToken("show_flipping_status", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_overview");
                EventHandler.unsetToken("show_data_source_outlier");
                EventHandler.unsetToken("show_data_source_outlier_configuration");
                EventHandler.unsetToken("show_data_source_status_message");
                EventHandler.unsetToken("show_data_quality");
                EventHandler.unsetToken("show_data_source_audit_changes");
                EventHandler.unsetToken("show_data_source_lagging_metrics");
            } else if (e.value === "status_message") {
                EventHandler.setToken("show_data_source_status_message", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_overview");
                EventHandler.unsetToken("show_data_source_outlier_configuration");
                EventHandler.unsetToken("show_data_source_outlier");
                EventHandler.unsetToken("show_data_quality");
                EventHandler.unsetToken("show_flipping_status");
                EventHandler.unsetToken("show_data_source_audit_changes");
                EventHandler.unsetToken("show_data_source_lagging_metrics");
            } else if (e.value === "data_source_audit_changes") {
                EventHandler.setToken("show_data_source_audit_changes", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_overview");
                EventHandler.unsetToken("show_data_source_outlier_configuration");
                EventHandler.unsetToken("show_data_source_outlier");
                EventHandler.unsetToken("show_data_quality");
                EventHandler.unsetToken("show_flipping_status");
                EventHandler.unsetToken("show_data_source_status_message");
                EventHandler.unsetToken("show_data_source_lagging_metrics");
            }            
        });

        // input link selection for modal window
        var inputLinkTime = new LinkListInput({
            "id": "inputLinkTime",
            "choices": [{
                    "value": "60m",
                    "label": "60m"
                },
                {
                    "value": "4h",
                    "label": "4h"
                },
                {
                    "value": "8h",
                    "label": "8h"
                },
                {
                    "value": "12h",
                    "label": "12h"
                },
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "48h",
                    "label": "48h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "15d",
                    "label": "15d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "60d",
                    "label": "60d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.modalActionTime$",
            "el": $('#inputLinkTime')
        }, {
            tokens: true
        }).render();

        inputLinkTime.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkTime.on("valueChange", function(e) {
            if (e.value === "60m") {
                EventHandler.setToken("modalTime.earliest", "-60m", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "1m", {}, e.data);
            } else if (e.value === "4h") {
                EventHandler.setToken("modalTime.earliest", "-4h", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "5m", {}, e.data);
            } else if (e.value === "8h") {
                EventHandler.setToken("modalTime.earliest", "-8h", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "5m", {}, e.data);
            } else if (e.value === "12h") {
                EventHandler.setToken("modalTime.earliest", "-12h", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "10m", {}, e.data);
            } else if (e.value === "24h") {
                EventHandler.setToken("modalTime.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "15m", {}, e.data);
            } else if (e.value === "48h") {
                EventHandler.setToken("modalTime.earliest", "-48h", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "30m", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTime.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "1h", {}, e.data);
            } else if (e.value === "15d") {
                EventHandler.setToken("modalTime.earliest", "-15d", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "2h", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTime.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "4h", {}, e.data);
            } else if (e.value === "60d") {
                EventHandler.setToken("modalTime.earliest", "-60d", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "8h", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTime.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "12h", {}, e.data);
            }
        });

        // outliers configuration data_source
        var LinkTimeOutlierConfigurationDataSource = new LinkListInput({
            "id": "LinkTimeOutlierConfigurationDataSource",
            "choices": [{
                    "value": "-24h",
                    "label": "24h"
                },
                {
                    "value": "-48h",
                    "label": "48h"
                },
                {
                    "value": "-7d",
                    "label": "7d"
                },
                {
                    "value": "-30d",
                    "label": "30d"
                }
            ],
            "default": "7d",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "7d",
            "value": "$form.TimeOutlierConfigurationDataSource$",
            "el": $('#LinkTimeOutlierConfigurationDataSource')
        }, {
            tokens: true
        }).render();

        LinkTimeOutlierConfigurationDataSource.on("change", function(newValue) {
            FormUtils.handleValueChange(LinkTimeOutlierConfigurationDataSource);
        });

        LinkTimeOutlierConfigurationDataSource.on("valueChange", function(e) {
			if (e.value === "-24h") {
                EventHandler.setToken("tk_input_data_source_outlier_period", "-24h", {}, e.data);
            } else if (e.value === "-48h") {
                EventHandler.setToken("tk_input_data_source_outlier_period", "-48h", {}, e.data);
            } else if (e.value === "-7d") {
                EventHandler.setToken("tk_input_data_source_outlier_period", "-7d", {}, e.data);
            } else if (e.value === "-30d") {
                EventHandler.setToken("tk_input_data_source_outlier_period", "-30d", {}, e.data);
            }
        });

        var LinkTimeOutlierConfigurationDataSourceSpan = new LinkListInput({
            "id": "LinkTimeOutlierConfigurationDataSourceSpan",
            "choices": [{
                    "value": "5m",
                    "label": "5m"
                },
                {
                    "value": "60m",
                    "label": "60m"
                },
                {
                    "value": "4h",
                    "label": "4h"
                },
                {
                    "value": "12h",
                    "label": "12h"
                },
                {
                    "value": "1d",
                    "label": "1d"
                }
            ],
            "default": "5m",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "5m",
            "value": "$form.TimeOutlierConfigurationDataSourceSpan$",
            "el": $('#LinkTimeOutlierConfigurationDataSourceSpan')
        }, {
            tokens: true
        }).render();

        LinkTimeOutlierConfigurationDataSourceSpan.on("change", function(newValue) {
            FormUtils.handleValueChange(LinkTimeOutlierConfigurationDataSourceSpan);
        });

        LinkTimeOutlierConfigurationDataSourceSpan.on("valueChange", function(e) {
			if (e.value === "5m") {
                EventHandler.setToken("tk_input_data_source_outlier_span", "5m", {}, e.data);
            } else if (e.value === "60m") {
                EventHandler.setToken("tk_input_data_source_outlier_span", "60m", {}, e.data);
            } else if (e.value === "4h") {
                EventHandler.setToken("tk_input_data_source_outlier_span", "4h", {}, e.data);
            } else if (e.value === "12h") {
                EventHandler.setToken("tk_input_data_source_outlier_span", "12h", {}, e.data);
            } else if (e.value === "1d") {
                EventHandler.setToken("tk_input_data_source_outlier_span", "1d", {}, e.data);
            }
        });

        // data host monitoring

        // main data_host link input for modal window
        var inputLinkDataHost = new LinkListInput({
            "id": "inputLinkDataHost",
            "choices": [{
                    "value": "overview",
                    "label": "Overview data host"
                },
                {
                    "value": "outlier",
                    "label": "Outlier detection overview"
                },
                {
                    "value": "outlier_configuration",
                    "label": "Outlier detection configuration"
                },
                {
                    "value": "data_quality",
                    "label": "Data parsing quality"
                },
                {
                    "value": "lagging_metrics",
                    "label": "Lagging performances"
                },
                {
                    "value": "flipping_status",
                    "label": "Status flipping"
                },
                {
                    "value": "status_message",
                    "label": "Status message"
                },
                {
                    "value": "audit_changes",
                    "label": "Audit changes"
                }
            ],
            "default": "overview",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "overview",
            "value": "$form.inputLinkDataHost$",
            "el": $('#inputLinkDataHost')
        }, {
            tokens: true
        }).render();

        inputLinkDataHost.on("change", function(newValue) {
            FormUtils.handleValueChange(inputLinkDataHost);
        });

        inputLinkDataHost.on("valueChange", function(e) {
            if (e.value === "overview") {
                EventHandler.setToken("show_data_host_overview", "true", {}, e.data);
                EventHandler.unsetToken("show_data_host_outlier");
                EventHandler.unsetToken("show_data_host_outlier_configuration");
                EventHandler.unsetToken("show_data_host_status_message");
                EventHandler.unsetToken("show_data_host_quality");
                EventHandler.unsetToken("show_data_host_flipping_status");
                EventHandler.unsetToken("show_data_host_audit_changes");
                EventHandler.unsetToken("show_data_host_lagging_metrics");
            } else if (e.value === "outlier") {
                EventHandler.setToken("show_data_host_outlier", "true", {}, e.data);
                EventHandler.unsetToken("show_data_host_overview");
                EventHandler.unsetToken("show_data_host_outlier_configuration");
                EventHandler.unsetToken("show_data_host_status_message");
                EventHandler.unsetToken("show_data_host_quality");
                EventHandler.unsetToken("show_data_host_flipping_status");
                EventHandler.unsetToken("show_data_host_audit_changes");
                EventHandler.unsetToken("show_data_host_lagging_metrics");
            } else if (e.value === "outlier_configuration") {
                EventHandler.setToken("show_data_host_outlier_configuration", "true", {}, e.data);
                EventHandler.unsetToken("show_data_host_overview");
                EventHandler.unsetToken("show_data_host_outlier");
                EventHandler.unsetToken("show_data_host_status_message");
                EventHandler.unsetToken("show_data_host_quality");
                EventHandler.unsetToken("show_data_host_flipping_status");
                EventHandler.unsetToken("show_data_host_audit_changes");
                EventHandler.unsetToken("show_data_host_lagging_metrics");
            } else if (e.value === "data_quality") {
                EventHandler.setToken("show_data_host_quality", "true", {}, e.data);
                EventHandler.unsetToken("show_data_host_overview");
                EventHandler.unsetToken("show_data_host_outlier");
                EventHandler.unsetToken("show_data_host_status_message");
                EventHandler.unsetToken("show_data_host_outlier_configuration");
                EventHandler.unsetToken("show_data_host_flipping_status");
                EventHandler.unsetToken("show_data_host_audit_changes");
                EventHandler.unsetToken("show_data_host_lagging_metrics");
            } else if (e.value === "lagging_metrics") {
                EventHandler.setToken("show_data_host_lagging_metrics", "true", {}, e.data);
                EventHandler.unsetToken("show_data_host_overview");
                EventHandler.unsetToken("show_data_host_outlier");
                EventHandler.unsetToken("show_data_host_status_message");
                EventHandler.unsetToken("show_data_host_outlier_configuration");
                EventHandler.unsetToken("show_data_host_flipping_status");
                EventHandler.unsetToken("show_data_host_audit_changes");
                EventHandler.unsetToken("show_data_host_quality");
            } else if (e.value === "flipping_status") {
                EventHandler.setToken("show_data_host_flipping_status", "true", {}, e.data);
                EventHandler.unsetToken("show_data_host_overview");
                EventHandler.unsetToken("show_data_host_outlier");
                EventHandler.unsetToken("show_data_host_status_message");
                EventHandler.unsetToken("show_data_host_outlier_configuration");
                EventHandler.unsetToken("show_data_host_quality");
                EventHandler.unsetToken("show_data_host_audit_changes");
                EventHandler.unsetToken("show_data_host_lagging_metrics");
            } else if (e.value === "status_message") {
                EventHandler.setToken("show_data_host_status_message", "true", {}, e.data);
                EventHandler.unsetToken("show_data_host_overview");
                EventHandler.unsetToken("show_data_host_outlier_configuration");
                EventHandler.unsetToken("show_data_host_outlier");
                EventHandler.unsetToken("show_data_host_quality");
                EventHandler.unsetToken("show_data_host_flipping_status");
                EventHandler.unsetToken("show_data_host_audit_changes");
                EventHandler.unsetToken("show_data_host_lagging_metrics");
            } else if (e.value === "audit_changes") {
                EventHandler.setToken("show_data_host_audit_changes", "true", {}, e.data);
                EventHandler.unsetToken("show_data_host_overview");
                EventHandler.unsetToken("show_data_host_outlier_configuration");
                EventHandler.unsetToken("show_data_host_outlier");
                EventHandler.unsetToken("show_data_host_quality");
                EventHandler.unsetToken("show_data_host_flipping_status");
                EventHandler.unsetToken("show_data_host_status_message");
                EventHandler.unsetToken("show_data_host_lagging_metrics");
            }
        });

        // outliers configuration data_host
        var LinkTimeOutlierConfigurationDataHost = new LinkListInput({
            "id": "LinkTimeOutlierConfigurationDataHost",
            "choices": [{
                    "value": "-24h",
                    "label": "24h"
                },
                {
                    "value": "-48h",
                    "label": "48h"
                },
                {
                    "value": "-7d",
                    "label": "7d"
                },
                {
                    "value": "-30d",
                    "label": "30d"
                }
            ],
            "default": "-7d",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "-7d",
            "value": "$form.TimeOutlierConfigurationDataHost$",
            "el": $('#LinkTimeOutlierConfigurationDataHost')
        }, {
            tokens: true
        }).render();

        LinkTimeOutlierConfigurationDataHost.on("change", function(newValue) {
            FormUtils.handleValueChange(LinkTimeOutlierConfigurationDataHost);
        });

        LinkTimeOutlierConfigurationDataHost.on("valueChange", function(e) {
			if (e.value === "-24h") {
                EventHandler.setToken("tk_input_data_host_outlier_period", "-24h", {}, e.data);
            } else if (e.value === "-48h") {
                EventHandler.setToken("tk_input_data_host_outlier_period", "-48h", {}, e.data);
            } else if (e.value === "-7d") {
                EventHandler.setToken("tk_input_data_host_outlier_period", "-7d", {}, e.data);
            } else if (e.value === "-30d") {
                EventHandler.setToken("tk_input_data_host_outlier_period", "-30d", {}, e.data);
            }
        });

        var LinkTimeOutlierConfigurationDataHostSpan = new LinkListInput({
            "id": "LinkTimeOutlierConfigurationDataHostSpan",
            "choices": [{
                    "value": "5m",
                    "label": "5m"
                },
                {
                    "value": "60m",
                    "label": "60m"
                },
                {
                    "value": "4h",
                    "label": "4h"
                },
                {
                    "value": "12h",
                    "label": "12h"
                },
                {
                    "value": "1d",
                    "label": "1d"
                }
            ],
            "default": "5m",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "5m",
            "value": "$form.TimeOutlierConfigurationDataHostSpan$",
            "el": $('#LinkTimeOutlierConfigurationDataHostSpan')
        }, {
            tokens: true
        }).render();

        LinkTimeOutlierConfigurationDataHostSpan.on("change", function(newValue) {
            FormUtils.handleValueChange(LinkTimeOutlierConfigurationDataHostSpan);
        });

        LinkTimeOutlierConfigurationDataHostSpan.on("valueChange", function(e) {
			if (e.value === "5m") {
                EventHandler.setToken("tk_input_data_host_outlier_span", "5m", {}, e.data);
            } else if (e.value === "60m") {
                EventHandler.setToken("tk_input_data_host_outlier_span", "60m", {}, e.data);
            } else if (e.value === "4h") {
                EventHandler.setToken("tk_input_data_host_outlier_span", "4h", {}, e.data);
            } else if (e.value === "12h") {
                EventHandler.setToken("tk_input_data_host_outlier_span", "12h", {}, e.data);
            } else if (e.value === "1d") {
                EventHandler.setToken("tk_input_data_host_outlier_span", "1d", {}, e.data);
            }
        });

        // data source outlier configuration
        var inputDataSourceConfigOutlierEnableOutlier = new DropdownInput({
            "id": "inputDataSourceConfigOutlierEnableOutlier",
            "choices": [
                {"label": "True", "value": "true"},
                {"label": "False", "value": "false"}
            ],
            "default": "true",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "showClearButton": true,
            "initialValue": "true",
            "value": "$form.tk_input_data_source_enable_outlier$",
            "el": $('#inputDataSourceConfigOutlierEnableOutlier')
        }, {tokens: true}).render();

        inputDataSourceConfigOutlierEnableOutlier.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourceConfigOutlierEnableOutlier);
        });

        var inputDataSourceConfigOutlierOutlierMinEventCountMode = new DropdownInput({
            "id": "inputDataSourceConfigOutlierOutlierMinEventCountMode",
            "choices": [
                {"label": "Dynamic", "value": "dynamic"},
                {"label": "Static", "value": "static"}
            ],
            "default": "dynamic",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "showClearButton": true,
            "initialValue": "dynamic",
            "value": "$form.tk_input_data_source_outlier_min_eventcount_mode$",
            "el": $('#inputDataSourceConfigOutlierOutlierMinEventCountMode')
        }, {tokens: true}).render();

        inputDataSourceConfigOutlierOutlierMinEventCountMode.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourceConfigOutlierOutlierMinEventCountMode);
        });

        var inputDataSourceConfigOutlierAlertOnUpper = new DropdownInput({
            "id": "inputDataSourceConfigOutlierAlertOnUpper",
            "choices": [
                {"label": "True", "value": "true"},
                {"label": "False", "value": "false"}
            ],
            "default": "false",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "showClearButton": true,
            "initialValue": "false",
            "value": "$form.tk_input_data_source_outlier_alert_on_upper$",
            "el": $('#inputDataSourceConfigOutlierAlertOnUpper')
        }, {tokens: true}).render();

        inputDataSourceConfigOutlierAlertOnUpper.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourceConfigOutlierAlertOnUpper);
        });

        inputDataSourceConfigOutlierOutlierMinEventCountMode.on("valueChange", function(e) {
            if (e.value === "dynamic") {
                EventHandler.setToken("form.tk_input_data_source_outlier_min_eventcount", "disabled", {}, e.data);
            } else if (e.value === "static") {
                EventHandler.unsetToken("form.tk_input_data_source_outlier_min_eventcount");
            }
        });

        var inputDataSourceConfigOutlierOutlierMinEventCount = new TextInput({
            "id": "inputDataSourceConfigOutlierOutlierMinEventCount",
            "tokenDependencies": {"depends": "$show_tk_input_data_source_outlier_min_eventcount$"},
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_outlier_min_eventcount$",
            "el": $('#inputDataSourceConfigOutlierOutlierMinEventCount')
        }, {tokens: true}).render();

        inputDataSourceConfigOutlierOutlierMinEventCount.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourceConfigOutlierOutlierMinEventCount);
        });

        var inputDataSourceConfigOutlierOutlierLowerThresholdMultiplier = new TextInput({
            "id": "inputDataSourceConfigOutlierOutlierLowerThresholdMultiplier",
            "default": "4",
            "searchWhenChanged": true,
            "initialValue": "4",
            "value": "$form.tk_input_data_source_outlier_lower_threshold_multiplier$",
            "el": $('#inputDataSourceConfigOutlierOutlierLowerThresholdMultiplier')
        }, {tokens: true}).render();

        inputDataSourceConfigOutlierOutlierLowerThresholdMultiplier.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourceConfigOutlierOutlierLowerThresholdMultiplier);
        });

        var inputDataSourceConfigOutlierOutlierUpperThresholdMultiplier = new TextInput({
            "id": "inputDataSourceConfigOutlierOutlierUpperThresholdMultiplier",
            "default": "4",
            "searchWhenChanged": true,
            "initialValue": "4",
            "value": "$form.tk_input_data_source_outlier_upper_threshold_multiplier$",
            "el": $('#inputDataSourceConfigOutlierOutlierUpperThresholdMultiplier')
        }, {tokens: true}).render();

        inputDataSourceConfigOutlierOutlierUpperThresholdMultiplier.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourceConfigOutlierOutlierUpperThresholdMultiplier);
        });

        // data host outlier configuration
        var inputDataHostConfigOutlierEnableOutlier = new DropdownInput({
            "id": "inputDataHostConfigOutlierEnableOutlier",
            "choices": [
                {"label": "True", "value": "true"},
                {"label": "False", "value": "false"}
            ],
            "default": "true",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "showClearButton": true,
            "initialValue": "true",
            "value": "$form.tk_input_data_host_enable_outlier$",
            "el": $('#inputDataHostConfigOutlierEnableOutlier')
        }, {tokens: true}).render();

        inputDataHostConfigOutlierEnableOutlier.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostConfigOutlierEnableOutlier);
        });

        var inputDataHostConfigOutlierAlertOnUpper = new DropdownInput({
            "id": "inputDataHostConfigOutlierAlertOnUpper",
            "choices": [
                {"label": "True", "value": "true"},
                {"label": "False", "value": "false"}
            ],
            "default": "false",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "showClearButton": true,
            "initialValue": "false",
            "value": "$form.tk_input_data_host_outlier_alert_on_upper$",
            "el": $('#inputDataHostConfigOutlierAlertOnUpper')
        }, {tokens: true}).render();

        inputDataHostConfigOutlierAlertOnUpper.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostConfigOutlierAlertOnUpper);
        });

        var inputDataHostConfigOutlierOutlierMinEventCountMode = new DropdownInput({
            "id": "inputDataHostConfigOutlierOutlierMinEventCountMode",
            "choices": [
                {"label": "Dynamic", "value": "dynamic"},
                {"label": "Static", "value": "static"}
            ],
            "default": "dynamic",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "showClearButton": true,
            "initialValue": "dynamic",
            "value": "$form.tk_input_data_host_outlier_min_eventcount_mode$",
            "el": $('#inputDataHostConfigOutlierOutlierMinEventCountMode')
        }, {tokens: true}).render();

        inputDataHostConfigOutlierOutlierMinEventCountMode.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostConfigOutlierOutlierMinEventCountMode);
        });

        inputDataHostConfigOutlierOutlierMinEventCountMode.on("valueChange", function(e) {
            if (e.value === "dynamic") {
                EventHandler.setToken("form.tk_input_data_host_outlier_min_eventcount", "disabled", {}, e.data);
            } else if (e.value === "static") {
                EventHandler.unsetToken("form.tk_input_data_host_outlier_min_eventcount");
            }
        });

        var inputDataHostConfigOutlierOutlierMinEventCount = new TextInput({
            "id": "inputDataHostConfigOutlierOutlierMinEventCount",
            "tokenDependencies": {"depends": "$show_tk_input_data_host_outlier_min_eventcount$"},
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_outlier_min_eventcount$",
            "el": $('#inputDataHostConfigOutlierOutlierMinEventCount')
        }, {tokens: true}).render();

        inputDataHostConfigOutlierOutlierMinEventCount.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostConfigOutlierOutlierMinEventCount);
        });

        var inputDataHostConfigOutlierOutlierLowerThresholdMultiplier = new TextInput({
            "id": "inputDataHostConfigOutlierOutlierLowerThresholdMultiplier",
            "default": "4",
            "searchWhenChanged": true,
            "initialValue": "4",
            "value": "$form.tk_input_data_host_outlier_lower_threshold_multiplier$",
            "el": $('#inputDataHostConfigOutlierOutlierLowerThresholdMultiplier')
        }, {tokens: true}).render();

        inputDataHostConfigOutlierOutlierLowerThresholdMultiplier.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostConfigOutlierOutlierLowerThresholdMultiplier);
        });

        var inputDataHostConfigOutlierOutlierUpperThresholdMultiplier = new TextInput({
            "id": "inputDataHostConfigOutlierOutlierUpperThresholdMultiplier",
            "default": "4",
            "searchWhenChanged": true,
            "initialValue": "4",
            "value": "$form.tk_input_data_host_outlier_upper_threshold_multiplier$",
            "el": $('#inputDataHostConfigOutlierOutlierUpperThresholdMultiplier')
        }, {tokens: true}).render();

        inputDataHostConfigOutlierOutlierUpperThresholdMultiplier.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostConfigOutlierOutlierUpperThresholdMultiplier);
        });

        DashboardController.onReady(function() {
            if (!submittedTokenModel.has('earliest') && !submittedTokenModel.has('latest')) {
                submittedTokenModel.set({ earliest: '0', latest: '' });
            }
        });

        // input link selection for modal window
        var inputLinkTimeHost = new LinkListInput({
            "id": "inputLinkTimeHost",
            "choices": [{
                    "value": "60m",
                    "label": "60m"
                },
                {
                    "value": "4h",
                    "label": "4h"
                },
                {
                    "value": "8h",
                    "label": "8h"
                },
                {
                    "value": "12h",
                    "label": "12h"
                },
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "48h",
                    "label": "48h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "15d",
                    "label": "15d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "60d",
                    "label": "60d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.modalActionTimeHost$",
            "el": $('#inputLinkTimeHost')
        }, {
            tokens: true
        }).render();

        inputLinkTimeHost.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkTimeHost.on("valueChange", function(e) {
            if (e.value === "60m") {
                EventHandler.setToken("modalTimeHost.earliest", "-60m", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "1m", {}, e.data);
            } else if (e.value === "4h") {
                EventHandler.setToken("modalTimeHost.earliest", "-4h", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "5m", {}, e.data);
            } else if (e.value === "8h") {
                EventHandler.setToken("modalTimeHost.earliest", "-8h", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "5m", {}, e.data);
            } else if (e.value === "12h") {
                EventHandler.setToken("modalTimeHost.earliest", "-12h", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "10m", {}, e.data);
            } else if (e.value === "24h") {
                EventHandler.setToken("modalTimeHost.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "15m", {}, e.data);
            } else if (e.value === "48h") {
                EventHandler.setToken("modalTimeHost.earliest", "-48h", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "30m", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTimeHost.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "1h", {}, e.data);
            } else if (e.value === "15d") {
                EventHandler.setToken("modalTimeHost.earliest", "-15d", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "2h", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTimeHost.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "4h", {}, e.data);
            } else if (e.value === "60d") {
                EventHandler.setToken("modalTimeHost.earliest", "-60d", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "8h", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTimeHost.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "12h", {}, e.data);
            }
        });

        // input link selection for modal window
        var inputLinkTimeMetricHost = new LinkListInput({
            "id": "inputLinkTimeMetricHost",
            "choices": [{
                    "value": "60m",
                    "label": "60m"
                },
                {
                    "value": "4h",
                    "label": "4h"
                },
                {
                    "value": "8h",
                    "label": "8h"
                },
                {
                    "value": "12h",
                    "label": "12h"
                },
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "48h",
                    "label": "48h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "15d",
                    "label": "15d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "60d",
                    "label": "60d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.modalActionTimeMetricHost$",
            "el": $('#inputLinkTimeMetricHost')
        }, {
            tokens: true
        }).render();

        inputLinkTimeMetricHost.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkTimeMetricHost.on("valueChange", function(e) {
            if (e.value === "60m") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-60m", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "1m", {}, e.data);
            } else if (e.value === "4h") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-4h", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "5m", {}, e.data);
            } else if (e.value === "8h") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-8h", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "5m", {}, e.data);
            } else if (e.value === "12h") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-12h", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "10m", {}, e.data);
            } else if (e.value === "24h") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "15m", {}, e.data);
            } else if (e.value === "48h") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-48h", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "30m", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "1h", {}, e.data);
            } else if (e.value === "15d") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-15d", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "2h", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "4h", {}, e.data);
            } else if (e.value === "60d") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-60d", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "8h", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTimeMetricHost.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeMetricHost.span", "12h", {}, e.data);
            }
        });

        // input link selection for modal window
        var inputLinkQueuesTime = new LinkListInput({
            "id": "inputLinkQueuesTime",
            "choices": [{
                    "value": "4h",
                    "label": "4h"
                },
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                }
            ],
            "default": "4h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "4h",
            "value": "$form.inputLinkQueuesTime$",
            "el": $('#inputLinkQueuesTime')
        }, {
            tokens: true
        }).render();

        inputLinkQueuesTime.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkQueuesTime.on("valueChange", function(e) {
            if (e.value === "4h") {
                EventHandler.setToken("inputLinkQueuesTime.earliest", "-4h", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.span", "5m", {}, e.data);
            } else if (e.value === "24h") {
                EventHandler.setToken("inputLinkQueuesTime.earliest", "-24h", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.span", "15m", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("inputLinkQueuesTime.earliest", "-7d", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.span", "30m", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("inputLinkQueuesTime.earliest", "-30d", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.span", "4h", {}, e.data);
            }
        });

        // input link selection for modal window
        var inputLinkParsingIssuesTime = new LinkListInput({
            "id": "inputLinkParsingIssuesTime",
            "choices": [{
                    "value": "4h",
                    "label": "4h"
                },
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                }
            ],
            "default": "4h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "4h",
            "value": "$form.inputLinkParsingIssuesTime$",
            "el": $('#inputLinkParsingIssuesTime')
        }, {
            tokens: true
        }).render();

        inputLinkParsingIssuesTime.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkParsingIssuesTime.on("valueChange", function(e) {
            if (e.value === "4h") {
                EventHandler.setToken("inputLinkParsingIssuesTime.earliest", "-4h", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.span", "5m", {}, e.data);
            } else if (e.value === "24h") {
                EventHandler.setToken("inputLinkParsingIssuesTime.earliest", "-24h", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.span", "15m", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("inputLinkParsingIssuesTime.earliest", "-7d", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.span", "30m", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("inputLinkParsingIssuesTime.earliest", "-30d", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.span", "4h", {}, e.data);
            }
        });

        // data source monitoring

        // input lag

        var modal_input_lag = new TextInput({
            "id": "modal_input_lag",
            "searchWhenChanged": true,
            "value": "$form.tk_input_lag$",
            "el": $('#modal_input_lag')
        }, {
            tokens: true
        }).render();

        modal_input_lag.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_lag);
        });

        var modal_input_lag_override_class = new DropdownInput({
            "id": "modal_input_lag_override_class",
            "choices": [{
                    "label": "true",
                    "value": "true"
                },
                {
                    "label": "false",
                    "value": "false"
                }
            ],
            "searchWhenChanged": true,
            "default": "true",
            "showClearButton": true,
            "initialValue": "true",
            "selectFirstChoice": false,
            "value": "$form.modal_input_lag_override_class$",
            "el": $('#modal_input_lag_override_class')
        }, {
            tokens: true
        }).render();

        modal_input_lag_override_class.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_lag_override_class);
        });

        var modal_input_lag_override_class_host = new DropdownInput({
            "id": "modal_input_lag_override_class_host",
            "choices": [{
                    "label": "true",
                    "value": "true"
                },
                {
                    "label": "false",
                    "value": "false"
                }
            ],
            "searchWhenChanged": true,
            "default": "true",
            "showClearButton": true,
            "initialValue": "true",
            "selectFirstChoice": false,
            "value": "$form.modal_input_lag_override_class_host$",
            "el": $('#modal_input_lag_override_class_host')
        }, {
            tokens: true
        }).render();

        modal_input_lag_override_class_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_lag_override_class_host);
        });

        // elastic sources

        var modal_input_elastic_source_search_type = new DropdownInput({
            "id": "modal_input_elastic_source_search_type",
            "choices": [{
                    "label": "tstats",
                    "value": "tstats"
                },
                {
                    "label": "raw",
                    "value": "raw"
                },
                {
                    "label": "from",
                    "value": "from"
                },
                {
                    "label": "mstats",
                    "value": "mstats"
                }
            ],
            "searchWhenChanged": false,
            "default": "tstats",
            "showClearButton": true,
            "initialValue": "tstats",
            "selectFirstChoice": false,
            "value": "$form.tk_input_elastic_source_search_type$",
            "el": $('#modal_input_elastic_source_search_type')
        }, {
            tokens: true
        }).render();

        modal_input_elastic_source_search_type.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_elastic_source_search_type);
        });

        var modal_input_elastic_source_data_name = new TextInput({
            "id": "modal_input_elastic_source_data_name",
            "searchWhenChanged": false,
            "value": "$form.tk_input_elastic_source_data_name$",
            "el": $('#modal_input_elastic_source_data_name')
        }, {
            tokens: true
        }).render();

        modal_input_elastic_source_data_name.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_elastic_source_data_name);
        });

        var modal_input_elastic_source_elastic_data_index = new TextInput({
            "id": "modal_input_elastic_source_elastic_data_index",
            "searchWhenChanged": false,
            "default": "none",
            "initialValue": "none",
            "value": "$form.tk_input_elastic_source_elastic_data_index$",
            "el": $('#modal_input_elastic_source_elastic_data_index')
        }, {
            tokens: true
        }).render();

        modal_input_elastic_source_elastic_data_index.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_elastic_source_elastic_data_index);
        });

        var modal_input_elastic_source_elastic_data_sourcetype = new TextInput({
            "id": "modal_input_elastic_source_elastic_data_sourcetype",
            "searchWhenChanged": false,
            "default": "none",
            "initialValue": "none",
            "value": "$form.tk_input_elastic_source_elastic_data_sourcetype$",
            "el": $('#modal_input_elastic_source_elastic_data_sourcetype')
        }, {
            tokens: true
        }).render();

        modal_input_elastic_source_elastic_data_sourcetype.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_elastic_source_elastic_data_sourcetype);
        });

        var modal_input_elastic_source_earliest = new TextInput({
            "id": "modal_input_elastic_source_earliest",
            "searchWhenChanged": false,
            "default": "-4h",
            "initialValue": "-4h",
            "value": "$form.tk_input_elastic_source_earliest$",
            "el": $('#modal_input_elastic_source_earliest')
        }, {
            tokens: true
        }).render();

        modal_input_elastic_source_earliest.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_elastic_source_earliest);
        });

        var modal_input_elastic_source_latest = new TextInput({
            "id": "modal_input_elastic_source_latest",
            "searchWhenChanged": false,
            "default": "+4h",
            "initialValue": "+4h",
            "value": "$form.tk_input_elastic_source_latest$",
            "el": $('#modal_input_elastic_source_latest')
        }, {
            tokens: true
        }).render();

        modal_input_elastic_source_latest.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_elastic_source_latest);
        });

        // Custom lagging

        var modal_input_custom_lagging_type = new DropdownInput({
            "id": "modal_input_custom_lagging_type",
            "choices": [{
                    "label": "sourcetype",
                    "value": "sourcetype"
                },
                {
                    "label": "index",
                    "value": "index"
                }
            ],
            "searchWhenChanged": true,
            "default": "sourcetype",
            "showClearButton": true,
            "initialValue": "sourcetype",
            "selectFirstChoice": false,
            "value": "$form.tk_input_custom_lagging_type$",
            "el": $('#modal_input_custom_lagging_type')
        }, {
            tokens: true
        }).render();

        modal_input_custom_lagging_type.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_lagging_type);
        });

        var modal_input_custom_lagging_name = new TextInput({
            "id": "modal_input_custom_lagging_name",
            "searchWhenChanged": true,
            "value": "$form.tk_input_custom_lagging_name$",
            "el": $('#modal_input_custom_lagging_name')
        }, {
            tokens: true
        }).render();

        modal_input_custom_lagging_name.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_lagging_name);
        });

        var modal_input_custom_lagging_value = new TextInput({
            "id": "modal_input_custom_lagging_value",
            "searchWhenChanged": true,
            "value": "$form.tk_input_custom_lagging_value$",
            "el": $('#modal_input_custom_lagging_value')
        }, {
            tokens: true
        }).render();

        modal_input_custom_lagging_value.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_lagging_value);
        });

        // data host monitoring

        // input lag

        var modal_input_lag_host = new TextInput({
            "id": "modal_input_lag_host",
            "searchWhenChanged": true,
            "value": "$form.tk_input_lag_host$",
            "el": $('#modal_input_lag_host')
        }, {
            tokens: true
        }).render();

        modal_input_lag_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_lag_host);
        });

        // metric host priority

        var modal_input_metric_host_priority = new DropdownInput({
            "id": "modal_input_metric_host_priority",
            "choices": [{
                    "label": "low",
                    "value": "low"
                },
                {
                    "label": "medium",
                    "value": "medium"
                },
                {
                    "label": "high",
                    "value": "high"
                }
            ],
            "searchWhenChanged": true,
            "default": "medium",
            "showClearButton": true,
            "initialValue": "medium",
            "selectFirstChoice": false,
            "value": "$form.tk_input_metric_host_priority$",
            "el": $('#modal_input_metric_host_priority')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_priority.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_priority);
        });

        // data host priority

        var modal_input_host_priority = new DropdownInput({
            "id": "modal_input_host_priority",
            "choices": [{
                    "label": "low",
                    "value": "low"
                },
                {
                    "label": "medium",
                    "value": "medium"
                },
                {
                    "label": "high",
                    "value": "high"
                }
            ],
            "searchWhenChanged": true,
            "default": "medium",
            "showClearButton": true,
            "initialValue": "medium",
            "selectFirstChoice": false,
            "value": "$form.tk_input_host_priority$",
            "el": $('#modal_input_host_priority')
        }, {
            tokens: true
        }).render();

        modal_input_host_priority.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_host_priority);
        });

        var modal_input_level = new DropdownInput({
            "id": "modal_input_level",
            "choices": [{
                    "label": "sourcetype",
                    "value": "sourcetype"
                },
                {
                    "label": "index",
                    "value": "index"
                }
            ],
            "searchWhenChanged": true,
            "default": "sourcetype",
            "showClearButton": true,
            "initialValue": "sourcetype",
            "selectFirstChoice": false,
            "value": "$form.tk_input_level$",
            "el": $('#modal_input_level')
        }, {
            tokens: true
        }).render();

        modal_input_level.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_level);
        });

        // data source priority

        var modal_input_priority = new DropdownInput({
            "id": "modal_input_priority",
            "choices": [{
                    "label": "low",
                    "value": "low"
                },
                {
                    "label": "medium",
                    "value": "medium"
                },
                {
                    "label": "high",
                    "value": "high"
                }
            ],
            "searchWhenChanged": true,
            "default": "medium",
            "showClearButton": true,
            "initialValue": "medium",
            "selectFirstChoice": false,
            "value": "$form.tk_input_priority$",
            "el": $('#modal_input_priority')
        }, {
            tokens: true
        }).render();

        modal_input_priority.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_priority);
        });

        // data source monitoring

        var modal_input_wdays = new DropdownInput({
            "id": "modal_input_wdays",
            "choices": [{
                    "label": "manual:all_days",
                    "value": "manual:all_days"
                },
                {
                    "label": "manual:monday-to-friday",
                    "value": "manual:monday-to-friday"
                },
                {
                    "label": "manual:monday-to-saturday",
                    "value": "manual:monday-to-saturday"
                }
            ],
            "searchWhenChanged": true,
            "default": "manual:all_days",
            "showClearButton": true,
            "initialValue": "all_days",
            "selectFirstChoice": false,
            "value": "$form.tk_input_wdays$",
            "el": $('#modal_input_wdays')
        }, {
            tokens: true
        }).render();

        modal_input_wdays.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_wdays);
        });

        modal_input_wdays.on("valueChange", function(e) {
            if (e.value === "manual:enter_days_numbers") {
                EventHandler.setToken("show_manual_wdays", "true", {}, e.data);
            } else {
                EventHandler.unsetToken("show_manual_wdays");
            }
        });

        var modal_input_wdays_no = new CheckboxGroupInput({
            "id": "modal_input_wdays_no",
            "choices": [{
                    "label": "Monday",
                    "value": "1"
                },
                {
                    "label": "Tuesday",
                    "value": "2"
                },
                {
                    "label": "Wednesday",
                    "value": "3"
                },
                {
                    "label": "Thursday",
                    "value": "4"
                },
                {
                    "label": "Friday",
                    "value": "5"
                },
                {
                    "label": "Saturday",
                    "value": "6"
                },
                {
                    "label": "Sunday",
                    "value": "0"
                }
            ],
            "prefix": "manual:",
            "searchWhenChanged": true,
            "default": ["1", "2", "3", "4", "5", "6", "0"],
            "delimiter": ",",
            "value": "$form.tk_input_wdays_no$",
            "el": $('#modal_input_wdays_no')
        }, {
            tokens: true
        }).render();

        modal_input_wdays_no.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_wdays_no);
        });

        // data host monitoring

        var modal_input_wdays_host = new DropdownInput({
            "id": "modal_input_wdays_host",
            "choices": [{
                    "label": "manual:all_days",
                    "value": "manual:all_days"
                },
                {
                    "label": "manual:monday-to-friday",
                    "value": "manual:monday-to-friday"
                },
                {
                    "label": "manual:monday-to-saturday",
                    "value": "manual:monday-to-saturday"
                }
            ],
            "searchWhenChanged": true,
            "default": "manual:all_days",
            "showClearButton": true,
            "initialValue": "all_days",
            "selectFirstChoice": false,
            "value": "$form.tk_input_wdays_host$",
            "el": $('#modal_input_wdays_host')
        }, {
            tokens: true
        }).render();

        modal_input_wdays_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_wdays_host);
        });

        modal_input_wdays_host.on("valueChange", function(e) {
            if (e.value === "manual:enter_days_numbers") {
                EventHandler.setToken("show_manual_wdays_host", "true", {}, e.data);
            } else {
                EventHandler.unsetToken("show_manual_wdays_host");
            }
        });

        var modal_input_wdays_host_no = new CheckboxGroupInput({
            "id": "modal_input_wdays_host_no",
            "choices": [{
                    "label": "Monday",
                    "value": "1"
                },
                {
                    "label": "Tuesday",
                    "value": "2"
                },
                {
                    "label": "Wednesday",
                    "value": "3"
                },
                {
                    "label": "Thursday",
                    "value": "4"
                },
                {
                    "label": "Friday",
                    "value": "5"
                },
                {
                    "label": "Saturday",
                    "value": "6"
                },
                {
                    "label": "Sunday",
                    "value": "0"
                }
            ],
            "prefix": "manual:",
            "searchWhenChanged": true,
            "default": ["1", "2", "3", "4", "5", "6", "0"],
            "delimiter": ",",
            "value": "$form.tk_input_wdays_host_no$",
            "el": $('#modal_input_wdays_host_no')
        }, {
            tokens: true
        }).render();

        modal_input_wdays_host_no.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_wdays_host_no);
        });

        // metric host monitoring

        // modal link input
        var inputLinkMetricHost = new LinkListInput({
            "id": "inputLinkMetricHost",
            "choices": [{
                    "value": "overview",
                    "label": "Overview metric host"
                },
                {
                    "value": "flipping_status",
                    "label": "Status flipping"
                },
                {
                    "value": "status_message",
                    "label": "Status message"
                },
                {
                    "value": "audit_changes",
                    "label": "Audit changes"
                }
            ],
            "default": "overview",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "overview",
            "value": "$form.inputLinkMetricHost$",
            "el": $('#inputLinkMetricHost')
        }, {
            tokens: true
        }).render();

        inputLinkMetricHost.on("change", function(newValue) {
            FormUtils.handleValueChange(inputLinkMetricHost);
        });

        inputLinkMetricHost.on("valueChange", function(e) {
            if (e.value === "overview") {
                EventHandler.setToken("show_metric_host_overview", "true", {}, e.data);
                EventHandler.unsetToken("show_metric_host_status_message");
                EventHandler.unsetToken("show_metric_host_flipping_status");
                EventHandler.unsetToken("show_metric_host_audit_changes");
            } else if (e.value === "flipping_status") {
                EventHandler.setToken("show_metric_host_flipping_status", "true", {}, e.data);
                EventHandler.unsetToken("show_metric_host_overview");
                EventHandler.unsetToken("show_metric_host_status_message");
                EventHandler.unsetToken("show_metric_host_audit_changes");
            } else if (e.value === "status_message") {
                EventHandler.setToken("show_metric_host_status_message", "true", {}, e.data);
                EventHandler.unsetToken("show_metric_host_overview");
                EventHandler.unsetToken("show_metric_host_flipping_status");
                EventHandler.unsetToken("show_metric_host_audit_changes");
            } else if (e.value === "audit_changes") {
                EventHandler.setToken("show_metric_host_audit_changes", "true", {}, e.data);
                EventHandler.unsetToken("show_metric_host_overview");
                EventHandler.unsetToken("show_metric_host_flipping_status");
                EventHandler.unsetToken("show_metric_host_status_message");
            }
        });

        // whitelist

        // whitelist data_source

        var modal_input_data_source_whitelist = new DropdownInput({
            "id": "modal_input_data_source_whitelist",
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "index",
            "selectFirstChoice": false,
            "valueField": "index",
            "value": "$form.tk_input_whitelist_data_source$",
            "managerid": "searchPopulateIndexesForWhiteListDataSource",
            "el": $('#modal_input_data_source_whitelist')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_whitelist.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_whitelist);
        });

        var modal_input_data_source_whitelist_search = new TextInput({
            "id": "modal_input_data_source_whitelist_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_whitelist_search$",
            "el": $('#modal_input_data_source_whitelist_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_whitelist_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_whitelist_search);
        });

        // whitelist metric_host

        var modal_input_metric_host_whitelist = new DropdownInput({
            "id": "modal_input_metric_host_whitelist",
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "index",
            "selectFirstChoice": false,
            "valueField": "index",
            "value": "$form.tk_input_whitelist_metric_host$",
            "managerid": "searchPopulateIndexesForWhiteListMetricHost",
            "el": $('#modal_input_metric_host_whitelist')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_whitelist.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_whitelist);
        });

        var modal_input_metric_host_whitelist_search = new TextInput({
            "id": "modal_input_metric_host_whitelist_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_metric_host_whitelist_search$",
            "el": $('#modal_input_metric_host_whitelist_search')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_whitelist_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_whitelist_search);
        });

        // whitelist data_host

        var modal_input_data_host_whitelist = new DropdownInput({
            "id": "modal_input_data_host_whitelist",
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "index",
            "selectFirstChoice": false,
            "valueField": "index",
            "value": "$form.tk_input_whitelist_data_host$",
            "managerid": "searchPopulateIndexesForWhiteListDataHost",
            "el": $('#modal_input_data_host_whitelist')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_whitelist.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_whitelist);
        });

        var modal_input_data_host_whitelist_search = new TextInput({
            "id": "modal_input_data_host_whitelist_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_whitelist_search$",
            "el": $('#modal_input_data_host_whitelist_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_whitelist_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_whitelist_search);
        });

        // blacklist data source

        // blacklist host

        var modal_input_data_source_blacklist_host = new TextInput({
            "id": "modal_input_data_source_blacklist_host",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_blacklist_host$",
            "el": $('#modal_input_data_source_blacklist_host')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_host);
        });

        var modal_input_data_source_blacklist_host_search = new TextInput({
            "id": "modal_input_data_source_blacklist_host_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_blacklist_host_search$",
            "el": $('#modal_input_data_source_blacklist_host_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_host_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_host_search);
        });

        // blacklist index

        var modal_input_data_source_blacklist_index = new TextInput({
            "id": "modal_input_data_source_blacklist_index",
            "searchWhenChanged": true,
            "value": "$form.tk_input_blacklist_index$",
            "el": $('#modal_input_data_source_blacklist_index')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_index.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_index);
        });

        var modal_input_data_source_blacklist_index_search = new TextInput({
            "id": "modal_input_data_source_blacklist_index_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_blacklist_index_search$",
            "el": $('#modal_input_data_source_blacklist_index_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_index_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_index_search);
        });

        // Identify card
        var FilterIdentityCardTable = new TextInput({
            "id": "FilterIdentityCardTable",
            "searchWhenChanged": true,
            "default": "*",
            "value": "$form.FilterIdentityCardTable$",
            "el": $('#FilterIdentityCardTable')
        }, {
            tokens: true
        }).render();

        FilterIdentityCardTable.on("change", function(newValue) {
            FormUtils.handleValueChange(FilterIdentityCardTable);
        });

        // Logical group
        var FilterLogicalGroupTable = new TextInput({
            "id": "FilterLogicalGroupTable",
            "searchWhenChanged": true,
            "default": "*",
            "value": "$form.FilterLogicalGroupTable$",
            "el": $('#FilterLogicalGroupTable')
        }, {
            tokens: true
        }).render();

        FilterLogicalGroupTable.on("change", function(newValue) {
            FormUtils.handleValueChange(FilterLogicalGroupTable);
        });

        // Logical group add
        var InputLogicalGroupName = new TextInput({
            "id": "InputLogicalGroupName",
            "searchWhenChanged": true,
            "value": "$form.InputLogicalGroupName$",
            "el": $('#InputLogicalGroupName')
        }, {
            tokens: true
        }).render();

        InputLogicalGroupName.on("change", function(newValue) {
            FormUtils.handleValueChange(InputLogicalGroupName);
        });

        var InputLogicalGroupNamePercent = new DropdownInput({
            "id": "InputLogicalGroupNamePercent",
            "choices": [{
                    "label": "50%",
                    "value": "50"
                },
                {
                    "label": "33.33%",
                    "value": "33.33"
                },
                {
                    "label": "25%",
                    "value": "25"
                },
                {
                    "label": "12.5%",
                    "value": "12.5"
                }
            ],
            "searchWhenChanged": true,
            "default": "50",
            "showClearButton": true,
            "initialValue": "50",
            "selectFirstChoice": false,
            "value": "$form.InputLogicalGroupNamePercent$",
            "el": $('#InputLogicalGroupNamePercent')
        }, {
            tokens: true
        }).render();

        InputLogicalGroupNamePercent.on("change", function(newValue) {
            FormUtils.handleValueChange(InputLogicalGroupNamePercent);
        });

        // blacklist sourcetype

        var modal_input_data_source_blacklist_sourcetype = new TextInput({
            "id": "modal_input_data_source_blacklist_sourcetype",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_blacklist_sourcetype$",
            "el": $('#modal_input_data_source_blacklist_sourcetype')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_sourcetype.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_sourcetype);
        });

        var modal_input_data_source_blacklist_sourcetype_search = new TextInput({
            "id": "modal_input_data_source_blacklist_sourcetype_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_blacklist_sourcetype_search$",
            "el": $('#modal_input_data_source_blacklist_sourcetype_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_sourcetype_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_sourcetype_search);
        });

        // blacklist data host

        // blacklist host

        var modal_input_data_host_blacklist_host = new TextInput({
            "id": "modal_input_data_host_blacklist_host",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_blacklist_host$",
            "el": $('#modal_input_data_host_blacklist_host')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_blacklist_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_blacklist_host);
        });

        var modal_input_data_host_blacklist_host_search = new TextInput({
            "id": "modal_input_data_host_blacklist_host_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_blacklist_host_search$",
            "el": $('#modal_input_data_host_blacklist_host_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_blacklist_host_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_blacklist_host_search);
        });

        // blacklist host

        var modal_input_metric_host_blacklist_host = new TextInput({
            "id": "modal_input_metric_host_blacklist_host",
            "searchWhenChanged": true,
            "value": "$form.tk_input_metric_host_blacklist_host$",
            "el": $('#modal_input_metric_host_blacklist_host')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_blacklist_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_blacklist_host);
        });

        var modal_input_metric_host_blacklist_host_search = new TextInput({
            "id": "modal_input_metric_host_blacklist_host_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_metric_host_blacklist_host_search$",
            "el": $('#modal_input_metric_host_blacklist_host_search')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_blacklist_host_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_blacklist_host_search);
        });

        // blacklist index

        var modal_input_data_host_blacklist_index = new TextInput({
            "id": "modal_input_data_host_blacklist_index",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_blacklist_index$",
            "el": $('#modal_input_data_host_blacklist_index')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_blacklist_index.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_blacklist_index);
        });

        var modal_input_data_host_blacklist_index_search = new TextInput({
            "id": "modal_input_data_host_blacklist_index_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_blacklist_index_search$",
            "el": $('#modal_input_data_host_blacklist_index_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_blacklist_index_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_blacklist_index_search);
        });

        var modal_input_metric_host_blacklist_index = new TextInput({
            "id": "modal_input_metric_host_blacklist_index",
            "searchWhenChanged": true,
            "value": "$form.tk_input_metric_host_blacklist_index$",
            "el": $('#modal_input_metric_host_blacklist_index')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_blacklist_index.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_blacklist_index);
        });

        var modal_input_metric_host_blacklist_index_search = new TextInput({
            "id": "modal_input_metric_host_blacklist_index_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_metric_host_blacklist_index_search$",
            "el": $('#modal_input_metric_host_blacklist_index_search')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_blacklist_index_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_blacklist_index_search);
        });

        // blacklist sourcetype

        var modal_input_data_host_blacklist_sourcetype = new TextInput({
            "id": "modal_input_data_host_blacklist_sourcetype",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_blacklist_sourcetype$",
            "el": $('#modal_input_data_host_blacklist_sourcetype')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_blacklist_sourcetype.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_blacklist_sourcetype);
        });

        var modal_input_data_host_blacklist_sourcetype_search = new TextInput({
            "id": "modal_input_data_host_blacklist_sourcetype_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_blacklist_sourcetype_search$",
            "el": $('#modal_input_data_host_blacklist_sourcetype_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_blacklist_sourcetype_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_blacklist_sourcetype_search);
        });

        // blacklist metric_category

        var modal_input_metric_host_blacklist_metric_category = new DropdownInput({
            "id": "modal_input_metric_host_blacklist_metric_category",
            "tokenDependencies": {
                "depends": "$start_modify_metric_host_blacklist_metric_category$"
            },
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "metric_category",
            "selectFirstChoice": false,
            "valueField": "metric_category",
            "value": "$form.tk_input_metric_host_blacklist_metric_category$",
            "managerid": "searchPopulateMetricCategoriesForBlackListMetricHost",
            "el": $('#modal_input_metric_host_blacklist_metric_category')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_blacklist_metric_category.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_blacklist_metric_category);
        });

        var modal_input_metric_host_blacklist_metric_category_search = new TextInput({
            "id": "modal_input_metric_host_blacklist_metric_category_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_metric_host_blacklist_metric_category_search$",
            "el": $('#modal_input_metric_host_blacklist_metric_category_search')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_blacklist_metric_category_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_blacklist_metric_category_search);
        });

        // Elastic Sources

        var modal_input_elastic_sources_search = new TextInput({
            "id": "modal_input_elastic_sources_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_elastic_sources_search$",
            "el": $('#modal_input_elastic_sources_search')
        }, {
            tokens: true
        }).render();

        modal_input_elastic_sources_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_elastic_sources_search);
        });

        // Custom lagging

        var modal_input_custom_lagging_search = new TextInput({
            "id": "modal_input_custom_lagging_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_custom_lagging_search$",
            "el": $('#modal_input_custom_lagging_search')
        }, {
            tokens: true
        }).render();

        modal_input_custom_lagging_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_lagging_search);
        });

        //
        // SPLUNK LAYOUT
        //

        $('header').remove();
        new LayoutView({
                "hideChrome": false,
                "hideAppBar": false,
                "hideSplunkBar": false,
                "hideFooter": false
            })
            .render()
            .getContainerElement()
            .appendChild($('.dashboard-body')[0]);

        //
        // DASHBOARD EDITOR
        //

        new Dashboard({
            id: 'dashboard',
            el: $('.dashboard-body'),
            showTitle: true,
            editable: false
        }, {
            tokens: true
        }).render();


        //
        // VIEWS: VISUALIZATION ELEMENTS
        //

        var DonutDataSourceCountByStateAndPriority = new VisualizationElement({
            "id": "DonutDataSourceCountByStateAndPriority",
            "type": "semicircle_donut.semicircle_donut",
            "resizable": true,
            "drilldown": "none",
            "height": "170",
            "refresh.display": "progressbar",
            "semicircle_donut.semicircle_donut.colorField": "color",
            "semicircle_donut.semicircle_donut.cutoutPercentage": "50",
            "semicircle_donut.semicircle_donut.legendPosition": "top",
            "semicircle_donut.semicircle_donut.type": "half",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchSingleDataSourceDonutAlerts",
            "el": $('#DonutDataSourceCountByStateAndPriority')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var DonutDataSourceCountByPriority = new VisualizationElement({
            "id": "DonutDataSourceCountByPriority",
            "type": "semicircle_donut.semicircle_donut",
            "resizable": true,
            "drilldown": "all",
            "height": "170",
            "refresh.display": "progressbar",
            "semicircle_donut.semicircle_donut.colorField": "color",
            "semicircle_donut.semicircle_donut.cutoutPercentage": "50",
            "semicircle_donut.semicircle_donut.legendPosition": "top",
            "semicircle_donut.semicircle_donut.type": "half",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchSingleDataSourceDonutPriorities",
            "el": $('#DonutDataSourceCountByPriority')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        DonutDataSourceCountByPriority.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.inputDataPriority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_source_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataSource = new SingleElement({
            "id": "singleFormTotalDataSource",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0x779ecb\"]",
            "underLabel": "DATA SOURCES",
            "managerid": "searchSingleDataSource1",
            "el": $('#singleFormTotalDataSource')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataSource.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_source_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataSourceAlerts = new SingleElement({
            "id": "singleFormTotalDataSourceAlerts",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0xffb347\"]",
            "underLabel": "ANY PRIORITY DATA SOURCES IN ALERT",
            "managerid": "searchSingleDataSourceInAlert",
            "el": $('#singleFormTotalDataSourceAlerts')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataSourceAlerts.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.inputDataPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_source_state", TokenUtils.replaceTokenNames("red", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataSourceAlertsHighPriority = new SingleElement({
            "id": "singleFormTotalDataSourceAlertsHighPriority",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0xff6961\"]",
            "underLabel": "HIGH PRIORITY DATA SOURCES IN ALERT",
            "managerid": "searchSingleDataSourceHighPriority",
            "el": $('#singleFormTotalDataSourceAlertsHighPriority')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataSourceAlertsHighPriority.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_source_state", TokenUtils.replaceTokenNames("red", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataPriority", TokenUtils.replaceTokenNames("high", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataSourceDisabled = new SingleElement({
            "id": "singleFormTotalDataSourceDisabled",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0x779ecb\"]",
            "underLabel": "DATA SOURCES NOT MONITORED",
            "managerid": "searchSingleDataSourceNotMonitored",
            "el": $('#singleFormTotalDataSourceDisabled')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataSourceDisabled.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("disabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_source_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var DonutDataHostCountByPriority = new VisualizationElement({
            "id": "DonutDataHostCountByPriority",
            "type": "semicircle_donut.semicircle_donut",
            "resizable": true,
            "drilldown": "none",
            "height": "170",
            "refresh.display": "progressbar",
            "semicircle_donut.semicircle_donut.colorField": "color",
            "semicircle_donut.semicircle_donut.cutoutPercentage": "50",
            "semicircle_donut.semicircle_donut.legendPosition": "top",
            "semicircle_donut.semicircle_donut.type": "half",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchSingleDataHostDonutAlerts",
            "el": $('#DonutDataHostCountByPriority')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var DonutDataHostCountByStateAndPriority = new VisualizationElement({
            "id": "DonutDataHostCountByStateAndPriority",
            "type": "semicircle_donut.semicircle_donut",
            "resizable": true,
            "drilldown": "all",
            "height": "170",
            "refresh.display": "progressbar",
            "semicircle_donut.semicircle_donut.colorField": "color",
            "semicircle_donut.semicircle_donut.cutoutPercentage": "50",
            "semicircle_donut.semicircle_donut.legendPosition": "top",
            "semicircle_donut.semicircle_donut.type": "half",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchSingleDataHostDonutPriorities",
            "el": $('#DonutDataHostCountByStateAndPriority')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        DonutDataHostCountByStateAndPriority.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_host_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataHostPriority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataHost = new SingleElement({
            "id": "singleFormTotalDataHost",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0x779ecb\"]",
            "underLabel": "DATA HOSTS",
            "managerid": "searchSingleDataHost1",
            "el": $('#singleFormTotalDataHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_host_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataHostPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataHostAlerts = new SingleElement({
            "id": "singleFormTotalDataHostAlerts",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0xffb347\"]",
            "underLabel": "ANY PRIORITY DATA HOSTS IN ALERT",
            "managerid": "searchSingleDataHostInAlert",
            "el": $('#singleFormTotalDataHostAlerts')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataHostAlerts.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.inputDataHostPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_host_state", TokenUtils.replaceTokenNames("red", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataHostAlertsHighPriority = new SingleElement({
            "id": "singleFormTotalDataHostAlertsHighPriority",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0xff6961\"]",
            "underLabel": "HIGH PRIORITY DATA HOSTS IN ALERT",
            "managerid": "searchSingleDataHostHighPriority",
            "el": $('#singleFormTotalDataHostAlertsHighPriority')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataHostAlertsHighPriority.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_host_state", TokenUtils.replaceTokenNames("red", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataHostPriority", TokenUtils.replaceTokenNames("high", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataHostDisabled = new SingleElement({
            "id": "singleFormTotalDataHostDisabled",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0x779ecb\"]",
            "underLabel": "DATA HOSTS NOT MONITORED",
            "managerid": "searchSingleDataHostNotMonitored",
            "el": $('#singleFormTotalDataHostDisabled')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataHostDisabled.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("disabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_host_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataHostPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var DonutMetricHostCountByPriority = new VisualizationElement({
            "id": "DonutMetricHostCountByPriority",
            "type": "semicircle_donut.semicircle_donut",
            "resizable": true,
            "drilldown": "none",
            "height": "170",
            "refresh.display": "progressbar",
            "semicircle_donut.semicircle_donut.colorField": "color",
            "semicircle_donut.semicircle_donut.cutoutPercentage": "50",
            "semicircle_donut.semicircle_donut.legendPosition": "top",
            "semicircle_donut.semicircle_donut.type": "half",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchSingleMetricHostDonutAlerts",
            "el": $('#DonutMetricHostCountByPriority')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var DonutMetricHostCountByStateAndPriority = new VisualizationElement({
            "id": "DonutMetricHostCountByStateAndPriority",
            "type": "semicircle_donut.semicircle_donut",
            "resizable": true,
            "drilldown": "all",
            "height": "170",
            "refresh.display": "progressbar",
            "semicircle_donut.semicircle_donut.colorField": "color",
            "semicircle_donut.semicircle_donut.cutoutPercentage": "50",
            "semicircle_donut.semicircle_donut.legendPosition": "top",
            "semicircle_donut.semicircle_donut.type": "half",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "managerid": "searchSingleMetricHostDonutPriorities",
            "el": $('#DonutMetricHostCountByStateAndPriority')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        DonutMetricHostCountByStateAndPriority.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.metric_host_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputMetricHostPriority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.metric_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalMetricHost = new SingleElement({
            "id": "singleFormTotalMetricHost",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0x779ecb\"]",
            "underLabel": "METRIC HOSTS",
            "managerid": "searchSingleMetricHost1",
            "el": $('#singleFormTotalMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalMetricHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.metric_host_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputMetricHostPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.metric_monitored_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalMetricHostAlerts = new SingleElement({
            "id": "singleFormTotalMetricHostAlerts",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0xffb347\"]",
            "underLabel": "ANY PRIORITY METRIC HOSTS IN ALERT",
            "managerid": "searchSingleMetricHostInAlert",
            "el": $('#singleFormTotalMetricHostAlerts')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalMetricHostAlerts.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.inputMetricHostPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.metric_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.metric_host_state", TokenUtils.replaceTokenNames("red", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalMetricHostAlertsHighPriority = new SingleElement({
            "id": "singleFormTotalMetricHostAlertsHighPriority",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0xff6961\"]",
            "underLabel": "HIGH PRIORITY METRIC HOSTS IN ALERT",
            "managerid": "searchSingleMetricHostHighPriority",
            "el": $('#singleFormTotalMetricHostAlertsHighPriority')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalMetricHostAlertsHighPriority.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.metric_host_state", TokenUtils.replaceTokenNames("red", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.metric_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputMetricHostPriority", TokenUtils.replaceTokenNames("high", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalMetricHostDisabled = new SingleElement({
            "id": "singleFormTotalMetricHostDisabled",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "height": "75",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0x779ecb\"]",
            "underLabel": "METRIC HOSTS NOT MONITORED",
            "managerid": "searchSingleMetricHostNotMonitored",
            "el": $('#singleFormTotalMetricHostDisabled')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalMetricHostDisabled.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.metric_monitored_state", TokenUtils.replaceTokenNames("disabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.metric_host_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputMetricHostPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        // whitelist

        // whitelist data_source

        var singleWhiteListDataSource = new SingleElement({
            "id": "singleWhiteListDataSource",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "index(es) in whitelist currently",
            "managerid": "searchSingleWhiteListDataSource",
            "el": $('#singleWhiteListDataSource')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // whitelist metric_host

        var singleWhiteListMetricHost = new SingleElement({
            "id": "singleWhiteListMetricHost",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "index(es) in whitelist currently",
            "managerid": "searchSingleWhiteListMetricHost",
            "el": $('#singleWhiteListMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // whitelist data_host

        var singleWhiteListDataHost = new SingleElement({
            "id": "singleWhiteListDataHost",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "index(es) in whitelist currently",
            "managerid": "searchSingleWhiteListDataHost",
            "el": $('#singleWhiteListDataHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListDataSourceHost = new SingleElement({
            "id": "singleBlackListDataSourceHost",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "host(s) in blacklist currently",
            "managerid": "searchSingleBlackListDataSourceHost",
            "el": $('#singleBlackListDataSourceHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListDataSourceIndex = new SingleElement({
            "id": "singleBlackListDataSourceIndex",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "index(es) in blacklist currently",
            "managerid": "searchSingleBlackListDataSourceIndex",
            "el": $('#singleBlackListDataSourceIndex')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListDataSourceSourcetype = new SingleElement({
            "id": "singleBlackListDataSourceSourcetype",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "sourcetype(s) in blacklist currently",
            "managerid": "searchSingleBlackListDataSourceSourcetype",
            "el": $('#singleBlackListDataSourceSourcetype')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListDataHostHost = new SingleElement({
            "id": "singleBlackListDataHostHost",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "host(s) in blacklist currently",
            "managerid": "searchSingleBlackListDataHostHost",
            "el": $('#singleBlackListDataHostHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListDataHostIndex = new SingleElement({
            "id": "singleBlackListDataHostIndex",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "index(es) in blacklist currently",
            "managerid": "searchSingleBlackListDataHostIndex",
            "el": $('#singleBlackListDataHostIndex')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListMetricHostIndex = new SingleElement({
            "id": "singleBlackListMetricHostIndex",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "index(es) in blacklist currently",
            "managerid": "searchSingleBlackListMetricHostIndex",
            "el": $('#singleBlackListMetricHostIndex')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListDataHostSourcetype = new SingleElement({
            "id": "singleBlackListDataHostSourcetype",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "sourcetype(s) in blacklist currently",
            "managerid": "searchSingleBlackListDataHostSourcetype",
            "el": $('#singleBlackListDataHostSourcetype')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // blacklist netric host
        var singleBlackListMetricHostHost = new SingleElement({
            "id": "singleBlackListMetricHostHost",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "host(s) in blacklist currently",
            "managerid": "searchSingleBlackListMetricHostHost",
            "el": $('#singleBlackListMetricHostHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // blacklist metric_category
        var singleBlackListMetricHostMetricCategory = new SingleElement({
            "id": "singleBlackListMetricHostMetricCategory",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "metric categorie(s) in blacklist currently",
            "managerid": "searchSingleBlackListMetricHostMetricCategory",
            "el": $('#singleBlackListMetricHostMetricCategory')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // metric sla policies
        var SingleMetricPolicies = new SingleElement({
            "id": "SingleMetricPolicies",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "metric policies",
            "managerid": "searchSingleMetricPolicies",
            "el": $('#SingleMetricPolicies')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Elastic Sources
        var SingleElasticSources = new SingleElement({
            "id": "SingleElasticSources",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "current elastic source(s)",
            "managerid": "searchSingleElasticSources",
            "el": $('#SingleElasticSources')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Custom lagging
        var SingleCustomLagging = new SingleElement({
            "id": "SingleCustomLagging",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "current lagging class(es)",
            "managerid": "searchSingleCustomLagging",
            "el": $('#SingleCustomLagging')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementMainTable = new TableElement({
            "id": "elementMainTable",
            "count": 20,
            "drilldown": "row",
            "fields": "data_name, data_index, data_sourcetype, \"last time\", \"last ingest\", priority, state, \"lag summary (lag event / lag ingestion)\", \"last time idx\", data_last_lag_seen_idx, data_max_lag_allowed, monitoring, data_monitoring_level, data_monitoring_wdays",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchDataSourcesPostTable",
            "el": $('#elementMainTable')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementMainTable.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                // clean any previously set main token, used for variable purposes
                unsetToken("tk_data_host");
                unsetToken("tk_metric_host");

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_name", TokenUtils.replaceTokenNames("$row.data_name$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_index", TokenUtils.replaceTokenNames("$row.data_index$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_sourcetype", TokenUtils.replaceTokenNames("$row.data_sourcetype$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_lag_seen", TokenUtils.replaceTokenNames("$row.data_last_lag_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_ingestion_lag_seen", TokenUtils.replaceTokenNames("$row.data_last_ingestion_lag_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_lag_summary", TokenUtils.replaceTokenNames("$row.lag summary (lag event / lag ingestion)$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_lag_seen_idx", TokenUtils.replaceTokenNames("$row.data_last_lag_seen_idx$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_eventcount", TokenUtils.replaceTokenNames("$row.data_eventcount$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_first_time_seen", TokenUtils.replaceTokenNames("$row.data_first_time_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_time_seen", TokenUtils.replaceTokenNames("$row.data_last_time_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_time_seen_human", TokenUtils.replaceTokenNames("$row.last time$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_ingest", TokenUtils.replaceTokenNames("$row.data_last_ingest$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_ingest_human", TokenUtils.replaceTokenNames("$row.last ingest$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_time_seen_idx", TokenUtils.replaceTokenNames("$row.data_last_time_seen_idx$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_time_seen_idx_human", TokenUtils.replaceTokenNames("$row.data_last_time_seen_idx (translated)$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_max_lag_allowed", TokenUtils.replaceTokenNames("$row.data_max_lag_allowed$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_monitored_state", TokenUtils.replaceTokenNames("$row.data_monitored_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_monitoring_level", TokenUtils.replaceTokenNames("$row.data_monitoring_level$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_monitoring_wdays", TokenUtils.replaceTokenNames("$row.data_monitoring_wdays$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_override_lagging_class", TokenUtils.replaceTokenNames("$row.data_override_lagging_class$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_source_state", TokenUtils.replaceTokenNames("$row.data_source_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_tracker_runtime", TokenUtils.replaceTokenNames("$row.data_tracker_runtime$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_previous_source_state", TokenUtils.replaceTokenNames("$row.data_previous_source_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_previous_tracker_runtime", TokenUtils.replaceTokenNames("$row.data_previous_tracker_runtime$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_state", TokenUtils.replaceTokenNames("$row.latest_flip_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_time", TokenUtils.replaceTokenNames("$row.latest_flip_time$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_time_human", TokenUtils.replaceTokenNames("$row.latest_flip_time (translated)$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_priority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // outlier
                setToken("tk_outliermineventcount", TokenUtils.replaceTokenNames("$row.OutlierMinEventCount$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlierlowerthresholdmultiplier", TokenUtils.replaceTokenNames("$row.OutlierLowerThresholdMultiplier$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlierupperthresholdmultiplier", TokenUtils.replaceTokenNames("$row.OutlierUpperThresholdMultiplier$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlieralertonupper", TokenUtils.replaceTokenNames("$row.OutlierAlertOnUpper$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlier_period", TokenUtils.replaceTokenNames("$row.OutlierTimePeriod$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlier_span", TokenUtils.replaceTokenNames("$row.OutlierSpan$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_isoutlier", TokenUtils.replaceTokenNames("$row.isOutlier$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_enable_behaviour_analytic", TokenUtils.replaceTokenNames("$row.enable_behaviour_analytic$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // elastic sources
                setToken("tk_elastic_source_search_mode", TokenUtils.replaceTokenNames("$row.elastic_source_search_mode$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_elastic_source_search_constraint", TokenUtils.replaceTokenNames("$row.elastic_source_search_constraint$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_elastic_source_from_part1", TokenUtils.replaceTokenNames("$row.elastic_source_from_part1$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_elastic_source_from_part2", TokenUtils.replaceTokenNames("$row.elastic_source_from_part2$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_elastic_mstats_idx", TokenUtils.replaceTokenNames("$row.elastic_mstats_idx$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_elastic_mstats_filters", TokenUtils.replaceTokenNames("$row.elastic_mstats_filters$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pre-fill current values for outlier modification window
                setToken("form.tk_input_data_source_outlier_alert_on_upper", TokenUtils.replaceTokenNames("$row.OutlierAlertOnUpper$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.tk_input_data_source_enable_outlier", TokenUtils.replaceTokenNames("$row.enable_behaviour_analytic$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.tk_input_data_source_outlier_lower_threshold_multiplier", TokenUtils.replaceTokenNames("$row.OutlierLowerThresholdMultiplier$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.tk_input_data_source_outlier_upper_threshold_multiplier", TokenUtils.replaceTokenNames("$row.OutlierUpperThresholdMultiplier$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.TimeOutlierConfigurationDataSource", TokenUtils.replaceTokenNames("$row.OutlierTimePeriod$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.TimeOutlierConfigurationDataSourceSpan", TokenUtils.replaceTokenNames("$row.OutlierSpan$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // status message
                setToken("tk_status_message", TokenUtils.replaceTokenNames("$row.status_message$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // doc href
                setToken("tk_doc_link", TokenUtils.replaceTokenNames("$row.doc_link$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_doc_note", TokenUtils.replaceTokenNames("$row.doc_note$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pref-fill current lagging input
                setToken("form.tk_input_lag", TokenUtils.replaceTokenNames("$row.data_max_lag_allowed$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pref-fill current wdays input
                setToken("form.tk_input_wdays", TokenUtils.replaceTokenNames("$row.data_monitoring_wdays$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pre-fill current monitoring level
                setToken("form.tk_input_level", TokenUtils.replaceTokenNames("$row.data_monitoring_level$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pre-fill current priority
                setToken("form.tk_input_priority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_name = tokens.get("tk_data_name");
                var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
                var tk_data_index = tokens.get("tk_data_index");
                var tk_data_sourcetype = tokens.get("tk_data_sourcetype");

                // define some NA values for outlier
                var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
                var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
                var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
                var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
                var tk_isoutlier = tokens.get("tk_isoutlier");
                var tk_outlier_span = tokens.get("tk_outlier_span");

                if (tk_outliermineventcount = "null") {
                    setToken("tk_outliermineventcount", TokenUtils.replaceTokenNames("-1", _.extend(submittedTokenModel.toJSON(), e.data)));
                }
                if (tk_outlierlowerthresholdmultiplier = "null") {
                    setToken("tk_outlierlowerthresholdmultiplier", TokenUtils.replaceTokenNames("4", _.extend(submittedTokenModel.toJSON(), e.data)));
                }
                if (tk_outlierupperthresholdmultiplier = "null") {
                    setToken("tk_outlierupperthresholdmultiplier", TokenUtils.replaceTokenNames("4", _.extend(submittedTokenModel.toJSON(), e.data)));
                }
                if (tk_isoutlier = "null") {
                    setToken("tk_isoutlier", TokenUtils.replaceTokenNames("0", _.extend(submittedTokenModel.toJSON(), e.data)));
                }
                if (tk_isoutlier = "null") {
                    setToken("tk_isoutlier", TokenUtils.replaceTokenNames("0", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // href docs
                var tk_doc_link = tokens.get("tk_doc_link");
                var tk_doc_note = tokens.get("tk_doc_note");

                // If the documentation reference has not been set, define the href format
                if (tk_doc_link == "null") {
                    setToken("tk_doc_link_main", TokenUtils.replaceTokenNames("No identity documentation has been defined, click here to define a documentation reference", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_doc_modal_target", TokenUtils.replaceTokenNames("define_identity_card", _.extend(submittedTokenModel.toJSON(), e.data)));
                    // replace the textinput for modification requests
                    document.getElementById("input_doc_link").value = "link to documentation";
                } else {
                    setToken("tk_doc_link_main", TokenUtils.replaceTokenNames("Click here to access data source identity card", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_doc_modal_target", TokenUtils.replaceTokenNames("manage_identity_card", _.extend(submittedTokenModel.toJSON(), e.data)));
                    // replace the textinput for modification requests
                    document.getElementById("input_doc_link").value = tk_doc_link;
                }

                if (tk_doc_note == "null") {
                    setToken("tk_doc_link", TokenUtils.replaceTokenNames("No documentation defined.", _.extend(submittedTokenModel.toJSON(), e.data)));
                    // replace the textarea for modification requests
                    document.getElementById("input_doc_note").value = "documentation note";
                } else {
                    // replace the textarea for modification requests
                    document.getElementById("input_doc_note").value = tk_doc_note;
                }

                // Manage root search for overview, conditionally define the query depending on the search
                var tk_elastic_source_search_mode = tokens.get("tk_elastic_source_search_mode");
                var tk_elastic_source_search_constraint = tokens.get("tk_elastic_source_search_constraint");
                var tk_elastic_source_from_part1 = tokens.get("tk_elastic_source_from_part1");
                var tk_elastic_source_from_part2 = tokens.get("tk_elastic_source_from_part2");
                var tk_elastic_mstats_idx = tokens.get("tk_elastic_mstats_idx");
                var tk_elastic_mstats_filters = tokens.get("tk_elastic_mstats_filters");

                if (tk_elastic_source_search_mode == "null") {
                    tk_data_source_overview_root_search = "| `trackme_tstats` count latest(_indextime) as indextime where index=\"" + tk_data_index + "\" sourcetype=\"" + tk_data_sourcetype + "\" by _time, index, sourcetype span=1s | eval delta=(indextime-_time)";
                    tk_data_source_raw_search = "null";
                } else if (tk_elastic_source_search_mode == "tstats") {
                    tk_data_source_overview_root_search = "| `trackme_tstats` count latest(_indextime) as indextime where " + tk_elastic_source_search_constraint + " by _time, index, sourcetype span=1s | eval delta=(indextime-_time)";
                    tk_data_source_raw_search = "?q=search%20" + encodeURI(tk_elastic_source_search_constraint);
                } else if (tk_elastic_source_search_mode == "raw") {
                    tk_data_source_overview_root_search = tk_elastic_source_search_constraint + " | eval delta=(_indextime-_time) | bucket _time span=1s | stats count, avg(delta) as delta by _time";
                    tk_data_source_raw_search = "?q=search%20" + encodeURI(tk_elastic_source_search_constraint);
                } else if (tk_elastic_source_search_mode == "from" && tk_elastic_source_from_part1 != "null" && tk_elastic_source_from_part2 != "null") {
                    tk_data_source_overview_root_search = "| " + tk_elastic_source_search_mode + " " + tk_elastic_source_from_part1 + " | " +  tk_elastic_source_from_part2 + " | eval delta=(_indextime-_time) | bucket _time span=1s | stats count, avg(delta) as delta by _time";
                    tk_data_source_raw_search = "?q=" + encodeURI("| ") + encodeURI(tk_elastic_source_search_mode) + " " + encodeURI(tk_elastic_source_from_part1) + encodeURI("|") +  encodeURI(tk_elastic_source_from_part2);
                } else if (tk_elastic_source_search_mode == "mstats" && tk_elastic_mstats_filters != "null") {
                    tk_data_source_overview_root_search = "| mstats latest(_value) as value where `trackme_metrics_idx` (metric_name=trackme.eventcount_4h OR metric_name=trackme.lag_event_sec) object_category=\"data_source\" object=\"" + tk_data_name + "\" by metric_name span=5m | eval {metric_name}=value | stats first(trackme.eventcount_4h) as count, first(trackme.lag_event_sec) as delta by _time";
                    if (tk_elastic_mstats_idx == "null") {
                        tk_data_source_raw_search = "?q=" + encodeURI("| msearch ") + encodeURI("index=*") + " " + encodeURI("filter=\"" + tk_elastic_mstats_filters + "\"") + encodeURI(" earliest=\"-5m\" latest=now");
                    } else {
                        tk_data_source_raw_search = "?q=" + encodeURI("| msearch ") + encodeURI(tk_elastic_mstats_idx) + " " + encodeURI("filter=\"" + tk_elastic_mstats_filters + "\"") + encodeURI(" earliest=\"-5m\" latest=now");
                    }
                } else {
                    tk_data_source_overview_root_search = "| `trackme_tstats` count latest(_indextime) as indextime where index=\"" + tk_data_index + "\" sourcetype=\"" + tk_data_sourcetype + "\" by _time, index, sourcetype span=1s | eval delta=(indextime-_time)";
                }

                //console.log("tk_data_source_overview_root_search is: " + tk_data_source_overview_root_search);
                setToken("tk_data_source_overview_root_search", TokenUtils.replaceTokenNames(tk_data_source_overview_root_search, _.extend(submittedTokenModel.toJSON(), e.data)));

                // Define the history search

                // Honour elastic sources
                //console.log("tk_data_source_raw_search is: " + tk_data_source_raw_search);

                if (tk_elastic_source_search_mode == "null") {
                    var search_data_source = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + '//app/trackme/search' + "?q=search%20index%3D\"" + encodeURI(tk_data_index) + "\"" + " sourcetype%3D\"" + encodeURI(tk_data_sourcetype) + "\""
                } else {
                    var search_data_source = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + '//app/trackme/search' + tk_data_source_raw_search
                }

                // state
                var tk_data_source_state = tokens.get("tk_data_source_state");

                // priority
                var tk_priority = tokens.get("tk_priority");

                // Define the URL target
                document.getElementById("btn_search_data_source").href = search_data_source;

                // Dynamically manage buttons states
                if (tk_data_monitored_state == "enabled") {
                    document.getElementById('btn_enable_monitoring').disabled = true;
                    document.getElementById('btn_disable_monitoring').disabled = false;
                    setToken("tk_data_monitored_state_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else {
                    document.getElementById('btn_enable_monitoring').disabled = false;
                    document.getElementById('btn_disable_monitoring').disabled = true;
                    setToken("tk_data_monitored_state_class", TokenUtils.replaceTokenNames("title_grey", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Dynamically manage Ack button
                if (tk_data_source_state == "red") {
                    document.getElementById('btn_ack_data_source').disabled = false;
                } else {
                    document.getElementById('btn_ack_data_source').disabled = true;
                }

                // Dynamically manage state color
                if (tk_data_source_state == "green") {
                    setToken("tk_data_source_state_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_data_source_status_message_class", TokenUtils.replaceTokenNames("status_message_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_data_source_state == "orange") {
                    setToken("tk_data_source_state_class", TokenUtils.replaceTokenNames("title_orange", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_data_source_status_message_class", TokenUtils.replaceTokenNames("status_message_orange", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_data_source_state == "blue") {
                    setToken("tk_data_source_state_class", TokenUtils.replaceTokenNames("title_blue", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_data_source_status_message_class", TokenUtils.replaceTokenNames("status_message_blue", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_data_source_state == "red") {
                    setToken("tk_data_source_state_class", TokenUtils.replaceTokenNames("title_red", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_data_source_status_message_class", TokenUtils.replaceTokenNames("status_message_red", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Dynamically manage priority color
                if (tk_priority == "low") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_low_priority", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_priority == "medium") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_medium_priority", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_priority == "high") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_high_priority", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Enable modal context
                $("#modal_manage").modal();

            }
        });

        // Get assets tags
        var elementGetTagsDataHost = new TableElement({
            "id": "elementGetTagsDataHost",
            "count": 100,
            "drilldown": "row",
            "refresh.display": "none",
            "wrap": "true",
            "managerid": "searchGetDataHostTags",
            "el": $('#elementGetTagsDataHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementGetTagsMetricHost = new TableElement({
            "id": "elementGetTagsMetricHost",
            "count": 100,
            "drilldown": "row",
            "refresh.display": "none",
            "wrap": "true",
            "managerid": "searchGetMetricHostTags",
            "el": $('#elementGetTagsMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Ack
        var elementAckGet = new TableElement({
            "id": "elementAckGet",
            "count": 100,
            "drilldown": "row",
            "fields": "object, object_category, ack_mtime, ack_expiration, ack_state",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchAckGet",
            "el": $('#elementAckGet')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementAckGet.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("input_object", TokenUtils.replaceTokenNames("$row.object$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("input_object_category", TokenUtils.replaceTokenNames("$row.object_category$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("ack_expiration", TokenUtils.replaceTokenNames("$row.ack_expiration$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("ack_state", TokenUtils.replaceTokenNames("$row.ack_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // check if already inactive
                var ack_state = tokens.get("ack_state");

                if (ack_state === "inactive") {
                    // Enable modal context
                    $("#ack_disable_already").modal();
                }
                else {
                    // Enable modal context
                    $("#disable_ack").modal();
                }

            }
        });

        // Identity card
        var elementIdentityCardTable = new TableElement({
            "id": "elementIdentityCardTable",
            "count": 100,
            "drilldown": "row",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchIdentityCardTable",
            "el": $('#elementIdentityCardTable')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementIdentityCardTable.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_object", TokenUtils.replaceTokenNames("$row.object$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_doc_link", TokenUtils.replaceTokenNames("$row.doc_link$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_doc_note", TokenUtils.replaceTokenNames("$row.doc_note$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // Enable modal context
                $("#confirm_associate_identity_card").modal();

            }
        });

        // Logical group
        var elementLogicalGroupTable = new TableElement({
            "id": "elementLogicalGroupTable",
            "count": 100,
            "drilldown": "row",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchLogicalGroupTable",
            "el": $('#elementLogicalGroupTable')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementLogicalGroupTable.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                // Enable modal context
                $("#confirm_remove_from_logical_group").modal();

            }
        });

        // Logical group add member
        var elementLogicalGroupTableAddMember = new TableElement({
            "id": "elementLogicalGroupTableAddMember",
            "count": 5,
            "drilldown": "row",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchLogicalGroupTableAddMember",
            "el": $('#elementLogicalGroupTableAddMember')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementLogicalGroupTableAddMember.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_object_group_name", TokenUtils.replaceTokenNames("$row.object_group_name$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // Enable modal context
                $("#confirm_add_member_logical_group").modal();

            }
        });

        // Audit Flip
        var elementMainTableAuditFlip = new TableElement({
            "id": "elementMainTableAuditFlip",
            "count": 100,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainAuditFlipTable",
            "el": $('#elementMainTableAuditFlip')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditFlipOverTime = new ChartElement({
            "id": "chartAuditFlipOverTime",
            "charting.chart.stackMode": "stacked",
            "charting.chart": "column",
            "charting.drilldown": "all",
            "resizable": true,
            "managerid": "searchAuditFlipOverTime",
            "el": $('#chartAuditFlipOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditFlipTopObject = new ChartElement({
            "id": "chartAuditFlipTopObject",
            "charting.chart": "pie",
            "charting.drilldown": "all",
            "resizable": true,
            "managerid": "searchAuditFlipTopObject",
            "el": $('#chartAuditFlipTopObject')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Audit Changes Data Source
        var elementMainTableAuditChangesDataSource = new TableElement({
            "id": "elementMainTableAuditChangesDataSource",
            "count": 5,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainDataSourceAuditChangesTable",
            "el": $('#elementMainTableAuditChangesDataSource')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditChangesDataSourceOverTime = new ChartElement({
            "id": "chartAuditChangesDataSourceOverTime",
            "charting.chart.stackMode": "stacked",
            "charting.chart": "column",
            "charting.drilldown": "all",
            "charting.axisLabelsY.majorUnit": "1",
            "charting.fieldColors": "{\"success\": 0xb6edb6, \"failure\": 0xFFBABA}",
            "resizable": true,
            "height": "150",
            "managerid": "searchAuditDataSourceAuditChangesOverTime",
            "el": $('#chartAuditChangesDataSourceOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Lagging performance metrics
        var chartLaggingMetricDataSourceOverTime = new ChartElement({
            "id": "chartLaggingMetricDataSourceOverTime",
            "charting.chart": "line",
            "charting.chart.nullValueMode": "connect",
            "charting.axisTitleX.visibility": "collapsed",
            "charting.drilldown": "all",
            "resizable": true,
            "height": "300",
            "managerid": "searchLaggingMetricDataSource",
            "el": $('#chartLaggingMetricDataSourceOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartLaggingMetricDataHostOverTime = new ChartElement({
            "id": "chartLaggingMetricDataHostOverTime",
            "charting.chart": "line",
            "charting.chart.nullValueMode": "connect",
            "charting.axisTitleX.visibility": "collapsed",
            "charting.drilldown": "all",
            "resizable": true,
            "height": "300",
            "managerid": "searchLaggingMetricDataHost",
            "el": $('#chartLaggingMetricDataHostOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Audit Changes Data Host
        var elementMainTableAuditChangesDataHost = new TableElement({
            "id": "elementMainTableAuditChangesDataHost",
            "count": 5,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainDataHostAuditChangesTable",
            "el": $('#elementMainTableAuditChangesDataHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditChangesDataHostOverTime = new ChartElement({
            "id": "chartAuditChangesDataHostOverTime",
            "charting.chart.stackMode": "stacked",
            "charting.chart": "column",
            "charting.drilldown": "all",
            "charting.axisLabelsY.majorUnit": "1",
            "charting.fieldColors": "{\"success\": 0xb6edb6, \"failure\": 0xFFBABA}",
            "resizable": true,
            "height": "150",
            "managerid": "searchAuditDataHostAuditChangesOverTime",
            "el": $('#chartAuditChangesDataHostOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Audit Changes Metric Host
        var elementMainTableAuditChangesMetricHost = new TableElement({
            "id": "elementMainTableAuditChangesMetricHost",
            "count": 5,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainMetricHostAuditChangesTable",
            "el": $('#elementMainTableAuditChangesMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditChangesMetricHostOverTime = new ChartElement({
            "id": "chartAuditChangesMetricHostOverTime",
            "charting.chart.stackMode": "stacked",
            "charting.chart": "column",
            "charting.drilldown": "all",
            "charting.axisLabelsY.majorUnit": "1",
            "charting.fieldColors": "{\"success\": 0xb6edb6, \"failure\": 0xFFBABA}",
            "resizable": true,
            "height": "150",
            "managerid": "searchAuditMetricHostAuditChangesOverTime",
            "el": $('#chartAuditChangesMetricHostOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Audit Flip Data Source
        var elementMainTableAuditFlipDataSource = new TableElement({
            "id": "elementMainTableAuditFlipDataSource",
            "count": 5,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainDataSourceAuditFlipTable",
            "el": $('#elementMainTableAuditFlipDataSource')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditFlipDataSourceOverTime = new ChartElement({
            "id": "chartAuditFlipDataSourceOverTime",
            "charting.chart.stackMode": "stacked",
            "charting.chart": "column",
            "charting.drilldown": "all",
            "charting.axisLabelsY.majorUnit": "1",
            "charting.fieldColors": "{\"orange\": 0xffd394, \"blue\": 0xcfebf9, \"green\": 0xb6edb6, \"red\": 0xFFBABA}",
            "resizable": true,
            "height": "150",
            "managerid": "searchAuditDataSourceFlipOverTime",
            "el": $('#chartAuditFlipDataSourceOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Audit Flip Data Host
        var elementMainTableAuditFlipDataHost = new TableElement({
            "id": "elementMainTableAuditFlipDataHost",
            "count": 5,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainDataHostAuditFlipTable",
            "el": $('#elementMainTableAuditFlipDataHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditFlipDataHostOverTime = new ChartElement({
            "id": "chartAuditFlipDataHostOverTime",
            "charting.chart.stackMode": "stacked",
            "charting.chart": "column",
            "charting.drilldown": "all",
            "charting.axisLabelsY.majorUnit": "1",
            "charting.fieldColors": "{\"orange\": 0xffd394, \"blue\": 0xcfebf9, \"green\": 0xb6edb6, \"red\": 0xFFBABA}",
            "resizable": true,
            "height": "150",
            "managerid": "searchAuditDataHostFlipOverTime",
            "el": $('#chartAuditFlipDataHostOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Audit Flip Metric Host
        var elementMainTableAuditFlipMetricHost = new TableElement({
            "id": "elementMainTableAuditFlipMetricHost",
            "count": 5,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainMetricHostAuditFlipTable",
            "el": $('#elementMainTableAuditFlipMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditFlipMetricHostOverTime = new ChartElement({
            "id": "chartAuditFlipMetricHostOverTime",
            "charting.chart.stackMode": "stacked",
            "charting.chart": "column",
            "charting.drilldown": "all",
            "charting.axisLabelsY.majorUnit": "1",
            "charting.fieldColors": "{\"orange\": 0xffd394, \"blue\": 0xcfebf9, \"green\": 0xb6edb6, \"red\": 0xFFBABA}",
            "resizable": true,
            "height": "150",
            "managerid": "searchAuditmetricHostFlipOverTime",
            "el": $('#chartAuditFlipMetricHostOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Audit Changes
        var elementMainTableAuditChanges = new TableElement({
            "id": "elementMainTableAuditChanges",
            "count": 100,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "true",
            "managerid": "searchMainAuditChanges",
            "el": $('#elementMainTableAuditChanges')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditChangesTopAction = new ChartElement({
            "id": "chartAuditChangesTopAction",
            "charting.chart": "pie",
            "charting.drilldown": "all",
            "resizable": true,
            "managerid": "searchAuditChangesTopAction",
            "el": $('#chartAuditChangesTopAction')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditChangesTopUser = new ChartElement({
            "id": "chartAuditChangesUser",
            "charting.chart": "pie",
            "charting.drilldown": "all",
            "resizable": true,
            "managerid": "searchAuditChangesTopUser",
            "el": $('#chartAuditChangesTopUser')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditChangesTopChangeType = new ChartElement({
            "id": "chartAuditChangesTopChangeType",
            "charting.chart": "pie",
            "charting.drilldown": "all",
            "resizable": true,
            "managerid": "searchAuditChangesTopChangeType",
            "el": $('#chartAuditChangesTopChangeType')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // data host monitoring

        var elementMainTableHost = new TableElement({
            "id": "elementMainTableHost",
            "count": 20,
            "drilldown": "row",
            "fields": "data_host, data_index, data_sourcetype, \"last time\", \"last ingest\", priority, state, \"lag summary (lag event / lag ingestion)\", data_max_lag_allowed, monitoring, data_monitoring_wdays",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainTableHost",
            "el": $('#elementMainTableHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementMainTableHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                // clean any previously set main token, used for variable purposes
                unsetToken("tk_data_name");
                unsetToken("tk_metric_host");

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_host", TokenUtils.replaceTokenNames("$row.data_host$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_index", TokenUtils.replaceTokenNames("$row.data_index_raw$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_sourcetype", TokenUtils.replaceTokenNames("$row.data_sourcetype_raw$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_lag_seen", TokenUtils.replaceTokenNames("$row.data_last_lag_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_ingestion_lag_seen", TokenUtils.replaceTokenNames("$row.data_last_ingestion_lag_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_lag_summary", TokenUtils.replaceTokenNames("$row.lag summary (lag event / lag ingestion)$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_eventcount", TokenUtils.replaceTokenNames("$row.data_eventcount$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_first_time_seen", TokenUtils.replaceTokenNames("$row.data_first_time_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_time_seen", TokenUtils.replaceTokenNames("$row.data_last_time_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_time_seen_human", TokenUtils.replaceTokenNames("$row.last time$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_ingest", TokenUtils.replaceTokenNames("$row.data_last_ingest$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_ingest_human", TokenUtils.replaceTokenNames("$row.last ingest$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_max_lag_allowed", TokenUtils.replaceTokenNames("$row.data_max_lag_allowed$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_monitored_state", TokenUtils.replaceTokenNames("$row.data_monitored_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_monitoring_wdays", TokenUtils.replaceTokenNames("$row.data_monitoring_wdays$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_override_lagging_class", TokenUtils.replaceTokenNames("$row.data_override_lagging_class$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_host_state", TokenUtils.replaceTokenNames("$row.data_host_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_tracker_runtime", TokenUtils.replaceTokenNames("$row.data_tracker_runtime$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_previous_host_state", TokenUtils.replaceTokenNames("$row.data_previous_host_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_previous_tracker_runtime", TokenUtils.replaceTokenNames("$row.data_previous_tracker_runtime$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_state", TokenUtils.replaceTokenNames("$row.latest_flip_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_time", TokenUtils.replaceTokenNames("$row.latest_flip_time$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_time_human", TokenUtils.replaceTokenNames("$row.latest_flip_time (translated)$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_priority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // outlier
                setToken("tk_outliermineventcount", TokenUtils.replaceTokenNames("$row.OutlierMinEventCount$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlierlowerthresholdmultiplier", TokenUtils.replaceTokenNames("$row.OutlierLowerThresholdMultiplier$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlierupperthresholdmultiplier", TokenUtils.replaceTokenNames("$row.OutlierUpperThresholdMultiplier$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlieralertonupper", TokenUtils.replaceTokenNames("$row.OutlierAlertOnUpper$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlier_period", TokenUtils.replaceTokenNames("$row.OutlierTimePeriod$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_outlier_span", TokenUtils.replaceTokenNames("$row.OutlierSpan$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_isoutlier", TokenUtils.replaceTokenNames("$row.isOutlier$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_enable_behaviour_analytic", TokenUtils.replaceTokenNames("$row.enable_behaviour_analytic$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pre-fill current values for outlier modification window
                setToken("form.tk_input_data_host_outlier_alert_on_upper", TokenUtils.replaceTokenNames("$row.OutlierAlertOnUpper$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.tk_input_data_host_enable_outlier", TokenUtils.replaceTokenNames("$row.enable_behaviour_analytic$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.tk_input_data_host_outlier_lower_threshold_multiplier", TokenUtils.replaceTokenNames("$row.OutlierLowerThresholdMultiplier$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.tk_input_data_host_outlier_upper_threshold_multiplier", TokenUtils.replaceTokenNames("$row.OutlierUpperThresholdMultiplier$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.TimeOutlierConfigurationDataHost", TokenUtils.replaceTokenNames("$row.OutlierTimePeriod$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.TimeOutlierConfigurationDataHostSpan", TokenUtils.replaceTokenNames("$row.OutlierSpan$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // status message
                setToken("tk_status_message", TokenUtils.replaceTokenNames("$row.status_message$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // tags
                setToken("tk_data_host_tags", TokenUtils.replaceTokenNames("$row.data_host_tags$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pref-fill current lagging input
                setToken("form.tk_input_lag_host", TokenUtils.replaceTokenNames("$row.data_max_lag_allowed$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pref-fill current wdays input
                setToken("form.tk_input_wdays_host", TokenUtils.replaceTokenNames("$row.data_monitoring_wdays$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pre-fill current priority
                setToken("form.tk_input_host_priority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
                var tk_data_host = tokens.get("tk_data_host");

                // state
                var tk_data_host_state = tokens.get("tk_data_host_state");

                // priority
                var tk_priority = tokens.get("tk_priority");

                // Define the history search
                var search_data_host = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + '//app/trackme/search' + "?q=search%20index%3D\"*\" " + "host=\"" + encodeURI(tk_data_host) + "\""

                // Define the URL target
                document.getElementById("btn_search_data_host").href = search_data_host;

                // Dynamically manage buttons states
                if (tk_data_monitored_state == "enabled") {
                    document.getElementById('btn_enable_monitoring_host').disabled = true;
                    document.getElementById('btn_disable_monitoring_host').disabled = false;
                    setToken("tk_data_monitored_state_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else {
                    document.getElementById('btn_enable_monitoring_host').disabled = false;
                    document.getElementById('btn_disable_monitoring_host').disabled = true;
                    setToken("tk_data_monitored_state_class", TokenUtils.replaceTokenNames("title_grey", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Dynamically manage Ack button
                if (tk_data_host_state == "red") {
                    document.getElementById('btn_ack_data_host').disabled = false;
                } else {
                    document.getElementById('btn_ack_data_host').disabled = true;
                }

                // Dynamically manage state color
                if (tk_data_host_state == "green") {
                    setToken("tk_data_host_state_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_data_host_status_message_class", TokenUtils.replaceTokenNames("status_message_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_data_host_state == "orange") {
                    setToken("tk_data_host_state_class", TokenUtils.replaceTokenNames("title_orange", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_data_host_status_message_class", TokenUtils.replaceTokenNames("status_message_orange", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_data_host_state == "blue") {
                    setToken("tk_data_host_state_class", TokenUtils.replaceTokenNames("title_blue", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_data_host_status_message_class", TokenUtils.replaceTokenNames("status_message_blue", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_data_host_state == "red") {
                    setToken("tk_data_host_state_class", TokenUtils.replaceTokenNames("title_red", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_data_host_status_message_class", TokenUtils.replaceTokenNames("status_message_red", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Dynamically manage priority color
                if (tk_priority == "low") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_low_priority", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_priority == "medium") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_medium_priority", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_priority == "high") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_high_priority", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // define some NA values for outlier
                var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
                var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
                var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
                var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
                var tk_isoutlier = tokens.get("tk_isoutlier");

                if (tk_outliermineventcount = "null") {
                    setToken("tk_outliermineventcount", TokenUtils.replaceTokenNames("-1", _.extend(submittedTokenModel.toJSON(), e.data)));
                }
                if (tk_outlierlowerthresholdmultiplier = "null") {
                    setToken("tk_outlierlowerthresholdmultiplier", TokenUtils.replaceTokenNames("4", _.extend(submittedTokenModel.toJSON(), e.data)));
                }
                if (tk_outlierupperthresholdmultiplier = "null") {
                    setToken("tk_outlierupperthresholdmultiplier", TokenUtils.replaceTokenNames("4", _.extend(submittedTokenModel.toJSON(), e.data)));
                }
                if (tk_isoutlier = "null") {
                    setToken("tk_isoutlier", TokenUtils.replaceTokenNames("0", _.extend(submittedTokenModel.toJSON(), e.data)));
                }
                if (tk_isoutlier = "null") {
                    setToken("tk_isoutlier", TokenUtils.replaceTokenNames("0", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Explicitly refresh the get tags search
                searchGetDataHostTags.startSearch();

                // Enable modal context
                $("#modal_manage_host").modal();

            }
        });

        // Metric host monitoring

        var elementMainTableMetricHost = new TableElement({
            "id": "elementMainTableMetricHost",
            "count": 20,
            "drilldown": "row",
            "fields": "metric_host, metric_index, metric_category, metric_details_human, \"last time\", priority, state, monitoring",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainTableMetricHost",
            "el": $('#elementMainTableMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementMainTableMetricHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                // clean any previously set main token, used for variable purposes
                unsetToken("tk_data_name");
                unsetToken("tk_data_host");

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_host", TokenUtils.replaceTokenNames("$row.metric_host$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_index", TokenUtils.replaceTokenNames("$row.metric_index_raw$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_category", TokenUtils.replaceTokenNames("$row.metric_category_raw$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_first_time_seen", TokenUtils.replaceTokenNames("$row.metric_first_time_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_last_time_seen", TokenUtils.replaceTokenNames("$row.metric_last_time_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_last_time_seen_human", TokenUtils.replaceTokenNames("$row.last time$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_last_lag_seen", TokenUtils.replaceTokenNames("$row.metric_last_lag_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_details", TokenUtils.replaceTokenNames("$row.metric_details_raw$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_monitored_state", TokenUtils.replaceTokenNames("$row.metric_monitored_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_host_state", TokenUtils.replaceTokenNames("$row.metric_host_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_tracker_runtime", TokenUtils.replaceTokenNames("$row.metric_tracker_runtime$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_previous_host_state", TokenUtils.replaceTokenNames("$row.metric_previous_host_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_previous_tracker_runtime", TokenUtils.replaceTokenNames("$row.metric_previous_tracker_runtime$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_state", TokenUtils.replaceTokenNames("$row.latest_flip_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_time", TokenUtils.replaceTokenNames("$row.latest_flip_time$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_time_human", TokenUtils.replaceTokenNames("$row.latest_flip_time (translated)$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_priority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pre-fill current priority
                setToken("form.tk_input_metric_host_priority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // logical group
                setToken("tk_object_group_name", TokenUtils.replaceTokenNames("$row.object_group_name$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_object_group_state", TokenUtils.replaceTokenNames("$row.object_group_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_object_group_green_percent", TokenUtils.replaceTokenNames("$row.object_group_green_percent$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_object_group_min_green_percent", TokenUtils.replaceTokenNames("$row.object_group_min_green_percent$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // status message
                setToken("tk_status_message", TokenUtils.replaceTokenNames("$row.status_message$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_metric_monitored_state = tokens.get("tk_metric_monitored_state");
                var tk_metric_host = tokens.get("tk_metric_host");

                // state
                var tk_metric_host_state = tokens.get("tk_metric_host_state");

                // priority
                var tk_priority = tokens.get("tk_priority");

                // Define the history search
                var search_metric_host = '| mcatalog values(metric_name), values(_dims) where index=* host=\"' + tk_metric_host + '\" by host'
                search_metric_host = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + '//app/trackme/search' + "?q=" + encodeURI(search_metric_host) + '&earliest=-15m&latest=now'

                // Define the history msearch
                var msearch_metric_host = '| msearch index=* filter=\"host=\"' + tk_metric_host + '\"\"'
                msearch_metric_host = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + '//app/trackme/search' + "?q=" + encodeURI(msearch_metric_host) + '&earliest=-15m&latest=now'

                // Define the URL target
                document.getElementById("btn_search_metric_host").href = search_metric_host;
                document.getElementById("btn_msearch_metric_host").href = msearch_metric_host;

                var search_metric_host_live_report = '| savedsearch \"trackMe - metric host live report\" host=\"' + tk_metric_host + '"'
                search_metric_host_live_report = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + '//app/trackme/search' + "?q=" + encodeURI(search_metric_host_live_report) + '&earliest=-15m&latest=now'

                // Define the URL target
                document.getElementById("btn_search_metric_host_live_report").href = search_metric_host_live_report;

                // Dynamically manage buttons states
                if (tk_metric_monitored_state == "enabled") {
                    document.getElementById('btn_enable_monitoring_metric_host').disabled = true;
                    document.getElementById('btn_disable_monitoring_metric_host').disabled = false;
                    setToken("tk_metric_monitored_state_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else {
                    document.getElementById('btn_enable_monitoring_metric_host').disabled = false;
                    document.getElementById('btn_disable_monitoring_metric_host').disabled = true;
                    setToken("tk_metric_monitored_state_class", TokenUtils.replaceTokenNames("title_grey", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Dynamically manage Ack button
                if (tk_metric_host_state == "red") {
                    document.getElementById('btn_ack_metric_host').disabled = false;
                } else {
                    document.getElementById('btn_ack_metric_host').disabled = true;
                }

                // Dynamically manage state color
                if (tk_metric_host_state == "green") {
                    setToken("tk_metric_host_state_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_metric_host_status_message_class", TokenUtils.replaceTokenNames("status_message_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_metric_host_state == "orange") {
                    setToken("tk_metric_host_state_class", TokenUtils.replaceTokenNames("title_orange", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_metric_host_status_message_class", TokenUtils.replaceTokenNames("status_message_orange", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_metric_host_state == "blue") {
                    setToken("tk_metric_host_state_class", TokenUtils.replaceTokenNames("title_blue", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_metric_host_status_message_class", TokenUtils.replaceTokenNames("status_message_blue", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_metric_host_state == "red") {
                    setToken("tk_metric_host_state_class", TokenUtils.replaceTokenNames("title_red", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_metric_host_status_message_class", TokenUtils.replaceTokenNames("status_message_red", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Dynamically manage priority color
                if (tk_priority == "low") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_low_priority", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_priority == "medium") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_medium_priority", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_priority == "high") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_high_priority", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Explicitly refresh the get tags search
                searchGetMetricHostTags.startSearch();

                // Enable modal context
                $("#modal_manage_metric_host").modal();

            }
        });

        var elementHostTableMetricHost = new TableElement({
            "id": "elementHostTableMetricHost",
            "count": 8,
            "drilldown": "none",
            "fields": "metric_category, metric_last_time, metric_max_lag_allowed, metric_current_lag_sec, duration, state",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchHostTableMetricHost",
            "el": $('#elementHostTableMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementHostChartMetricHost = new ChartElement({
            "id": "elementHostChartMetricHost",
            "charting.chart": "pie",
            "charting.drilldown": "all",
            "charting.fieldColors": "{\"red\": 0xff6961, \"orange\": 0xffb347, \"blue\": 0x89cff0, \"green\": 0x77dd77}",
            "height": "180",
            "resizable": true,
            "managerid": "searchHostChartMetricHost",
            "el": $('#elementHostChartMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSingleSLAMetricHostpct = new SingleElement({
            "id": "elementSingleSLAMetricHostpct",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "all",
            "height": "60",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "%",
            "rangeColors": "[\"0xdc4e41\",\"0xf1813f\",\"0x53a051\"]",
            "colorMode": "none",
            "rangeValues": "[50,90]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "useThousandSeparators": "1",
            "underLabel": "SLA COMPLIANCE PERCENTAGE (% of time spent in green/blue mode in the last 90d)",
            "managerid": "searchSingleSLAMetricHostpct",
            "el": $('#elementSingleSLAMetricHostpct')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementSingleSLAMetricHostpct.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                var url = TokenUtils.replaceTokenNames("{{SPLUNKWEB_URL_PREFIX}}/app/trackme/search?q=%20%60trackme_get_sla($tk_metric_host$,metric_host)%60&earliest=-90d@d&latest=now", _.extend(submittedTokenModel.toJSON(), e.data), TokenUtils.getEscaper('url'), TokenUtils.getFilters(mvc.Components));
                utils.redirect(url, false, "_blank");
            }
        });

        // Metric SLA policies

        var tableMetricPolicies = new TableElement({
            "id": "tableMetricPolicies",
            "tokenDependencies": {
                "depends": "$show_table_metric_policies$"
            },
            "count": 10,
            "drilldown": "row",
            "fields": "metric_category, metric_max_lag_allowed",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMetricPolicies",
            "el": $('#tableMetricPolicies')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableMetricPolicies.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_input_metric_policy_metric_category", TokenUtils.replaceTokenNames("$row.metric_category$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_input_metric_max_lag_allowed", TokenUtils.replaceTokenNames("$row.metric_max_lag_allowed$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_input_metric_policy_metric_category = tokens.get("tk_input_metric_policy_metric_category");
                var tk_input_metric_max_lag_allowed = tokens.get("tk_input_metric_max_lag_allowed");

                // Enable modal context
                $("#modal_metric_sla_policies").modal('hide');
                $("#manage_metric_sla_policy").modal();

            }
        });

        var elementHostSingleMetricHost = new SingleElement({
            "id": "elementHostSingleMetricHost",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "height": "80",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "SUMMARY",
            "managerid": "searchHostSingleMetricHost",
            "el": $('#elementHostSingleMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Custom lagging

        var tableCustomLagging = new TableElement({
            "id": "tableCustomLagging",
            "tokenDependencies": {
                "depends": "$show_table_custom_lagging$"
            },
            "count": 10,
            "drilldown": "row",
            "fields": "level, name, value",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchCustomLagging",
            "el": $('#tableCustomLagging')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableCustomLagging.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_input_custom_lagging_level", TokenUtils.replaceTokenNames("$row.level$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_input_custom_lagging_name", TokenUtils.replaceTokenNames("$row.name$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_input_custom_lagging_value", TokenUtils.replaceTokenNames("$row.value$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // Enable modal context
                $("#modify_custom_lagging").modal('hide');
                $("#manage_custom_lagging").modal();

            }
        });

        // Elastic Sources

        var tableElasticSources = new TableElement({
            "id": "tableElasticSources",
            "tokenDependencies": {
                "depends": "$show_table_elastic_sources$"
            },
            "count": 10,
            "drilldown": "row",
            "fields": "data_name, search_mode, search_constraint, elastic_data_index, elastic_data_sourcetype",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchElasticSources",
            "el": $('#tableElasticSources')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableElasticSources.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                // get tokens
                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_elastic_source_data_name", TokenUtils.replaceTokenNames("$row.data_name$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_elastic_source_search_mode", TokenUtils.replaceTokenNames("$row.search_mode$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_elastic_source_search_constraint", TokenUtils.replaceTokenNames("$row.search_constraint$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_elastic_source_elastic_data_index", TokenUtils.replaceTokenNames("$row.elastic_data_index$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_elastic_source_elastic_data_sourcetype", TokenUtils.replaceTokenNames("$row.elastic_data_sourcetype$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // Enable modal context
                $("#modify_elastic_sources").modal('hide');
                $("#delete_elastic_source_main").modal();

            }
        });

        // Simulation
        var tableElasticSourcesTest = new TableElement({
            "id": "tableElasticSourcesTest",
            "tokenDependencies": {
                "depends": "$start_simulation_elastic_sources$"
            },
            "count": 1,
            "drilldown": "row",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchElasticSourcesTest",
            "el": $('#tableElasticSourcesTest')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // whitelist

        // whitelist data_source

        var tableWhiteListDataSource = new TableElement({
            "id": "tableWhiteListDataSource",
            "tokenDependencies": {
                "depends": "$show_table_data_source_whitelist$",
            },
            "count": 10,
            "drilldown": "none",
            "fields": "data_index, select",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchWhiteListDataSource",
            "el": $('#tableWhiteListDataSource')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // whitelist data_host

        var tableWhiteListDataHost = new TableElement({
            "id": "tableWhiteListDataHost",
            "tokenDependencies": {
                "depends": "$show_table_data_host_whitelist$",
            },
            "count": 10,
            "drilldown": "none",
            "fields": "data_index, select",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchWhiteListDataHost",
            "el": $('#tableWhiteListDataHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // whitelist metric_host

        var tableWhiteListMetricHost = new TableElement({
            "id": "tableWhiteListMetricHost",
            "tokenDependencies": {
                "depends": "$show_table_metric_host_whitelist$",
            },
            "count": 10,
            "drilldown": "row",
            "fields": "metric_index",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchWhiteListMetricHost",
            "el": $('#tableWhiteListMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableWhiteListMetricHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_index", TokenUtils.replaceTokenNames("$row.metric_index$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_metric_index = tokens.get("tk_metric_index");

                // Enable modal context
                $("#modal_modify_metric_host_whitelist").modal('hide');
                $("#modal_manage_metric_host_whitelist").modal();

            }
        });

        // blacklist

        var tableBlackListDataSourceHost = new TableElement({
            "id": "tableBlackListDataSourceHost",
            "tokenDependencies": {
                "depends": "$show_table_data_source_blacklist_host$"
            },
            "count": 5,
            "drilldown": "row",
            "fields": "data_host, data_blacklist_state, is_rex",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListDataSourceHost",
            "el": $('#tableBlackListDataSourceHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableBlackListDataSourceHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_host", TokenUtils.replaceTokenNames("$row.data_host$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_blacklist_state", TokenUtils.replaceTokenNames("$row.data_blacklist_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_host = tokens.get("tk_data_host");
                var tk_data_blacklist_state = tokens.get("tk_data_blacklist_state");

                // Enable modal context
                $("#modal_modify_data_source_blacklist_host").modal('hide');
                $("#modal_manage_data_source_blacklist_host").modal();

            }
        });

        var tableBlackListDataSourceIndex = new TableElement({
            "id": "tableBlackListDataSourceIndex",
            "tokenDependencies": {
                "depends": "$show_table_data_source_blacklist_index$",
            },
            "count": 5,
            "drilldown": "row",
            "fields": "data_index, data_blacklist_state, is_rex",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListDataSourceIndex",
            "el": $('#tableBlackListDataSourceIndex')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableBlackListDataSourceIndex.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_index", TokenUtils.replaceTokenNames("$row.data_index$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_blacklist_state", TokenUtils.replaceTokenNames("$row.data_blacklist_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_index = tokens.get("tk_data_index");
                var tk_data_blacklist_state = tokens.get("tk_data_blacklist_state");

                // Enable modal context
                $("#modal_modify_data_source_blacklist_index").modal('hide');
                $("#modal_manage_data_source_blacklist_index").modal();

            }
        });

        var tableBlackListDataSourceSourcetype = new TableElement({
            "id": "tableBlackListDataSourceSourcetype",
            "tokenDependencies": {
                "depends": "$show_table_data_source_blacklist_sourcetype$"
            },
            "count": 5,
            "drilldown": "row",
            "fields": "data_sourcetype, data_blacklist_state, is_rex",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListDataSourceSourcetype",
            "el": $('#tableBlackListDataSourceSourcetype')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableBlackListDataSourceSourcetype.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_sourcetype", TokenUtils.replaceTokenNames("$row.data_sourcetype$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_blacklist_state", TokenUtils.replaceTokenNames("$row.data_blacklist_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
                var tk_data_blacklist_state = tokens.get("tk_data_blacklist_state");

                // Enable modal context
                $("#modal_modify_data_source_blacklist_sourcetype").modal('hide');
                $("#modal_manage_data_source_blacklist_sourcetype").modal();

            }
        });

        var tableBlackListDataHostHost = new TableElement({
            "id": "tableBlackListDataHostHost",
            "tokenDependencies": {
                "depends": "$show_table_data_host_blacklist_host$"
            },
            "count": 5,
            "drilldown": "row",
            "fields": "data_host, data_blacklist_state, is_rex",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListDataHostHost",
            "el": $('#tableBlackListDataHostHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableBlackListDataHostHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_host", TokenUtils.replaceTokenNames("$row.data_host$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_blacklist_state", TokenUtils.replaceTokenNames("$row.data_blacklist_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_host = tokens.get("tk_data_host");
                var tk_data_blacklist_state = tokens.get("tk_data_blacklist_state");

                // Enable modal context
                $("#modal_modify_data_host_blacklist_host").modal('hide');
                $("#modal_manage_data_host_blacklist_host").modal();

            }
        });

        var tableBlackListDataHostIndex = new TableElement({
            "id": "tableBlackListDataHostIndex",
            "tokenDependencies": {
                "depends": "$show_table_data_host_blacklist_index$"
            },
            "count": 5,
            "drilldown": "row",
            "fields": "data_index, data_blacklist_state, is_rex",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListDataHostIndex",
            "el": $('#tableBlackListDataHostIndex')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableBlackListDataHostIndex.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_index", TokenUtils.replaceTokenNames("$row.data_index$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_blacklist_state", TokenUtils.replaceTokenNames("$row.data_blacklist_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_index = tokens.get("tk_data_index");
                var tk_data_blacklist_state = tokens.get("tk_data_blacklist_state");

                // Enable modal context
                $("#modal_modify_data_host_blacklist_index").modal('hide');
                $("#modal_manage_data_host_blacklist_index").modal();

            }
        });

        var tableBlackListMetricHostIndex = new TableElement({
            "id": "tableBlackListMetricHostIndex",
            "tokenDependencies": {
                "depends": "$show_table_metric_host_blacklist_index$"
            },
            "count": 5,
            "drilldown": "row",
            "fields": "metric_index, metric_blacklist_state, is_rex",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListMetricHostIndex",
            "el": $('#tableBlackListMetricHostIndex')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableBlackListMetricHostIndex.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_index", TokenUtils.replaceTokenNames("$row.metric_index$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_blacklist_state", TokenUtils.replaceTokenNames("$row.metric_blacklist_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_metric_index = tokens.get("tk_metric_index");
                var tk_metric_blacklist_state = tokens.get("tk_metric_blacklist_state");

                // Enable modal context
                $("#modal_modify_metric_host_blacklist_index").modal('hide');
                $("#modal_manage_metric_host_blacklist_index").modal();

            }
        });

        var tableBlackListDataHostSourcetype = new TableElement({
            "id": "tableBlackListDataHostSourcetype",
            "tokenDependencies": {
                "depends": "$show_table_data_host_blacklist_sourcetype$"
            },
            "count": 5,
            "drilldown": "row",
            "fields": "data_sourcetype, data_blacklist_state, is_rex",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListDataHostSourcetype",
            "el": $('#tableBlackListDataHostSourcetype')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableBlackListDataHostSourcetype.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_sourcetype", TokenUtils.replaceTokenNames("$row.data_sourcetype$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_blacklist_state", TokenUtils.replaceTokenNames("$row.data_blacklist_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
                var tk_data_blacklist_state = tokens.get("tk_data_blacklist_state");

                // Enable modal context
                $("#modal_modify_data_host_blacklist_sourcetype").modal('hide');
                $("#modal_manage_data_host_blacklist_sourcetype").modal();

            }
        });

        var tableBlackListMetricHostHost = new TableElement({
            "id": "tableBlackListMetricHostHost",
            "tokenDependencies": {
                "depends": "$show_table_metric_host_blacklist_host$"
            },
            "count": 5,
            "drilldown": "row",
            "fields": "metric_host, metric_blacklist_state, is_rex",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListMetricHostHost",
            "el": $('#tableBlackListMetricHostHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableBlackListMetricHostHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_host", TokenUtils.replaceTokenNames("$row.metric_host$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_blacklist_state", TokenUtils.replaceTokenNames("$row.metric_blacklist_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_metric_host = tokens.get("tk_metric_host");
                var tk_metric_blacklist_state = tokens.get("tk_metric_blacklist_state");

                // Enable modal context
                $("#modal_modify_metric_host_blacklist_host").modal('hide');
                $("#modal_manage_metric_host_blacklist_host").modal();

            }
        });

        var tableBlackListMetricHostMetricCategory = new TableElement({
            "id": "tableBlackListMetricHostMetricCategory",
            "tokenDependencies": {
                "depends": "$show_table_metric_host_blacklist_metric_category$"
            },
            "count": 5,
            "drilldown": "row",
            "fields": "metric_category, metric_blacklist_state, is_rex",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListMetricHostMetricCategory",
            "el": $('#tableBlackListMetricHostMetricCategory')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableBlackListMetricHostMetricCategory.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_category", TokenUtils.replaceTokenNames("$row.metric_category$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_blacklist_state", TokenUtils.replaceTokenNames("$row.metric_blacklist_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_metric_category = tokens.get("tk_metric_category");
                var tk_metric_blacklist_state = tokens.get("tk_metric_blacklist_state");

                // Enable modal context
                $("#modal_modify_metric_host_blacklist_metric_category").modal('hide');
                $("#modal_manage_metric_host_blacklist_metric_category").modal();

            }
        });

        // modal window chart
        var elementChartLag = new ChartElement({
            "id": "elementChartLag",
            "charting.axisX.abbreviation": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.axisTitleY.text": "Events count",
            "refresh.display": "progressbar",
            "charting.chart.nullValueMode": "gaps",
            "charting.axisTitleX.visibility": "collapsed",
            "charting.axisTitleY2.text": "lag in seconds",
            "charting.axisX.scale": "linear",
            "charting.drilldown": "none",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.chart.overlayFields": "avg_lag_sec",
            "charting.chart.showDataLabels": "none",
            "charting.axisTitleY2.visibility": "visible",
            "charting.axisY2.enabled": "1",
            "charting.axisY2.scale": "inherit",
            "trellis.scales.shared": "1",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart.bubbleSizeBy": "area",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.chart.style": "shiny",
            "charting.axisY.scale": "linear",
            "charting.layout.splitSeries": "0",
            "charting.fieldColors": "{\"events_count\": 0xaec6cf, \"avg_lag_sec\": 0x8b0000}",
            "resizable": true,
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.lineWidth": "2",
            "charting.axisTitleY.visibility": "visible",
            "charting.chart.stackMode": "default",
            "charting.legend.placement": "right",
            "trellis.size": "medium",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisY2.abbreviation": "none",
            "charting.chart": "column",
            "charting.axisY.abbreviation": "none",
            "trellis.enabled": "0",
            "managerid": "searchChartLag",
            "el": $('#elementChartLag')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // data source monitoring

        // Data Parsing Quality
        var elementSearchDataSourceParsingQualityChart = new ChartElement({
            "id": "elementSearchDataSourceParsingQualityChart",
            "charting.chart.nullValueMode": "gaps",
            "resizable": true,
            "trellis.enabled": "0",
            "charting.axisTitleX.visibility": "collapsed",
            "refresh.display": "progressbar",
            "charting.chart.stackMode": "stacked",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisY.abbreviation": "none",
            "charting.legend.placement": "bottom",
            "charting.axisY2.abbreviation": "none",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.chart.showDataLabels": "none",
            "charting.axisY2.enabled": "0",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.style": "shiny",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart": "column",
            "charting.axisX.scale": "linear",
            "trellis.scales.shared": "1",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.drilldown": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "trellis.size": "medium",
            "charting.axisY.scale": "linear",
            "charting.chart.bubbleSizeBy": "area",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisX.abbreviation": "none",
            "charting.layout.splitSeries": "0",
            "charting.lineWidth": "2",
            "charting.axisY2.scale": "inherit",
            "managerid": "SearchDataSourceParsingQualityChart",
            "el": $('#elementSearchDataSourceParsingQualityChart')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSearchDataSourceParsingQualitySingle = new SingleElement({
            "id": "elementSearchDataSourceParsingQualitySingle",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "all",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "height": "50",
            "unit": "",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "SUMMARY OF INDEXING TIME PARSING ERRORS (click to drilldown in a new tab)",
            "managerid": "SearchDataSourceParsingQualitySingle",
            "el": $('#elementSearchDataSourceParsingQualitySingle')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementSearchDataSourceParsingQualitySingle.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                var url = TokenUtils.replaceTokenNames("{{SPLUNKWEB_URL_PREFIX}}/app/trackme/search?q=index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=LineBreakingProcessor OR component=AggregatorMiningProcessor OR component=DateParserVerbose | `trackme_data_quality_parse` | search data_sourcetype=\"$tk_data_sourcetype$\"", _.extend(submittedTokenModel.toJSON(), e.data), TokenUtils.getEscaper('url'), TokenUtils.getFilters(mvc.Components));
                utils.redirect(url, false, "_blank");
            }
        });

        // Outliers
        var elementOutlier = new VisualizationElement({
            "id": "elementOutlier",
            "type": "Splunk_ML_Toolkit.OutliersViz",
            "resizable": true,
            "Splunk_ML_Toolkit.OutliersViz.showOutlierCount": "true",
            "drilldown": "none",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "height": "350",
            "managerid": "searchOutlierDetectionChart",
            "el": $('#elementOutlier')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var elementOutlierSimulation = new VisualizationElement({
            "id": "elementOutlierSimulation",
            "type": "Splunk_ML_Toolkit.OutliersViz",
            "resizable": true,
            "Splunk_ML_Toolkit.OutliersViz.showOutlierCount": "true",
            "drilldown": "none",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "height": "300",
            "managerid": "searchOutlierDetectionChartSimulation",
            "el": $('#elementOutlierSimulation')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var elementOutlierTable = new TableElement({
            "id": "elementOutlierTable",
            "count": 100,
            "dataOverlayMode": "none",
            "drilldown": "none",
            "percentagesRow": "false",
            "rowNumbers": "false",
            "totalsRow": "false",
            "wrap": "true",
            "managerid": "searchOutlierDetectionTable",
            "el": $('#elementOutlierTable')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        // modal Single AutoLag
        var elementDataSourceAutoLaggingDataSourceSingleLagPerc95 = new SingleElement({
            "id": "elementDataSourceAutoLaggingDataSourceSingleLagPerc95",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "LAST 7 DAYS PERCENTILE 95 AUTO LAG",
            "managerid": "searchSingleLagAutoLaggingDataSource7dSingleLagPerc95",
            "el": $('#elementDataSourceAutoLaggingDataSourceSingleLagPerc95')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementDataSourceAutoLaggingDataSourceSingleLagAvg = new SingleElement({
            "id": "elementDataSourceAutoLaggingDataSourceSingleLagAvg",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "LAST 7 DAYS AVERAGE AUTO LAG",
            "managerid": "searchSingleLagAutoLaggingDataSource7dSingleLagAvg",
            "el": $('#elementDataSourceAutoLaggingDataSourceSingleLagAvg')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementDataSourceAutoLaggingDataSourceSingleLagPerc95Last30d = new SingleElement({
            "id": "elementDataSourceAutoLaggingDataSourceSingleLagPerc95Last30d",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "LAST 30 DAYS PERCENTILE 95 AUTO LAG",
            "managerid": "searchSingleLagAutoLaggingDataSource30dSingleLagPerc95",
            "el": $('#elementDataSourceAutoLaggingDataSourceSingleLagPerc95Last30d')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementDataSourceAutoLaggingDataSourceSingleLagAvgLast30d = new SingleElement({
            "id": "elementDataSourceAutoLaggingDataSourceSingleLagAvgLast30d",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "LAST 30 DAYS AVERAGE AUTO LAG",
            "managerid": "searchSingleLagAutoLaggingDataSource30dSingleLagAvg",
            "el": $('#elementDataSourceAutoLaggingDataSourceSingleLagAvgLast30d')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // modal Single AutoLag
        var elementDataHostAutoLaggingDataHostSingleLagPerc95 = new SingleElement({
            "id": "elementDataHostAutoLaggingDataHostSingleLagPerc95",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "LAST 7 DAYS PERCENTILE 95 AUTO LAG",
            "managerid": "searchSingleLagAutoLaggingDataHost7dSingleLagPerc95",
            "el": $('#elementDataHostAutoLaggingDataHostSingleLagPerc95')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementDataHostAutoLaggingDataHostSingleLagAvg = new SingleElement({
            "id": "elementDataHostAutoLaggingDataHostSingleLagAvg",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "LAST 7 DAYS AVERAGE AUTO LAG",
            "managerid": "searchSingleLagAutoLaggingDataHost7dSingleLagAvg",
            "el": $('#elementDataHostAutoLaggingDataHostSingleLagAvg')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementDataHostAutoLaggingDataHostSingleLagPerc95Last30d = new SingleElement({
            "id": "elementDataHostAutoLaggingDataHostSingleLagPerc95Last30d",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "LAST 30 DAYS PERCENTILE 95 AUTO LAG",
            "managerid": "searchSingleLagAutoLaggingDataHost30dSingleLagPerc95",
            "el": $('#elementDataHostAutoLaggingDataHostSingleLagPerc95Last30d')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementDataHostAutoLaggingDataHostSingleLagAvgLast30d = new SingleElement({
            "id": "elementDataHostAutoLaggingDataHostSingleLagAvgLast30d",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "LAST 30 DAYS AVERAGE AUTO LAG",
            "managerid": "searchSingleLagAutoLaggingDataHost30dSingleLagAvg",
            "el": $('#elementDataHostAutoLaggingDataHostSingleLagAvgLast30d')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // modal Single Lag
        var elementSingleLagPerc95 = new SingleElement({
            "id": "elementSingleLagPerc95",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "sec",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "PERCENTILE 95 DATA SOURCE LAG",
            "managerid": "searchSingleLagPerc95",
            "el": $('#elementSingleLagPerc95')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSingleLagAvg = new SingleElement({
            "id": "elementSingleLagAvg",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "sec",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "AVERAGE DATA SOURCE LAG",
            "managerid": "searchSingleLagAvg",
            "el": $('#elementSingleLagAvg')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSingleSLApct = new SingleElement({
            "id": "elementSingleSLApct",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "all",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "height": "80",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "%",
            "rangeColors": "[\"0xdc4e41\",\"0xf1813f\",\"0x53a051\"]",
            "colorMode": "none",
            "rangeValues": "[50,90]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "useThousandSeparators": "1",
            "underLabel": "SLA COMPLIANCE PERCENTAGE (% of time spent in green/blue mode in the last 90d)",
            "managerid": "searchSingleSLApct",
            "el": $('#elementSingleSLApct')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementSingleSLApct.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                var url = TokenUtils.replaceTokenNames("{{SPLUNKWEB_URL_PREFIX}}/app/trackme/search?q=%20%60trackme_get_sla($tk_data_name$,data_source)%60&earliest=-90d@d&latest=now", _.extend(submittedTokenModel.toJSON(), e.data), TokenUtils.getEscaper('url'), TokenUtils.getFilters(mvc.Components));
                utils.redirect(url, false, "_blank");
            }
        });

        // data host monitoring

        // Data Parsing Quality
        var elementSearchDataHostParsingQualityChart = new ChartElement({
            "id": "elementSearchDataHostParsingQualityChart",
            "charting.chart.nullValueMode": "gaps",
            "resizable": true,
            "trellis.enabled": "0",
            "charting.axisTitleX.visibility": "collapsed",
            "refresh.display": "progressbar",
            "charting.chart.stackMode": "stacked",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisY.abbreviation": "none",
            "charting.legend.placement": "bottom",
            "charting.axisY2.abbreviation": "none",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.chart.showDataLabels": "none",
            "charting.axisY2.enabled": "0",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.style": "shiny",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart": "column",
            "charting.axisX.scale": "linear",
            "trellis.scales.shared": "1",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.drilldown": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "trellis.size": "medium",
            "charting.axisY.scale": "linear",
            "charting.chart.bubbleSizeBy": "area",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisX.abbreviation": "none",
            "charting.layout.splitSeries": "0",
            "charting.lineWidth": "2",
            "charting.axisY2.scale": "inherit",
            "managerid": "SearchDataHostParsingQualityChart",
            "el": $('#elementSearchDataHostParsingQualityChart')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSearchDataHostParsingQualitySingle = new SingleElement({
            "id": "elementSearchDataHostParsingQualitySingle",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "all",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "height": "50",
            "unit": "",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "SUMMARY OF INDEXING TIME PARSING ERRORS (click to drilldown in a new tab)",
            "managerid": "SearchDataHostParsingQualitySingle",
            "el": $('#elementSearchDataHostParsingQualitySingle')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementSearchDataHostParsingQualitySingle.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                var url = TokenUtils.replaceTokenNames("{{SPLUNKWEB_URL_PREFIX}}/app/trackme/search?q=index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=LineBreakingProcessor OR component=AggregatorMiningProcessor OR component=DateParserVerbose | `trackme_data_quality_parse` | search data_host=\"$tk_data_host$\"", _.extend(submittedTokenModel.toJSON(), e.data), TokenUtils.getEscaper('url'), TokenUtils.getFilters(mvc.Components));
                utils.redirect(url, false, "_blank");
            }
        });

        // outlier chart
        var elementOutlierDataHost = new VisualizationElement({
            "id": "elementOutlierDataHost",
            "type": "Splunk_ML_Toolkit.OutliersViz",
            "resizable": true,
            "Splunk_ML_Toolkit.OutliersViz.showOutlierCount": "true",
            "drilldown": "none",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "height": "350",
            "managerid": "searchOutlierDetectionChartDataHost",
            "el": $('#elementOutlierDataHost')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var elementOutlierTableDataHost = new TableElement({
            "id": "elementOutlierTableDataHost",
            "count": 100,
            "dataOverlayMode": "none",
            "drilldown": "none",
            "percentagesRow": "false",
            "rowNumbers": "false",
            "totalsRow": "false",
            "wrap": "true",
            "managerid": "searchOutlierDetectionTableDataHost",
            "el": $('#elementOutlierTableDataHost')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        var elementOutlierSimulationDataHost = new VisualizationElement({
            "id": "elementOutlierSimulationDataHost",
            "type": "Splunk_ML_Toolkit.OutliersViz",
            "resizable": true,
            "Splunk_ML_Toolkit.OutliersViz.showOutlierCount": "true",
            "drilldown": "none",
            "trellis.enabled": "0",
            "trellis.scales.shared": "1",
            "trellis.size": "medium",
            "height": "300",
            "managerid": "searchOutlierDetectionChartSimulationDataHost",
            "el": $('#elementOutlierSimulationDataHost')
        }, {tokens: true, tokenNamespace: "submitted"}).render();

        // modal window chart
        var elementChartLagHostOverTime = new ChartElement({
            "id": "elementChartLagHostOverTime",
            "charting.axisX.abbreviation": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.axisTitleY.text": "Events count",
            "refresh.display": "progressbar",
            "charting.chart.nullValueMode": "gaps",
            "charting.axisTitleX.visibility": "collapsed",
            "charting.axisTitleY2.text": "lag in seconds",
            "charting.axisX.scale": "linear",
            "charting.drilldown": "none",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.chart.overlayFields": "avg_lag_sec",
            "charting.chart.showDataLabels": "none",
            "charting.axisTitleY2.visibility": "visible",
            "charting.axisY2.enabled": "1",
            "charting.axisY2.scale": "inherit",
            "trellis.scales.shared": "1",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart.bubbleSizeBy": "area",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.chart.style": "shiny",
            "charting.axisY.scale": "linear",
            "charting.layout.splitSeries": "0",
            "resizable": true,
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.lineWidth": "2",
            "charting.axisTitleY.visibility": "visible",
            "charting.chart.stackMode": "default",
            "charting.legend.placement": "right",
            "trellis.size": "medium",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisY2.abbreviation": "none",
            "charting.chart": "column",
            "charting.axisY.abbreviation": "none",
            "charting.fieldColors": "{\"events_count\": 0xaec6cf, \"avg_lag_sec\": 0x8b0000}",
            "trellis.enabled": "0",
            "height": "160",
            "managerid": "searchChartLagHostOverTime",
            "el": $('#elementChartLagHostOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // modal Single Lag
        var elementSingleLagHostPerc95 = new SingleElement({
            "id": "elementSingleLagHostPerc95",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "height": "80",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "sec",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "PERCENTILE 95 DATA HOST LAG",
            "managerid": "searchSingleLagHostPerc95",
            "el": $('#elementSingleLagHostPerc95')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSingleLagHostAvg = new SingleElement({
            "id": "elementSingleLagHostAvg",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "height": "80",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "sec",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "AVERAGE DATA HOST LAG",
            "managerid": "searchSingleLagHostAvg",
            "el": $('#elementSingleLagHostAvg')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSingleSLAHostpct = new SingleElement({
            "id": "elementSingleSLAHostpct",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "all",
            "height": "80",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "%",
            "rangeColors": "[\"0xdc4e41\",\"0xf1813f\",\"0x53a051\"]",
            "colorMode": "none",
            "rangeValues": "[50,90]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "useThousandSeparators": "1",
            "underLabel": "SLA COMPLIANCE PERCENTAGE (% of time spent in green/blue mode in the last 90d)",
            "managerid": "searchSingleSLAHostpct",
            "el": $('#elementSingleSLAHostpct')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementSingleSLAHostpct.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                var url = TokenUtils.replaceTokenNames("{{SPLUNKWEB_URL_PREFIX}}/app/trackme/search?q=%20%60trackme_get_sla($tk_data_host$,data_host)%60&earliest=-90d@d&latest=now", _.extend(submittedTokenModel.toJSON(), e.data), TokenUtils.getEscaper('url'), TokenUtils.getFilters(mvc.Components));
                utils.redirect(url, false, "_blank");
            }
        });

        var elementChartHostIndexes = new ChartElement({
            "id": "elementChartHostIndexes",
            "charting.drilldown": "all",
            "resizable": true,
            "charting.chart": "pie",
            "height": "160",
            "managerid": "searchChartHostIndexes",
            "el": $('#elementChartHostIndexes')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementChartHostSourcetypes = new ChartElement({
            "id": "elementChartHostSourcetypes",
            "charting.drilldown": "all",
            "resizable": true,
            "charting.chart": "pie",
            "height": "160",
            "managerid": "searchChartHostSourcetypes",
            "el": $('#elementChartHostSourcetypes')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Ops: Indexer Queues
        var elementChartQueue1 = new ChartElement({
            "id": "elementChartQueue1",
            "charting.chart.nullValueMode": "gaps",
            "resizable": true,
            "trellis.enabled": "0",
            "charting.axisTitleX.visibility": "collapsed",
            "refresh.display": "progressbar",
            "charting.chart.stackMode": "stacked",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisY.abbreviation": "none",
            "charting.legend.placement": "bottom",
            "charting.axisY2.abbreviation": "none",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.chart.showDataLabels": "none",
            "charting.axisY2.enabled": "0",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.style": "shiny",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart": "line",
            "charting.axisX.scale": "linear",
            "trellis.scales.shared": "1",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "height": "350",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.drilldown": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "trellis.size": "medium",
            "charting.axisY.scale": "linear",
            "charting.chart.bubbleSizeBy": "area",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisX.abbreviation": "none",
            "charting.layout.splitSeries": "0",
            "charting.lineWidth": "2",
            "charting.axisY2.scale": "inherit",
            "managerid": "searchQueue1",
            "el": $('#elementChartQueue1')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementChartQueue2 = new ChartElement({
            "id": "elementChartQueue2",
            "charting.chart.nullValueMode": "gaps",
            "resizable": true,
            "trellis.enabled": "0",
            "charting.axisTitleX.visibility": "collapsed",
            "refresh.display": "progressbar",
            "charting.chart.stackMode": "stacked",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisY.abbreviation": "none",
            "charting.legend.placement": "bottom",
            "charting.axisY2.abbreviation": "none",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.chart.showDataLabels": "none",
            "charting.axisY2.enabled": "0",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.style": "shiny",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart": "line",
            "charting.axisX.scale": "linear",
            "trellis.scales.shared": "1",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "height": "350",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.drilldown": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "trellis.size": "medium",
            "charting.axisY.scale": "linear",
            "charting.chart.bubbleSizeBy": "area",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisX.abbreviation": "none",
            "charting.layout.splitSeries": "0",
            "charting.lineWidth": "2",
            "charting.axisY2.scale": "inherit",
            "managerid": "searchQueue2",
            "el": $('#elementChartQueue2')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();


        var elementChartQueue3 = new ChartElement({
            "id": "elementChartQueue3",
            "charting.chart.nullValueMode": "gaps",
            "resizable": true,
            "trellis.enabled": "0",
            "charting.axisTitleX.visibility": "collapsed",
            "refresh.display": "progressbar",
            "charting.chart.stackMode": "stacked",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisY.abbreviation": "none",
            "charting.legend.placement": "bottom",
            "charting.axisY2.abbreviation": "none",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.chart.showDataLabels": "none",
            "charting.axisY2.enabled": "0",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.style": "shiny",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart": "line",
            "charting.axisX.scale": "linear",
            "trellis.scales.shared": "1",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "height": "350",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.drilldown": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "trellis.size": "medium",
            "charting.axisY.scale": "linear",
            "charting.chart.bubbleSizeBy": "area",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisX.abbreviation": "none",
            "charting.layout.splitSeries": "0",
            "charting.lineWidth": "2",
            "charting.axisY2.scale": "inherit",
            "managerid": "searchQueue3",
            "el": $('#elementChartQueue3')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();


        var elementChartQueue4 = new ChartElement({
            "id": "elementChartQueue4",
            "charting.chart.nullValueMode": "gaps",
            "resizable": true,
            "trellis.enabled": "0",
            "charting.axisTitleX.visibility": "collapsed",
            "refresh.display": "progressbar",
            "charting.chart.stackMode": "stacked",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisY.abbreviation": "none",
            "charting.legend.placement": "bottom",
            "charting.axisY2.abbreviation": "none",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.chart.showDataLabels": "none",
            "charting.axisY2.enabled": "0",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.style": "shiny",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart": "line",
            "charting.axisX.scale": "linear",
            "trellis.scales.shared": "1",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "height": "350",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.drilldown": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "trellis.size": "medium",
            "charting.axisY.scale": "linear",
            "charting.chart.bubbleSizeBy": "area",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisX.abbreviation": "none",
            "charting.layout.splitSeries": "0",
            "charting.lineWidth": "2",
            "charting.axisY2.scale": "inherit",
            "managerid": "searchQueue4",
            "el": $('#elementChartQueue4')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();


        var elementChartQueue5 = new ChartElement({
            "id": "elementChartQueue5",
            "charting.chart.nullValueMode": "gaps",
            "resizable": true,
            "trellis.enabled": "0",
            "charting.axisTitleX.visibility": "collapsed",
            "refresh.display": "progressbar",
            "charting.chart.stackMode": "stacked",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisY.abbreviation": "none",
            "charting.legend.placement": "bottom",
            "charting.axisY2.abbreviation": "none",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.chart.showDataLabels": "none",
            "charting.axisY2.enabled": "0",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.style": "shiny",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart": "line",
            "charting.axisX.scale": "linear",
            "trellis.scales.shared": "1",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "height": "350",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.drilldown": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "trellis.size": "medium",
            "charting.axisY.scale": "linear",
            "charting.chart.bubbleSizeBy": "area",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisX.abbreviation": "none",
            "charting.layout.splitSeries": "0",
            "charting.lineWidth": "2",
            "charting.axisY2.scale": "inherit",
            "managerid": "searchQueue5",
            "el": $('#elementChartQueue5')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Ops: Parsing Issues
        var elementChartParsingIssues = new ChartElement({
            "id": "elementChartParsingIssues",
            "charting.chart.nullValueMode": "gaps",
            "resizable": true,
            "trellis.enabled": "0",
            "charting.axisTitleX.visibility": "collapsed",
            "refresh.display": "progressbar",
            "charting.chart.stackMode": "stacked",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisY.abbreviation": "none",
            "charting.legend.placement": "bottom",
            "charting.axisY2.abbreviation": "none",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.chart.showDataLabels": "none",
            "charting.axisY2.enabled": "0",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.style": "shiny",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart": "column",
            "charting.axisX.scale": "linear",
            "trellis.scales.shared": "1",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "height": "350",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.drilldown": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "trellis.size": "medium",
            "charting.axisY.scale": "linear",
            "charting.chart.bubbleSizeBy": "area",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisX.abbreviation": "none",
            "charting.layout.splitSeries": "0",
            "charting.lineWidth": "2",
            "charting.axisY2.scale": "inherit",
            "managerid": "searchParsingIssuesChart",
            "el": $('#elementChartParsingIssues')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // modal Single Lag
        var elementSingleParsingIssues = new SingleElement({
            "id": "elementSingleParsingIssues",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "SUMMARY",
            "managerid": "searchParsingIssuesSingle",
            "el": $('#elementSingleParsingIssues')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Manage html dynamic panels

        // object tags

        var body_data_host_tags = new HtmlElement({
            "id": "body_data_host_tags",
            "useTokens": true,
            "el": $('#body_data_host_tags')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var body_metric_host_tags = new HtmlElement({
            "id": "body_metric_host_tags",
            "useTokens": true,
            "el": $('#body_metric_host_tags')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var body_modal_manage = new HtmlElement({
            "id": "body_modal_manage",
            "useTokens": true,
            "el": $('#body_modal_manage')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        //function update_body_modal_manage() {
        //  var tk_keyid = tokens.get("tk_keyid");
        //}

        var body_modal_manage_host = new HtmlElement({
            "id": "body_modal_manage_host",
            "useTokens": true,
            "el": $('#body_modal_manage_host')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var body_data_source_status_message = new HtmlElement({
            "id": "body_data_source_status_message",
            "useTokens": true,
            "el": $('#body_data_source_status_message')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var body_data_host_status_message = new HtmlElement({
            "id": "body_data_host_status_message",
            "useTokens": true,
            "el": $('#body_data_host_status_message')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // metric host

        var body_metric_host_status_message = new HtmlElement({
            "id": "body_metric_host_status_message",
            "useTokens": true,
            "el": $('#body_metric_host_status_message')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var body_modal_manage_metric_host = new HtmlElement({
            "id": "body_modal_manage_metric_host",
            "useTokens": true,
            "el": $('#body_modal_manage_metric_host')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Metric SLA policies
        var body_manage_metric_sla_policy = new HtmlElement({
            "id": "body_manage_metric_sla_policy",
            "useTokens": true,
            "el": $('#body_manage_metric_sla_policy')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Custom lagging
        var body_manage_custom_lagging = new HtmlElement({
            "id": "body_manage_custom_lagging",
            "useTokens": true,
            "el": $('#body_manage_custom_lagging')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Custom lagging
        var body_delete_elastic_source = new HtmlElement({
            "id": "body_delete_elastic_source",
            "useTokens": true,
            "el": $('#body_delete_elastic_source')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // data source identity card
        var body_manage_identity_card = new HtmlElement({
            "id": "body_manage_identity_card",
            "useTokens": true,
            "el": $('#body_manage_identity_card')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_manage_custom_lagging.contentLoaded());

        // whitelist

        // whitelist metric_host

        var body_modal_manage_metric_host_whitelist = new HtmlElement({
            "id": "body_modal_manage_metric_host_whitelist",
            "useTokens": true,
            "el": $('#body_modal_manage_metric_host_whitelist')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_metric_host_whitelist.contentLoaded());

        // blacklist

        // blacklist host

        var body_modal_manage_data_source_blacklist_host = new HtmlElement({
            "id": "body_modal_manage_data_source_blacklist_host",
            "useTokens": true,
            "el": $('#body_modal_manage_data_source_blacklist_host')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_data_source_blacklist_host.contentLoaded());

        var body_modal_manage_data_host_blacklist_host = new HtmlElement({
            "id": "body_modal_manage_data_host_blacklist_host",
            "useTokens": true,
            "el": $('#body_modal_manage_data_host_blacklist_host')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_data_host_blacklist_host.contentLoaded());

        var body_modal_manage_metric_host_blacklist_host = new HtmlElement({
            "id": "body_modal_manage_metric_host_blacklist_host",
            "useTokens": true,
            "el": $('#body_modal_manage_metric_host_blacklist_host')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_metric_host_blacklist_host.contentLoaded());

        // blacklist index

        var body_modal_manage_data_source_blacklist_index = new HtmlElement({
            "id": "body_modal_manage_data_source_blacklist_index",
            "useTokens": true,
            "el": $('#body_modal_manage_data_source_blacklist_index')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_data_source_blacklist_index.contentLoaded());

        var body_modal_manage_data_host_blacklist_index = new HtmlElement({
            "id": "body_modal_manage_data_host_blacklist_index",
            "useTokens": true,
            "el": $('#body_modal_manage_data_host_blacklist_index')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_data_host_blacklist_index.contentLoaded());

        var body_modal_manage_metric_host_blacklist_index = new HtmlElement({
            "id": "body_modal_manage_metric_host_blacklist_index",
            "useTokens": true,
            "el": $('#body_modal_manage_metric_host_blacklist_index')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_metric_host_blacklist_index.contentLoaded());

        // blacklist host

        var body_modal_manage_data_source_blacklist_sourcetype = new HtmlElement({
            "id": "body_modal_manage_data_source_blacklist_sourcetype",
            "useTokens": true,
            "el": $('#body_modal_manage_data_source_blacklist_sourcetype')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_data_source_blacklist_sourcetype.contentLoaded());

        var body_modal_manage_data_host_blacklist_sourcetype = new HtmlElement({
            "id": "body_modal_manage_data_host_blacklist_sourcetype",
            "useTokens": true,
            "el": $('#body_modal_manage_data_host_blacklist_sourcetype')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_data_host_blacklist_sourcetype.contentLoaded());

        var body_modal_manage_metric_host_blacklist_metric_category = new HtmlElement({
            "id": "body_modal_manage_metric_host_blacklist_metric_category",
            "useTokens": true,
            "el": $('#body_modal_manage_metric_host_blacklist_metric_category')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_metric_host_blacklist_metric_category.contentLoaded());

        //
        // VIEWS: FORM INPUTS
        //

        var link1 = new LinkListInput({
            "id": "link1",
            "choices": [{
                    "value": "show_data_source_tracker",
                    "label": "DATA SOURCES TRACKING"
                },
                {
                    "value": "show_data_host_tracker",
                    "label": "DATA HOSTS TRACKING"
                },
                {
                    "value": "show_metric_host_tracker",
                    "label": "METRIC HOSTS TRACKING"
                },
                {
                    "value": "show_audit_flip",
                    "label": "INVESTIGATE STATUS FLIPPING"
                },
                {
                    "value": "show_audit_changes",
                    "label": "INVESTIGATE AUDIT CHANGES"
                }
            ],
            "default": "show_data_source_tracker",
            "selectFirstChoice": false,
            "searchWhenChanged": true,
            "value": "$form.tk_main_link$",
            "el": $('#link1')
        }, {
            tokens: true
        }).render();

        link1.on("change", function(newValue) {
            FormUtils.handleValueChange(link1);
        });

        link1.on("valueChange", function(e) {
            if (e.value === "show_data_source_tracker") {
                EventHandler.setToken("show_data_source_tracker", "true", {}, e.data);
                EventHandler.unsetToken("show_data_host_tracker");
                EventHandler.unsetToken("show_audit_flip");
                EventHandler.unsetToken("show_audit_changes");
                EventHandler.unsetToken("show_metric_host_tracker");
            } else if (e.value === "show_data_host_tracker") {
                EventHandler.setToken("show_data_host_tracker", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_tracker");
                EventHandler.unsetToken("show_audit_flip");
                EventHandler.unsetToken("show_audit_changes");
                EventHandler.unsetToken("show_metric_host_tracker");
            } else if (e.value === "show_metric_host_tracker") {
                EventHandler.setToken("show_metric_host_tracker", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_tracker");
                EventHandler.unsetToken("show_data_host_tracker");
                EventHandler.unsetToken("show_audit_flip");
                EventHandler.unsetToken("show_audit_changes");
            } else if (e.value === "show_audit_flip") {
                EventHandler.setToken("show_audit_flip", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_tracker");
                EventHandler.unsetToken("show_data_host_tracker");
                EventHandler.unsetToken("show_audit_changes");
                EventHandler.unsetToken("show_metric_host_tracker");
            } else if (e.value === "show_audit_changes") {
                EventHandler.setToken("show_audit_changes", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_tracker");
                EventHandler.unsetToken("show_data_host_tracker");
                EventHandler.unsetToken("show_audit_flip");
                EventHandler.unsetToken("show_metric_host_tracker");
            }
        });

        var input1 = new TimeRangeInput({
            "id": "input1",
            "searchWhenChanged": true,
            "default": {
                "latest_time": "now",
                "earliest_time": "-24h@h"
            },
            "earliest_time": "$form.time.earliest$",
            "latest_time": "$form.time.latest$",
            "el": $('#input1')
        }, {
            tokens: true
        }).render();

        input1.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        // Audit Flip

        var input_timerange_audit_flip = new TimeRangeInput({
            "id": "input_timerange_audit_flip",
            "searchWhenChanged": true,
            "default": {"latest_time": "now", "earliest_time": "-24h"},
            "earliest_time": "$form.timerange_audit_flip.earliest$",
            "latest_time": "$form.timerange_audit_flip.latest$",
            "el": $('#input_timerange_audit_flip')
        }, {tokens: true}).render();

        input_timerange_audit_flip.on("change", function(newValue) {
            FormUtils.handleValueChange(input_timerange_audit_flip);
        });

        var inputAuditFlipObjectCategory = new DropdownInput({
            "id": "inputAuditFlipObjectCategory",
            "tokenDependencies": {
                "depends": "$show_audit_flip$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "object_category",
            "prefix": "object_category=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "object_category",
            "value": "$form.audit_flip_object_category$",
            "managerid": "searchAuditFlipObjectCategory",
            "el": $('#inputAuditFlipObjectCategory')
        }, {
            tokens: true
        }).render();

        inputAuditFlipObjectCategory.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditFlipObjectCategory);
        });

        var inputAuditFlipObjectFilter = new TextInput({
            "id": "inputAuditFlipObjectFilter",
            "searchWhenChanged": true,
            "default": "*",
            "prefix": "object=\"*",
            "suffix": "*\"",
            "initialValue": "*",
            "value": "$form.inputAuditFlipObjectFilter$",
            "el": $('#inputAuditFlipObjectFilter')
        }, {
            tokens: true
        }).render();

        inputAuditFlipObjectFilter.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditFlipObjectFilter);
        });

        var inputAuditFlipObject = new DropdownInput({
            "id": "inputAuditFlipObject",
            "tokenDependencies": {
                "depends": "$show_audit_flip$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "object",
            "prefix": "object=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "object",
            "value": "$form.audit_flip_object$",
            "managerid": "searchAuditFlipObject",
            "el": $('#inputAuditFlipObject')
        }, {
            tokens: true
        }).render();

        inputAuditFlipObject.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditFlipObject);
        });

        // Ack
        var input_ack_duration = new DropdownInput({
            "id": "input_ack_duration",
            "choices": [],
            "searchWhenChanged": true,
            "labelField": "label",
            "valueField": "duration",
            "selectFirstChoice": true,
            "showClearButton": true,
            "value": "$form.input_ack_duration$",
            "managerid": "searchAckDuration",
            "el": $('#input_ack_duration')
        }, {tokens: true}).render();

        input_ack_duration.on("change", function(newValue) {
            FormUtils.handleValueChange(input_ack_duration);
        });

        DashboardController.onReady(function() {
            if (!submittedTokenModel.has('earliest') && !submittedTokenModel.has('latest')) {
                submittedTokenModel.set({ earliest: '0', latest: '' });
            }
        });

        // Audit Changes

        var input_timerange_audit_changes = new TimeRangeInput({
            "id": "input_timerange_audit_changes",
            "searchWhenChanged": true,
            "default": {"latest_time": "now", "earliest_time": "-24h"},
            "earliest_time": "$form.timerange_audit_changes.earliest$",
            "latest_time": "$form.timerange_audit_changes.latest$",
            "el": $('#input_timerange_audit_changes')
        }, {tokens: true}).render();

        input_timerange_audit_changes.on("change", function(newValue) {
            FormUtils.handleValueChange(input_timerange_audit_changes);
        });

        var inputAuditChangesAction = new DropdownInput({
            "id": "inputAuditChangesAction",
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "action",
            "prefix": "action=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "action",
            "value": "$form.audit_changes_action$",
            "managerid": "searchAuditChangesAction",
            "el": $('#inputAuditChangesAction')
        }, {
            tokens: true
        }).render();

        inputAuditChangesAction.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditChangesAction);
        });

        var inputAuditChangesObjectCategory = new DropdownInput({
            "id": "inputAuditChangesObjectCategory",
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "object_category",
            "prefix": "object_category=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "object_category",
            "value": "$form.audit_changes_object_category$",
            "managerid": "searchAuditChangesObjectCategory",
            "el": $('#inputAuditChangesObjectCategory')
        }, {
            tokens: true
        }).render();

        inputAuditChangesObjectCategory.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditChangesObjectCategory);
        });

        var inputAuditChangesChangeType = new DropdownInput({
            "id": "inputAuditChangesChangeType",
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "change_type",
            "prefix": "change_type=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "change_type",
            "value": "$form.audit_changes_change_type$",
            "managerid": "searchAuditChangesChangeType",
            "el": $('#inputAuditChangesChangeType')
        }, {
            tokens: true
        }).render();

        inputAuditChangesChangeType.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditChangesChangeType);
        });

        var inputAuditChangesUser = new DropdownInput({
            "id": "inputAuditChangesUser",
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "user",
            "prefix": "user=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "user",
            "value": "$form.audit_changes_user$",
            "managerid": "searchAuditChangesUser",
            "el": $('#inputAuditChangesUser')
        }, {
            tokens: true
        }).render();

        inputAuditChangesUser.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditChangesUser);
        });

        var inputAuditChangesObject = new DropdownInput({
            "id": "inputAuditChangesObject",
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "object",
            "prefix": "object=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "object",
            "value": "$form.audit_changes_object$",
            "managerid": "searchAuditChangesObject",
            "el": $('#inputAuditChangesObject')
        }, {
            tokens: true
        }).render();

        inputAuditChangesObject.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditChangesObject);
        });

        //

        var inputDataNameFilter = new TextInput({
            "id": "inputDataNameFilter",
            "searchWhenChanged": true,
            "default": "*",
            "prefix": "data_name=\"*",
            "suffix": "*\"",
            "initialValue": "*",
            "value": "$form.inputDataNameFilter$",
            "el": $('#inputDataNameFilter')
        }, {
            tokens: true
        }).render();

        inputDataNameFilter.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataNameFilter);
        });

        var inputDataName = new MultiSelectInput({
            "id": "inputDataName",
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "data_name",
            "valuePrefix": "data_name=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "data_name",
            "value": "$form.inputDataName$",
            "managerid": "searchPopulateDataSources",
            "el": $('#inputDataName')
        }, {
            tokens: true
        }).render();

        inputDataName.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataName);
        });

        var inputDataIndex = new MultiSelectInput({
            "id": "inputDataIndex",
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "data_index",
            "valuePrefix": "data_index=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "data_index",
            "value": "$form.inputDataIndex$",
            "managerid": "searchPopulateDataSourcesIndexes",
            "el": $('#inputDataIndex')
        }, {
            tokens: true
        }).render();

        inputDataIndex.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataIndex);
        });

        var inputDataSourcetype = new MultiSelectInput({
            "id": "inputDataSourcetype",
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "data_sourcetype",
            "valuePrefix": "data_sourcetype=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "data_sourcetype",
            "value": "$form.inputDataSourcetype$",
            "managerid": "searchPopulateDataSourcesSourcetypes",
            "el": $('#inputDataSourcetype')
        }, {
            tokens: true
        }).render();

        inputDataSourcetype.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourcetype);
        });

        // metric host monitoring

        var inputMetricHostIndexes = new MultiSelectInput({
            "id": "inputMetricHostIndexes",
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "metric_index",
            "valuePrefix": "metric_index=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "metric_index",
            "value": "$form.inputMetricHostIndexes$",
            "managerid": "searchPopulateMetricHostsIndexes",
            "el": $('#inputMetricHostIndexes')
        }, {
            tokens: true
        }).render();

        inputMetricHostIndexes.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHostIndexes);
        });

        var inputMetricHostCategories = new MultiSelectInput({
            "id": "inputMetricHostCategories",
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "metric_category",
            "valuePrefix": "metric_category=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "metric_category",
            "value": "$form.inputMetricHostCategories$",
            "managerid": "searchPopulateMetricHostsCategories",
            "el": $('#inputMetricHostCategories')
        }, {
            tokens: true
        }).render();

        inputMetricHostCategories.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHostCategories);
        });

        var inputMetricHostFilter = new TextInput({
            "id": "inputMetricHostFilter",
            "searchWhenChanged": true,
            "default": "*",
            "prefix": "metric_host=\"*",
            "suffix": "*\"",
            "initialValue": "*",
            "value": "$form.inputMetricHostFilter$",
            "el": $('#inputMetricHostFilter')
        }, {
            tokens: true
        }).render();

        inputMetricHostFilter.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHostFilter);
        });

        var inputMetricHost = new MultiSelectInput({
            "id": "inputMetricHost",
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "metric_host",
            "valuePrefix": "metric_host=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "metric_host",
            "value": "$form.inputMetricHost$",
            "managerid": "searchPopulateMetricHosts",
            "el": $('#inputMetricHost')
        }, {
            tokens: true
        }).render();

        inputMetricHost.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHost);
        });

        var inputMetricHostState = new MultiSelectInput({
            "id": "inputMetricHostState",
            "choices": [
                {"label": "ALL", "value": "*"},
                {"label": "Green", "value": "green"},
                {"label": "Blue", "value": "blue"},
                {"label": "Orange", "value": "orange"},
                {"label": "Red", "value": "red"}
            ],
            "valuePrefix": "metric_host_state=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "searchWhenChanged": true,
            "initialValue": ["*"],
            "value": "$form.metric_host_state$",
            "el": $('#inputMetricHostState')
        }, {tokens: true}).render();

        inputMetricHostState.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHostState);
        });

        var inputMetricHostMonitoredState = new DropdownInput({
            "id": "inputMetricHostMonitoredState",
            "choices": [{
                    "label": "ALL",
                    "value": "*"
                },
                {
                    "label": "Enabled",
                    "value": "enabled"
                },
                {
                    "label": "Disabled",
                    "value": "disabled"
                }
            ],
            "searchWhenChanged": true,
            "default": "enabled",
            "showClearButton": true,
            "prefix": "metric_monitored_state=\"",
            "suffix": "\"",
            "initialValue": "enabled",
            "selectFirstChoice": false,
            "value": "$form.metric_monitored_state$",
            "el": $('#inputMetricHostMonitoredState')
        }, {
            tokens: true
        }).render();

        inputMetricHostMonitoredState.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHostMonitoredState);
        });

        var refreshMetricHostForm = new DropdownInput({
            "id": "refreshMetricHostForm",
            "choices": [{
                    "value": "60",
                    "label": "1 min"
                },
                {
                    "value": "120",
                    "label": "2 min"
                },
                {
                    "value": "300",
                    "label": "5 min"
                },
                {
                    "value": "none",
                    "label": "none"
                }
            ],
            "selectFirstChoice": false,
            "default": "300",
            "showClearButton": true,
            "initialValue": "300",
            "searchWhenChanged": true,
            "value": "$refresh$",
            "el": $('#refreshMetricHostForm')
        }, {
            tokens: true
        }).render();

        refreshMetricHostForm.on("change", function(newValue) {
            FormUtils.handleValueChange(refreshMetricHostForm);
        });

        var inputMetricPolicySLA_category = new DropdownInput({
            "id": "inputMetricPolicySLA_category",
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "metric_category",
            "selectFirstChoice": false,
            "valueField": "metric_category",
            "value": "$form.tk_input_metric_policy_metric_category$",
            "managerid": "searchPopulateMetricHostsCategories",
            "el": $('#inputMetricPolicySLA_category')
        }, {
            tokens: true
        }).render();

        inputMetricPolicySLA_category.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricPolicySLA_category);
        });

        var inputMetricPolicySLA_value = new TextInput({
            "id": "inputMetricPolicySLA_value",
            "searchWhenChanged": true,
            "value": "$form.tk_input_metric_policy_metric_value$",
            "el": $('#inputMetricPolicySLA_value')
        }, {
            tokens: true
        }).render();

        inputMetricPolicySLA_value.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricPolicySLA_value);
        });

        var inputDataHostIndexes = new MultiSelectInput({
            "id": "inputDataHostIndexes",
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "data_index",
            "valuePrefix": "data_index=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "data_index",
            "value": "$form.inputDataHostIndexes$",
            "managerid": "searchPopulateDataHostsIndexes",
            "el": $('#inputDataHostIndexes')
        }, {
            tokens: true
        }).render();

        inputDataHostIndexes.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostIndexes);
        });

        var inputDataHostSourcetypes = new MultiSelectInput({
            "id": "inputDataHostSourcetypes",
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "data_sourcetype",
            "valuePrefix": "data_sourcetype=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "data_sourcetype",
            "value": "$form.inputDataHostSourcetypes$",
            "managerid": "searchPopulateDataHostsSourcetypes",
            "el": $('#inputDataHostSourcetypes')
        }, {
            tokens: true
        }).render();

        inputDataHostSourcetypes.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostSourcetypes);
        });

        var inputDataHostFilter = new TextInput({
            "id": "inputDataHostFilter",
            "searchWhenChanged": true,
            "default": "*",
            "prefix": "data_host=\"*",
            "suffix": "*\"",
            "initialValue": "*",
            "value": "$form.inputDataHostFilter$",
            "el": $('#inputDataHostFilter')
        }, {
            tokens: true
        }).render();

        inputDataHostFilter.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostFilter);
        });

        var inputDataHost = new MultiSelectInput({
            "id": "inputDataHost",
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "choices": [{
                "label": "ALL",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "data_host",
            "valuePrefix": "data_host=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "data_host",
            "value": "$form.inputDataHost$",
            "managerid": "searchPopulateDataHosts",
            "el": $('#inputDataHost')
        }, {
            tokens: true
        }).render();

        inputDataHost.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHost);
        });

        var inputDataSourceState = new MultiSelectInput({
            "id": "inputDataSourceState",
            "choices": [
                {"label": "ALL", "value": "*"},
                {"label": "Green", "value": "green"},
                {"label": "Blue", "value": "blue"},
                {"label": "Orange", "value": "orange"},
                {"label": "Red", "value": "red"}
            ],
            "valuePrefix": "data_source_state=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "searchWhenChanged": true,
            "initialValue": ["*"],
            "value": "$form.data_source_state$",
            "el": $('#inputDataSourceState')
        }, {tokens: true}).render();

        inputDataSourceState.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourceState);
        });

        var inputDataHostState = new MultiSelectInput({
            "id": "inputDataHostState",
            "choices": [
                {"label": "ALL", "value": "*"},
                {"label": "Green", "value": "green"},
                {"label": "Blue", "value": "blue"},
                {"label": "Orange", "value": "orange"},
                {"label": "Red", "value": "red"}
            ],
            "valuePrefix": "data_host_state=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "searchWhenChanged": true,
            "initialValue": ["*"],
            "value": "$form.data_host_state$",
            "el": $('#inputDataHostState')
        }, {tokens: true}).render();

        inputDataHostState.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostState);
        });

        var inputDataMonitoredState = new DropdownInput({
            "id": "inputDataMonitoredState",
            "choices": [{
                    "label": "ALL",
                    "value": "*"
                },
                {
                    "label": "Enabled",
                    "value": "enabled"
                },
                {
                    "label": "Disabled",
                    "value": "disabled"
                }
            ],
            "searchWhenChanged": true,
            "default": "enabled",
            "showClearButton": true,
            "prefix": "data_monitored_state=\"",
            "suffix": "\"",
            "initialValue": "enabled",
            "selectFirstChoice": false,
            "value": "$form.data_monitored_state$",
            "el": $('#inputDataMonitoredState')
        }, {
            tokens: true
        }).render();

        inputDataMonitoredState.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataMonitoredState);
        });

        var inputDataPriority = new MultiSelectInput({
            "id": "inputDataPriority",
            "choices": [
                {"label": "ALL", "value": "*"},
                {"label": "low", "value": "low"},
                {"label": "medium", "value": "medium"},
                {"label": "high", "value": "high"}
            ],
            "valuePrefix": "priority=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "searchWhenChanged": true,
            "initialValue": ["*"],
            "value": "$form.inputDataPriority$",
            "el": $('#inputDataPriority')
        }, {tokens: true}).render();

        inputDataPriority.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataPriority);
        });

        var inputDataHostMonitoredState = new DropdownInput({
            "id": "inputDataHostMonitoredState",
            "choices": [{
                    "label": "ALL",
                    "value": "*"
                },
                {
                    "label": "Enabled",
                    "value": "enabled"
                },
                {
                    "label": "Disabled",
                    "value": "disabled"
                }
            ],
            "searchWhenChanged": true,
            "default": "enabled",
            "showClearButton": true,
            "prefix": "data_monitored_state=\"",
            "suffix": "\"",
            "initialValue": "enabled",
            "selectFirstChoice": false,
            "value": "$form.data_monitored_state$",
            "el": $('#inputDataHostMonitoredState')
        }, {
            tokens: true
        }).render();

        inputDataHostMonitoredState.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostMonitoredState);
        });

        var inputDataHostPriority = new MultiSelectInput({
            "id": "inputDataHostPriority",
            "choices": [
                {"label": "ALL", "value": "*"},
                {"label": "low", "value": "low"},
                {"label": "medium", "value": "medium"},
                {"label": "high", "value": "high"}
            ],
            "valuePrefix": "priority=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "searchWhenChanged": true,
            "initialValue": ["*"],
            "value": "$form.inputDataHostPriority$",
            "el": $('#inputDataHostPriority')
        }, {tokens: true}).render();

        inputDataHostPriority.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostPriority);
        });

        var inputMetricHostPriority = new MultiSelectInput({
            "id": "inputMetricHostPriority",
            "choices": [
                {"label": "ALL", "value": "*"},
                {"label": "low", "value": "low"},
                {"label": "medium", "value": "medium"},
                {"label": "high", "value": "high"}
            ],
            "valuePrefix": "priority=\"",
            "valueSuffix": "\"",
            "delimiter": " OR ",
            "searchWhenChanged": true,
            "initialValue": ["*"],
            "value": "$form.inputMetricHostPriority$",
            "el": $('#inputMetricHostPriority')
        }, {tokens: true}).render();

        inputMetricHostPriority.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHostPriority);
        });

        var refreshForm = new DropdownInput({
            "id": "refreshForm",
            "choices": [{
                    "value": "60",
                    "label": "1 min"
                },
                {
                    "value": "120",
                    "label": "2 min"
                },
                {
                    "value": "300",
                    "label": "5 min"
                },
                {
                    "value": "3600",
                    "label": "none"
                }
            ],
            "selectFirstChoice": false,
            "default": "300",
            "showClearButton": true,
            "initialValue": "300",
            "searchWhenChanged": true,
            "value": "$refresh$",
            "el": $('#refreshForm')
        }, {
            tokens: true
        }).render();

        refreshForm.on("change", function(newValue) {
            FormUtils.handleValueChange(refreshForm);
        });

        var refreshHostForm = new DropdownInput({
            "id": "refreshHostForm",
            "choices": [{
                    "value": "60",
                    "label": "1 min"
                },
                {
                    "value": "120",
                    "label": "2 min"
                },
                {
                    "value": "300",
                    "label": "5 min"
                },
                {
                    "value": "3600",
                    "label": "none"
                }
            ],
            "selectFirstChoice": false,
            "default": "300",
            "showClearButton": true,
            "initialValue": "300",
            "searchWhenChanged": true,
            "value": "$refresh$",
            "el": $('#refreshHostForm')
        }, {
            tokens: true
        }).render();

        refreshForm.on("change", function(newValue) {
            FormUtils.handleValueChange(refreshForm);
        });

        //
        // SERVICE OBJECT
        //

        // Create a service object using the Splunk SDK for JavaScript
        // to send REST requests
        var service = mvc.createService({
            owner: "nobody"
        });

        //
        // BEGIN OPERATIONS
        //

        // Audit changes
        var tokens = mvc.Components.get("default");
        var currentUser = Splunk.util.getConfigValue("USERNAME");
        tokens.set("currentUser", currentUser);
        var auditendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_audit_changes/"

        // FUNCTIONS

        function updateDataSource(tk_keyid) {

            //console.log("Starting function");

            // Perform a target search to update key values
            var searchQuery = "| savedsearch trackme_get_data_source_table_by_key key=" + tk_keyid;
            //console.log(searchQuery);

            // Set the search parameters
            var searchParams = {
              exec_mode: "normal",
              earliest_time: "-5m"
            };

            service.search(
              searchQuery,
              searchParams,
              function(err, job) {

                // Poll the status of the search job
                job.track({period: 200}, {
                  done: function(job) {

                    // Get the results and print them
                    job.results({}, function(err, results, job) {
                      var fields = results.fields;
                      var rows = results.rows;
                      for(var i = 0; i < rows.length; i++) {
                        var values = rows[i];
                        //console.log("Row " + i + ": ");
                        for(var j = 0; j < values.length; j++) {
                          var field = fields[j];
                          var value = values[j];
                          //console.log("  " + field + ": " + value);

                            // update state color
                            if (field == "data_source_state") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_data_source_state", value);
                                tk_data_source_state = value
                                // Dynamically manage state color
                                if (tk_data_source_state == "green") {
                                    setToken("tk_data_source_state_class", "title_green");
                                    setToken("tk_data_source_status_message_class", "status_message_green");
                                } else if (tk_data_source_state == "orange") {
                                    setToken("tk_data_source_state_class", "title_orange");
                                    setToken("tk_data_source_status_message_class", "status_message_orange");
                                } else if (tk_data_source_state == "blue") {
                                    setToken("tk_data_source_state_class", "title_blue");
                                    setToken("tk_data_source_status_message_class", "status_message_blue");
                                } else if (tk_data_source_state == "red") {
                                    setToken("tk_data_source_state_class", "title_red");
                                    setToken("tk_data_source_status_message_class", "status_message_red");
                                }
                            }

                            // update priority color
                            if (field == "priority") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_priority", value);
                                tk_priority = value
                                // Dynamically manage state color
                                if (tk_priority == "low") {
                                    setToken("tk_priority_class", "title_low_priority");
                                } else if (tk_priority == "medium") {
                                    setToken("tk_priority_class", "title_medium_priority");
                                } else if (tk_priority == "high") {
                                    setToken("tk_priority_class", "title_high_priority");
                                }
                            }

                            // update monitored state
                            if (field == "data_monitored_state") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_data_monitored_state", value);
                                tk_data_monitored_state = value
                                // Dynamically manage state color
                                if (tk_data_monitored_state == "enabled") {
                                    document.getElementById('btn_enable_monitoring').disabled = true;
                                    document.getElementById('btn_disable_monitoring').disabled = false;
                                    setToken("tk_data_monitored_state_class", "title_green");
                                } else {
                                    document.getElementById('btn_enable_monitoring').disabled = false;
                                    document.getElementById('btn_disable_monitoring').disabled = true;
                                    setToken("tk_data_monitored_state_class", "title_grey");
                                }
                            }

                            // update lag summary
                            if (field == "lag summary (lag event / lag ingestion)") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_data_lag_summary", value);
                                tk_data_lag_summary = value
                            }

                            // update last time
                            if (field == "last time") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_data_last_time_seen_human", value);
                                tk_data_last_time_seen_human = value
                            }

                            // update last ingest
                            if (field == "last ingest") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_data_last_ingest_human", value);
                                tk_data_last_ingest_human = value
                            }

                            // update data_monitoring_level
                            if (field == "data_monitoring_level") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_data_monitoring_level", value);
                                tk_data_monitoring_level = value
                            }

                            // update data_max_lag_allowed
                            if (field == "data_max_lag_allowed") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_data_max_lag_allowed", value);
                                tk_data_max_lag_allowed = value
                            }

                            // update flip
                            if (field == "latest_flip_time (translated)") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_latest_flip_time_human", value);
                                tk_latest_flip_time_human = value
                            }

                            if (field == "latest_flip_state") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_latest_flip_state", value);
                                tk_latest_flip_state = value
                            }

                            // update status_message
                            if (field == "status_message") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_status_message", value);
                                tk_status_message = value
                            }

                        }
                      }
                    });

                  },
                  failed: function(job) {
                  },
                  error: function(err) {
                    done(err);
                  }
                });

              }
            );

        }

        function updateDataHost(tk_keyid) {

            //console.log("Starting function");

            // Perform a target search to update key values
            var searchQuery = "| savedsearch trackme_get_data_host_table_by_key key=" + tk_keyid;
            //console.log(searchQuery);

            // Set the search parameters
            var searchParams = {
              exec_mode: "normal",
              earliest_time: "-5m"
            };

            service.search(
              searchQuery,
              searchParams,
              function(err, job) {

                // Poll the status of the search job
                job.track({period: 200}, {
                  done: function(job) {

                    // Get the results and print them
                    job.results({}, function(err, results, job) {
                      var fields = results.fields;
                      var rows = results.rows;
                      for(var i = 0; i < rows.length; i++) {
                        var values = rows[i];
                        //console.log("Row " + i + ": ");
                        for(var j = 0; j < values.length; j++) {
                          var field = fields[j];
                          var value = values[j];
                          //console.log("  " + field + ": " + value);

                            // update state color
                            if (field == "data_host_state") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_data_host_state", value);
                                tk_data_host_state = value
                                // Dynamically manage state color
                                if (tk_data_host_state == "green") {
                                    setToken("tk_data_host_state_class", "title_green");
                                    setToken("tk_data_host_status_message_class", "status_message_green");
                                } else if (tk_data_host_state == "orange") {
                                    setToken("tk_data_host_state_class", "title_orange");
                                    setToken("tk_data_host_status_message_class", "status_message_orange");
                                } else if (tk_data_host_state == "blue") {
                                    setToken("tk_data_host_state_class", "title_blue");
                                    setToken("tk_data_host_status_message_class", "status_message_blue");
                                } else if (tk_data_host_state == "red") {
                                    setToken("tk_data_host_state_class", "title_red");
                                    setToken("tk_data_host_status_message_class", "status_message_red");
                                }
                            }

                            // update priority color
                            if (field == "priority") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_priority", value);
                                tk_priority = value
                                // Dynamically manage state color
                                if (tk_priority == "low") {
                                    setToken("tk_priority_class", "title_low_priority");
                                } else if (tk_priority == "medium") {
                                    setToken("tk_priority_class", "title_medium_priority");
                                } else if (tk_priority == "high") {
                                    setToken("tk_priority_class", "title_high_priority");
                                }
                            }

                            // update monitored state
                            if (field == "data_monitored_state") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_data_monitored_state", value);
                                tk_data_monitored_state = value
                                // Dynamically manage state color
                                if (tk_data_monitored_state == "enabled") {
                                    document.getElementById('btn_enable_monitoring').disabled = true;
                                    document.getElementById('btn_disable_monitoring').disabled = false;
                                    setToken("tk_data_monitored_state_class", "title_green");
                                } else {
                                    document.getElementById('btn_enable_monitoring').disabled = false;
                                    document.getElementById('btn_disable_monitoring').disabled = true;
                                    setToken("tk_data_monitored_state_class", "title_grey");
                                }
                            }

                            // update lag summary
                            if (field == "lag summary (lag event / lag ingestion)") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_data_lag_summary", value);
                                tk_data_lag_summary = value
                            }

                            // update last time
                            if (field == "last time") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_data_last_time_seen_human", value);
                                tk_data_last_time_seen_human = value
                            }

                            // update last ingest
                            if (field == "last ingest") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_data_last_ingest_human", value);
                                tk_data_last_ingest_human = value
                            }

                            // update data_monitoring_level
                            if (field == "data_monitoring_level") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_data_monitoring_level", value);
                                tk_data_monitoring_level = value
                            }

                            // update data_max_lag_allowed
                            if (field == "data_max_lag_allowed") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_data_max_lag_allowed", value);
                                tk_data_max_lag_allowed = value
                            }

                            // update flip
                            if (field == "latest_flip_time (translated)") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_latest_flip_time_human", value);
                                tk_latest_flip_time_human = value
                            }

                            if (field == "latest_flip_state") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_latest_flip_state", value);
                                tk_latest_flip_state = value
                            }

                            // update status_message
                            if (field == "status_message") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_status_message", value);
                                tk_status_message = value
                            }

                        }
                      }
                    });

                  },
                  failed: function(job) {
                  },
                  error: function(err) {
                    done(err);
                  }
                });

              }
            );

        }

        function updateMetricHost(tk_keyid) {

            //console.log("Starting function");

            // Perform a target search to update key values
            var searchQuery = "| savedsearch trackme_get_metric_host_table_by_key key=\"" + tk_keyid + "\"";
            //console.log(searchQuery);

            // Set the search parameters
            var searchParams = {
              exec_mode: "normal",
              earliest_time: "-5m"
            };

            service.search(
              searchQuery,
              searchParams,
              function(err, job) {

                // Poll the status of the search job
                job.track({period: 200}, {
                  done: function(job) {

                    // Get the results and print them
                    job.results({}, function(err, results, job) {
                      var fields = results.fields;
                      var rows = results.rows;
                      for(var i = 0; i < rows.length; i++) {
                        var values = rows[i];
                        //console.log("Row " + i + ": ");
                        for(var j = 0; j < values.length; j++) {
                          var field = fields[j];
                          var value = values[j];
                          //console.log("  " + field + ": " + value);

                            // update state color
                            if (field == "metric_host_state") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_metric_host_state", value);
                                tk_metric_host_state = value
                                // Dynamically manage state color
                                if (tk_metric_host_state == "green") {
                                    setToken("tk_metric_host_state_class", "title_green");
                                    setToken("tk_metric_host_status_message_class", "status_message_green");
                                } else if (tk_metric_host_state == "orange") {
                                    setToken("tk_metric_host_state_class", "title_orange");
                                    setToken("tk_metric_host_status_message_class", "status_message_orange");
                                } else if (tk_metric_host_state == "blue") {
                                    setToken("tk_metric_host_state_class", "title_blue");
                                    setToken("tk_metric_host_status_message_class", "status_message_blue");
                                } else if (tk_metric_host_state == "red") {
                                    setToken("tk_metric_host_state_class", "title_red");
                                    setToken("tk_metric_host_status_message_class", "status_message_red");
                                }
                            }

                            // update priority color
                            if (field == "priority") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_priority", value);
                                tk_priority = value
                                // Dynamically manage state color
                                if (tk_priority == "low") {
                                    setToken("tk_priority_class", "title_low_priority");
                                } else if (tk_priority == "medium") {
                                    setToken("tk_priority_class", "title_medium_priority");
                                } else if (tk_priority == "high") {
                                    setToken("tk_priority_class", "title_high_priority");
                                }
                            }

                            // update monitored state
                            if (field == "metric_monitored_state") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_metric_monitored_state", value);
                                tk_metric_monitored_state = value
                                // Dynamically manage state color
                                if (tk_metric_monitored_state == "enabled") {
                                    document.getElementById('btn_enable_monitoring').disabled = true;
                                    document.getElementById('btn_disable_monitoring').disabled = false;
                                    setToken("tk_metric_monitored_state_class", "title_green");
                                } else {
                                    document.getElementById('btn_enable_monitoring').disabled = false;
                                    document.getElementById('btn_disable_monitoring').disabled = true;
                                    setToken("tk_metric_monitored_state_class", "title_grey");
                                }
                            }

                            // update last time
                            if (field == "last time") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_metric_last_time_seen_human", value);
                                tk_metric_last_time_seen_human = value
                            }

                            // update flip
                            if (field == "latest_flip_time (translated)") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_latest_flip_time_human", value);
                                tk_latest_flip_time_human = value
                            }

                            if (field == "latest_flip_state") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_latest_flip_state", value);
                                tk_latest_flip_state = value
                            }

                            // update status_message
                            if (field == "status_message") {
                                //console.log("  " + field + ": " + value);
                                setToken("tk_status_message", value);
                                tk_status_message = value
                            }

                        }
                      }
                    });

                  },
                  failed: function(job) {
                  },
                  error: function(err) {
                    done(err);
                  }
                });

              }
            );

        }

        function updateDataSourceEntity(tk_data_name, tk_data_index, tk_data_sourcetype) {

            // console.log("Starting function");

            // First retrieve the name of the search to run depending on the context

            // Define the query
            var searchQuery = "| `trackme_get_tracker_data_source(\"" + tk_data_name + "\", \"" + tk_data_index + "\", \"" + tk_data_sourcetype + "\")`";
            // console.log(searchQuery);

            // Set the search parameters
            var searchParams = {
              exec_mode: "normal",
              earliest_time: "-4h"
            };

            // Run a oneshot search that returns the job's results
            service.oneshotSearch(
                searchQuery,
                searchParams,
                function(err, results) {

                    // Display the results
                    var fields = results.fields;
                    var rows = results.rows;
                    var current_maintenance_mode;
                    var current_time_updated;

                    for (var i = 0; i < rows.length; i++) {
                        var values = rows[i];
                        //console.log("Row " + i + ": ");

                        for (var j = 0; j < values.length; j++) {
                            var field = fields[j];

                            if (fields[j] == "savedsearch_name") {
                                savedsearch_name = values[j];
                            }
                        }
                    }

                    // console.log("savedsearch_name: " + savedsearch_name);
                    // console.log("Starting update entity");

                    var searchQuery = "| savedsearch " + savedsearch_name;
                    // console.log(searchQuery);

                    // Set the search parameters
                    var searchParams = {
                      exec_mode: "normal",
                      earliest_time: "-4h"
                    };

                    service.search(
                      searchQuery,
                      searchParams,
                      function(err, job) {

                        // Poll the status of the search job
                        job.track({period: 200}, {
                          done: function(job) {

                            // Get the results and print them
                            job.results({}, function(err, results, job) {
                              var fields = results.fields;
                              var rows = results.rows;
                              for(var i = 0; i < rows.length; i++) {
                                var values = rows[i];
                                //console.log("Row " + i + ": ");
                                for(var j = 0; j < values.length; j++) {
                                  var field = fields[j];
                                  var value = values[j];
                                  //console.log("  " + field + ": " + value);

                                }
                              }
                            });

                          },
                          failed: function(job) {
                          },
                          error: function(err) {
                            done(err);
                          }
                        });

                      }
                    );

            });

        }

        function updateDataHostEntity(tk_summary_report, tk_data_host) {

            //console.log("Starting function");

            // Perform a target search to update key values
            var searchQuery = "| savedsearch \"TrackMe - Data host entity refresh\" host=" + tk_data_host;
            //console.log(searchQuery);

            // Set the search parameters
            var searchParams = {
              exec_mode: "normal",
              earliest_time: "-4h"
            };

            service.search(
              searchQuery,
              searchParams,
              function(err, job) {

                // Poll the status of the search job
                job.track({period: 200}, {
                  done: function(job) {

                    // Get the results and print them
                    job.results({}, function(err, results, job) {
                      var fields = results.fields;
                      var rows = results.rows;
                      for(var i = 0; i < rows.length; i++) {
                        var values = rows[i];
                        //console.log("Row " + i + ": ");
                        for(var j = 0; j < values.length; j++) {
                          var field = fields[j];
                          var value = values[j];
                          //console.log("  " + field + ": " + value);

                        }
                      }
                    });

                  },
                  failed: function(job) {
                  },
                  error: function(err) {
                    done(err);
                  }
                });

              }
            );

        }

        // This function generates outliers statistics and be called when the outliers period calculaton is changed

        function metricOutliersGen(object_category, object, TargetOutlierTimePeriod) {

            //console.log("Starting function");

            // Perform a target search to update key values
            var searchQuery = "| `trackme_outliers_gen_metrics(" + object_category + "," + object + "," + TargetOutlierTimePeriod + ")`";
            //console.log(searchQuery);

            // Set the search parameters
            var searchParams = {
                exec_mode: "normal",
                earliest_time: "-30d"
            };

            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    // Poll the status of the search job
                    job.track({
                        period: 200
                    }, {
                        done: function(job) {

                            // Get the results and print them
                            job.results({}, function(err, results, job) {
                                var fields = results.fields;
                                var rows = results.rows;
                                for (var i = 0; i < rows.length; i++) {
                                    var values = rows[i];
                                    //console.log("Row " + i + ": ");
                                    for (var j = 0; j < values.length; j++) {
                                        var field = fields[j];
                                        var value = values[j];
                                        //console.log("  " + field + ": " + value);

                                    }
                                }

                                // Perform a target search to update key values
                                var searchQuery = "| `trackme_summary_investigator_mstats(" + object_category + "," + object + ")`" + " `trackme_summary_investigator_define_bound_abstract` | eval key = md5(object_category . \":\" . object) | `trackme_outputlookup(trackme_summary_investigator_volume_outliers, key)` | stats c";
                                //console.log(searchQuery);

                                // Set the search parameters
                                var searchParams = {
                                    exec_mode: "normal",
                                    earliest_time: "-30d"
                                };

                                service.search(
                                    searchQuery,
                                    searchParams,
                                    function(err, job) {

                                        // Poll the status of the search job
                                        job.track({
                                            period: 200
                                        }, {
                                            done: function(job) {

                                                // Get the results and print them
                                                job.results({}, function(err, results, job) {
                                                    var fields = results.fields;
                                                    var rows = results.rows;
                                                    for (var i = 0; i < rows.length; i++) {
                                                        var values = rows[i];
                                                        //console.log("Row " + i + ": ");
                                                        for (var j = 0; j < values.length; j++) {
                                                            var field = fields[j];
                                                            var value = values[j];
                                                            //console.log("  " + field + ": " + value);

                                                        }
                                                    }
                                                });

                                            },
                                            failed: function(job) {},
                                            error: function(err) {
                                                done(err);
                                            }
                                        });

                                    }
                                );

                            });

                        },
                        failed: function(job) {},
                        error: function(err) {
                            done(err);
                        }
                    });

                }
            );

        }

        // enable monitoring

        $("#btn_enable_monitoring").click(function(mode) {

            // Hide main modal
            $("#modal_manage").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_last_lag_seen_idx = tokens.get("tk_data_last_lag_seen_idx");
            var tk_data_last_time_seen_idx = tokens.get("tk_data_last_time_seen_idx");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_level = tokens.get("tk_data_monitoring_level");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_source_state = tokens.get("tk_data_source_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_source_state = tokens.get("tk_data_previous_source_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_data_monitored_state = "enabled";
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring/" + tk_keyid;

            // Create a dictionary to store the field names and values
            var record = {
                "object_category": "data_source",
                "data_name": tk_data_name,
                "data_index": tk_data_index,
                "data_sourcetype": tk_data_sourcetype,
                "data_last_lag_seen": tk_data_last_lag_seen,
                "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                "data_eventcount": tk_data_eventcount,
                "data_first_time_seen": tk_data_first_time_seen,
                "data_last_time_seen": tk_data_last_time_seen,
                "data_last_ingest": tk_data_last_ingest,
                "data_last_lag_seen_idx": tk_data_last_lag_seen_idx,
                "data_last_time_seen_idx": tk_data_last_time_seen_idx,
                "data_max_lag_allowed": tk_data_max_lag_allowed,
                "data_monitored_state": tk_data_monitored_state,
                "data_monitoring_level": tk_data_monitoring_level,
                "data_monitoring_wdays": tk_data_monitoring_wdays,
                "data_override_lagging_class": tk_data_override_lagging_class,
                "data_source_state": tk_data_source_state,
                "data_tracker_runtime": tk_data_tracker_runtime,
                "data_previous_source_state": tk_data_previous_source_state,
                "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                "OutlierMinEventCount": tk_outliermineventcount,
                "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                "OutlierAlertOnUpper": tk_outlieralertonupper,
                "OutlierTimePeriod": tk_outlier_period,
                "OutlierSpan": tk_outlier_span,
                "isOutlier": tk_isoutlier,
                "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                "latest_flip_state": tk_latest_flip_state,
                "latest_flip_time": tk_latest_flip_time,
                "priority": tk_priority
            };

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    // Retrieve update comment if any
                    var tk_comment = document.getElementById("input_update_comment").value;

                    // if is not defined, give it a value and override text box content
                    if (tk_comment == "null") {
                        setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else if (tk_comment == "update note") {
                        tk_comment = "No comment for update.";
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else {
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            searchDataSourcesMain.startSearch();

                            // Audit
                            action = "success";
                            change_type = "enable monitoring";
                            object = tk_data_name;
                            object_category = "data_source";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = "N/A";
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit
                            action = "failure";
                            change_type = "enable monitoring";
                            object = tk_data_name;
                            object_category = "data_source";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = message;
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        $("#btn_enable_monitoring_host").click(function(mode) {

            // Hide main modal
            $("#modal_manage_host").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_host_state = tokens.get("tk_data_host_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_host_state = tokens.get("tk_data_previous_host_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");
            var tk_data_monitored_state = "enabled";
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_host_monitoring/" + tk_keyid;

            // Create a dictionary to store the field names and values
            var record = {
                "object_category": "data_host",
                "data_host": tk_data_host,
                "data_index": tk_data_index,
                "data_sourcetype": tk_data_sourcetype,
                "data_last_lag_seen": tk_data_last_lag_seen,
                "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                "data_eventcount": tk_data_eventcount,
                "data_first_time_seen": tk_data_first_time_seen,
                "data_last_time_seen": tk_data_last_time_seen,
                "data_last_ingest": tk_data_last_ingest,
                "data_max_lag_allowed": tk_data_max_lag_allowed,
                "data_monitored_state": tk_data_monitored_state,
                "data_monitoring_wdays": tk_data_monitoring_wdays,
                "data_override_lagging_class": tk_data_override_lagging_class,
                "data_host_state": tk_data_host_state,
                "data_tracker_runtime": tk_data_tracker_runtime,
                "data_previous_host_state": tk_data_previous_host_state,
                "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                "OutlierMinEventCount": tk_outliermineventcount,
                "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                "OutlierAlertOnUpper": tk_outlieralertonupper,
                "OutlierTimePeriod": tk_outlier_period,
                "OutlierSpan": tk_outlier_span,
                "isOutlier": tk_isoutlier,
                "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                "latest_flip_state": tk_latest_flip_state,
                "latest_flip_time": tk_latest_flip_time,
                "priority": tk_priority
            };

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    // Retrieve update comment if any
                    var tk_comment = document.getElementById("input_update_comment").value;

                    // if is not defined, give it a value and override text box content
                    if (tk_comment == "null") {
                        setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else if (tk_comment == "update note") {
                        tk_comment = "No comment for update.";
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else {
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            searchDataHostsMain.startSearch();

                            // Audit
                            action = "success";
                            change_type = "enable monitoring";
                            object = tk_data_host;
                            object_category = "data_host";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = "N/A";
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit
                            action = "failure";
                            change_type = "enable monitoring";
                            object = tk_data_host;
                            object_category = "data_host";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = message;
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        // refresh data_source
        $("#btn_refresh_data_source").click(function(mode) {
            // notify
            notification('Refresh completed.', 6000)
            searchSingleLag.startSearch();
            searchChartLag.startSearch();
            searchSingleSLApct.startSearch();
            searchOutlierDetectionChart.startSearch();
            searchOutlierDetectionTable.startSearch();
            searchLaggingMetricDataSource.startSearch();
            searchDataSourceMainAuditFlip.startSearch();
            searchDataSourceMainAuditChanges.startSearch();
            SearchDataSourceParsingQualityMain.startSearch();
            // call update summary investigator for that entity only
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            updateDataSourceEntity(tk_data_name, tk_data_index, tk_data_sourcetype);
            // call update data source
            var tk_keyid = tokens.get("tk_keyid");
            updateDataSource(tk_keyid);
        });

        // refresh data_host
        $("#btn_refresh_data_host").click(function(mode) {
            // notify
            notification('Refresh completed.', 6000)
            searchSingleLagHost.startSearch();
            searchChartHostBaseSearch.startSearch();
            searchChartLagHostOverTime.startSearch();
            searchSingleSLAHostpct.startSearch();
            searchOutlierDetectionChartDataHost.startSearch();
            searchOutlierDetectionTableDataHost.startSearch();
            searchLaggingMetricDataHost.startSearch();
            searchDataHostMainAuditFlip.startSearch();
            searchDataHostMainAuditChanges.startSearch();
            SearchDataHostParsingQualityMain.startSearch();

            // call update summary investigator for that entity only
            var tk_data_host = tokens.get("tk_data_host");
            updateDataHostEntity("trackme_datahost_tracker_shorterm", tk_data_host);
            // call update data host
            var tk_keyid = tokens.get("tk_keyid");
            updateDataHost(tk_keyid);
        });

        // refresh metric_host
        $("#btn_refresh_metric_host").click(function(mode) {
            // notify
            notification('Refresh completed.', 6000)
            searchHostTableMetricHost.startSearch();
            searchSingleSLAMetricHostpct.startSearch();
            searchMetricHostMainAuditFlip.startSearch();
            searchMetricHostMainAuditChanges.startSearch();

            var tk_keyid = tokens.get("tk_keyid");
            // call update metric host
            updateMetricHost(tk_keyid);
        });

        $("#btn_enable_monitoring_metric_host").click(function(mode) {

            // Hide main modal
            $("#modal_manage_metric_host").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_metric_host = tokens.get("tk_metric_host");
            var tk_metric_index = tokens.get("tk_metric_index");
            var tk_metric_category = tokens.get("tk_metric_category");
            var tk_metric_details = tokens.get("tk_metric_details");
            var tk_metric_last_lag_seen = tokens.get("tk_metric_last_lag_seen");
            var tk_metric_first_time_seen = tokens.get("tk_metric_first_time_seen");
            var tk_metric_last_time_seen = tokens.get("tk_metric_last_time_seen");
            var tk_metric_host_state = tokens.get("tk_metric_host_state");
            var tk_metric_tracker_runtime = tokens.get("tk_metric_tracker_runtime");
            var tk_metric_previous_host_state = tokens.get("tk_metric_previous_host_state");
            var tk_metric_previous_tracker_runtime = tokens.get("tk_metric_previous_tracker_runtime");
            var tk_metric_monitored_state = "enabled";
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring/" + tk_keyid;

            // Create a dictionary to store the field names and values
            var record = {
                "object_category": "metric_host",
                "metric_host": tk_metric_host,
                "metric_index": tk_metric_index,
                "metric_category": tk_metric_category,
                "metric_details": tk_metric_details,
                "metric_last_lag_seen": tk_metric_last_lag_seen,
                "metric_first_time_seen": tk_metric_first_time_seen,
                "metric_last_time_seen": tk_metric_last_time_seen,
                "metric_monitored_state": tk_metric_monitored_state,
                "metric_host_state": tk_metric_host_state,
                "metric_tracker_runtime": tk_metric_tracker_runtime,
                "metric_previous_host_state": tk_metric_previous_host_state,
                "metric_previous_tracker_runtime": tk_metric_previous_tracker_runtime,
                "latest_flip_state": tk_latest_flip_state,
                "latest_flip_time": tk_latest_flip_time,
                "priority": tk_priority
            };

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    // Retrieve update comment if any
                    var tk_comment = document.getElementById("input_update_comment").value;

                    // if is not defined, give it a value and override text box content
                    if (tk_comment == "null") {
                        setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else if (tk_comment == "update note") {
                        tk_comment = "No comment for update.";
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else {
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            searchMetricHostsMain.startSearch();

                            // Audit
                            action = "success";
                            change_type = "enable monitoring";
                            object = tk_metric_host;
                            object_category = "metric_host";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = "N/A";
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit
                            action = "failure";
                            change_type = "enable monitoring";
                            object = tk_metric_host;
                            object_category = "metric_host";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = message;
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        // cancel button: returns to selected
        $("#btn_close_metric_host_unified").click(function() {
            submitTokens();

            // Show modal
            $("#modal_manage_metric_host").modal();

        });

        // metric host priority
        $("#btn_modal_modify_priority_metric_host_confirm").click(function() {

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_metric_host = tokens.get("tk_metric_host");
            var tk_metric_index = tokens.get("tk_metric_index");
            var tk_metric_category = tokens.get("tk_metric_category");
            var tk_metric_details = tokens.get("tk_metric_details");
            var tk_metric_last_lag_seen = tokens.get("tk_metric_last_lag_seen");
            var tk_metric_first_time_seen = tokens.get("tk_metric_first_time_seen");
            var tk_metric_last_time_seen = tokens.get("tk_metric_last_time_seen");
            var tk_metric_host_state = tokens.get("tk_metric_host_state");
            var tk_metric_tracker_runtime = tokens.get("tk_metric_tracker_runtime");
            var tk_metric_previous_host_state = tokens.get("tk_metric_previous_host_state");
            var tk_metric_previous_tracker_runtime = tokens.get("tk_metric_previous_tracker_runtime");
            var tk_metric_monitored_state = "enabled";
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring/" + tk_keyid;

            var tk_origin_priority = tk_priority;
            var tk_new_priority = tokens.get("tk_input_metric_host_priority");

            if (!tk_new_priority || !tk_new_priority.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "object_category": "metric_host",
	                "metric_host": tk_metric_host,
	                "metric_index": tk_metric_index,
	                "metric_category": tk_metric_category,
	                "metric_details": tk_metric_details,
	                "metric_last_lag_seen": tk_metric_last_lag_seen,
	                "metric_first_time_seen": tk_metric_first_time_seen,
	                "metric_last_time_seen": tk_metric_last_time_seen,
	                "metric_monitored_state": tk_metric_monitored_state,
	                "metric_host_state": tk_metric_host_state,
	                "metric_tracker_runtime": tk_metric_tracker_runtime,
	                "metric_previous_host_state": tk_metric_previous_host_state,
	                "metric_previous_tracker_runtime": tk_metric_previous_tracker_runtime,
                    "latest_flip_state": tk_latest_flip_state,
                    "latest_flip_time": tk_latest_flip_time,
	                "priority": tk_new_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchMetricHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // call update data source
                        updateMetricHost(tk_keyid);

                        // Audit
                        action = "success";
                        change_type = "modify priority";
                        object = tk_metric_host;
                        object_category = "metric_host";
                        object_attrs = "priority changed from:" + tk_origin_priority + " to:" + tk_new_priority
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "modify priority";
                        object = tk_metric_host;
                        object_category = "metric_host";
                        object_attrs = "priority changed from:" + tk_origin_priority + " to:" + tk_new_priority
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        // disable monitoring

        $("#btn_disable_monitoring").click(function(mode) {

            // Hide main modal
            $("#modal_manage").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_last_lag_seen_idx = tokens.get("tk_data_last_lag_seen_idx");
            var tk_data_last_time_seen_idx = tokens.get("tk_data_last_time_seen_idx");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_level = tokens.get("tk_data_monitoring_level");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_source_state = tokens.get("tk_data_source_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_source_state = tokens.get("tk_data_previous_source_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_data_monitored_state = "disabled";
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring/" + tk_keyid;

            // Create a dictionary to store the field names and values
            var record = {
                "object_category": "data_source",
                "data_name": tk_data_name,
                "data_index": tk_data_index,
                "data_sourcetype": tk_data_sourcetype,
                "data_last_lag_seen": tk_data_last_lag_seen,
                "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                "data_eventcount": tk_data_eventcount,
                "data_first_time_seen": tk_data_first_time_seen,
                "data_last_time_seen": tk_data_last_time_seen,
                "data_last_ingest": tk_data_last_ingest,
                "data_last_lag_seen_idx": tk_data_last_lag_seen_idx,
                "data_last_time_seen_idx": tk_data_last_time_seen_idx,
                "data_max_lag_allowed": tk_data_max_lag_allowed,
                "data_monitored_state": tk_data_monitored_state,
                "data_monitoring_level": tk_data_monitoring_level,
                "data_monitoring_wdays": tk_data_monitoring_wdays,
                "data_override_lagging_class": tk_data_override_lagging_class,
                "data_source_state": tk_data_source_state,
                "data_tracker_runtime": tk_data_tracker_runtime,
                "data_previous_source_state": tk_data_previous_source_state,
                "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                "OutlierMinEventCount": tk_outliermineventcount,
                "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                "OutlierAlertOnUpper": tk_outlieralertonupper,
                "OutlierTimePeriod": tk_outlier_period,
                "OutlierSpan": tk_outlier_span,
                "isOutlier": tk_isoutlier,
                "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                "latest_flip_state": tk_latest_flip_state,
                "latest_flip_time": tk_latest_flip_time,
                "priority": tk_priority
            };

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    // Retrieve update comment if any
                    var tk_comment = document.getElementById("input_update_comment").value;

                    // if is not defined, give it a value and override text box content
                    if (tk_comment == "null") {
                        setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else if (tk_comment == "update note") {
                        tk_comment = "No comment for update.";
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else {
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            searchDataSourcesMain.startSearch();

                            // Audit
                            action = "success";
                            change_type = "disable monitoring";
                            object = tk_data_name;
                            object_category = "data_source";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = "N/A";
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit
                            action = "failure";
                            change_type = "disable monitoring";
                            object = tk_data_name;
                            object_category = "data_source";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = message;
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        $("#btn_disable_monitoring_host").click(function(mode) {

            // Hide main modal
            $("#modal_manage_host").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_host_state = tokens.get("tk_data_host_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_host_state = tokens.get("tk_data_previous_host_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_data_monitored_state = "disabled";
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_host_monitoring/" + tk_keyid;

            // Create a dictionary to store the field names and values
            var record = {
                "object_category": "data_host",
                "data_host": tk_data_host,
                "data_index": tk_data_index,
                "data_sourcetype": tk_data_sourcetype,
                "data_last_lag_seen": tk_data_last_lag_seen,
                "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                "data_eventcount": tk_data_eventcount,
                "data_first_time_seen": tk_data_first_time_seen,
                "data_last_time_seen": tk_data_last_time_seen,
                "data_last_ingest": tk_data_last_ingest,
                "data_max_lag_allowed": tk_data_max_lag_allowed,
                "data_monitored_state": tk_data_monitored_state,
                "data_monitoring_wdays": tk_data_monitoring_wdays,
                "data_override_lagging_class": tk_data_override_lagging_class,
                "data_host_state": tk_data_host_state,
                "data_tracker_runtime": tk_data_tracker_runtime,
                "data_previous_host_state": tk_data_previous_host_state,
                "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                "OutlierMinEventCount": tk_outliermineventcount,
                "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                "OutlierAlertOnUpper": tk_outlieralertonupper,
                "OutlierTimePeriod": tk_outlier_period,
                "OutlierSpan": tk_outlier_span,
                "isOutlier": tk_isoutlier,
                "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                "latest_flip_state": tk_latest_flip_state,
                "latest_flip_time": tk_latest_flip_time,
                "priority": tk_priority
            };

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    // Retrieve update comment if any
                    var tk_comment = document.getElementById("input_update_comment").value;

                    // if is not defined, give it a value and override text box content
                    if (tk_comment == "null") {
                        setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else if (tk_comment == "update note") {
                        tk_comment = "No comment for update.";
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else {
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            searchDataHostsMain.startSearch();

                            // Audit
                            action = "success";
                            change_type = "disable monitoring";
                            object = tk_data_host;
                            object_category = "data_host";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = "N/A";
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit
                            action = "failure";
                            change_type = "disable monitoring";
                            object = tk_data_host;
                            object_category = "data_host";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = message;
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        $("#btn_disable_monitoring_metric_host").click(function(mode) {

            // Hide main modal
            $("#modal_manage_metric_host").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_metric_host = tokens.get("tk_metric_host");
            var tk_metric_index = tokens.get("tk_metric_index");
            var tk_metric_category = tokens.get("tk_metric_category");
            var tk_metric_details = tokens.get("tk_metric_details");
            var tk_metric_last_lag_seen = tokens.get("tk_metric_last_lag_seen");
            var tk_metric_first_time_seen = tokens.get("tk_metric_first_time_seen");
            var tk_metric_last_time_seen = tokens.get("tk_metric_last_time_seen");
            var tk_metric_host_state = tokens.get("tk_metric_host_state");
            var tk_metric_tracker_runtime = tokens.get("tk_metric_tracker_runtime");
            var tk_metric_previous_host_state = tokens.get("tk_metric_previous_host_state");
            var tk_metric_previous_tracker_runtime = tokens.get("tk_metric_previous_tracker_runtime");
            var tk_metric_monitored_state = "disabled";
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring/" + tk_keyid;

            // Create a dictionary to store the field names and values
            var record = {
                "metric_host": tk_metric_host,
                "metric_index": tk_metric_index,
                "metric_category": tk_metric_category,
                "metric_details": tk_metric_details,
                "metric_last_lag_seen": tk_metric_last_lag_seen,
                "metric_first_time_seen": tk_metric_first_time_seen,
                "metric_last_time_seen": tk_metric_last_time_seen,
                "metric_monitored_state": tk_metric_monitored_state,
                "metric_host_state": tk_metric_host_state,
                "metric_tracker_runtime": tk_metric_tracker_runtime,
                "metric_previous_host_state": tk_metric_previous_host_state,
                "metric_previous_tracker_runtime": tk_metric_previous_tracker_runtime,
                "latest_flip_state": tk_latest_flip_state,
                "latest_flip_time": tk_latest_flip_time,
                "priority": tk_priority
            };

            //console.log(record);

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    // Retrieve update comment if any
                    var tk_comment = document.getElementById("input_update_comment").value;

                    // if is not defined, give it a value and override text box content
                    if (tk_comment == "null") {
                        setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else if (tk_comment == "update note") {
                        tk_comment = "No comment for update.";
                        document.getElementById("input_update_comment").value = "update note";
                    }
                    else {
                        // replace the textarea for modification requests
                        document.getElementById("input_update_comment").value = "update note";
                    }

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            searchMetricHostsMain.startSearch();

                            // Audit
                            action = "success";
                            change_type = "disable monitoring";
                            object = tk_metric_host;
                            object_category = "metric_host";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = "N/A";
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit
                            action = "failure";
                            change_type = "disable monitoring";
                            object = tk_metric_host;
                            object_category = "metric_host";
                            object_attrs = JSON.stringify(record,null,'\t');
                            result = "N/A";
                            comment = tk_comment;
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        //
        // DELETE BUTTON
        //

        $("#btn_delete_metric_host").click(function() {

            // Hide main modal
            $("#modal_manage_metric_host").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_metric_host = tokens.get("tk_metric_host");
            var tk_metric_index = tokens.get("tk_metric_index");
            var tk_metric_category = tokens.get("tk_metric_category");
            var tk_metric_details = tokens.get("tk_metric_details");
            var tk_metric_last_lag_seen = tokens.get("tk_metric_last_lag_seen");
            var tk_metric_first_time_seen = tokens.get("tk_metric_first_time_seen");
            var tk_metric_last_time_seen = tokens.get("tk_metric_last_time_seen");
            var tk_metric_host_state = tokens.get("tk_metric_host_state");
            var tk_metric_tracker_runtime = tokens.get("tk_metric_tracker_runtime");
            var tk_metric_previous_host_state = tokens.get("tk_metric_previous_host_state");
            var tk_metric_previous_tracker_runtime = tokens.get("tk_metric_previous_tracker_runtime");
            var tk_metric_monitored_state = "disabled";
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");

            // Create a dictionary to store the field names and values
            var record = {
                "metric_host": tk_metric_host,
                "metric_index": tk_metric_index,
                "metric_category": tk_metric_category,
                "metric_details": tk_metric_details,
                "metric_last_lag_seen": tk_metric_last_lag_seen,
                "metric_first_time_seen": tk_metric_first_time_seen,
                "metric_last_time_seen": tk_metric_last_time_seen,
                "metric_monitored_state": tk_metric_monitored_state,
                "metric_host_state": tk_metric_host_state,
                "metric_tracker_runtime": tk_metric_tracker_runtime,
                "metric_previous_host_state": tk_metric_previous_host_state,
                "metric_previous_tracker_runtime": tk_metric_previous_tracker_runtime,
                "latest_flip_state": tk_latest_flip_state,
                "latest_flip_time": tk_latest_flip_time,
                "priority": tk_priority
            };

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring/" + tk_keyid;

            if (tk_keyid && tk_keyid.length) {

                $("#modal_entry_deletion").modal()

                $("#btn_modal_entry_deletion_temporary").unbind('click').click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $("#modal_entry_modification").modal()

                    $("#btn_modal_entry_modification").click(function() {

                        var that = $(this);
                        that.off('click'); // remove handler

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("input_update_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else {
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }

                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                                searchMetricHostsMain.startSearch();

                                // Audit
                                action = "success";
                                change_type = "delete temporary";
                                object = tk_metric_host;
                                object_category = "metric_host";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);
                                return;
                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete temporary";
                                object = tk_metric_host;
                                object_category = "metric_host";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                                $("#modal_update_collection_failure_return").modal()
                            }

                        });

                    });

                });

                $("#btn_modal_entry_deletion").unbind('click').click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $("#modal_entry_modification").modal()

                    $("#btn_modal_entry_modification").click(function() {

                        var that = $(this);
                        that.off('click'); // remove handler

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("input_update_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else {
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }

                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                                searchMetricHostsMain.startSearch();

                                // Audit
                                action = "success";
                                change_type = "delete permanent";
                                object = tk_metric_host;
                                object_category = "metric_host";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);
                                return;
                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete permanent";
                                object = tk_metric_host;
                                object_category = "metric_host";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                                $("#modal_update_collection_failure_return").modal()
                            }

                        });

                    });

                });

            }

        });

        // delete entry

        $("#btn_delete_data_source").click(function() {

            // Hide main modal
            $("#modal_manage").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_last_lag_seen_idx = tokens.get("tk_data_last_lag_seen_idx");
            var tk_data_last_time_seen_idx = tokens.get("tk_data_last_time_seen_idx");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_monitoring_level = tokens.get("tk_data_monitoring_level");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");

            // Create a dictionary to store the field names and values
            var record = {
                "object_category": "data_source",
                "data_name": tk_data_name,
                "data_index": tk_data_index,
                "data_sourcetype": tk_data_sourcetype,
                "data_last_lag_seen": tk_data_last_lag_seen,
                "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                "data_eventcount": tk_data_eventcount,
                "data_first_time_seen": tk_data_first_time_seen,
                "data_last_time_seen": tk_data_last_time_seen,
                "data_last_ingest": tk_data_last_ingest,
                "data_last_lag_seen_idx": tk_data_last_lag_seen_idx,
                "data_last_time_seen_idx": tk_data_last_time_seen_idx,
                "data_max_lag_allowed": tk_data_max_lag_allowed,
                "data_monitored_state": tk_data_monitored_state,
                "data_monitoring_level": tk_data_monitoring_level,
                "data_monitoring_wdays": tk_data_monitoring_wdays,
                "data_override_lagging_class": tk_data_override_lagging_class,
                "OutlierMinEventCount": tk_outliermineventcount,
                "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                "OutlierAlertOnUpper": tk_outlieralertonupper,
                "OutlierTimePeriod": tk_outlier_period,
                "OutlierSpan": tk_outlier_span,
                "isOutlier": tk_isoutlier,
                "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                "latest_flip_state": tk_latest_flip_state,
                "latest_flip_time": tk_latest_flip_time,
                "priority": tk_priority
            };

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring/" + tk_keyid;

            if (tk_keyid && tk_keyid.length) {

                $("#modal_entry_deletion").modal()

                // Delete temporary: change_type will be set to temporary
                $("#btn_modal_entry_deletion_temporary").unbind('click').click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $("#modal_entry_modification").modal()

                    $("#btn_modal_entry_modification").click(function() {

                        var that = $(this);
                        that.off('click'); // remove handler

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("input_update_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else {
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }

                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                                searchDataSourcesMain.startSearch();

                                // Audit
                                action = "success";
                                change_type = "delete temporary";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);
                                return;
                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete temporary";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                                $("#modal_update_collection_failure_return").modal()
                            }

                        });

                    });

                });

                // Delete temporary: change_type will be set to permanent
                $("#btn_modal_entry_deletion").unbind('click').click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $("#modal_entry_modification").modal()

                    $("#btn_modal_entry_modification").click(function() {

                        var that = $(this);
                        that.off('click'); // remove handler

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("input_update_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else {
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }

                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                                searchDataSourcesMain.startSearch();

                                // Audit
                                action = "success";
                                change_type = "delete permanent";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);
                                return;
                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete permanent";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                                $("#modal_update_collection_failure_return").modal()
                            }

                        });

                    });

                });

            }

        });

        $("#btn_delete_data_host").click(function() {

            // Hide main modal
            $("#modal_manage_host").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");

            // Create a dictionary to store the field names and values
            var record = {
                "object_category": "data_host",
                "data_host": tk_data_host,
                "data_index": tk_data_index,
                "data_sourcetype": tk_data_sourcetype,
                "data_last_lag_seen": tk_data_last_lag_seen,
                "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                "data_eventcount": tk_data_eventcount,
                "data_first_time_seen": tk_data_first_time_seen,
                "data_last_time_seen": tk_data_last_time_seen,
                "data_last_ingest": tk_data_last_ingest,
                "data_max_lag_allowed": tk_data_max_lag_allowed,
                "data_monitored_state": tk_data_monitored_state,
                "data_monitoring_wdays": tk_data_monitoring_wdays,
                "data_override_lagging_class": tk_data_override_lagging_class,
                "OutlierMinEventCount": tk_outliermineventcount,
                "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                "OutlierAlertOnUpper": tk_outlieralertonupper,
                "OutlierTimePeriod": tk_outlier_period,
                "OutlierSpan": tk_outlier_span,
                "isOutlier": tk_isoutlier,
                "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                "latest_flip_state": tk_latest_flip_state,
                "latest_flip_time": tk_latest_flip_time,
                "priority": tk_priority
            };

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_host_monitoring/" + tk_keyid;

            if (tk_keyid && tk_keyid.length) {

                $("#modal_entry_deletion").modal()

                $("#btn_modal_entry_deletion_temporary").unbind('click').click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $("#modal_entry_modification").modal()

                    $("#btn_modal_entry_modification").click(function() {

                        var that = $(this);
                        that.off('click'); // remove handler

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("input_update_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else {
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }

                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                                searchDataHostsMain.startSearch();

                                // Audit
                                action = "success";
                                change_type = "delete temporary";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);
                                return;
                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete temporary";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                                $("#modal_update_collection_failure_return").modal()
                            }

                        });

                    });

                });

                $("#btn_modal_entry_deletion").unbind('click').click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $("#modal_entry_modification").modal()

                    $("#btn_modal_entry_modification").click(function() {

                        var that = $(this);
                        that.off('click'); // remove handler

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("input_update_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                            document.getElementById("input_update_comment").value = "update note";
                        }
                        else {
                            // replace the textarea for modification requests
                            document.getElementById("input_update_comment").value = "update note";
                        }

                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                                searchDataHostsMain.startSearch();

                                // Audit
                                action = "success";
                                change_type = "delete permanent";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);
                                return;
                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete permanent";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = JSON.stringify(record,null,'\t');
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                                $("#modal_update_collection_failure_return").modal()
                            }

                        });

                    });

                });

            }

        });

        // metrics sla policy

        // add policy

        $("#btn_modal_metric_policy_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_metric_policy_metric_category = tokens.get("tk_input_metric_policy_metric_category");
            var tk_input_metric_policy_metric_value = tokens.get("tk_input_metric_policy_metric_value");

            // Define the query
            var searchQuery = "| inputlookup trackme_metric_lagging_definition | append [ | makeresults | eval metric_category=\"" + tk_input_metric_policy_metric_category + "\", metric_max_lag_allowed=\"" + tk_input_metric_policy_metric_value + "\" ] | dedup metric_category | sort limit=0 metric_category | outputlookup trackme_metric_lagging_definition";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_metric_policy_metric_category && tk_input_metric_policy_metric_category.length && tk_input_metric_policy_metric_value && tk_input_metric_policy_metric_value.length && isNumeric(tk_input_metric_policy_metric_value)) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "create metric sla policy";
                            object = tk_input_metric_policy_metric_category;
                            object_category = "metric_sla_policy";
                            object_attrs = "SLA policy was created for metric_category:" + tk_input_metric_policy_metric_category + ", metric_max_lag_allowed:" + tk_input_metric_policy_metric_value;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    unsetToken("form.tk_input_metric_policy_metric_category");
                                    searchMetricHostsMain.startSearch();
                                    searchMetricPolicies.startSearch();

                                    // Audit
                                    action = "success";
                                    change_type = "create metric sla policy";
                                    object = tk_input_metric_policy_metric_category;
                                    object_category = "metric_sla_policy";
                                    object_attrs = "SLA policy was created for metric_category:" + tk_input_metric_policy_metric_category + ", metric_max_lag_allowed:" + tk_input_metric_policy_metric_value;
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_metric_sla_policies").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete policy

        $("#btn_delete_metric_sla_policy").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_metric_policy_metric_category = tokens.get("tk_input_metric_policy_metric_category");
            var tk_input_metric_policy_metric_value = tokens.get("tk_input_metric_policy_metric_value");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_lagging_definition/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#manage_metric_sla_policy").modal('hide');

                        // Audit
                        action = "success";
                        change_type = "delete metric sla policy";
                        object = tk_input_metric_policy_metric_category;
                        object_category = "metric_sla_policy";
                        object_attrs = "SLA policy was removed for metric_category:" + tk_input_metric_policy_metric_category + ", metric_max_lag_allowed:" + tk_input_metric_policy_metric_value;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        unsetToken("form.tk_input_metric_policy_metric_category");
                        searchMetricHostsMain.startSearch();
                        searchMetricPolicies.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_metric_sla_policies").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "delete metric sla policy";
                        object = tk_input_metric_policy_metric_category;
                        object_category = "metric_sla_policy";
                        object_attrs = "SLA policy was removed for metric_category:" + tk_input_metric_policy_metric_category + ", metric_max_lag_allowed:" + tk_input_metric_policy_metric_value;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // Hide main modal
                        $("#manage_metric_sla_policy").modal('hide');
                        $("#modal_metric_sla_policies").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // Custom lagging

        $("#btn_modal_custom_lagging_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_custom_lagging_type = tokens.get("tk_input_custom_lagging_type");
            var tk_input_custom_lagging_name = tokens.get("tk_input_custom_lagging_name");
            var tk_input_custom_lagging_value = tokens.get("tk_input_custom_lagging_value");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_custom_lagging_definition";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_custom_lagging_definition | append [ | makeresults | eval level=\"" + tk_input_custom_lagging_type + "\", name=\"" + tk_input_custom_lagging_name + "\", value=\"" + tk_input_custom_lagging_value + "\" ] | dedup level, name, value | sort limit=0 level, name | outputlookup trackme_custom_lagging_definition";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_custom_lagging_name && tk_input_custom_lagging_name.length && tk_input_custom_lagging_value && tk_input_custom_lagging_value.length && isNumeric(tk_input_custom_lagging_value)) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "create lagging class";
                            object = tk_input_custom_lagging_name;
                            object_category = "lagging_class";
                            object_attrs = "type:" + tk_input_custom_lagging_type + ", name:" + tk_input_custom_lagging_name + ", value:" + tk_input_custom_lagging_value;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchCustomLagging.startSearch();

                                    // Audit
                                    action = "success";
                                    change_type = "create lagging class";
                                    object = tk_input_custom_lagging_name;
                                    object_category = "lagging_class";
                                    object_attrs = "type:" + tk_input_custom_lagging_type + ", name:" + tk_input_custom_lagging_name + ", value:" + tk_input_custom_lagging_value;
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modify_custom_lagging").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete lagging class

        $("#btn_delete_custom_lagging").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_custom_lagging_definition/" + tk_keyid;

            // Get tokens
            var tk_input_custom_lagging_type = tokens.get("tk_input_custom_lagging_type");
            var tk_input_custom_lagging_name = tokens.get("tk_input_custom_lagging_name");
            var tk_input_custom_lagging_value = tokens.get("tk_input_custom_lagging_value");

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#manage_custom_lagging").modal('hide');

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchCustomLagging.startSearch();

                        // Audit
                        action = "success";
                        change_type = "delete lagging class";
                        object = tk_input_custom_lagging_name;
                        object_category = "lagging_class";
                        object_attrs = "type:" + tk_input_custom_lagging_type + ", name:" + tk_input_custom_lagging_name + ", value:" + tk_input_custom_lagging_value;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modify_custom_lagging").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "delete lagging class";
                        object = tk_input_custom_lagging_name;
                        object_category = "lagging_class";
                        object_attrs = "type:" + tk_input_custom_lagging_type + ", name:" + tk_input_custom_lagging_name + ", value:" + tk_input_custom_lagging_value;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // Hide main modal
                        $("#modify_custom_lagging").modal('hide');
                        $("#manage_custom_lagging").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // whitelist

        // add entry from whitelist

        $("#btn_modal_data_source_whitelist_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_whitelist_data_source = tokens.get("tk_input_whitelist_data_source");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_whitelist_index";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_data_source_monitoring_whitelist_index | append [ | makeresults | eval data_index=\"" + tk_input_whitelist_data_source + "\"] | dedup data_index | sort limit=0 data_index | outputlookup trackme_data_source_monitoring_whitelist_index";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_whitelist_data_source && tk_input_whitelist_data_source.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add whitelist index";
                            object = tk_input_whitelist_data_source;
                            object_category = "data_source";
                            object_attrs = "index:" + tk_input_whitelist_data_source;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchWhiteListDataSource.startSearch();
                                    searchSingleWhiteListDataSource.startSearch();
                                    searchDataSourcesMain.startSearch();
                                    searchPopulateIndexesForWhiteListDataSource.startSearch();
                                    unsetToken("form.tk_input_whitelist_data_source");

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add whitelist index";
                                    object = tk_input_whitelist_data_source;
                                    object_category = "data_source";
                                    object_attrs = "index:" + tk_input_whitelist_data_source;
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_data_source_whitelist").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from whitelist

        $("#btn_modal_data_source_whitelist_add_delete").click(function() {
                $("#modal_modify_data_source_whitelist").modal('hide');
                $("#modal_manage_data_source_whitelist").modal();
        });

        function foreachDeleteWhitelistDataSource(item) {
          //console.log("removal of key :" + item);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_whitelist_index/" + item;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (item && item.length) {

                // Get the KV entry content first
                $.ajax({
                    url: myendpoint_URl,
                    type: "GET",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        removedObject = returneddata.data_index;
                        //console.log("removedObject is: " + removedObject);

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("data_source_whitelist_index_delete_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                        }

                        // Proceed to delete call
                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {

                                console.log(returneddata);

                                // Audit
                                action = "success";
                                change_type = "delete whitelist index";
                                object = removedObject;
                                object_category = "data_source";
                                object_attrs = "{" + "\"data_index\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);

                                // Return to modal
                                $("#modal_modify_data_source_whitelist").modal();
                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete whitelist index";
                                object = removedObject;
                                object_category = "data_source";
                                object_attrs = "{" + "\"data_index\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                        });

                    }

                });

            }

        }

        $("#btn_delete_data_source_whitelist").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeWhitelistDataSource");
            tk_multi_table_array = tk_multi_table_array.split(',');
            console.log("tk_multi_table_array is: " + tk_multi_table_array);

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachDeleteWhitelistDataSource);

            // Hide main modal
            $("#modal_manage_data_source_whitelist").modal('hide');

            //console.log("Updated!", returneddata)
            // Run the search again to update the table
            searchWhiteListDataSource.startSearch();
            searchSingleWhiteListDataSource.startSearch();
            searchDataSourcesMain.startSearch();
            searchPopulateIndexesForWhiteListDataSource.startSearch();
            unsetToken("form.tk_input_whitelist_data_source");

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeWhitelistDataSource");

        });

        // add entry from whitelist

        $("#btn_modal_metric_host_whitelist_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_whitelist_metric_host = tokens.get("tk_input_whitelist_metric_host");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring_whitelist_index";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_metric_host_monitoring_whitelist_index | append [ | makeresults | eval metric_index=\"" + tk_input_whitelist_metric_host + "\"] | dedup metric_index | sort limit=0 metric_index | outputlookup trackme_metric_host_monitoring_whitelist_index";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_whitelist_metric_host && tk_input_whitelist_metric_host.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add whitelist index";
                            object = tk_input_whitelist_metric_host;
                            object_category = "metric_host";
                            object_attrs = "index:" + tk_input_whitelist_metric_host;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchPopulateIndexesForWhiteListMetricHost.startSearch();
                                    searchWhiteListMetricHost.startSearch();
                                    searchSingleWhiteListMetricHost.startSearch();
                                    searchMetricHostsMain.startSearch();
                                    unsetToken("form.tk_input_whitelist_metric_host");

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add whitelist index";
                                    object = tk_input_whitelist_metric_host;
                                    object_category = "metric_host";
                                    object_attrs = "index:" + tk_input_whitelist_metric_host;
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_metric_host_whitelist").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from whitelist

        $("#btn_delete_metric_host_whitelist").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // Get
            var tk_metric_index = tokens.get("tk_metric_index");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring_whitelist_index/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_metric_host_whitelist").modal('hide');

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchPopulateIndexesForWhiteListMetricHost.startSearch();
                        searchWhiteListMetricHost.startSearch();
                        searchSingleWhiteListMetricHost.startSearch();
                        searchMetricHostsMain.startSearch();
                        unsetToken("form.tk_input_whitelist_metric_host");

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit
                        action = "success";
                        change_type = "delete whitelist index";
                        object = tk_metric_index;
                        object_category = "metric_host";
                        object_attrs = "index:" + tk_metric_index;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_metric_host_whitelist").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "delete whitelist index";
                        object = tk_metric_index;
                        object_category = "metric_host";
                        object_attrs = "index:" + tk_metric_index;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // Hide main modal
                        $("#modal_manage_metric_host_whitelist").modal('hide');
                        $("#modal_modify_metric_host_whitelist").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // add entry from whitelist

        $("#btn_modal_data_host_whitelist_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_whitelist_data_host = tokens.get("tk_input_whitelist_data_host");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_whitelist_index";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_data_host_monitoring_whitelist_index | append [ | makeresults | eval data_index=\"" + tk_input_whitelist_data_host + "\"] | dedup data_index | sort limit=0 data_index | outputlookup trackme_data_host_monitoring_whitelist_index";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_whitelist_data_host && tk_input_whitelist_data_host.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add whitelist index";
                            object = tk_input_whitelist_data_host;
                            object_category = "data_host";
                            object_attrs = "index:" + tk_input_whitelist_data_host;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchWhiteListDataHost.startSearch();
                                    searchSingleWhiteListDataHost.startSearch();
                                    searchDataHostsMain.startSearch();
                                    searchPopulateIndexesForWhiteListDataHost.startSearch();
                                    unsetToken("form.tk_input_whitelist_data_host");

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add whitelist index";
                                    object = tk_input_whitelist_data_host;
                                    object_category = "data_host";
                                    object_attrs = "index:" + tk_input_whitelist_data_host;
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_data_host_whitelist").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from whitelist

        $("#btn_modal_data_host_whitelist_add_delete").click(function() {
                $("#modal_modify_data_host_whitelist").modal('hide');
                $("#modal_manage_data_host_whitelist").modal();
        });

        function foreachDeleteWhitelistDataHost(item) {
          //console.log("removal of key :" + item);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_whitelist_index/" + item;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (item && item.length) {

                // Get the KV entry content first
                $.ajax({
                    url: myendpoint_URl,
                    type: "GET",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        removedObject = returneddata.data_index;
                        //console.log("removedObject is: " + removedObject);

                        // Retrieve update comment if any
                        var tk_comment = document.getElementById("data_host_whitelist_index_delete_comment").value;

                        // if is not defined, give it a value and override text box content
                        if (tk_comment == "null") {
                            setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                        }
                        else if (tk_comment == "update note") {
                            tk_comment = "No comment for update.";
                        }

                        // Proceed to delete call
                        $.ajax({
                            url: myendpoint_URl,
                            type: "DELETE",
                            async: true,
                            contentType: "application/json",
                            success: function(returneddata) {

                                console.log(returneddata);

                                // Audit
                                action = "success";
                                change_type = "delete whitelist index";
                                object = removedObject;
                                object_category = "data_host";
                                object_attrs = "{" + "\"data_index\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                // house cleaning
                                myendpoint_URl = undefined;
                                delete(myendpoint_URl);
                                tk_keyid = undefined;
                                delete(tk_keyid);

                                // Return to modal
                                $("#modal_modify_data_host_whitelist").modal();
                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;

                                // Audit
                                action = "failure";
                                change_type = "delete whitelist index";
                                object = removedObject;
                                object_category = "data_host";
                                object_attrs = "{" + "\"data_index\": \"" + removedObject + "\", \"_key\": \"" + item + "\"}";
                                result = message;
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                        });

                    }

                });

            }

        }

        $("#btn_delete_data_host_whitelist").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the arrays of keys
            var tk_multi_table_array = tokens.get("removeWhitelistDataHost");
            tk_multi_table_array = tk_multi_table_array.split(',');
            console.log("tk_multi_table_array is: " + tk_multi_table_array);

            // Call the function for each value from the array
            tk_multi_table_array.forEach(foreachDeleteWhitelistDataHost);

            // Hide main modal
            $("#modal_manage_data_host_whitelist").modal('hide');

            //console.log("Updated!", returneddata)
            // Run the search again to update the table
            searchWhiteListDataHost.startSearch();
            searchSingleWhiteListDataHost.startSearch();
            searchDataHostsMain.startSearch();
            searchPopulateIndexesForWhiteListDataHost.startSearch();
            unsetToken("form.tk_input_whitelist_data_host");

            // notify
            notification('Modification has been registered successfully.', 2000)

            // house cleaning
            unsetToken("removeWhitelistDataHost");

        });

        // blacklist

        // host blacklist

        // add entry from blacklist

        $("#btn_modal_data_source_blacklist_host_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_host = tokens.get("tk_input_data_source_blacklist_host");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_host";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_data_source_monitoring_blacklist_host | append [ | makeresults | eval data_host=\"" + tk_input_blacklist_host + "\", data_blacklist_state=\"true\" ] | dedup data_host | sort limit=0 data_host | outputlookup trackme_data_source_monitoring_blacklist_host";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_host && tk_input_blacklist_host.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add blacklist host";
                            object = tk_input_blacklist_host;
                            object_category = "data_source";
                            object_attrs = "host:" + tk_input_blacklist_host;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataSourceHost.startSearch();
                                    searchSingleBlackListDataSourceHost.startSearch();
                                    searchDataSourcesMain.startSearch();
                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add blacklist host";
                                    object = tk_input_blacklist_host;
                                    object_category = "data_source";
                                    object_attrs = "host:" + tk_input_blacklist_host;
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_data_source_blacklist_host").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_delete_data_source_blacklist_host").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // Get
            var tk_data_host = tokens.get("tk_data_host");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_host/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_data_source_blacklist_host").modal('hide');

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchBlackListDataSourceHost.startSearch();
                        searchSingleBlackListDataSourceHost.startSearch();
                        searchDataSourcesMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit
                        action = "success";
                        change_type = "delete blacklist host";
                        object = tk_data_host;
                        object_category = "data_source";
                        object_attrs = "host:" + tk_data_host;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_data_source_blacklist_host").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "delete blacklist host";
                        object = tk_data_host;
                        object_category = "data_source";
                        object_attrs = "host:" + tk_data_host;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // Hide main modal
                        $("#modal_manage_data_source_blacklist_host").modal('hide');
                        $("#modal_modify_data_source_blacklist_host").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // add entry from blacklist

        $("#btn_modal_data_host_blacklist_host_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_host = tokens.get("tk_input_data_host_blacklist_host");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_blacklist_host";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_data_host_monitoring_blacklist_host | append [ | makeresults | eval data_host=\"" + tk_input_blacklist_host + "\", data_blacklist_state=\"true\" ] | dedup data_host | sort limit=0 data_host | outputlookup trackme_data_host_monitoring_blacklist_host";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_host && tk_input_blacklist_host.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add blacklist host";
                            object = tk_input_blacklist_host;
                            object_category = "data_host";
                            object_attrs = "host:" + tk_input_blacklist_host;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataHostHost.startSearch();
                                    searchSingleBlackListDataHostHost.startSearch();
                                    searchDataHostsMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add blacklist host";
                                    object = tk_input_blacklist_host;
                                    object_category = "data_host";
                                    object_attrs = "host:" + tk_input_blacklist_host;
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_data_host_blacklist_host").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_delete_data_host_blacklist_host").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // Get
            var tk_data_host = tokens.get("tk_data_host");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_blacklist_host/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_data_host_blacklist_host").modal('hide');

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchBlackListDataHostHost.startSearch();
                        searchSingleBlackListDataHostHost.startSearch();
                        searchDataHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit
                        action = "success";
                        change_type = "delete blacklist host";
                        object = tk_data_host;
                        object_category = "data_host";
                        object_attrs = "host:" + tk_data_host;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_data_host_blacklist_host").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "delete blacklist host";
                        object = tk_data_host;
                        object_category = "data_host";
                        object_attrs = "host:" + tk_data_host;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // Hide main modal
                        $("#modal_manage_data_host_blacklist_host").modal('hide');
                        $("#modal_modify_data_host_blacklist_host").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // index blacklist

        // add entry from blacklist

        $("#btn_modal_data_source_blacklist_index_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_index = tokens.get("tk_input_blacklist_index");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_index";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_data_source_monitoring_blacklist_index | append [ | makeresults | eval data_index=\"" + tk_input_blacklist_index + "\", data_blacklist_state=\"true\" ] | dedup data_index | sort limit=0 data_index | outputlookup trackme_data_source_monitoring_blacklist_index";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_index && tk_input_blacklist_index.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add blacklist index";
                            object = tk_input_blacklist_index;
                            object_category = "data_source";
                            object_attrs = "index:" + tk_input_blacklist_index;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataSourceIndex.startSearch();
                                    searchSingleBlackListDataSourceIndex.startSearch();
                                    searchDataSourcesMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add blacklist index";
                                    object = tk_input_blacklist_index;
                                    object_category = "data_source";
                                    object_attrs = "index:" + tk_input_blacklist_index;
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_data_source_blacklist_index").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_delete_data_source_blacklist_index").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // Get
            var tk_data_index = tokens.get("tk_data_index");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_index/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_data_source_blacklist_index").modal('hide');

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchBlackListDataSourceIndex.startSearch();
                        searchSingleBlackListDataSourceIndex.startSearch();
                        searchDataSourcesMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit
                        action = "success";
                        change_type = "delete blacklist index";
                        object = tk_data_index;
                        object_category = "data_source";
                        object_attrs = "index:" + tk_data_index;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_data_source_blacklist_index").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "delete blacklist index";
                        object = tk_data_index;
                        object_category = "data_source";
                        object_attrs = "index:" + tk_data_index;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // Hide main modal
                        $("#modal_manage_data_source_blacklist_index").modal('hide');
                        $("#modal_modify_data_source_blacklist_index").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // add entry from blacklist

        $("#btn_modal_data_host_blacklist_index_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_index = tokens.get("tk_input_data_host_blacklist_index");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_index";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_data_host_monitoring_blacklist_index | append [ | makeresults | eval data_index=\"" + tk_input_blacklist_index + "\", data_blacklist_state=\"true\" ] | dedup data_index | sort limit=0 data_index | outputlookup trackme_data_host_monitoring_blacklist_index";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_index && tk_input_blacklist_index.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add blacklist index";
                            object = tk_input_blacklist_index;
                            object_category = "data_host";
                            object_attrs = "index:" + tk_input_blacklist_index;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataHostIndex.startSearch();
                                    searchSingleBlackListDataHostIndex.startSearch();
                                    searchDataHostsMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add blacklist index";
                                    object = tk_input_blacklist_index;
                                    object_category = "data_host";
                                    object_attrs = "index:" + tk_input_blacklist_index;
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_data_host_blacklist_index").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_delete_data_host_blacklist_index").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_data_index = tokens.get("tk_data_index");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_blacklist_index/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_data_host_blacklist_index").modal('hide');

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchBlackListDataHostIndex.startSearch();
                        searchSingleBlackListDataHostIndex.startSearch();
                        searchDataHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit
                        action = "success";
                        change_type = "delete blacklist index";
                        object = tk_data_index;
                        object_category = "data_host";
                        object_attrs = "index:" + tk_data_index;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_data_host_blacklist_index").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "delete blacklist index";
                        object = tk_data_index;
                        object_category = "data_host";
                        object_attrs = "index:" + tk_data_index;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // Hide main modal
                        $("#modal_manage_data_host_blacklist_index").modal('hide');
                        $("#modal_modify_data_host_blacklist_index").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // add entry from blacklist

        $("#btn_modal_metric_host_blacklist_index_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_index = tokens.get("tk_input_metric_host_blacklist_index");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_index";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_metric_host_monitoring_blacklist_index | append [ | makeresults | eval metric_index=\"" + tk_input_blacklist_index + "\", metric_blacklist_state=\"true\" ] | dedup metric_index | sort limit=0 metric_index | outputlookup trackme_metric_host_monitoring_blacklist_index";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_index && tk_input_blacklist_index.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add blacklist index";
                            object = tk_input_blacklist_index;
                            object_category = "metric_host";
                            object_attrs = "index:" + tk_input_blacklist_index;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListMetricHostIndex.startSearch();
                                    searchSingleBlackListMetricHostIndex.startSearch();
                                    searchMetricHostsMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add blacklist index";
                                    object = tk_input_blacklist_index;
                                    object_category = "metric_host";
                                    object_attrs = "index:" + tk_input_blacklist_index;
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_metric_host_blacklist_index").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_delete_metric_host_blacklist_index").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_metric_index = tokens.get("tk_metric_index");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring_blacklist_index/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_metric_host_blacklist_index").modal('hide');

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchBlackListMetricHostIndex.startSearch();
                        searchSingleBlackListMetricHostIndex.startSearch();
                        searchMetricHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit
                        action = "success";
                        change_type = "delete blacklist index";
                        object = tk_metric_index;
                        object_category = "metric_host";
                        object_attrs = "index:" + tk_metric_index;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_metric_host_blacklist_index").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "delete blacklist index";
                        object = tk_metric_index;
                        object_category = "metric_host";
                        object_attrs = "index:" + tk_metric_index;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // Hide main modal
                        $("#modal_manage_metric_host_blacklist_index").modal('hide');
                        $("#modal_modify_metric_host_blacklist_index").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // sourcetype blacklist

        $("#btn_modal_data_source_blacklist_sourcetype_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_sourcetype = tokens.get("tk_input_data_source_blacklist_sourcetype");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_sourcetype";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_data_source_monitoring_blacklist_sourcetype | append [ | makeresults | eval data_sourcetype=\"" + tk_input_blacklist_sourcetype + "\", data_blacklist_state=\"true\" ] | dedup data_sourcetype | sort limit=0 data_sourcetype | outputlookup trackme_data_source_monitoring_blacklist_sourcetype";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_sourcetype && tk_input_blacklist_sourcetype.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add blacklist sourcetype";
                            object = tk_input_blacklist_sourcetype;
                            object_category = "data_source";
                            object_attrs = "sourcetype:" + tk_input_blacklist_sourcetype;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataSourceSourcetype.startSearch();
                                    searchSingleBlackListDataSourceSourcetype.startSearch();
                                    searchDataSourcesMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add blacklist sourcetype";
                                    object = tk_input_blacklist_sourcetype;
                                    object_category = "data_source";
                                    object_attrs = "sourcetype:" + tk_input_blacklist_sourcetype;
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_data_source_blacklist_sourcetype").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_delete_data_source_blacklist_sourcetype").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // Get
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_sourcetype/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_data_source_blacklist_sourcetype").modal('hide');

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchBlackListDataSourceSourcetype.startSearch();
                        searchSingleBlackListDataSourceSourcetype.startSearch();
                        searchDataSourcesMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit
                        action = "success";
                        change_type = "delete blacklist sourcetype";
                        object = tk_data_sourcetype;
                        object_category = "data_source";
                        object_attrs = "sourcetype:" + tk_data_sourcetype;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_data_source_blacklist_sourcetype").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "delete blacklist sourcetype";
                        object = tk_data_sourcetype;
                        object_category = "data_source";
                        object_attrs = "sourcetype:" + tk_data_sourcetype;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // Hide main modal
                        $("#modal_manage_data_source_blacklist_sourcetype").modal('hide');
                        $("#modal_modify_data_source_blacklist_sourcetype").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // sourcetype blacklist

        $("#btn_modal_data_host_blacklist_sourcetype_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_sourcetype = tokens.get("tk_input_data_host_blacklist_sourcetype");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_blacklist_sourcetype";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_data_host_monitoring_blacklist_sourcetype | append [ | makeresults | eval data_sourcetype=\"" + tk_input_blacklist_sourcetype + "\", data_blacklist_state=\"true\" ] | dedup data_sourcetype | sort limit=0 data_sourcetype | outputlookup trackme_data_host_monitoring_blacklist_sourcetype";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_sourcetype && tk_input_blacklist_sourcetype.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add blacklist sourcetypeg";
                            object = tk_input_blacklist_sourcetype;
                            object_category = "data_host";
                            object_attrs = "sourcetype:" + tk_input_blacklist_sourcetype;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataHostSourcetype.startSearch();
                                    searchSingleBlackListDataHostSourcetype.startSearch();
                                    searchDataHostsMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add blacklist sourcetypeg";
                                    object = tk_input_blacklist_sourcetype;
                                    object_category = "data_host";
                                    object_attrs = "sourcetype:" + tk_input_blacklist_sourcetype;
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_data_host_blacklist_sourcetype").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_delete_data_host_blacklist_sourcetype").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_blacklist_sourcetype/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_data_host_blacklist_sourcetype").modal('hide');

                        // Audit
                        action = "success";
                        change_type = "delete blacklist sourcetype";
                        object = tk_data_sourcetype;
                        object_category = "data_host";
                        object_attrs = "sourcetype:" + tk_data_sourcetype;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchBlackListDataHostSourcetype.startSearch();
                        searchSingleBlackListDataHostSourcetype.startSearch();
                        searchDataHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_data_host_blacklist_sourcetype").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "delete blacklist sourcetype";
                        object = tk_data_sourcetype;
                        object_category = "data_host";
                        object_attrs = "sourcetype:" + tk_data_sourcetype;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // Hide main modal
                        $("#modal_manage_data_host_blacklist_sourcetype").modal('hide');
                        $("#modal_modify_data_host_blacklist_sourcetype").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // metric host moonitoring
        // add entry from blacklist

        $("#btn_modal_metric_host_blacklist_host_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_host = tokens.get("tk_input_metric_host_blacklist_host");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring_blacklist_host";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_metric_host_monitoring_blacklist_host | append [ | makeresults | eval metric_host=\"" + tk_input_blacklist_host + "\", metric_blacklist_state=\"true\" ] | dedup metric_host | sort limit=0 metric_host | outputlookup trackme_metric_host_monitoring_blacklist_host";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_host && tk_input_blacklist_host.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add blacklist host";
                            object = tk_input_blacklist_host;
                            object_category = "metric_host";
                            object_attrs = "host:" + tk_input_blacklist_host;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListMetricHostHost.startSearch();
                                    searchSingleBlackListMetricHostHost.startSearch();
                                    searchMetricHostsMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add blacklist host";
                                    object = tk_input_blacklist_host;
                                    object_category = "metric_host";
                                    object_attrs = "host:" + tk_input_blacklist_host;
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_metric_host_blacklist_host").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_delete_metric_host_blacklist_host").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // Get
            var tk_metric_host = tokens.get("tk_metric_host");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring_blacklist_host/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_metric_host_blacklist_host").modal('hide');

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchBlackListMetricHostHost.startSearch();
                        searchSingleBlackListMetricHostHost.startSearch();
                        searchMetricHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit
                        action = "success";
                        change_type = "delete blacklist host";
                        object = tk_metric_host;
                        object_category = "metric_host";
                        object_attrs = "host:" + tk_metric_host;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_metric_host_blacklist_host").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "delete blacklist host";
                        object = tk_metric_host;
                        object_category = "metric_host";
                        object_attrs = "host:" + tk_metric_host;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // Hide main modal
                        $("#modal_manage_metric_host_blacklist_host").modal('hide');
                        $("#modal_modify_metric_host_blacklist_host").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // metric_category blacklist

        $("#btn_modal_metric_host_blacklist_metric_category_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_metric_category = tokens.get("tk_input_metric_host_blacklist_metric_category");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring_blacklist_metric_category";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_metric_host_monitoring_blacklist_metric_category | append [ | makeresults | eval metric_category=\"" + tk_input_blacklist_metric_category + "\", metric_blacklist_state=\"true\" ] | dedup metric_category | sort limit=0 metric_category | outputlookup trackme_metric_host_monitoring_blacklist_metric_category";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_metric_category && tk_input_blacklist_metric_category.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit
                            action = "failure";
                            change_type = "add blacklist metric_category";
                            object = tk_input_blacklist_metric_category;
                            object_category = "metric_category";
                            object_attrs = "metric_category:" + tk_input_blacklist_metric_category;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListMetricHostMetricCategory.startSearch();
                                    searchPopulateMetricCategoriesForBlackListMetricHost.startSearch();
                                    searchMetricHostsMain.startSearch();
                                    unsetToken("form.tk_input_metric_host_blacklist_metric_category");

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit
                                    action = "success";
                                    change_type = "add blacklist metric_category";
                                    object = tk_input_blacklist_metric_category;
                                    object_category = "metric_category";
                                    object_attrs = "metric_category:" + tk_input_blacklist_metric_category;
                                    result = "N/A";
                                    comment = "N/A";
                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    $("#modal_modify_metric_host_blacklist_metric_category").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_delete_metric_host_blacklist_metric_category").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_metric_category = tokens.get("tk_metric_category");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring_blacklist_metric_category/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_metric_host_blacklist_metric_category").modal('hide');

                        // Audit
                        action = "success";
                        change_type = "delete blacklist metric_category";
                        object = tk_metric_category;
                        object_category = "metric_category";
                        object_attrs = "metric_category:" + tk_metric_category;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchBlackListMetricHostMetricCategory.startSearch();
                        searchPopulateMetricCategoriesForBlackListMetricHost.startSearch();
                        searchMetricHostsMain.startSearch();
                        unsetToken("form.tk_input_metric_host_blacklist_metric_category");

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_metric_host_blacklist_metric_category").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "delete blacklist metric_category";
                        object = tk_metric_category;
                        object_category = "metric_category";
                        object_attrs = "metric_category:" + tk_metric_category;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // Hide main modal
                        $("#modal_manage_metric_host_blacklist_metric_category").modal('hide');
                        $("#modal_modify_metric_host_blacklist_metric_category").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // data sources monitoring

        $("#btn_modal_modify_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_manage").modal();

        });

        // data hosts monitoring

        $("#btn_modal_modify_host_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_manage_host").modal();

        });

        //
        // Elastic sources
        //

        $('.btn_modify_elastic_sources_main').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_elastic_sources", "true");
                // Show input modal
                $("#modify_elastic_sources_main").modal();
            });

        });

        $('#btn_modal_elastic_sources_manage').click(function() {
                // Show input modal
                $("#modify_elastic_sources").modal();

                // Excplicitely refresh the search
                searchElasticSources.startSearch();
        });

        $('#btn_modal_elastic_sources_add').click(function() {
                // Default disable button add state
                document.getElementById('btn_modal_elastic_source_add_new').disabled = true;
                document.getElementById('btn_modal_elastic_source_dedicated_add_new').disabled = true;
                // Show input modal
                $("#add_elastic_sources").modal();
        });

        // Back
        $('#btn_modal_elastic_sources_add_back').click(function() {
                // Show input modal
                $("#modify_elastic_sources_main").modal();
        });

        $('#btn_modal_elastic_sources_add_new_back').click(function() {
                // Show input modal
                $("#modify_elastic_sources_main").modal();
        });

        $('#btn_modal_generic_search_error_back').click(function() {
                // Show input modal
                $("#add_elastic_sources").modal();
        });

        function elastic_sources_check_unique(data_name, status) {

            // Define the query
            var searchQuery = "| makeresults | eval data_name=\"" + data_name + "\" | lookup trackme_elastic_sources data_name OUTPUTNEW _key as found | eval is_unique=if(isnull(found), \"true\", \"false\") | fields - _time | fields is_unique";
            //console.log("searchQuery is: " + searchQuery);

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-5m",
                latest_time: "now"
            };

            // Run a oneshot search that returns the job's results
            service.oneshotSearch(
                searchQuery,
                searchParams,
                function(err, results) {

                    // Display the results
                    var fields = results.fields;
                    var rows = results.rows;
                    var is_unique;

                    for (var i = 0; i < rows.length; i++) {
                        var values = rows[i];

                        for (var j = 0; j < values.length; j++) {
                            var field = fields[j];

                            if (fields[j] == "is_unique") {
                                is_unique = values[j];
                            }
                        }
                    }

                    if (!is_unique) {
                        var start_simulation_elastic_sources = "false";
                        document.getElementById('btn_modal_elastic_source_add_new').disabled = true;
                        document.getElementById('btn_modal_elastic_source_dedicated_add_new').disabled = true;
                        setToken("start_simulation_elastic_sources", "false");
                        //console.log("result is undefined");
                    }

                    if (is_unique == "true" && status == "true") {
                        var start_simulation_elastic_sources = "true";
                        document.getElementById('btn_modal_elastic_source_add_new').disabled = false;
                        document.getElementById('btn_modal_elastic_dedicated_ource_add_new').disabled = false;
                        setToken("start_simulation_elastic_sources", "true");
                        //console.log("data source is unique");
                    }
                    else if (is_unique == "false") {
                        var start_simulation_elastic_sources = "false";
                        document.getElementById('btn_modal_elastic_source_add_new').disabled = true;
                        document.getElementById('btn_modal_elastic_source_dedicated_add_new').disabled = true;
                        setToken("start_simulation_elastic_sources", "false");
                        //console.log("data source is not unique");
                    }

                });

            return false;

        };

        // Run simulation
        $('#btn_modal_elastic_source_add_simulate').click(function(event) {
            event.stopImmediatePropagation();

            //console.log("Button was pressed");
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // disabled if enabled
            document.getElementById('btn_modal_elastic_source_add_new').disabled = true;
            document.getElementById('btn_modal_elastic_source_dedicated_add_new').disabled = true;

            // Get tokens
            var tk_input_elastic_source_search_type = tokens.get("tk_input_elastic_source_search_type");
            var tk_input_elastic_source_data_name = tokens.get("tk_input_elastic_source_data_name");
            var tk_input_elastic_source_elastic_data_index = tokens.get("tk_input_elastic_source_elastic_data_index");
            var tk_input_elastic_source_elastic_data_sourcetype = tokens.get("tk_input_elastic_source_elastic_data_sourcetype");
            var tk_input_elastic_source_earliest = tokens.get("tk_input_elastic_source_earliest");
            var tk_input_elastic_source_latest = tokens.get("tk_input_elastic_source_latest");

            // This is not a Splunk form
            var tk_input_elastic_source_search_constraint = document.getElementById("modal_input_elastic_source_search_constraint").value
            // the token used by the search needs to have escaped double quotes, but not the value to be stored in the KV
            var tk_raw_input_elastic_source_search_constraint = document.getElementById("modal_input_elastic_source_search_constraint").value
            tk_input_elastic_source_search_constraint = escapeDoubleQuotes(tk_input_elastic_source_search_constraint);
            setToken("tk_input_elastic_source_search_constraint", tk_input_elastic_source_search_constraint);
            //console.log(tk_input_elastic_source_search_constraint);

            // Start the search if all tokens are defined
            if (tk_input_elastic_source_search_type && tk_input_elastic_source_data_name && tk_input_elastic_source_elastic_data_index && tk_input_elastic_source_elastic_data_sourcetype && tk_input_elastic_source_search_constraint && tk_input_elastic_source_search_constraint!=="Enter the Splunk search constraint chain according to the type of search selected") {
                notification('Elastic source simulation started for data_name: ' +  tk_input_elastic_source_data_name + ', if the simulation is successful, click on save new elastic source to include this new source in the collection.', 6000)
                // Free the beast
                var start_simulation_elastic_sources = "true";
                var success_simulation_elastic_sources = "false";
                setToken("start_simulation_elastic_sources", "true");
                searchElasticSourcesTest.startSearch();

                searchElasticSourcesTest.on('search:error', function(properties) {
                    var start_simulation_elastic_sources = "false";
                    var success_simulation_elastic_sources = "false";
                    setToken("start_simulation_elastic_sources", "false");
                    document.getElementById('btn_modal_elastic_source_add_new').disabled = true;
                    document.getElementById('btn_modal_elastic_source_dedicated_add_new').disabled = true;
                    $("#add_elastic_sources").modal('hide');
                    $("#modal_generic_search_error").modal();
                });

                searchElasticSourcesTest.on('search:fail', function(properties) {
                    var start_simulation_elastic_sources = "false";
                    var success_simulation_elastic_sources = "false";
                    setToken("start_simulation_elastic_sources", "false");
                    document.getElementById('btn_modal_elastic_source_add_new').disabled = true;
                    document.getElementById('btn_modal_elastic_source_dedicated_add_new').disabled = true;
                    $("#add_elastic_sources").modal('hide');
                    $("#modal_generic_search_error").modal();
                });

                // If the search is processed successfully
                searchElasticSourcesTest.on('search:done', function(properties) {
                    var start_simulation_elastic_sources = "true";
                    document.getElementById('btn_modal_elastic_source_add_new').disabled = false;
                    document.getElementById('btn_modal_elastic_source_dedicated_add_new').disabled = false;
                    setToken("start_simulation_elastic_sources", "true");
                    // to do: this isn't stable enough yet
                    // elastic_sources_check_unique(tk_input_elastic_source_data_name, "true");
                });

            } else {
                unsetToken("start_simulation_elastic_sources");
                notification('ERROR: Entries are either incorrect or incomplete, please correct and try again.', 6000)
            }

            // add a new elastic source
            $('#btn_modal_elastic_source_add_new').click(function(event) {
                event.stopImmediatePropagation();

                // Get status
                var success_simulation_elastic_sources = tokens.get("start_simulation_elastic_sources");

                // Get tokens
                var tk_input_elastic_source_search_type = tokens.get("tk_input_elastic_source_search_type");
                var tk_input_elastic_source_data_name = tokens.get("tk_input_elastic_source_data_name");
                var tk_input_elastic_source_elastic_data_index = tokens.get("tk_input_elastic_source_elastic_data_index");
                var tk_input_elastic_source_elastic_data_sourcetype = tokens.get("tk_input_elastic_source_elastic_data_sourcetype");
                var tk_input_elastic_source_earliest = tokens.get("tk_input_elastic_source_earliest");
                var tk_input_elastic_source_latest = tokens.get("tk_input_elastic_source_latest");

                // This is not a Splunk form
                var tk_input_elastic_source_search_constraint = document.getElementById("modal_input_elastic_source_search_constraint").value
                // the token used by the search needs to have escaped double quotes, but not the value to be stored in the KV
                var tk_raw_input_elastic_source_search_constraint = document.getElementById("modal_input_elastic_source_search_constraint").value
                tk_input_elastic_source_search_constraint = escapeDoubleQuotes(tk_input_elastic_source_search_constraint);
                setToken("tk_input_elastic_source_search_constraint", tk_input_elastic_source_search_constraint);
                //console.log(tk_input_elastic_source_search_constraint);

                // disable the button once clicked
                document.getElementById('btn_modal_elastic_source_add_new').disabled = true;

                if (start_simulation_elastic_sources && start_simulation_elastic_sources == 'true') {

                    var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_elastic_sources/"

                    // Create a dictionary to store the field names and values
                    var record = {
                        "data_name": tk_input_elastic_source_data_name,
                        "search_constraint": tk_raw_input_elastic_source_search_constraint,
                        "search_mode": tk_input_elastic_source_search_type,
                        "elastic_data_index": tk_input_elastic_source_elastic_data_index,
                        "elastic_data_sourcetype": tk_input_elastic_source_elastic_data_sourcetype
                    };

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {

                            // Processed modal
                            //console.log("New elastic source added with data_name: " + tk_input_elastic_source_data_name);
                            // clean status
                            unsetToken("start_simulation_elastic_sources");
                            // Show message
                            msg = "The new elastic source: " +  tk_input_elastic_source_data_name + " was successfully added to the collection, manually run the tracker report \"TrackMe - Elastic sources shared tracker\" or wait for its next execution."
                            $("#add_elastic_source_processed").find('.modal-error-message p').text(msg);
                            $("#add_elastic_sources").modal('hide');
                            $("#add_elastic_source_processed").modal();

                            // Audit
                            action = "success";
                            change_type = "add elastic source";
                            object = tk_input_elastic_source_data_name;
                            object_category = "elastic_sources";
                            object_attrs = "search_mode:" + tk_input_elastic_source_search_type + ", search_constraint:" + tk_raw_input_elastic_source_search_constraint + ", elastic_data_index:" + tk_input_elastic_source_elastic_data_index + ", elastic_data_sourcetype:" + tk_input_elastic_source_elastic_data_sourcetype;;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            // house cleaning
                            myendpoint_URl = undefined;
                            delete(myendpoint_URl);

                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit
                            action = "failure";
                            change_type = "add elastic source";
                            object = tk_input_elastic_source_data_name;
                            object_category = "elastic_sources";
                            object_attrs = "search_mode:" + tk_input_elastic_source_search_type + ", search_constraint:" + tk_raw_input_elastic_source_search_constraint + ", elastic_data_index:" + tk_input_elastic_source_elastic_data_index + ", elastic_data_sourcetype:" + tk_input_elastic_source_elastic_data_sourcetype;;
                            result = "N/A";
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            // back tp main modal
                            $("#add_elastic_sources").modal('hide');
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }

                    });

                } else {
                    notification('ERROR: Please successfully run the simulation first.', 6000)
                }

            });

            $('#btn_modal_elastic_source_dedicated_add_new').click(function(event) {
                event.stopImmediatePropagation();

                // Get status
                var success_simulation_elastic_sources = tokens.get("start_simulation_elastic_sources");

                // Get tokens
                var tk_input_elastic_source_search_type = tokens.get("tk_input_elastic_source_search_type");
                var tk_input_elastic_source_data_name = tokens.get("tk_input_elastic_source_data_name");
                var tk_input_elastic_source_elastic_data_index = tokens.get("tk_input_elastic_source_elastic_data_index");
                var tk_input_elastic_source_elastic_data_sourcetype = tokens.get("tk_input_elastic_source_elastic_data_sourcetype");
                var tk_input_elastic_source_earliest = tokens.get("tk_input_elastic_source_earliest");
                var tk_input_elastic_source_latest = tokens.get("tk_input_elastic_source_latest");

                // This is not a Splunk form
                var tk_input_elastic_source_search_constraint = document.getElementById("modal_input_elastic_source_search_constraint").value
                // the token used by the search needs to have escaped double quotes, but not the value to be stored in the KV
                var tk_raw_input_elastic_source_search_constraint = document.getElementById("modal_input_elastic_source_search_constraint").value
                tk_input_elastic_source_search_constraint = escapeDoubleQuotes(tk_input_elastic_source_search_constraint);
                setToken("tk_input_elastic_source_search_constraint", tk_input_elastic_source_search_constraint);
                //console.log(tk_input_elastic_source_search_constraint);

                // disable the button once clicked
                document.getElementById('btn_modal_elastic_source_dedicated_add_new').disabled = true;

                if (start_simulation_elastic_sources && start_simulation_elastic_sources == 'true') {

                    // Create a unique name for the tracker
                    var tracker_name = "TrackMe - " + tk_input_elastic_source_data_name + " elastic tracker " + uuid();
                    setToken("tk_tracker_name", tracker_name);

                    // define the alert search
                    if (tk_input_elastic_source_search_type == "tstats") {
                        tk_elastic_alert_root_search = "| `trackme_tstats` max(_indextime) as data_last_ingest, min(_time) as data_first_time_seen, max(_time) as data_last_time_seen, count as data_eventcount where " + tk_raw_input_elastic_source_search_constraint + " | eval data_name=\"" + tk_input_elastic_source_data_name + "\", data_index=\"" + tk_input_elastic_source_elastic_data_index + "\", data_sourcetype=\"" + tk_input_elastic_source_elastic_data_sourcetype + "\", data_last_ingestion_lag_seen=data_last_ingest-data_last_time_seen | `trackme_elastic_dedicated_tracker(\"" + tk_input_elastic_source_data_name + "\")` | stats c";

                    } else if (tk_input_elastic_source_search_type == "raw") {
                        tk_elastic_alert_root_search = tk_raw_input_elastic_source_search_constraint + " | stats max(_indextime) as data_last_ingest, min(_time) as data_first_time_seen, max(_time) as data_last_time_seen, count as data_eventcount | eval data_name=\"" + tk_input_elastic_source_data_name +"\", data_index=\"" + tk_input_elastic_source_elastic_data_index + "\", data_sourcetype=\"" + tk_input_elastic_source_elastic_data_sourcetype + "\", data_last_ingestion_lag_seen=data_last_ingest-data_last_time_seen | `trackme_elastic_dedicated_tracker(\"" + tk_input_elastic_source_data_name + "\")` | stats c";

                    } else if (tk_input_elastic_source_search_type == "from") {
                        tk_elastic_alert_root_search = "| " + tk_input_elastic_source_search_type + " " + tk_raw_input_elastic_source_search_constraint + " | stats max(_indextime) as data_last_ingest, min(_time) as data_first_time_seen, max(_time) as data_last_time_seen, count as data_eventcount | eval data_name=\"" + tk_input_elastic_source_data_name + "\", data_index=\"" + tk_input_elastic_source_elastic_data_index + "\", data_sourcetype=\"" + tk_input_elastic_source_elastic_data_sourcetype + "\" | `trackme_elastic_dedicated_tracker(\"" + tk_input_elastic_source_data_name + "\")` | stats c";

                    } else if (tk_input_elastic_source_search_type == "mstats") {
                        tk_elastic_alert_root_search = "| mstats latest(_value) as value where " + tk_raw_input_elastic_source_search_constraint + " by metric_name span=1s | stats min(_time) as data_first_time_seen, max(_time) as data_last_time_seen, dc(metric_name) as data_eventcount | eval data_name=\"" + tk_input_elastic_source_data_name + "\", data_index=\"" + tk_input_elastic_source_elastic_data_index + "\", data_sourcetype=\"" + tk_input_elastic_source_elastic_data_sourcetype + "\", data_last_ingest=data_last_time_seen, data_last_ingestion_lag_seen=now()-data_last_time_seen | `trackme_elastic_dedicated_tracker(\"" + tk_input_elastic_source_data_name + "\")` | stats c" ;
                    }

                    //console.log("tk_elastic_alert_root_search is: " + tk_elastic_alert_root_search);

                    function done(err) {
                        //error handling logic here
                    }

                    // Specify properties for the alert.
                    var alertOptions = {
                        name: tracker_name,
                        description: "Dedicated elastic tracker for data source",
                        search: tk_elastic_alert_root_search,
                        "dispatch.earliest_time": tk_input_elastic_source_earliest,
                        "dispatch.latest_time": tk_input_elastic_source_latest,
                        "is_scheduled": "1",
                        "cron_schedule": "*/5 * * * *"
                    };

                    // Create a saved search/report as an alert.
                    service.savedSearches().create(alertOptions, function(err, alert) {
                        // Error checking.
                        if (err && err.status === 409) {
                            msg = "ERROR: A saved search/report with the name " + alertOptions.name + " already exists";

                            // Audit
                            action = "failure";
                            change_type = "add elastic source tracker";
                            object = tracker_name;
                            object_category = "elastic_sources_tracker";
                            object_attrs = tk_elastic_alert_root_search;
                            result = msg;
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_elastic_source_alert_creation_error").find('.modal-error-message p').text(msg);
                            $("#add_elastic_sources").modal('hide');
                            $("#modal_elastic_source_alert_creation_success").modal()
                            done();
                            return;
                        }
                        else if (err) {
                            msg = "There was an error creating the saved search/report: " + err;

                            // Audit
                            action = "failure";
                            change_type = "add elastic source tracker";
                            object = tracker_name;
                            object_category = "elastic_sources_tracker";
                            object_attrs = tk_elastic_alert_root_search;
                            result = msg;
                            comment = "N/A";
                            auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            $("#modal_elastic_source_alert_creation_error").find('.modal-error-message p').text(msg);
                            $("#add_elastic_sources").modal('hide');
                            $("#modal_elastic_source_alert_creation_success").modal()
                            done(err);
                            return;
                        }

                        // clean status
                        unsetToken("start_simulation_elastic_sources");

                        // Confirmation message.

                        // Audit
                        action = "success";
                        change_type = "add elastic source tracker";
                        object = tracker_name;
                        object_category = "elastic_sources_tracker";
                        object_attrs = tk_elastic_alert_root_search;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // Store in the KVstore for mapping purposes
                            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_elastic_sources_dedicated/"

                            // Create a dictionary to store the field names and values
                            var record = {
                                "data_name": tk_input_elastic_source_data_name,
                                "search_constraint": tk_raw_input_elastic_source_search_constraint,
                                "search_mode": tk_input_elastic_source_search_type,
                                "elastic_data_index": tk_input_elastic_source_elastic_data_index,
                                "elastic_data_sourcetype": tk_input_elastic_source_elastic_data_sourcetype
                            };
                            $.ajax({
                                url: myendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(record),
                                success: function(returneddata) {
                                    // house cleaning
                                    myendpoint_URl = undefined;
                                    delete(myendpoint_URl);
                                },
                                error: function(xhr, textStatus, error) {
                                    message = "Error Updating!" + xhr + textStatus + error;
                                }
                            });

                        msg = "Created saved search/report as alert: " + alert.name;
                        $("#modal_elastic_source_alert_creation_success").find('.modal-error-message p').text(msg);
                        $("#add_elastic_sources").modal('hide');
                        $("#modal_elastic_source_alert_creation_success").modal()

                        done();
                    });

                } else {
                    notification('ERROR: Please successfully run the simulation first.', 6000)
                }

            });

        });

        // run elastic shared tracker now
        $("#add_elastic_source_processed_run_tracker").click(function() {

            //console.log("Button was pressed");
            $("#add_elastic_source_processed").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - Elastic sources shared tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-4h",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Running the Elastic Shared Tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                // Once the job is done, update all searches
                                searchDataSourcesMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        // run elastic shared tracker now
        $("#modal_elastic_source_alert_creation_success_run_tracker").click(function() {

            //console.log("Button was pressed");
            $("#modal_elastic_source_alert_creation_success").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Get the tracker name
            var tk_tracker_name = tokens.get("tk_tracker_name");

            // Define the query
            var searchQuery = "| savedsearch \"" + tk_tracker_name + "\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-4h",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Running the dedicated elastic tracker' +  tk_tracker_name + '...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                // Once the job is done, update all searches
                                searchDataSourcesMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        // delete elastic source

        $("#btn_delete_elastic_source_confirm").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_elastic_sources/" + tk_keyid;

            // Get tokens
            var tk_keyid = tokens.get("tk_keyid");
            var tk_elastic_source_data_name = tokens.get("tk_elastic_source_data_name");
            var tk_elastic_source_search_mode = tokens.get("tk_elastic_source_search_mode");
            var tk_elastic_source_search_constraint = tokens.get("tk_elastic_source_search_constraint");
            var tk_elastic_source_elastic_data_index = tokens.get("tk_elastic_source_elastic_data_index");
            var tk_elastic_source_elastic_data_sourcetype = tokens.get("tk_elastic_source_elastic_data_sourcetype");

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#btn_delete_elastic_source_confirm").modal('hide');

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchElasticSources.startSearch();

                        // Audit
                        action = "success";
                        change_type = "delete elastic source";
                        object = tk_elastic_source_data_name;
                        object_category = "elastic_sources";
                        object_attrs = "search_mode:" + tk_elastic_source_search_mode + ", search_constraint:" + tk_elastic_source_search_constraint + ", elastic_data_index:" + tk_elastic_source_elastic_data_index + ", elastic_data_sourcetype:" + tk_elastic_source_elastic_data_sourcetype;;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modify_elastic_sources").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "delete elastic source";
                        object = tk_elastic_source_data_name;
                        object_category = "elastic_sources";
                        object_attrs = "search_mode:" + tk_elastic_source_search_mode + ", search_constraint:" + tk_elastic_source_search_constraint + ", elastic_data_index:" + tk_elastic_source_elastic_data_index + ", elastic_data_sourcetype:" + tk_elastic_source_elastic_data_sourcetype;;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // back tp main modal
                        $("#btn_delete_elastic_source_confirm").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        //
        // Custom lagging classes
        //

        $('.btn_modify_custom_lagging').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_custom_lagging", "true");
                // Show input modal
                $("#modify_custom_lagging").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_custom_lagging_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modify_custom_lagging").modal();

        });

        //
        // Metrics SLA policies in-modal editor
        //

        $('.btn_modify_metric_sla_policies').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_metric_sla_policies", "true");
                // Show input modal
                $("#modal_metric_sla_policies").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_metric_sla_policy_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_metric_sla_policies").modal();

        });

        //
        // allowlisting data source
        //

        $('.btn_modify_data_source_whitelist').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_source_whitelist", "true");
                // Show input modal
                $("#modal_modify_data_source_whitelist").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_source_whitelist_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_source_whitelist").modal();

        });

        //
        // allowlisting data host
        //

        $('.btn_modify_data_host_whitelist').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_host_whitelist", "true");
                // Show input modal
                $("#modal_modify_data_host_whitelist").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_host_whitelist_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_host_whitelist").modal();

        });

        //
        // allowlisting metric host
        //

        $('.btn_modify_metric_host_whitelist').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_metric_host_whitelist", "true");
                // Show input modal
                $("#modal_modify_metric_host_whitelist").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_metric_host_whitelist_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_metric_host_whitelist").modal();

        });

        //
        // blacklisting data source
        //

        // host blacklist

        $('.btn_modify_data_source_blacklist_host').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_source_blacklist_host", "true");
                // Show input modal
                $("#modal_modify_data_source_blacklist_host").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_source_blacklist_host_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_source_blacklist_host").modal();

        });

        // indexe blacklist

        $('.btn_modify_data_source_blacklist_index').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_source_blacklist_index", "true");
                // Show input modal
                $("#modal_modify_data_source_blacklist_index").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_source_blacklist_index_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_source_blacklist_index").modal();

        });

        // sourcetype blacklist

        $('.btn_modify_data_source_blacklist_sourcetype').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_source_blacklist_sourcetype", "true");
                // Show input modal
                $("#modal_modify_data_source_blacklist_sourcetype").modal();
            });

        });

        // blacklisting data host

        // host blacklist

        $('.btn_modify_data_host_blacklist_host').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_host_blacklist_host", "true");
                // Show input modal
                $("#modal_modify_data_host_blacklist_host").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_host_blacklist_host_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_host_blacklist_host").modal();

        });

        // indexe blacklist

        $('.btn_modify_data_host_blacklist_index').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_host_blacklist_index", "true");
                // Show input modal
                $("#modal_modify_data_host_blacklist_index").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_host_blacklist_index_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_host_blacklist_index").modal();

        });

        // sourcetype blacklist

        $('.btn_modify_data_host_blacklist_sourcetype').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_host_blacklist_sourcetype", "true");
                // Show input modal
                $("#modal_modify_data_host_blacklist_sourcetype").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_host_blacklist_sourcetype_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_host_blacklist_sourcetype").modal();

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_source_blacklist_sourcetype_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_source_blacklist_sourcetype").modal();

        });

        // metric_host blacklist

        // host blacklist

        $('.btn_modify_metric_host_blacklist_host').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_metric_host_blacklist_host", "true");
                // Show input modal
                $("#modal_modify_metric_host_blacklist_host").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_metric_host_blacklist_host_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_metric_host_blacklist_host").modal();

        });

        // indexe blacklist

        $('.btn_modify_metric_host_blacklist_index').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_metric_host_blacklist_index", "true");
                // Show input modal
                $("#modal_modify_metric_host_blacklist_index").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_metric_host_blacklist_index_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_metric_host_blacklist_index").modal();

        });

        // metric category
        $('.btn_modify_metric_host_blacklist_metric_category').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_metric_host_blacklist_metric_category", "true");
                // Show input modal
                $("#modal_modify_metric_host_blacklist_metric_category").modal();
            });

        });

        // Ops: Indexer queues
        $('.btn_ops_index_queue').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("tk_start_indexers_queues_searches", "true");

                // Show input modal
                $("#modal_queues").modal();
            });

        });

        // Unset token when bootstrap modal is closed properly
        $("#btn_ops_index_queue_close").click(function() {
            submitTokens();

            unsetToken("tk_start_indexers_queues_searches");

        });

        // Ops: Parsing issues

        $('.btn_ops_parsing_issues').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("tk_start_parsing_issues_searches", "true");

                // Manage search button URLs

                // Define the history search
                var search_parsing_issues_linebreaking = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + '//app/trackme/search' + "?q=search%20" + encodeURI("index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=LineBreakingProcessor")

                // Define the URL target
                document.getElementById("btn_search_parsing_issues_linebreaking").href = search_parsing_issues_linebreaking;

                // Define the history search
                var search_parsing_issues_aggregator = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + '//app/trackme/search' + "?q=search%20" + encodeURI("index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=AggregatorMiningProcessor")

                // Define the URL target
                document.getElementById("btn_search_parsing_issues_aggregator").href = search_parsing_issues_aggregator;

                // Define the history search
                var search_parsing_issues_dateparser = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + '//app/trackme/search' + "?q=search%20" + encodeURI("index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=DateParserVerbose")

                // Define the URL target
                document.getElementById("btn_search_parsing_issues_dateparser").href = search_parsing_issues_dateparser;

                // Show input modal
                $("#modal_parsing_issues").modal();
            });

        });

        // Unset token when bootstrap modal is closed properly
        $("#btn_ops_parsing_issues_close").click(function() {
            submitTokens();

            unsetToken("tk_start_parsing_issues_searches");

        });

        //
        // RUN TRACKERS
        //

        //
        // UPDATE COLLECTION
        //

        // Call this function when the Update collection button is clicked

        $("#btn_run_tracker").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            //console.log("Start collection update");

            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - Data sources availability short term tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-4h",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Running the data sources short term tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                // Once the job is done, update all searches
                                searchDataSourcesMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        $("#btn_run_tracker_host").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            //console.log("Start collection update");

            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - hosts availability short term tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-4h",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Running the host short term tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                // Once the job is done, update all searches
                                searchDataHostsMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        // Call this function when the Update collection button is clicked

        $("#btn_run_tracker_longterm").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");


            //console.log("Start collection update");

            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - Data sources availability long term tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-7d",
                latest_time: "+4h"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Running the data sources long term tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                // Once the job is done, update all searches
                                searchDataSourcesMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        $("#btn_run_tracker_host_longterm").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");


            //console.log("Start collection update");

            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - hosts availability long term tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-7d",
                latest_time: "+4h"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Running the host long term tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                // Once the job is done, update all searches
                                searchDataHostsMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        // metric host

        $("#btn_run_tracker_metric_host").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            //console.log("Start collection update");

            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - metric hosts availability tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-5m",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Running the metric tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                // Once the job is done, update all searches
                                searchMetricHostsMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        // Show main

        // for data sources

        $("#btn_modify_data_source_blacklist_main").click(function() {
            // Show input modal
            $("#modal_manage_data_source_blacklists").modal();
        });

        // Cancel buttons

        $("#btn_modal_data_source_whitelist_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_source_blacklists").modal();
        });

        $("#btn_modal_data_source_blacklist_host_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_source_blacklists").modal();
        });

        $("#btn_modal_data_source_blacklist_index_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_source_blacklists").modal();
        });

        $("#btn_modal_data_source_blacklist_sourcetype_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_source_blacklists").modal();
        });

        // for data hosts

        // for data sources

        $("#btn_modify_data_host_blacklist_main").click(function() {
            // Show input modal
            $("#modal_manage_data_host_blacklists").modal();
        });

        // for metric indexes
        $("#btn_modify_metric_host_blacklist_main").click(function() {
            // Show input modal
            $("#modal_manage_metric_host_blacklists").modal();
        });

        // Cancel buttons

        $("#btn_modal_data_host_whitelist_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_host_blacklists").modal();
        });

        $("#btn_modal_data_host_blacklist_index_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_host_blacklists").modal();
        });

        $("#btn_modal_metric_host_blacklist_index_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_metric_host_blacklists").modal();
        });

        $("#btn_modal_data_host_blacklist_sourcetype_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_host_blacklists").modal();
        });

        $("#btn_modal_data_host_blacklist_host_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_host_blacklists").modal();
        });

        $("#btn_modal_metric_host_blacklist_host_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_metric_host_blacklists").modal();
        });

        $("#btn_modal_metric_host_whitelist_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_metric_host_blacklists").modal();
        });

        $("#btn_modal_metric_host_blacklist_metric_category_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_metric_host_blacklists").modal();
        });

        //
        // MODIFY BUTTON
        //

        // data source monitoring

        $("#btn_modify_data_source").click(function() {
            submitTokens();

            // Hide main modal
            $("#modal_manage").modal('hide');

            // Show input modal
            $("#modal_modify_data_source_unified").modal();

        });

        // cancel button: returns to selected
        $("#btn_close_data_source_unified").click(function() {
            submitTokens();

            // Show modal
            $("#modal_manage").modal();

        });

        $("#btn_modal_modify_wdays").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_monitoring_wdays").modal();

        });

        $("#btn_modal_modify_monitoring_wdays_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_last_lag_seen_idx = tokens.get("tk_data_last_lag_seen_idx");
            var tk_data_last_time_seen_idx = tokens.get("tk_data_last_time_seen_idx");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_monitoring_level = tokens.get("tk_data_monitoring_level");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_source_state = tokens.get("tk_data_source_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_source_state = tokens.get("tk_data_previous_source_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");

            //console.log("Value of modal_input_grace_period is: " + tk_kafka_infra_grace_period);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring/" + tk_keyid;

            var tk_origin_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitoring_wdays = tokens.get("tk_input_wdays");

            if (!tk_data_monitoring_wdays || !tk_data_monitoring_wdays.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "object_category": "data_source",
                    "data_name": tk_data_name,
                    "data_index": tk_data_index,
                    "data_sourcetype": tk_data_sourcetype,
                    "data_last_lag_seen": tk_data_last_lag_seen,
                    "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                    "data_eventcount": tk_data_eventcount,
                    "data_first_time_seen": tk_data_first_time_seen,
                    "data_last_time_seen": tk_data_last_time_seen,
                    "data_last_ingest": tk_data_last_ingest,
                    "data_last_lag_seen_idx": tk_data_last_lag_seen_idx,
                    "data_last_time_seen_idx": tk_data_last_time_seen_idx,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_monitored_state": tk_data_monitored_state,
                    "data_monitoring_level": tk_data_monitoring_level,
                    "data_monitoring_wdays": tk_data_monitoring_wdays,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "data_source_state": tk_data_source_state,
                    "data_tracker_runtime": tk_data_tracker_runtime,
                    "data_previous_source_state": tk_data_previous_source_state,
                    "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                    "OutlierMinEventCount": tk_outliermineventcount,
                    "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                    "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                    "OutlierAlertOnUpper": tk_outlieralertonupper,
                    "OutlierTimePeriod": tk_outlier_period,
                    "OutlierSpan": tk_outlier_span,
                    "isOutlier": tk_isoutlier,
                    "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                    "latest_flip_state": tk_latest_flip_state,
                    "latest_flip_time": tk_latest_flip_time,
                    "priority": tk_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchDataSourcesMain.startSearch();

                        // call update data source
                        updateDataSource(tk_keyid);

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit
                        action = "success";
                        change_type = "modify week days monitoring";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);

                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "modify week days monitoring";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }

        });

        // priority
        $("#btn_modal_modify_priority_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_last_lag_seen_idx = tokens.get("tk_data_last_lag_seen_idx");
            var tk_data_last_time_seen_idx = tokens.get("tk_data_last_time_seen_idx");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_monitoring_level = tokens.get("tk_data_monitoring_level");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_source_state = tokens.get("tk_data_source_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_source_state = tokens.get("tk_data_previous_source_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");

            //console.log("Value of modal_input_grace_period is: " + tk_kafka_infra_grace_period);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring/" + tk_keyid;

            var tk_origin_priority = tk_priority;
            var tk_new_priority = tokens.get("tk_input_priority");

            if (!tk_new_priority || !tk_new_priority.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "object_category": "data_source",
                    "data_name": tk_data_name,
                    "data_index": tk_data_index,
                    "data_sourcetype": tk_data_sourcetype,
                    "data_last_lag_seen": tk_data_last_lag_seen,
                    "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                    "data_eventcount": tk_data_eventcount,
                    "data_first_time_seen": tk_data_first_time_seen,
                    "data_last_time_seen": tk_data_last_time_seen,
                    "data_last_ingest": tk_data_last_ingest,
                    "data_last_lag_seen_idx": tk_data_last_lag_seen_idx,
                    "data_last_time_seen_idx": tk_data_last_time_seen_idx,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_monitored_state": tk_data_monitored_state,
                    "data_monitoring_level": tk_data_monitoring_level,
                    "data_monitoring_wdays": tk_data_monitoring_wdays,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "data_source_state": tk_data_source_state,
                    "data_tracker_runtime": tk_data_tracker_runtime,
                    "data_previous_source_state": tk_data_previous_source_state,
                    "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                    "OutlierMinEventCount": tk_outliermineventcount,
                    "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                    "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                    "OutlierAlertOnUpper": tk_outlieralertonupper,
                    "OutlierTimePeriod": tk_outlier_period,
                    "OutlierSpan": tk_outlier_span,
                    "isOutlier": tk_isoutlier,
                    "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                    "latest_flip_state": tk_latest_flip_state,
                    "latest_flip_time": tk_latest_flip_time,
                    "priority": tk_new_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchDataSourcesMain.startSearch();

                        // call update data source
                        updateDataSource(tk_keyid);

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit
                        action = "success";
                        change_type = "modify priority";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = "priority changed from:" + tk_origin_priority + " to:" + tk_new_priority;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);

                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "modify priority";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = "priority changed from:" + tk_origin_priority + " to:" + tk_new_priority;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }

        });

        $("#btn_modal_modify_wdays_no").click(function() {

            // Show input modal
            $("#modal_modify_monitoring_wdays_no").modal();

        });

        $("#btn_modal_modify_monitoring_wdays_no_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_last_lag_seen_idx = tokens.get("tk_data_last_lag_seen_idx");
            var tk_data_last_time_seen_idx = tokens.get("tk_data_last_time_seen_idx");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_monitoring_level = tokens.get("tk_data_monitoring_level");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_source_state = tokens.get("tk_data_source_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_source_state = tokens.get("tk_data_previous_source_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");

            //console.log("Value of modal_input_grace_period is: " + tk_kafka_infra_grace_period);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring/" + tk_keyid;

            var tk_origin_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitoring_wdays_no = tokens.get("tk_input_wdays_no");

            if (!tk_data_monitoring_wdays_no || !tk_data_monitoring_wdays_no.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "object_category": "data_source",
                    "data_name": tk_data_name,
                    "data_index": tk_data_index,
                    "data_sourcetype": tk_data_sourcetype,
                    "data_last_lag_seen": tk_data_last_lag_seen,
                    "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                    "data_eventcount": tk_data_eventcount,
                    "data_first_time_seen": tk_data_first_time_seen,
                    "data_last_time_seen": tk_data_last_time_seen,
                    "data_last_ingest": tk_data_last_ingest,
                    "data_last_lag_seen_idx": tk_data_last_lag_seen_idx,
                    "data_last_time_seen_idx": tk_data_last_time_seen_idx,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_monitored_state": tk_data_monitored_state,
                    "data_monitoring_level": tk_data_monitoring_level,
                    "data_monitoring_wdays": tk_data_monitoring_wdays_no,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "data_source_state": tk_data_source_state,
                    "data_tracker_runtime": tk_data_tracker_runtime,
                    "data_previous_source_state": tk_data_previous_source_state,
                    "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                    "OutlierMinEventCount": tk_outliermineventcount,
                    "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                    "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                    "OutlierAlertOnUpper": tk_outlieralertonupper,
                    "OutlierTimePeriod": tk_outlier_period,
                    "OutlierSpan": tk_outlier_span,
                    "isOutlier": tk_isoutlier,
                    "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                    "latest_flip_state": tk_latest_flip_state,
                    "latest_flip_time": tk_latest_flip_time,
                    "priority": tk_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchDataSourcesMain.startSearch();

                        $("#modal_modify_data_source_unified").modal();

                        // call update data source
                        updateDataSource(tk_keyid);

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit
                        action = "success";
                        change_type = "modify week days monitoring";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays_no;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "modify week days monitoring";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays_no;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        // cancel: returns to unified modal
        $("#btn_modal_modify_monitoring_wdays_no_cancel").click(function() {

            // Show input modal
            $("#modal_modify_data_source_unified").modal();

        });

        //
        // Modify monitoring level
        //

        $("#btn_modal_modify_level").click(function() {

            // Show input modal
            $("#modal_modify_monitoring_level").modal();

        });

        $("#btn_modal_modify_monitoring_level_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_last_lag_seen_idx = tokens.get("tk_data_last_lag_seen_idx");
            var tk_data_last_time_seen_idx = tokens.get("tk_data_last_time_seen_idx");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_monitoring_level = tokens.get("tk_data_monitoring_level");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_source_state = tokens.get("tk_data_source_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_source_state = tokens.get("tk_data_previous_source_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");

            //console.log("Value of modal_input_grace_period is: " + tk_kafka_infra_grace_period);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring/" + tk_keyid;

            var tk_data_monitoring_level = tokens.get("tk_input_level");
            var tk_origin_data_monitoring_level = tokens.get("tk_data_monitoring_level");

            if (!tk_data_monitoring_level || !tk_data_monitoring_level.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "object_category": "data_source",
                    "data_name": tk_data_name,
                    "data_index": tk_data_index,
                    "data_sourcetype": tk_data_sourcetype,
                    "data_last_lag_seen": tk_data_last_lag_seen,
                    "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                    "data_eventcount": tk_data_eventcount,
                    "data_first_time_seen": tk_data_first_time_seen,
                    "data_last_time_seen": tk_data_last_time_seen,
                    "data_last_ingest": tk_data_last_ingest,
                    "data_last_lag_seen_idx": tk_data_last_lag_seen_idx,
                    "data_last_time_seen_idx": tk_data_last_time_seen_idx,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_monitored_state": tk_data_monitored_state,
                    "data_monitoring_level": tk_data_monitoring_level,
                    "data_monitoring_wdays": tk_data_monitoring_wdays,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "data_source_state": tk_data_source_state,
                    "data_tracker_runtime": tk_data_tracker_runtime,
                    "data_previous_source_state": tk_data_previous_source_state,
                    "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                    "OutlierMinEventCount": tk_outliermineventcount,
                    "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                    "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                    "OutlierAlertOnUpper": tk_outlieralertonupper,
                    "OutlierTimePeriod": tk_outlier_period,
                    "OutlierSpan": tk_outlier_span,
                    "isOutlier": tk_isoutlier,
                    "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                    "latest_flip_state": tk_latest_flip_state,
                    "latest_flip_time": tk_latest_flip_time,
                    "priority": tk_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchDataSourcesMain.startSearch();

                        // call update data source
                        updateDataSource(tk_keyid);

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit
                        action = "success";
                        change_type = "modify monitoring level";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = "data_monitoring_level changed from:" + tk_origin_data_monitoring_level + " to:" + tk_data_monitoring_level;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "modify monitoring level";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = "data_monitoring_level changed from:" + tk_origin_data_monitoring_level + " to:" + tk_data_monitoring_level;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        //
        // Modify lag
        //

        $("#btn_modal_modify_lag").click(function() {

            // Show input modal
            $("#modal_modify_lag").modal();

        });

        $("#btn_modal_modify_lag_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_last_lag_seen_idx = tokens.get("tk_data_last_lag_seen_idx");
            var tk_data_last_time_seen_idx = tokens.get("tk_data_last_time_seen_idx");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_monitoring_level = tokens.get("tk_data_monitoring_level");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_source_state = tokens.get("tk_data_source_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_source_state = tokens.get("tk_data_previous_source_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");

            //console.log("Value of modal_input_grace_period is: " + tk_kafka_infra_grace_period);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring/" + tk_keyid;

            var tk_data_max_lag_allowed = tokens.get("tk_input_lag");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class");

            if (!tk_data_max_lag_allowed || !tk_data_max_lag_allowed.length || !isNumeric(tk_data_max_lag_allowed)) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "object_category": "data_source",
                    "data_name": tk_data_name,
                    "data_index": tk_data_index,
                    "data_sourcetype": tk_data_sourcetype,
                    "data_last_lag_seen": tk_data_last_lag_seen,
                    "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                    "data_eventcount": tk_data_eventcount,
                    "data_first_time_seen": tk_data_first_time_seen,
                    "data_last_time_seen": tk_data_last_time_seen,
                    "data_last_ingest": tk_data_last_ingest,
                    "data_last_lag_seen_idx": tk_data_last_lag_seen_idx,
                    "data_last_time_seen_idx": tk_data_last_time_seen_idx,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_monitored_state": tk_data_monitored_state,
                    "data_monitoring_level": tk_data_monitoring_level,
                    "data_monitoring_wdays": tk_data_monitoring_wdays,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "data_source_state": tk_data_source_state,
                    "data_tracker_runtime": tk_data_tracker_runtime,
                    "data_previous_source_state": tk_data_previous_source_state,
                    "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                    "OutlierMinEventCount": tk_outliermineventcount,
                    "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                    "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                    "OutlierAlertOnUpper": tk_outlieralertonupper,
                    "OutlierTimePeriod": tk_outlier_period,
                    "OutlierSpan": tk_outlier_span,
                    "isOutlier": tk_isoutlier,
                    "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                    "latest_flip_state": tk_latest_flip_state,
                    "latest_flip_time": tk_latest_flip_time,
                    "priority": tk_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchDataSourcesMain.startSearch();
                        // call update data source
                        updateDataSource(tk_keyid);
                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit
                        action = "success";
                        change_type = "modify monitoring lag";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = "data_max_lag_allowed changed from:" + tk_origin_data_max_lag_allowed + " to:" + tk_data_max_lag_allowed + " with data_override_lagging_class:" + tk_data_override_lagging_class;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "modify monitoring lag";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = "data_max_lag_allowed changed from:" + tk_origin_data_max_lag_allowed + " to:" + tk_data_max_lag_allowed + " with data_override_lagging_class:" + tk_data_override_lagging_class;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        // Show main modal
        $("#btn_modal_modify_lag_auto_main").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Free the searches
            setToken("show_data_source_autolagging", "true");

            // Show modal
            $("#modal_modify_data_source_autolag").modal();
        });

        // Show main modal back
        $("#btn_close_data_source_unified_autolag").click(function() {
            $("#modal_modify_data_source_unified").modal();
        });

        $("#btn_modal_modify_lag_auto_perc95").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class");

            //console.log("Start collection update");

            // Define the query
            var searchQuery = "| `trackme_tstats` count latest(_indextime) as indextime where index=\"" + tk_data_index + "\" sourcetype=\"" + tk_data_sourcetype + "\"  by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats perc95(delta) as value | eval data_name=\"" + tk_data_name + "\", data_override_lagging_class=\"" + tk_data_override_lagging_class + "\" | lookup trackme_data_source_monitoring data_name OUTPUT _key as keyid | lookup trackme_data_source_monitoring data_name | eval data_max_lag_allowed=if(value>0, round(value, 0), data_max_lag_allowed), value=round(value, 0) | outputlookup trackme_data_source_monitoring key_field=keyid";
            //console.log(searchQuery);

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-7d",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    // hide the current modal
                    $("#modal_modify_data_source_unified").modal('hide');

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Please wait while determining the entity lagging value...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                $("#loadingGray").remove()

                                // if the action is very fast, the modal may fail, show up after 1 sec
                                setTimeout(function(){
                                  $("#modal_modify_data_source_unified").modal()
                                }, 1000);

                                // Get the results and display them
                                job.results({}, function(err, results) {
                                    var fields = results.fields;
                                    var rows = results.rows;
                                    for (var i = 0; i < rows.length; i++) {
                                        var values = rows[i];
                                        //console.log("Row " + i + ": ");
                                        for (var j = 0; j < values.length; j++) {
                                            var field = fields[j];
                                            var value = values[j];

                                            if (field == "data_max_lag_allowed") {
                                                //console.log("  " + field + ": " + value);

                                                if (value === '0') {
                                                    notification('ERROR: No live data available for this entity, automatic lagging calculation cannot be performed for inactive entities.', 6000)
                                                } else {
                                                    // Run the search again to update the table
                                                    searchDataSourcesMain.startSearch();

                                                    // notify
                                                    notification('Modification has been registered successfully, max lagging value automatically defined to ' + value + ' seconds.', 6000)

                                                    setToken("tk_data_max_lag_allowed", value);
                                                    setToken("form.tk_input_lag", value);
                                                    tk_data_max_lag_allowed = value;

                                                    // Audit success change
                                                    action = "success";
                                                    change_type = "apply auto defined monitoring lag";
                                                    object = tk_data_name;
                                                    object_category = "data_source";
                                                    object_attrs = "data_max_lag_allowed changed from:" + tk_origin_data_max_lag_allowed + " to:" + tk_data_max_lag_allowed + " with data_override_lagging_class:" + tk_data_override_lagging_class;
                                                    result = "N/A";
                                                    comment = "N/A";
                                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                                }

                                            }

                                        }
                                    }
                                })

                                // call update data source
                                updateDataSource(tk_keyid);

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = errorStr;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = err;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);
                            }
                        });
                    }
                }
            );

        });

        $("#btn_modal_modify_lag_auto_average").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class");

            //console.log("Start collection update");

            // Define the query
            var searchQuery = "| `trackme_tstats` count latest(_indextime) as indextime where index=\"" + tk_data_index + "\" sourcetype=\"" + tk_data_sourcetype + "\"  by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats avg(delta) as value | eval data_name=\"" + tk_data_name + "\", data_override_lagging_class=\"" + tk_data_override_lagging_class + "\" | lookup trackme_data_source_monitoring data_name OUTPUT _key as keyid | lookup trackme_data_source_monitoring data_name | eval data_max_lag_allowed=if(value>0, round(value, 0), data_max_lag_allowed), value=round(value, 0) | outputlookup trackme_data_source_monitoring key_field=keyid";
            //console.log(searchQuery);

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-7d",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    // hide the current modal
                    $("#modal_modify_data_source_unified").modal('hide');

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Please wait while determining the entity lagging value...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                $("#loadingGray").remove()

                                // if the action is very fast, the modal may fail, show up after 1 sec
                                setTimeout(function(){
                                  $("#modal_modify_data_source_unified").modal()
                                }, 1000);

                                // Get the results and display them
                                job.results({}, function(err, results) {
                                    var fields = results.fields;
                                    var rows = results.rows;
                                    for (var i = 0; i < rows.length; i++) {
                                        var values = rows[i];
                                        //console.log("Row " + i + ": ");
                                        for (var j = 0; j < values.length; j++) {
                                            var field = fields[j];
                                            var value = values[j];

                                            if (field == "data_max_lag_allowed") {
                                                //console.log("  " + field + ": " + value);

                                                if (value === '0') {
                                                    notification('ERROR: No live data available for this entity, automatic lagging calculation cannot be performed for inactive entities.', 6000)
                                                } else {
                                                    // Run the search again to update the table
                                                    searchDataSourcesMain.startSearch();

                                                    // notify
                                                    notification('Modification has been registered successfully, max lagging value automatically defined to ' + value + ' seconds.', 6000)

                                                    setToken("tk_data_max_lag_allowed", value);
                                                    setToken("form.tk_input_lag", value);
                                                    tk_data_max_lag_allowed = value;

                                                    // Audit success change
                                                    action = "success";
                                                    change_type = "apply auto defined monitoring lag";
                                                    object = tk_data_name;
                                                    object_category = "data_source";
                                                    object_attrs = "data_max_lag_allowed changed from:" + tk_origin_data_max_lag_allowed + " to:" + tk_data_max_lag_allowed + " with data_override_lagging_class:" + tk_data_override_lagging_class;
                                                    result = "N/A";
                                                    comment = "N/A";
                                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                                }

                                            }

                                        }
                                    }
                                })

                                // call update data source
                                updateDataSource(tk_keyid);

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = errorStr;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = err;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }
                        });
                    }
                }
            );

        });

        $("#btn_modal_modify_lag_auto_perc95_30d").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class");

            //console.log("Start collection update");

            // Define the query
            var searchQuery = "| `trackme_tstats` count latest(_indextime) as indextime where index=\"" + tk_data_index + "\" sourcetype=\"" + tk_data_sourcetype + "\"  by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats perc95(delta) as value | eval data_name=\"" + tk_data_name + "\", data_override_lagging_class=\"" + tk_data_override_lagging_class + "\" | lookup trackme_data_source_monitoring data_name OUTPUT _key as keyid | lookup trackme_data_source_monitoring data_name | eval data_max_lag_allowed=if(value>0, round(value, 0), data_max_lag_allowed), value=round(value, 0) | outputlookup trackme_data_source_monitoring key_field=keyid";
            //console.log(searchQuery);

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-30d",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    // hide the current modal
                    $("#modal_modify_data_source_unified").modal('hide');

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Please wait while determining the entity lagging value...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                $("#loadingGray").remove()

                                // if the action is very fast, the modal may fail, show up after 1 sec
                                setTimeout(function(){
                                  $("#modal_modify_data_source_unified").modal()
                                }, 1000);

                                // Get the results and display them
                                job.results({}, function(err, results) {
                                    var fields = results.fields;
                                    var rows = results.rows;
                                    for (var i = 0; i < rows.length; i++) {
                                        var values = rows[i];
                                        //console.log("Row " + i + ": ");
                                        for (var j = 0; j < values.length; j++) {
                                            var field = fields[j];
                                            var value = values[j];

                                            if (field == "data_max_lag_allowed") {
                                                //console.log("  " + field + ": " + value);

                                                if (value === '0') {
                                                    notification('ERROR: No live data available for this entity, automatic lagging calculation cannot be performed for inactive entities.', 6000)
                                                } else {
                                                    // Run the search again to update the table
                                                    searchDataSourcesMain.startSearch();

                                                    // notify
                                                    notification('Modification has been registered successfully, max lagging value automatically defined to ' + value + ' seconds.', 6000)

                                                    setToken("tk_data_max_lag_allowed", value);
                                                    setToken("form.tk_input_lag", value);
                                                    tk_data_max_lag_allowed = value;

                                                    // Audit success change
                                                    action = "success";
                                                    change_type = "apply auto defined monitoring lag";
                                                    object = tk_data_name;
                                                    object_category = "data_source";
                                                    object_attrs = "data_max_lag_allowed changed from:" + tk_origin_data_max_lag_allowed + " to:" + tk_data_max_lag_allowed + " with data_override_lagging_class:" + tk_data_override_lagging_class;
                                                    result = "N/A";
                                                    comment = "N/A";
                                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                                }

                                            }

                                        }
                                    }
                                })

                                // call update data source
                                updateDataSource(tk_keyid);

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = errorStr;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = err;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }
                        });
                    }
                }
            );

        });

        $("#btn_modal_modify_lag_auto_average_30d").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class");

            //console.log("Start collection update");

            // Define the query
            var searchQuery = "| `trackme_tstats` count latest(_indextime) as indextime where index=\"" + tk_data_index + "\" sourcetype=\"" + tk_data_sourcetype + "\"  by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats avg(delta) as value | eval data_name=\"" + tk_data_name + "\", data_override_lagging_class=\"" + tk_data_override_lagging_class + "\" | lookup trackme_data_source_monitoring data_name OUTPUT _key as keyid | lookup trackme_data_source_monitoring data_name | eval data_max_lag_allowed=if(value>0, round(value, 0), data_max_lag_allowed), value=round(value, 0) | outputlookup trackme_data_source_monitoring key_field=keyid";
            //console.log(searchQuery);

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-30d",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    // hide the current modal
                    $("#modal_modify_data_source_unified").modal('hide');

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Please wait while determining the entity lagging value...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                $("#loadingGray").remove()

                                // if the action is very fast, the modal may fail, show up after 1 sec
                                setTimeout(function(){
                                  $("#modal_modify_data_source_unified").modal()
                                }, 1000);

                                // Get the results and display them
                                job.results({}, function(err, results) {
                                    var fields = results.fields;
                                    var rows = results.rows;
                                    for (var i = 0; i < rows.length; i++) {
                                        var values = rows[i];
                                        //console.log("Row " + i + ": ");
                                        for (var j = 0; j < values.length; j++) {
                                            var field = fields[j];
                                            var value = values[j];

                                            if (field == "data_max_lag_allowed") {
                                                //console.log("  " + field + ": " + value);

                                                if (value === '0') {
                                                    notification('ERROR: No live data available for this entity, automatic lagging calculation cannot be performed for inactive entities.', 6000)
                                                } else {
                                                    // Run the search again to update the table
                                                    searchDataSourcesMain.startSearch();

                                                    // notify
                                                    notification('Modification has been registered successfully, max lagging value automatically defined to ' + value + ' seconds.', 6000)

                                                    setToken("tk_data_max_lag_allowed", value);
                                                    setToken("form.tk_input_lag", value);
                                                    tk_data_max_lag_allowed = value;

                                                    // Audit success change
                                                    action = "success";
                                                    change_type = "apply auto defined monitoring lag";
                                                    object = tk_data_name;
                                                    object_category = "data_source";
                                                    object_attrs = "data_max_lag_allowed changed from:" + tk_origin_data_max_lag_allowed + " to:" + tk_data_max_lag_allowed + " with data_override_lagging_class:" + tk_data_override_lagging_class;
                                                    result = "N/A";
                                                    comment = "N/A";
                                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                                }

                                            }

                                        }
                                    }
                                })

                                // call update data source
                                updateDataSource(tk_keyid);

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = errorStr;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_name;
                                object_category = "data_source";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = err;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }
                        });
                    }
                }
            );

        });

        // metric host monitoring

        $("#btn_modify_metric_host").click(function() {

            // Hide main modal
            $("#modal_manage_metrichost").modal('hide');

            // Show input modal
            $("#modal_modify_metric_host_unified").modal();

        });

        // data host monitoring

        $("#btn_modify_data_host").click(function() {

            // Hide main modal
            $("#modal_manage_host").modal('hide');

            // Show input modal
            $("#modal_modify_data_host_unified").modal();

        });

        // cancel button: returns to selected
        $("#btn_close_data_host_unified").click(function() {
            submitTokens();

            // Show modal
            $("#modal_manage_host").modal();

        });

        //
        // Modify monitoring wdays
        //

        $("#btn_modal_modify_wdays_host").click(function() {

            // Show input modal
            $("#modal_modify_monitoring_wdays_host").modal();

        });

        $("#btn_modal_modify_monitoring_wdays_host_confirm").click(function() {

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_host_state = tokens.get("tk_data_host_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_host_state = tokens.get("tk_data_previous_host_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");

            //console.log("Value of modal_input_grace_period is: " + tk_kafka_infra_grace_period);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_host_monitoring/" + tk_keyid;

            var tk_origin_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitoring_wdays = tokens.get("tk_input_wdays_host");

            if (!tk_data_monitoring_wdays || !tk_data_monitoring_wdays.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "object_category": "data_host",
                    "data_host": tk_data_host,
                    "data_index": tk_data_index,
                    "data_sourcetype": tk_data_sourcetype,
                    "data_last_lag_seen": tk_data_last_lag_seen,
                    "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                    "data_eventcount": tk_data_eventcount,
                    "data_first_time_seen": tk_data_first_time_seen,
                    "data_last_time_seen": tk_data_last_time_seen,
                    "data_last_ingest": tk_data_last_ingest,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_monitored_state": tk_data_monitored_state,
                    "data_monitoring_wdays": tk_data_monitoring_wdays,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "data_host_state": tk_data_host_state,
                    "data_tracker_runtime": tk_data_tracker_runtime,
                    "data_previous_host_state": tk_data_previous_host_state,
                    "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                    "OutlierMinEventCount": tk_outliermineventcount,
                    "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                    "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                    "OutlierAlertOnUpper": tk_outlieralertonupper,
                    "OutlierTimePeriod": tk_outlier_period,
                    "OutlierSpan": tk_outlier_span,
                    "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                    "isOutlier": tk_isoutlier,
                    "latest_flip_state": tk_latest_flip_state,
                    "latest_flip_time": tk_latest_flip_time,
                    "priority": tk_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchDataHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // call update data source
                        updateDataHost(tk_keyid);

                        // Audit
                        action = "success";
                        change_type = "modify week days monitoring";
                        object = tk_data_host;
                        object_category = "data_host";
                        object_attrs = "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "modify week days monitoring";
                        object = tk_data_host;
                        object_category = "data_host";
                        object_attrs = "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        // host priority
        $("#btn_modal_modify_priority_host_confirm").click(function() {

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_host_state = tokens.get("tk_data_host_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_host_state = tokens.get("tk_data_previous_host_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_host_monitoring/" + tk_keyid;

            var tk_origin_priority = tk_priority;
            var tk_new_priority = tokens.get("tk_input_host_priority");

            if (!tk_new_priority || !tk_new_priority.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "object_category": "data_host",
                    "data_host": tk_data_host,
                    "data_index": tk_data_index,
                    "data_sourcetype": tk_data_sourcetype,
                    "data_last_lag_seen": tk_data_last_lag_seen,
                    "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                    "data_eventcount": tk_data_eventcount,
                    "data_first_time_seen": tk_data_first_time_seen,
                    "data_last_time_seen": tk_data_last_time_seen,
                    "data_last_ingest": tk_data_last_ingest,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_monitored_state": tk_data_monitored_state,
                    "data_monitoring_wdays": tk_data_monitoring_wdays,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "data_host_state": tk_data_host_state,
                    "data_tracker_runtime": tk_data_tracker_runtime,
                    "data_previous_host_state": tk_data_previous_host_state,
                    "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                    "OutlierMinEventCount": tk_outliermineventcount,
                    "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                    "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                    "OutlierAlertOnUpper": tk_outlieralertonupper,
                    "OutlierTimePeriod": tk_outlier_period,
                    "OutlierSpan": tk_outlier_span,
                    "isOutlier": tk_isoutlier,
                    "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                    "latest_flip_state": tk_latest_flip_state,
                    "latest_flip_time": tk_latest_flip_time,
                    "priority": tk_new_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchDataHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // call update data source
                        updateDataHost(tk_keyid);

                        // Audit
                        action = "success";
                        change_type = "modify priority";
                        object = tk_data_host;
                        object_category = "data_host";
                        object_attrs = "priority changed from:" + tk_origin_priority + " to:" + tk_new_priority;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "modify priority";
                        object = tk_data_host;
                        object_category = "data_host";
                        object_attrs = "priority changed from:" + tk_origin_priority + " to:" + tk_new_priority;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        $("#btn_modal_modify_wdays_host_no").click(function() {

            // Show input modal
            $("#modal_modify_monitoring_wdays_host_no").modal();

        });

        // Week days

        $("#btn_modal_modify_monitoring_wdays_host_no_confirm").click(function() {

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_host_state = tokens.get("tk_data_host_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_host_state = tokens.get("tk_data_previous_host_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");

            //console.log("Value of modal_input_grace_period is: " + tk_kafka_infra_grace_period);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_host_monitoring/" + tk_keyid;

            var tk_origin_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitoring_wdays_no = tokens.get("tk_input_wdays_host_no");

            if (!tk_data_monitoring_wdays_no || !tk_data_monitoring_wdays_no.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "object_category": "data_host",
                    "data_host": tk_data_host,
                    "data_index": tk_data_index,
                    "data_sourcetype": tk_data_sourcetype,
                    "data_last_lag_seen": tk_data_last_lag_seen,
                    "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                    "data_eventcount": tk_data_eventcount,
                    "data_first_time_seen": tk_data_first_time_seen,
                    "data_last_time_seen": tk_data_last_time_seen,
                    "data_last_ingest": tk_data_last_ingest,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_monitored_state": tk_data_monitored_state,
                    "data_monitoring_wdays": tk_data_monitoring_wdays_no,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "data_host_state": tk_data_host_state,
                    "data_tracker_runtime": tk_data_tracker_runtime,
                    "data_previous_host_state": tk_data_previous_host_state,
                    "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                    "OutlierMinEventCount": tk_outliermineventcount,
                    "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                    "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                    "OutlierAlertOnUpper": tk_outlieralertonupper,
                    "OutlierTimePeriod": tk_outlier_period,
                    "OutlierSpan": tk_outlier_span,
                    "isOutlier": tk_isoutlier,
                    "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                    "latest_flip_state": tk_latest_flip_state,
                    "latest_flip_time": tk_latest_flip_time,
                    "priority": tk_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchDataHostsMain.startSearch();

                        $("#modal_modify_data_host_unified").modal();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // call update data source
                        updateDataHost(tk_keyid);

                        // Audit
                        action = "success";
                        change_type = "modify week days monitorin";
                        object = tk_data_host;
                        object_category = "data_host";
                        object_attrs = "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays_no;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "modify week days monitorin";
                        object = tk_data_host;
                        object_category = "data_host";
                        object_attrs = "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays_no;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        // cancel: returns to unified modal
        $("#btn_modal_modify_monitoring_wdays_host_no_cancel").click(function() {

            // Show input modal
            $("#modal_modify_data_host_unified").modal();

        });

        //
        // data source id
        //


        //
        // Modify lag
        //

        $("#btn_modal_modify_lag_host").click(function() {

            // Show input modal
            $("#modal_modify_lag_host").modal();

        });

        $("#btn_modal_modify_lag_confirm_host").click(function() {

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_host_state = tokens.get("tk_data_host_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_host_state = tokens.get("tk_data_previous_host_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");

            //console.log("Value of modal_input_grace_period is: " + tk_kafka_infra_grace_period);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_host_monitoring/" + tk_keyid;

            var tk_data_max_lag_allowed = tokens.get("tk_input_lag_host");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class_host");

            if (!tk_data_max_lag_allowed || !tk_data_max_lag_allowed.length || !isNumeric(tk_data_max_lag_allowed)) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "object_category": "data_host",
                    "data_host": tk_data_host,
                    "data_index": tk_data_index,
                    "data_sourcetype": tk_data_sourcetype,
                    "data_last_lag_seen": tk_data_last_lag_seen,
                    "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                    "data_eventcount": tk_data_eventcount,
                    "data_first_time_seen": tk_data_first_time_seen,
                    "data_last_time_seen": tk_data_last_time_seen,
                    "data_last_ingest": tk_data_last_ingest,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_monitored_state": tk_data_monitored_state,
                    "data_monitoring_wdays": tk_data_monitoring_wdays,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "data_host_state": tk_data_host_state,
                    "data_tracker_runtime": tk_data_tracker_runtime,
                    "data_previous_host_state": tk_data_previous_host_state,
                    "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                    "OutlierMinEventCount": tk_outliermineventcount,
                    "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                    "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                    "OutlierAlertOnUpper": tk_outlieralertonupper,
                    "OutlierTimePeriod": tk_outlier_period,
                    "OutlierSpan": tk_outlier_span,
                    "isOutlier": tk_isoutlier,
                    "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                    "latest_flip_state": tk_latest_flip_state,
                    "latest_flip_time": tk_latest_flip_time,
                    "priority": tk_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchDataHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // call update data source
                        updateDataHost(tk_keyid);

                        // Audit
                        action = "success";
                        change_type = "modify monitoring lag";
                        object = tk_data_host;
                        object_category = "data_host";
                        object_attrs = "data_max_lag_allowed changed from:" + tk_origin_data_max_lag_allowed + " to:" + tk_data_max_lag_allowed + " with data_override_lagging_class:" + tk_data_override_lagging_class;
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "modify monitoring lag";
                        object = tk_data_host;
                        object_category = "data_host";
                        object_attrs = "data_max_lag_allowed changed from:" + tk_origin_data_max_lag_allowed + " to:" + tk_data_max_lag_allowed + " with data_override_lagging_class:" + tk_data_override_lagging_class;
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        // Show main modal
        $("#btn_modal_modify_lag_auto_main_host").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // Free the searches
            setToken("show_data_host_autolagging", "true");

            // Show modal
            $("#modal_modify_data_host_autolag").modal();
        });

        // Show main modal back
        $("#btn_close_data_host_unified_autolag").click(function() {
            $("#modal_modify_data_host_unified").modal();
        });

        $("#btn_modal_modify_lag_auto_perc95_host").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");

            //console.log("Start collection update");

            // Define the query
            var searchQuery = "| `trackme_tstats` count latest(_indextime) as indextime where index=* host=\"" + tk_data_host + "\"  by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats perc95(delta) as value | eval data_host=\"" + tk_data_host + "\", data_override_lagging_class=\"" + tk_data_override_lagging_class + "\" | lookup trackme_host_monitoring data_host OUTPUT _key as keyid | lookup trackme_host_monitoring data_host | eval data_max_lag_allowed=if(value>0, round(value, 0), data_max_lag_allowed), value=round(value, 0) | outputlookup trackme_host_monitoring key_field=keyid";
            //console.log(searchQuery);

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-7d",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    // hide the current modal
                    $("#modal_modify_data_host_unified").modal('hide');

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Please wait while determining the entity lagging value...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                $("#loadingGray").remove()

                                // if the action is very fast, the modal may fail, show up after 1 sec
                                setTimeout(function(){
                                  $("#modal_modify_data_host_unified").modal()
                                }, 1000);

                                // Get the results and display them
                                job.results({}, function(err, results) {
                                    var fields = results.fields;
                                    var rows = results.rows;
                                    for (var i = 0; i < rows.length; i++) {
                                        var values = rows[i];
                                        //console.log("Row " + i + ": ");
                                        for (var j = 0; j < values.length; j++) {
                                            var field = fields[j];
                                            var value = values[j];

                                            if (field == "value") {
                                                //console.log("  " + field + ": " + value);

                                                if (value === '0') {
                                                    notification('ERROR: No live data available for this entity, automatic lagging calculation cannot be performed for inactive entities.', 6000)
                                                } else {
                                                    // Run the search again to update the table
                                                    searchDataHostsMain.startSearch();

                                                    // notify
                                                    notification('Modification has been registered successfully, max lagging value automatically defined to ' + value + ' seconds.', 6000)

                                                    setToken("tk_data_max_lag_allowed", value);
                                                    setToken("form.tk_input_lag_host", value);
                                                    tk_data_max_lag_allowed = value;

                                                    // Audit success change
                                                    action = "success";
                                                    change_type = "apply auto defined monitoring lag";
                                                    object = tk_data_host;
                                                    object_category = "data_host";
                                                    object_attrs = "data_max_lag_allowed changed from:" + tk_origin_data_max_lag_allowed + " to:" + tk_data_max_lag_allowed + " with data_override_lagging_class:" + tk_data_override_lagging_class;
                                                    result = "N/A";
                                                    comment = "N/A";
                                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                                }
                                            }

                                        }
                                    }
                                })

                                // call update data source
                                updateDataHost(tk_keyid);

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = errorStr;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = err;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }
                        });
                    }
                }
            );

        });

        $("#btn_modal_modify_lag_auto_average_host").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");

            //console.log("Start collection update");

            // Define the query
            var searchQuery = "| `trackme_tstats` count latest(_indextime) as indextime where index=* host=\"" + tk_data_host + "\"  by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats avg(delta) as value | eval data_host=\"" + tk_data_host + "\", data_override_lagging_class=\"" + tk_data_override_lagging_class + "\" | lookup trackme_host_monitoring data_host OUTPUT _key as keyid | lookup trackme_host_monitoring data_host | eval data_max_lag_allowed=if(value>0, round(value, 0), data_max_lag_allowed), value=round(value, 0) | outputlookup trackme_host_monitoring key_field=keyid";
            //console.log(searchQuery);

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-7d",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    // hide the current modal
                    $("#modal_modify_data_host_unified").modal('hide');

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Please wait while determining the entity lagging value...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                $("#loadingGray").remove()

                                // if the action is very fast, the modal may fail, show up after 1 sec
                                setTimeout(function(){
                                  $("#modal_modify_data_host_unified").modal()
                                }, 1000);

                                // Get the results and display them
                                job.results({}, function(err, results) {
                                    var fields = results.fields;
                                    var rows = results.rows;
                                    for (var i = 0; i < rows.length; i++) {
                                        var values = rows[i];
                                        //console.log("Row " + i + ": ");
                                        for (var j = 0; j < values.length; j++) {
                                            var field = fields[j];
                                            var value = values[j];

                                            if (field == "value") {
                                                //console.log("  " + field + ": " + value);

                                                if (value === '0') {
                                                    notification('ERROR: No live data available for this entity, automatic lagging calculation cannot be performed for inactive entities.', 6000)
                                                } else {
                                                    // Run the search again to update the table
                                                    searchDataHostsMain.startSearch();

                                                    // notify
                                                    notification('Modification has been registered successfully, max lagging value automatically defined to ' + value + ' seconds.', 6000)

                                                    setToken("tk_data_max_lag_allowed", value);
                                                    setToken("form.tk_input_lag_host", value);

                                                    // Audit success change
                                                    action = "success";
                                                    change_type = "apply auto defined monitoring lag";
                                                    object = tk_data_host;
                                                    object_category = "data_host";
                                                    object_attrs = "data_max_lag_allowed changed from:" + tk_origin_data_max_lag_allowed + " to:" + tk_data_max_lag_allowed + " with data_override_lagging_class:" + tk_data_override_lagging_class;
                                                    result = "N/A";
                                                    comment = "N/A";
                                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                                }
                                            }

                                        }
                                    }
                                })

                                // call update data source
                                updateDataHost(tk_keyid);

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = errorStr;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = err;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }
                        });
                    }
                }
            );

        });

        $("#btn_modal_modify_lag_auto_perc95_30d_host").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");

            //console.log("Start collection update");

            // Define the query
            var searchQuery = "| `trackme_tstats` count latest(_indextime) as indextime where index=* host=\"" + tk_data_host + "\"  by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats perc95(delta) as value | eval data_host=\"" + tk_data_host + "\", data_override_lagging_class=\"" + tk_data_override_lagging_class + "\" | lookup trackme_host_monitoring data_host OUTPUT _key as keyid | lookup trackme_host_monitoring data_host | eval data_max_lag_allowed=if(value>0, round(value, 0), data_max_lag_allowed), value=round(value, 0) | outputlookup trackme_host_monitoring key_field=keyid";
            //console.log(searchQuery);

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-30d",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    // hide the current modal
                    $("#modal_modify_data_host_unified").modal('hide');

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Please wait while determining the entity lagging value...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                $("#loadingGray").remove()

                                // if the action is very fast, the modal may fail, show up after 1 sec
                                setTimeout(function(){
                                  $("#modal_modify_data_host_unified").modal()
                                }, 1000);

                                // Get the results and display them
                                job.results({}, function(err, results) {
                                    var fields = results.fields;
                                    var rows = results.rows;
                                    for (var i = 0; i < rows.length; i++) {
                                        var values = rows[i];
                                        //console.log("Row " + i + ": ");
                                        for (var j = 0; j < values.length; j++) {
                                            var field = fields[j];
                                            var value = values[j];

                                            if (field == "value") {
                                                //console.log("  " + field + ": " + value);

                                                if (value === '0') {
                                                    notification('ERROR: No live data available for this entity, automatic lagging calculation cannot be performed for inactive entities.', 6000)
                                                } else {
                                                    // Run the search again to update the table
                                                    searchDataHostsMain.startSearch();

                                                    // notify
                                                    notification('Modification has been registered successfully, max lagging value automatically defined to ' + value + ' seconds.', 6000)

                                                    setToken("tk_data_max_lag_allowed", value);
                                                    setToken("form.tk_input_lag_host", value);

                                                    // Audit success change
                                                    action = "success";
                                                    change_type = "apply auto defined monitoring lag";
                                                    object = tk_data_host;
                                                    object_category = "data_host";
                                                    object_attrs = "data_max_lag_allowed changed from:" + tk_origin_data_max_lag_allowed + " to:" + tk_data_max_lag_allowed + " with data_override_lagging_class:" + tk_data_override_lagging_class;
                                                    result = "N/A";
                                                    comment = "N/A";
                                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                                }
                                            }

                                        }
                                    }
                                })

                                // call update data source
                                updateDataHost(tk_keyid);

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = errorStr;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = err;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }
                        });
                    }
                }
            );

        });

        $("#btn_modal_modify_lag_auto_average_30d_host").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");

            //console.log("Start collection update");

            // Define the query
            var searchQuery = "| `trackme_tstats` count latest(_indextime) as indextime where index=* host=\"" + tk_data_host + "\"  by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats avg(delta) as value | eval data_host=\"" + tk_data_host + "\", data_override_lagging_class=\"" + tk_data_override_lagging_class + "\" | lookup trackme_host_monitoring data_host OUTPUT _key as keyid | lookup trackme_host_monitoring data_host | eval data_max_lag_allowed=if(value>0, round(value, 0), data_max_lag_allowed), value=round(value, 0) | outputlookup trackme_host_monitoring key_field=keyid";
            //console.log(searchQuery);

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-30d",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    // hide the current modal
                    $("#modal_modify_data_host_unified").modal('hide');

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Please wait while determining the entity lagging value...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                $("#loadingGray").remove()

                                // if the action is very fast, the modal may fail, show up after 1 sec
                                setTimeout(function(){
                                  $("#modal_modify_data_host_unified").modal()
                                }, 1000);

                                // Get the results and display them
                                job.results({}, function(err, results) {
                                    var fields = results.fields;
                                    var rows = results.rows;
                                    for (var i = 0; i < rows.length; i++) {
                                        var values = rows[i];
                                        //console.log("Row " + i + ": ");
                                        for (var j = 0; j < values.length; j++) {
                                            var field = fields[j];
                                            var value = values[j];

                                            if (field == "value") {
                                                //console.log("  " + field + ": " + value);

                                                if (value === '0') {
                                                    notification('ERROR: No live data available for this entity, automatic lagging calculation cannot be performed for inactive entities.', 6000)
                                                } else {
                                                    // Run the search again to update the table
                                                    searchDataHostsMain.startSearch();

                                                    // notify
                                                    notification('Modification has been registered successfully, max lagging value automatically defined to ' + value + ' seconds.', 6000)

                                                    setToken("tk_data_max_lag_allowed", value);
                                                    setToken("form.tk_input_lag_host", value);

                                                    // Audit success change
                                                    action = "success";
                                                    change_type = "apply auto defined monitoring lag";
                                                    object = tk_data_host;
                                                    object_category = "data_host";
                                                    object_attrs = "data_max_lag_allowed changed from:" + tk_origin_data_max_lag_allowed + " to:" + tk_data_max_lag_allowed + " with data_override_lagging_class:" + tk_data_override_lagging_class;
                                                    result = "N/A";
                                                    comment = "N/A";
                                                    auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                                }
                                            }

                                        }
                                    }
                                })

                                // call update data source
                                updateDataHost(tk_keyid);

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = errorStr;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()

                                // Audit failure change
                                action = "failure";
                                change_type = "apply auto defined monitoring lag";
                                object = tk_data_host;
                                object_category = "data_host";
                                object_attrs = "auto lagging determination search has failed or this operation was not allowed for this user";
                                result = err;
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }
                        });
                    }
                }
            );

        });

        // data source identity documentation

        // back button
        $("#btn_back_manage_identity_card").click(function() {
            // Show input modal
            $("#modal_manage").modal();
        });

        $("#btn_close_define_identity_card").click(function() {
            // Show input modal
            $("#modal_manage").modal();
        });

        // update button
        $("#btn_modify_manage_identity_card").click(function() {
            // Show input modal
            $("#define_identity_card").modal();
        });

        // delete button
        $("#btn_delete_manage_identity_card").click(function() {
            // Show deletion modal
            $("#delete_identity_card").modal();
        });

        // identity card

        $('.btn_define_identity_card').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // Retrieve input values

                var input_doc_object = tokens.get("tk_data_name");
                var input_doc_note = document.getElementById("input_doc_note").value;

                // replace chars that would lead the operation to fail
                var input_doc_note = input_doc_note.replace(/\"/g, '\\"');

                var input_doc_link = document.getElementById("input_doc_link").value;

                //console.log("link is: " + input_doc_link);
                //console.log("note is: " + input_doc_note);

                // Define the query
                var searchQuery = "| inputlookup trackme_sources_knowledge | where object!=\"" + input_doc_object + "\" | append [ | makeresults | eval object=\"" + input_doc_object + "\", doc_link=\"" +  input_doc_link + "\", doc_note=\"" +  input_doc_note + "\" ] | dedup object | sort limit=0 object | outputlookup trackme_sources_knowledge";

                //console.log(searchQuery);

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                if (input_doc_link === "link to documentation" && input_doc_note === "documentation note") {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

                else if (input_doc_link && input_doc_link.length) {

                    // Run a blocking search and get back a job
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            function audit_failure() {

                                // Audit
                                action = "failure";
                                change_type = "create or update identity card";
                                object = input_doc_object;
                                object_category = "data_source";
                                object_attrs = "object:" + input_doc_object + ", doc_link:" + input_doc_link + ", doc_note:" + input_doc_note;
                                result = "N/A";
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {
                                        // Run the search again to update the table
                                        searchDataSourcesMain.startSearch();
                                        $("#update_achieved_identity_card").modal()

                                        // Audit
                                        action = "success";
                                        change_type = "create or update identity card";
                                        object = input_doc_object;
                                        object_category = "data_source";
                                        object_attrs = "object:" + input_doc_object + ", doc_link:" + input_doc_link + ", doc_note:" + input_doc_note;
                                        result = "N/A";
                                        comment = "N/A";
                                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        audit_failure();
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        audit_failure();
                                        $("#modal_update_collection_failure_flush").modal()
                                    }
                                });

                            }

                        }
                    );

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

            });

        });

        // back
        $("#btn_define_identity_card_back").click(function() {
            // Show modal
            $("#modal_manage").modal();
        });

        // delete button
        $("#btn_delete_identity_card_confirm").click(function() {

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // Retrieve input values

                var input_doc_object = tokens.get("tk_data_name");
                var input_doc_note = document.getElementById("input_doc_note").value;
                var input_doc_link = document.getElementById("input_doc_link").value;

                //console.log("link is: " + input_doc_link);
                //console.log("note is: " + input_doc_note);

                // Define the query
                var searchQuery = "| inputlookup trackme_sources_knowledge | eval keyid=_key | mvexpand object | where object!=\"" + input_doc_object + "\" | stats values(*) as \"*\" by keyid | sort limit=0 keyid | fields - keyid | outputlookup trackme_sources_knowledge";

                //console.log(searchQuery);

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                if (input_doc_link && input_doc_link.length) {

                    // Run a blocking search and get back a job
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            function audit_failure() {

                                // Audit
                                action = "failure";
                                change_type = "delete identity card";
                                object = input_doc_object;
                                object_category = "data_source";
                                object_attrs = "object:" + input_doc_object + ", doc_link:" + input_doc_link + ", doc_note:" + input_doc_note;
                                result = "N/A";
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {
                                        // Run the search again to update the table
                                        searchDataSourcesMain.startSearch();
                                        // show deleted modal
                                        $("#delete_achieved_identity_card").modal()

                                        // Audit
                                        action = "success";
                                        change_type = "delete identity card";
                                        object = input_doc_object;
                                        object_category = "data_source";
                                        object_attrs = "object:" + input_doc_object + ", doc_link:" + input_doc_link + ", doc_note:" + input_doc_note;
                                        result = "N/A";
                                        comment = "N/A";
                                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        audit_failure();
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        audit_failure();
                                        $("#modal_update_collection_failure_flush").modal()
                                    }
                                });

                            }

                        }
                    );

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

        });

        // back button
        $("#btn_delete_identity_card_back").click(function() {
            // Show modal
            $("#define_identity_card").modal();
        });

        // associate identity card button

        $('.btn_associate_identity_card').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // if the token exists already, restart the search, otherwise allow the search to start
                var tk_start_associate_identity_card = tokens.get("tk_start_associate_identity_card");

                if (tk_start_associate_identity_card && tk_start_associate_identity_card.length) {
                    searchIdentityCardTable.startSearch();
                } else
                {
                    setToken("tk_start_associate_identity_card", "true");
                }

                // Show modal
                $("#associate_identity_card").modal();

            });

        });

        // confirm button
        $("#btn_associate_identity_card_confirm_valid").click(function() {

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // Retrieve input values

                var input_doc_keyid = tokens.get("tk_keyid");
                var input_doc_new_object = tokens.get("tk_data_name");
                var input_doc_origin_object = tokens.get("tk_object");
                var input_doc_link = tokens.get("tk_doc_link");
                var input_doc_note = tokens.get("tk_doc_note");

                //console.log("key is: " + input_doc_keyid);
                //console.log("new_object is: " + input_doc_new_object);
                //console.log("origin_object is: " + input_doc_origin_object);

                // Define the query
                var searchQuery = "| inputlookup trackme_sources_knowledge | eval keyid=_key | mvexpand object | append [ | makeresults | eval keyid=\"" + input_doc_keyid + "\", object=\"" + input_doc_new_object + "\" ] | stats values(*) as \"*\" by keyid | outputlookup append=t trackme_sources_knowledge key_field=keyid";

                //console.log(searchQuery);

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                if (input_doc_keyid && input_doc_keyid.length) {

                    // Run a blocking search and get back a job
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            function audit_failure() {

                                // Audit
                                action = "failure";
                                change_type = "associate identity card";
                                object = input_doc_new_object;
                                object_category = "data_source";
                                object_attrs = "object:" + input_doc_new_object + " was associated with identity card keyid: " + input_doc_keyid + ", doc_link:" + input_doc_link + ", doc_note:" + input_doc_note;
                                result = "N/A";
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {
                                        // Run the search again to update the table
                                        searchDataSourcesMain.startSearch();
                                        // show deleted modal
                                        $("#associate_achieved_identity_card").modal()

                                        // Audit
                                        action = "success";
                                        change_type = "associate identity card";
                                        object = input_doc_new_object;
                                        object_category = "data_source";
                                        object_attrs = "object:" + input_doc_new_object + " was associated with identity card keyid: " + input_doc_keyid + ", doc_link:" + input_doc_link + ", doc_note:" + input_doc_note;
                                        result = "N/A";
                                        comment = "N/A";
                                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        audit_failure();
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        audit_failure();
                                        $("#modal_update_collection_failure_flush").modal()
                                    }
                                });

                            }

                        }
                    );

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

        });

        // back button
        $("#btn_associate_identity_card_back").click(function() {
            // Show modal
            $("#define_identity_card").modal();
        });

        // back button
        $("#btn_associate_identity_card_confirm_back").click(function() {
            // Show modal
            $("#associate_identity_card").modal();
        });

        // Acknowledgment

        $('.btn_ack').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_name = tokens.get("tk_data_name");
                var tk_data_host = tokens.get("tk_data_host");
                var tk_metric_host = tokens.get("tk_metric_host");

                //console.log("tk_data_name is " + tk_data_name);
                //console.log("tk_data_host is " + tk_data_host);
                //console.log("tk_metric_host is " + tk_metric_host);

                if (tk_data_name !== undefined) {
                    setToken("input_object", tk_data_name);
                    setToken("input_object_category", "data_source");
                } else if (tk_data_host !== undefined) {
                    setToken("input_object", tk_data_host);
                    setToken("input_object_category", "data_host");
                } else if (tk_metric_host !== undefined) {
                    setToken("input_object", tk_metric_host);
                    setToken("input_object_category", "metric_host");
                }

                var input_object = tokens.get("input_object");
                var input_object_category = tokens.get("input_object_category");

                //console.log("input_object is: " + input_object);
                //console.log("input_object_category is: " + input_object_category);

                // if the token exists already, restart the search, otherwise allow the search to start
                var tk_start_ack_get = tokens.get("tk_start_ack_get");

                if (tk_start_ack_get && tk_start_ack_get.length) {
                    searchAckGet.startSearch();
                } else
                {
                    setToken("tk_start_ack_get", "true");
                }

                // Show modal
                $("#confirm_ack").modal();

            });

        });

        // Add ack

        $('.btn_ack_confirm_valid').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // Retrieve input values

                var input_object = tokens.get("input_object");
                var input_object_category = tokens.get("input_object_category");
                var input_ack_duration = tokens.get("input_ack_duration");

                //console.log("input_object is: " + input_object);
                //console.log("input_object_category is: " + input_object_category);
                //console.log("input_ack_duration is: "+ input_ack_duration);

                // Retrieve update comment if any
                var tk_comment = document.getElementById("input_ack_comment").value;

                // if is not defined, give it a value and override text box content
                if (tk_comment == "null") {
                    setToken("tk_update_comment", TokenUtils.replaceTokenNames("No comments for update.", _.extend(submittedTokenModel.toJSON(), e.data)));
                    // replace the textarea for modification requests
                    document.getElementById("input_ack_comment").value = "update note";
                }
                else if (tk_comment == "update note") {
                    tk_comment = "No comment for update.";
                    document.getElementById("input_ack_comment").value = "update note";
                }
                else {
                    // replace the textarea for modification requests
                    document.getElementById("input_ack_comment").value = "update note";
                }

                // Define the query
                var searchQuery = "| `trackme_ack_add(\"" + input_object + "\", \"" +  input_object_category + "\", \"" +  input_ack_duration + "\")`";

                //console.log(searchQuery);

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                if (input_object && input_object.length && input_ack_duration && input_ack_duration.length) {

                    // Run a blocking search and get back a job
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            function audit_failure() {

                                // Audit
                                action = "failure";
                                change_type = "ack enable";
                                object = input_object;
                                object_category = input_object_category;
                                object_attrs = "object:" + input_object + " has been acknowledged for a period of " + input_ack_duration + " seconds, no more alerts will be generated until the acknowledge is expired.";
                                result = "N/A";
                                comment = tk_comment;
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {

                                        // Refresh the main search
                                        if (input_object_category == "data_source") {
                                            searchDataSourcesMain.startSearch();
                                        } else if (input_object_category == "data_host") {
                                            searchDataHostsMain.startSearch();
                                        } else if (input_object_category == "metric_host") {
                                            searchMetricHostsMain.startSearch();
                                        }

                                        // show deleted modal
                                        $("#ack_achieved").modal()

                                        // Audit
                                        action = "success";
                                        change_type = "ack enable";
                                        object = input_object;
                                        object_category = input_object_category;
                                        object_attrs = "object:" + input_object + " has been acknowledged for a period of " + input_ack_duration + " seconds, no more alerts will be generated until the acknowledge is expired.";
                                        result = "N/A";
                                        comment = tk_comment;
                                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        audit_failure();
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        audit_failure();
                                        $("#modal_update_collection_failure_flush").modal()
                                    }
                                });

                            }

                        }
                    );

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

            });

        });

        // Disable ack

        $('.btn_ack_disable_valid').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // Retrieve input values

                var keyid = tokens.get("keyid");
                var input_object = tokens.get("input_object");
                var input_object_category = tokens.get("input_object_category");
                var ack_expiration = tokens.get("ack_expiration");
                var ack_state = tokens.get("ack_state");

                // Define the query
                var searchQuery = "| `trackme_ack_disable(\"" + keyid + "\")`";

                //console.log(keyid);
                //console.log(searchQuery);

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                if (ack_state === "inactive") {
                    // show modal
                    $("#ack_disable_already").modal()
                }

                else if (input_object && input_object.length) {

                    // Run a blocking search and get back a job
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            function audit_failure() {

                                // Audit
                                action = "failure";
                                change_type = "ack disable";
                                object = input_object;
                                object_category = input_object_category;
                                object_attrs = "object:" + input_object + " acknowledge has been disabled (ack_expiration was: " + ack_expiration + "), alerts will be generated depending on state and rules. ";
                                result = "N/A";
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {

                                        // Refresh the main search
                                        if (input_object_category == "data_source") {
                                            searchDataSourcesMain.startSearch();
                                        } else if (input_object_category == "data_host") {
                                            searchDataHostsMain.startSearch();
                                        } else if (input_object_category == "metric_host") {
                                            searchMetricHostsMain.startSearch();
                                        }

                                        // show disabled modal
                                        $("#ack_disable_achieved").modal()

                                        // Audit
                                        action = "success";
                                        change_type = "ack disable";
                                        object = input_object;
                                        object_category = input_object_category;
                                        object_attrs = "object:" + input_object + " acknowledge has been disabled (ack_expiration was: " + ack_expiration + "), alerts will be generated depending on state and rules. ";
                                        result = "N/A";
                                        comment = "N/A";
                                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        audit_failure();
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        audit_failure();
                                        $("#modal_update_collection_failure_flush").modal()
                                    }
                                });

                            }

                        }
                    );

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

            });

        });

        // Logical group

        // show modal
        $('.btn_logical_group').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // if the token exists already, restart the search, otherwise allow the search to start
                var tk_start_logical_member_get = tokens.get("tk_start_logical_member_get");

                if (tk_start_logical_member_get && tk_start_logical_member_get.length) {
                    searchLogicalGroupTable.startSearch();
                } else
                {
                    setToken("tk_start_logical_member_get", "true");
                }

                var tk_data_name = tokens.get("tk_data_name");
                var tk_data_host = tokens.get("tk_data_host");
                var tk_metric_host = tokens.get("tk_metric_host");

                //console.log("tk_data_name is " + tk_data_name);
                //console.log("tk_data_host is " + tk_data_host);
                //console.log("tk_metric_host is " + tk_metric_host);

                if (tk_data_name !== undefined) {
                    setToken("input_object", tk_data_name);
                    setToken("input_object_category", "data_source");
                } else if (tk_data_host !== undefined) {
                    setToken("input_object", tk_data_host);
                    setToken("input_object_category", "data_host");
                } else if (tk_metric_host !== undefined) {
                    setToken("input_object", tk_metric_host);
                    setToken("input_object_category", "metric_host");
                }

                // show modal
                $("#logical_group").modal()

            });

        });

        // back
        $("#btn_associate_logical_group_back").click(function() {

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // retrieve token
                var input_object_category = tokens.get("input_object_category");

                // conditional modal target
                if (input_object_category === "data_source") {
                    //console.log("Clicked back");
                    $("#modal_modify_data_source_unified").modal()
                }
                else if (input_object_category === "data_host") {
                    //console.log("Clicked back");
                    $("#modal_modify_data_host_unified").modal()
                }
                else if (input_object_category === "metric_host") {
                    //console.log("Clicked back");
                    $("#modal_modify_metric_host_unified").modal()
                }

        });

        // back delete
        $("#confirm_remove_from_logical_group").click(function() {
                $("#logical_group").modal()
        });

        //
        $('.btn_logical_group_valid').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_name = tokens.get("tk_data_name");
                var tk_data_host = tokens.get("tk_data_host");
                var tk_metric_host = tokens.get("tk_metric_host");

                if (tk_data_name !== undefined) {
                    setToken("input_object", tk_data_name);
                    setToken("input_object_category", "data_source");
                } else if (tk_data_host !== undefined) {
                    setToken("input_object", tk_data_host);
                    setToken("input_object_category", "data_host");
                } else if (tk_metric_host !== undefined) {
                    setToken("input_object", tk_metric_host);
                    setToken("input_object_category", "metric_host");
                }


            });

        });

        // Remove from logical group
        $("#btn_remove_from_logical_group_confirm_valid").click(function() {

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var input_object = tokens.get("input_object");
                var input_object_category = tokens.get("input_object_category");

                //console.log("Proceeding to removal of " + input_object);

                // Define the query
                var searchQuery = "| inputlookup trackme_logical_group | mvexpand object_group_members | where object_group_members!=\"" + input_object + "\" | stats values(*) as \"*\" by object_group_name | outputlookup trackme_logical_group";

                //console.log(keyid);
                //console.log(searchQuery);

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                if (input_object && input_object.length) {

                    // Run a blocking search and get back a job
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            function audit_failure() {

                                // Audit
                                action = "failure";
                                change_type = "Logical group removal";
                                object = input_object;
                                object_category = input_object_category;
                                object_attrs = "object:" + input_object + " has been removed from Logical group. ";
                                result = "N/A";
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {
                                        // show disabled modal
                                        $("#logical_group_removal_achieved").modal()

                                        if (input_object_category === "data_source") {
                                            searchDataSourcesMain.startSearch();
                                        }
                                        else if (input_object_category === "data_host") {
                                            searchDataHostsMain.startSearch();
                                        }
                                        else if (input_object_category === "metric_host") {
                                            searchMetricHostsMain.startSearch();
                                        }

                                        // Audit
                                        action = "success";
                                        change_type = "Logical group removal";
                                        object = input_object;
                                        object_category = input_object_category;
                                        object_attrs = "object:" + input_object + " has been removed from Logical group. ";
                                        result = "N/A";
                                        comment = "N/A";
                                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        audit_failure();
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        audit_failure();
                                        $("#modal_update_collection_failure_flush").modal()
                                    }
                                });

                            }

                        }
                    );

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

        });

        // Add logical group member
        $("#btn_add_logical_group_member").click(function() {

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // if the token exists already, restart the search, otherwise allow the search to start
                var tk_start_logical_member_add = tokens.get("tk_start_logical_member_add");
                
                if (tk_start_logical_member_add && tk_start_logical_member_add.length) {
                    searchLogicalGroupTableAddMember.startSearch();
                } else
                {
                    setToken("tk_start_logical_member_add", "true");
                }

                $("#logical_group_add_member").modal()
        });

        // Add logical group member
        $("#btn_add_logical_group_member_confirm_valid").click(function() {

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var input_object = tokens.get("input_object");
                var input_object_category = tokens.get("input_object_category");

                // keyid is used to add to group
                var tk_keyid = tokens.get("tk_keyid");

                // from click
                var tk_object_group_name = tokens.get("tk_object_group_name");

                // Define the query
                var searchQuery = "| inputlookup trackme_logical_group | eval keyid=_key | mvexpand object_group_members | append [ | makeresults | eval keyid=\"" + tk_keyid + "\", object_group_members=\"" + input_object + "\", object_group_name=\"" + tk_object_group_name + "\", object_group_mtime=now() ] | stats values(object_group_members) as object_group_members, first(object_group_name) as object_group_name, first(object_group_min_green_percent) as object_group_min_green_percent, max(object_group_mtime) as object_group_mtime by keyid | outputlookup trackme_logical_group append=t key_field=keyid";
                //console.log(searchQuery);

                //console.log(keyid);
                //console.log(searchQuery);

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                if (input_object && input_object.length) {

                    // Run a blocking search and get back a job
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            function audit_failure() {

                                // Audit
                                action = "failure";
                                change_type = "Logical group add membership";
                                object = input_object;
                                object_category = input_object_category;
                                object_attrs = "object:" + input_object + " has been added to the logical group " + tk_object_group_name + ".";
                                result = "N/A";
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {
                                        // show disabled modal
                                        $("#logical_group_add_member_achieved").modal()

                                        if (input_object_category === "data_source") {
                                            searchDataSourcesMain.startSearch();
                                        }
                                        else if (input_object_category === "data_host") {
                                            searchDataHostsMain.startSearch();
                                        }
                                        else if (input_object_category === "metric_host") {
                                            searchMetricHostsMain.startSearch();
                                        }

                                        // Audit
                                        action = "success";
                                        change_type = "Logical group add membership";
                                        object = input_object;
                                        object_category = input_object_category;
                                        object_attrs = "object:" + input_object + " has been added to the logical group " + tk_object_group_name + ".";
                                        result = "N/A";
                                        comment = "N/A";
                                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        audit_failure();
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        audit_failure();
                                        $("#modal_update_collection_failure_flush").modal()
                                    }
                                });

                            }

                        }
                    );

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

        });

        // Add logical group member
        $("#btn_add_logical_group_new").click(function() {
                $("#logical_group_add_group").modal()
        });

        // back
        $("#btn_associate_logical_group_add_member_back").click(function() {
                $("#logical_group").modal()
        });

        // back
        $("#btn_associate_logical_group_add_group_back").click(function() {
                $("#logical_group").modal()
        });

        // back
        $("#btn_add_logical_group_member_confirm_back").click(function() {
                $("#logical_group").modal()
        });

        // Add logical group
        $("#btn_associate_logical_group_add_group").click(function() {

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var input_object = tokens.get("input_object");
                var input_object_category = tokens.get("input_object_category");

                // from input
                var tk_object_group_name = tokens.get("InputLogicalGroupName");
                var tk_object_group_green_percent = tokens.get("InputLogicalGroupNamePercent");

                // Define the query
                var searchQuery = "| makeresults | eval object_group_name=\"" + tk_object_group_name + "\", object_group_members=\"" + input_object + "\", object_group_min_green_percent=\"" +  tk_object_group_green_percent + "\", object_group_mtime=now() | append [ | inputlookup trackme_logical_group ] | outputlookup trackme_logical_group";
                //console.log(searchQuery);

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                if (tk_object_group_name && tk_object_group_name.length) {

                    // Run a blocking search and get back a job
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            function audit_failure() {

                                // Audit
                                action = "failure";
                                change_type = "Logical group add";
                                object = tk_object_group_name;
                                object_category = input_object_category;
                                object_attrs = "new logical group " + tk_object_group_name + " has been created for object:" + input_object + " with a minimal logical group green percentage of " + tk_object_group_green_percent + ".";
                                result = "N/A";
                                comment = "N/A";
                                auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                            }

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {
                                        // show disabled modal
                                        $("#logical_group_add_achieved").modal()

                                        if (input_object_category === "data_source") {
                                            searchDataSourcesMain.startSearch();
                                        }
                                        else if (input_object_category === "data_host") {
                                            searchDataHostsMain.startSearch();
                                        }
                                        else if (input_object_category === "metric_host") {
                                            searchMetricHostsMain.startSearch();
                                        }

                                        // Audit
                                        action = "success";
                                        change_type = "Logical group add";
                                        object = tk_object_group_name;
                                        object_category = input_object_category;
                                        object_attrs = "new logical group " + tk_object_group_name + " has been created for object:" + input_object + " with a minimal logical group green percentage of " + tk_object_group_green_percent + ".";
                                        result = "N/A";
                                        comment = "N/A";
                                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        audit_failure();
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        audit_failure();
                                        $("#modal_update_collection_failure_flush").modal()
                                    }
                                });

                            }

                        }
                    );

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

        });

        // object tags

        // return to unified modify when clicking on back
        $("#btn_back_data_host_tags").click(function() {
                $("#modal_manage_host").modal()
        });

        // return to unified modify when clicking on back
        $("#btn_back_metric_host_tags").click(function() {
                $("#modal_manage_metric_host").modal()
        });

        // Outliers simulation

        // data source run simulation
        $("#btn_outlier_config_data_source_simulate").click(function() {

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // get the object name
                var tk_data_name = tokens.get("tk_data_name");

                // set the token the search depends on
                setToken("start_outliers_simulation_data_source", "true");

                // explicitly start the search
                searchOutlierDetectionChartSimulation.startSearch();

                // notify
                notification('Outliers simulation started for data source ' + tk_data_name + '.', 6000)

        });

        $("#btn_outlier_config_data_source_save").unbind('click').click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_last_lag_seen_idx = tokens.get("tk_data_last_lag_seen_idx");
            var tk_data_last_time_seen_idx = tokens.get("tk_data_last_time_seen_idx");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_level = tokens.get("tk_data_monitoring_level");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_source_state = tokens.get("tk_data_source_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_source_state = tokens.get("tk_data_previous_source_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");;
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");

            // get inputs tokens

            var tk_input_data_source_enable_outlier = tokens.get("tk_input_data_source_enable_outlier");
            var tk_input_data_source_outlier_min_eventcount_mode = tokens.get("tk_input_data_source_outlier_min_eventcount_mode");
            var tk_input_data_source_outlier_alert_on_upper = tokens.get("tk_input_data_source_outlier_alert_on_upper");
            var tk_input_data_source_outlier_min_eventcount = tokens.get("tk_input_data_source_outlier_min_eventcount");
            var tk_input_data_source_outlier_lower_threshold_multiplier = tokens.get("tk_input_data_source_outlier_lower_threshold_multiplier");
            var tk_input_data_source_outlier_upper_threshold_multiplier = tokens.get("tk_input_data_source_outlier_upper_threshold_multiplier");
            var tk_input_data_source_outlier_span = tokens.get("tk_input_data_source_outlier_span");

            // OutlierTimePeriod equals to the earliest LinkInput
            var tk_input_data_source_outlier_period = tokens.get("tk_input_data_source_outlier_period");

            // Conditionally define record values for Outliers
            if (tk_enable_behaviour_analytic != tk_input_data_source_enable_outlier) {
                tk_enable_behaviour_analytic = tk_input_data_source_enable_outlier;
            }

            if (tk_outlieralertonupper != tk_input_data_source_outlier_alert_on_upper) {
                tk_outlieralertonupper = tk_input_data_source_outlier_alert_on_upper;
            }

            tk_source_outlier_period = tk_outlier_period;
            if (tk_outlier_period != tk_input_data_source_outlier_period) {
                tk_outlier_period = tk_input_data_source_outlier_period;
            }

            if (tk_outlier_span != tk_input_data_source_outlier_span) {
                tk_outlier_span = tk_input_data_source_outlier_span;
                // refresh the token for current view usage
                setToken("tk_outlier_span", tk_input_data_source_outlier_span);
            }

            if (tk_outlierlowerthresholdmultiplier != tk_input_data_source_outlier_lower_threshold_multiplier && isNumeric(tk_input_data_source_outlier_lower_threshold_multiplier)) {
                tk_outlierlowerthresholdmultiplier = tk_input_data_source_outlier_lower_threshold_multiplier;
            }

            if (tk_outlierupperthresholdmultiplier != tk_input_data_source_outlier_upper_threshold_multiplier && isNumeric(tk_input_data_source_outlier_upper_threshold_multiplier)) {
                tk_outlierupperthresholdmultiplier = tk_input_data_source_outlier_upper_threshold_multiplier;
            }

            if (tk_input_data_source_outlier_min_eventcount_mode === "static" && isNumeric(tk_input_data_source_outlier_min_eventcount)) {
                tk_outliermineventcount = tk_input_data_source_outlier_min_eventcount;
            } else {
                tk_outliermineventcount = "-1";
                tk_input_data_source_outlier_min_eventcount_mode = "dynamic";
            }

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring/" + tk_keyid;

            // Create a dictionary to store the field names and values
            var record = {
                "object_category": "data_source",
                "data_name": tk_data_name,
                "data_index": tk_data_index,
                "data_sourcetype": tk_data_sourcetype,
                "data_last_lag_seen": tk_data_last_lag_seen,
                "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                "data_eventcount": tk_data_eventcount,
                "data_first_time_seen": tk_data_first_time_seen,
                "data_last_time_seen": tk_data_last_time_seen,
                "data_last_ingest": tk_data_last_ingest,
                "data_last_lag_seen_idx": tk_data_last_lag_seen_idx,
                "data_last_time_seen_idx": tk_data_last_time_seen_idx,
                "data_max_lag_allowed": tk_data_max_lag_allowed,
                "data_monitored_state": tk_data_monitored_state,
                "data_monitoring_level": tk_data_monitoring_level,
                "data_monitoring_wdays": tk_data_monitoring_wdays,
                "data_override_lagging_class": tk_data_override_lagging_class,
                "data_source_state": tk_data_source_state,
                "data_tracker_runtime": tk_data_tracker_runtime,
                "data_previous_source_state": tk_data_previous_source_state,
                "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                "OutlierMinEventCount": tk_outliermineventcount,
                "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                "OutlierAlertOnUpper": tk_outlieralertonupper,
                "OutlierTimePeriod": tk_outlier_period,
                "OutlierSpan": tk_outlier_span,
                "isOutlier": tk_isoutlier,
                "enable_behaviour_analytic": tk_enable_behaviour_analytic,
                "latest_flip_state": tk_latest_flip_state,
                "latest_flip_time": tk_latest_flip_time,
                "priority": tk_priority
            };

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)

                        // notify
                        var tk_data_name = tokens.get("tk_data_name");
                        var tk_data_index = tokens.get("tk_data_index");
                        var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
                        notification('Outliers configuration updated, please wait a few seconds while statistics are generated, click on refresh in the Outliers tab if statistics are not yet available.', 6000)

                        // Generate metrics if outlier period was changed
                        if (tk_source_outlier_period != tk_input_data_source_outlier_span) {
                            metricOutliersGen("data_source", tk_data_name, tk_input_data_source_outlier_period);
                        }

                        // call update summary investigator for that entity only
                        updateDataSourceEntity(tk_data_name, tk_data_index, tk_data_sourcetype);

                        searchSingleLag.startSearch();
                        searchChartLag.startSearch();
                        searchSingleSLApct.startSearch();
                        searchOutlierDetectionChart.startSearch();
                        searchOutlierDetectionTable.startSearch();

                        // call update data source
                        var tk_keyid = tokens.get("tk_keyid");
                        updateDataSource(tk_keyid);

                        // Audit
                        action = "success";
                        change_type = "modify outliers";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = JSON.stringify(record, null, '\t');
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "modify outliers";
                        object = tk_data_name;
                        object_category = "data_source";
                        object_attrs = JSON.stringify(record, null, '\t');
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }

        });

        // Outliers simulation

        // data source run simulation
        $("#btn_outlier_config_data_host_simulate").click(function() {

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // get the object name
                var tk_data_host = tokens.get("tk_data_host");

                // set the token the search depends on
                setToken("start_outliers_simulation_data_host", "true");

                // explicitly start the search
                searchOutlierDetectionChartSimulationDataHost.startSearch();

                // notify
                notification('Outliers simulation started for data host ' + tk_data_host + '.', 6000)

        });

        $("#btn_outlier_config_data_host_save").click(function(mode) {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_host_state = tokens.get("tk_data_host_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_host_state = tokens.get("tk_data_previous_host_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_outliermineventcount = tokens.get("tk_outliermineventcount");
            var tk_outlierlowerthresholdmultiplier = tokens.get("tk_outlierlowerthresholdmultiplier");
            var tk_outlierupperthresholdmultiplier = tokens.get("tk_outlierupperthresholdmultiplier");
            var tk_outlieralertonupper = tokens.get("tk_outlieralertonupper");
            var tk_outlier_period = tokens.get("tk_outlier_period");
            var tk_outlier_span = tokens.get("tk_outlier_span");
            var tk_isoutlier = tokens.get("tk_isoutlier");
            var tk_enable_behaviour_analytic = tokens.get("tk_enable_behaviour_analytic");
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_latest_flip_time = tokens.get("tk_latest_flip_time");
            var tk_priority = tokens.get("tk_priority");

            // get inputs tokens

            var tk_input_data_host_enable_outlier = tokens.get("tk_input_data_host_enable_outlier");
            var tk_input_data_host_outlier_min_eventcount_mode = tokens.get("tk_input_data_host_outlier_min_eventcount_mode");
            var tk_input_data_host_outlier_alert_on_upper = tokens.get("tk_input_data_host_outlier_alert_on_upper");
            var tk_input_data_host_outlier_min_eventcount = tokens.get("tk_input_data_host_outlier_min_eventcount");
            var tk_input_data_host_outlier_lower_threshold_multiplier = tokens.get("tk_input_data_host_outlier_lower_threshold_multiplier");
            var tk_input_data_host_outlier_upper_threshold_multiplier = tokens.get("tk_input_data_host_outlier_upper_threshold_multiplier");
            var tk_input_data_host_outlier_period = tokens.get("tk_input_data_host_outlier_period");
            var tk_input_data_host_outlier_span = tokens.get("tk_input_data_host_outlier_span");

            // Conditionally define record values for Outliers
            if (tk_enable_behaviour_analytic != tk_input_data_host_enable_outlier) {
                tk_enable_behaviour_analytic = tk_input_data_host_enable_outlier;
            }

            if (tk_outlieralertonupper != tk_input_data_host_outlier_alert_on_upper) {
                tk_outlieralertonupper = tk_input_data_host_outlier_alert_on_upper;
            }

            tk_source_outlier_period = tk_outlier_period;
            if (tk_outlier_period != tk_input_data_host_outlier_period) {
                tk_outlier_period = tk_input_data_host_outlier_period;
            }

            if (tk_outlier_span != tk_input_data_host_outlier_span) {
                tk_outlier_span = tk_input_data_host_outlier_span;
                // refresh the token for current view usage
                setToken("tk_outlier_span", tk_input_data_host_outlier_span);
            }

            if (tk_outlierlowerthresholdmultiplier != tk_input_data_host_outlier_lower_threshold_multiplier && isNumeric(tk_input_data_host_outlier_lower_threshold_multiplier)) {
                tk_outlierlowerthresholdmultiplier = tk_input_data_host_outlier_lower_threshold_multiplier;
            }

            if (tk_outlierupperthresholdmultiplier != tk_input_data_host_outlier_upper_threshold_multiplier && isNumeric(tk_input_data_host_outlier_upper_threshold_multiplier)) {
                tk_outlierupperthresholdmultiplier = tk_input_data_host_outlier_upper_threshold_multiplier;
            }

            if (tk_input_data_host_outlier_min_eventcount_mode === "static" && isNumeric(tk_input_data_host_outlier_min_eventcount)) {
                tk_outliermineventcount = tk_input_data_host_outlier_min_eventcount;
            } else {
                tk_outliermineventcount = "-1";
                tk_input_data_host_outlier_min_eventcount_mode = "dynamic";
            }

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_host_monitoring/" + tk_keyid;

            // Create a dictionary to store the field names and values
            var record = {
                "object_category": "data_host",
                "data_host": tk_data_host,
                "data_index": tk_data_index,
                "data_sourcetype": tk_data_sourcetype,
                "data_last_lag_seen": tk_data_last_lag_seen,
                "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                "data_eventcount": tk_data_eventcount,
                "data_first_time_seen": tk_data_first_time_seen,
                "data_last_time_seen": tk_data_last_time_seen,
                "data_last_ingest": tk_data_last_ingest,
                "data_max_lag_allowed": tk_data_max_lag_allowed,
                "data_monitored_state": tk_data_monitored_state,
                "data_monitoring_wdays": tk_data_monitoring_wdays,
                "data_override_lagging_class": tk_data_override_lagging_class,
                "data_host_state": tk_data_host_state,
                "data_tracker_runtime": tk_data_tracker_runtime,
                "data_previous_host_state": tk_data_previous_host_state,
                "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                "OutlierMinEventCount": tk_outliermineventcount,
                "OutlierLowerThresholdMultiplier": tk_outlierlowerthresholdmultiplier,
                "OutlierUpperThresholdMultiplier": tk_outlierupperthresholdmultiplier,
                "OutlierAlertOnUpper": tk_outlieralertonupper,
                "OutlierTimePeriod": tk_outlier_period,
                "OutlierSpan": tk_outlier_span,
                "isOutlier": tk_isoutlier,
                "enable_behaviour_analytic" : tk_enable_behaviour_analytic,
                "latest_flip_state": tk_latest_flip_state,
                "latest_flip_time": tk_latest_flip_time,
                "priority": tk_priority
            };

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)

                        // notify
                        var tk_data_host = tokens.get("tk_data_host");
                        notification('Outliers configuration updated, please wait a few seconds while statistics are generated, click on refresh in the Outliers tab if statistics are not yet available.', 6000)

                        // Generate metrics if outlier period was changed
                        if (tk_source_outlier_period != tk_input_data_host_outlier_span) {
                            metricOutliersGen("data_host", tk_data_host, tk_input_data_host_outlier_period);
                        }

                        // call update summary investigator for that entity only
                        updateDataHostEntity("trackme_datahost_tracker_shorterm", tk_data_host);

                        searchSingleLagHost.startSearch();
                        searchChartHostBaseSearch.startSearch();
                        searchChartLagHostOverTime.startSearch();
                        searchSingleSLAHostpct.startSearch();
                        searchOutlierDetectionChartDataHost.startSearch();
                        searchOutlierDetectionTableDataHost.startSearch();

                        // call update data host
                        var tk_keyid = tokens.get("tk_keyid");
                        updateDataHost(tk_keyid);

                        // Audit
                        action = "success";
                        change_type = "modify outliers";
                        object = tk_data_host;
                        object_category = "data_host";
                        object_attrs = JSON.stringify(record, null, '\t');
                        result = "N/A";
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit
                        action = "failure";
                        change_type = "modify outliers";
                        object = tk_data_host;
                        object_category = "data_host";
                        object_attrs = JSON.stringify(record, null, '\t');
                        result = message;
                        comment = "N/A";
                        auditRecord(action, change_type, object, object_category, object_attrs, result, comment);

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }

        });

        // END

        DashboardController.onReady(function() {
            if (!submittedTokenModel.has('earliest') && !submittedTokenModel.has('latest')) {
                submittedTokenModel.set({
                    earliest: '0',
                    latest: ''
                });
            }
        });

        // Initialize time tokens to default
        if (!defaultTokenModel.has('earliest') && !defaultTokenModel.has('latest')) {
            defaultTokenModel.set({
                earliest: '0',
                latest: ''
            });
        }

        if (!_.isEmpty(urlTokenModel.toJSON())) {
            submitTokens();
        }

        //
        // DASHBOARD READY
        //

        DashboardController.ready();
        pageLoading = false;

    }
);
// ]]>
</script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/trackme/table.js" type="text/javascript"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/trackme/checkbox_table.js" type="text/javascript"></script>
<script>
$(".btn").mouseup(function(){
    $(this).blur();
})
</script>
<script>
$('.modal').on('show.bs.modal', function () {
    $('.modal').not($(this)).each(function () {
        $(this).modal('hide');
    });
});
</script>
<script>
function notification(s, time) {

  $("<p>" + s + "</p>").appendTo('#boxnotify-data-source').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-data-host').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-metric-host').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-unified-data-source').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-unified-data-source-autolag').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-unified-data-host').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-unified-data-host-autolag').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-unified-metric-host').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_source_whitelist').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_host_whitelist').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_metric_host_whitelist').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_source_blacklist_host').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_source_blacklist_index').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_source_blacklist_sourcetype').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_host_blacklist_host').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_host_blacklist_index').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_metric_host_blacklist_host').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_metric_host_blacklist_index').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_host_blacklist_sourcetype').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_metric_host_blacklist_metric_category').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modify_custom_lagging').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-data-source-outliers-update').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-data-host-outliers-update').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-add_elastic_source').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

}
</script>
</body>
</html>