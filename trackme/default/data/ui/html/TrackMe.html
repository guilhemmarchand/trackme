<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>TrackMe - Data tracking system</title>
    <link rel="shortcut icon" href="/en-US/static/@E0748683B67CEA4FEB581C608314742274902FE131518C73E0D443740659785A.7/img/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="{{SPLUNKWEB_URL_PREFIX}}/static/build/css/bootstrap-enterprise.css" />
    <link rel="stylesheet" type="text/css" href="{{SPLUNKWEB_URL_PREFIX}}/static/css/build/pages/dashboard-simple-bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" media="all" href="{{SPLUNKWEB_URL_PREFIX}}/static/app/trackme/table.css" />
    <link rel="stylesheet" type="text/css" media="all" href="{{SPLUNKWEB_URL_PREFIX}}/static/app/trackme/common.css" />


    <meta name="referrer" content="never" />
    <meta name="referrer" content="no-referrer" />

    <script>
        window._splunk_metrics_events = {
            push : function() {},
            active: false,
        }
    </script>
    <style>
        /* Bootstrap btns */
        .btn-primary{color:#fff;background-color:#337ab7;border-color:#2e6da4}.btn-primary.focus,.btn-primary:focus{color:#fff;background-color:#286090;border-color:#122b40}.btn-primary:hover{color:#fff;background-color:#286090;border-color:#204d74}.btn-primary.active,.btn-primary:active,.open>.dropdown-toggle.btn-primary{color:#fff;background-color:#286090;border-color:#204d74}.btn-primary.active.focus,.btn-primary.active:focus,.btn-primary.active:hover,.btn-primary:active.focus,.btn-primary:active:focus,.btn-primary:active:hover,.open>.dropdown-toggle.btn-primary.focus,.open>.dropdown-toggle.btn-primary:focus,.open>.dropdown-toggle.btn-primary:hover{color:#fff;background-color:#204d74;border-color:#122b40}.btn-primary.active,.btn-primary:active,.open>.dropdown-toggle.btn-primary{background-image:none}.btn-primary.disabled.focus,.btn-primary.disabled:focus,.btn-primary.disabled:hover,.btn-primary[disabled].focus,.btn-primary[disabled]:focus,.btn-primary[disabled]:hover,fieldset[disabled] .btn-primary.focus,fieldset[disabled] .btn-primary:focus,fieldset[disabled] .btn-primary:hover{background-color:#337ab7;border-color:#2e6da4}.btn-primary .badge{color:#337ab7;background-color:#fff}

        .btn-danger{color:#fff;background-color:#d9534f;border-color:#d43f3a}.btn-danger.focus,.btn-danger:focus{color:#fff;background-color:#c9302c;border-color:#761c19}.btn-danger:hover{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger.active,.btn-danger:active,.open>.dropdown-toggle.btn-danger{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger.active.focus,.btn-danger.active:focus,.btn-danger.active:hover,.btn-danger:active.focus,.btn-danger:active:focus,.btn-danger:active:hover,.open>.dropdown-toggle.btn-danger.focus,.open>.dropdown-toggle.btn-danger:focus,.open>.dropdown-toggle.btn-danger:hover{color:#fff;background-color:#ac2925;border-color:#761c19}.btn-danger.active,.btn-danger:active,.open>.dropdown-toggle.btn-danger{background-image:none}.btn-danger.disabled.focus,.btn-danger.disabled:focus,.btn-danger.disabled:hover,.btn-danger[disabled].focus,.btn-danger[disabled]:focus,.btn-danger[disabled]:hover,fieldset[disabled] .btn-danger.focus,fieldset[disabled] .btn-danger:focus,fieldset[disabled] .btn-danger:hover{background-color:#d9534f;border-color:#d43f3a}.btn-danger .badge{color:#d9534f;background-color:#fff}

        .btn-info{color:#fff;background-color:#5bc0de;border-color:#46b8da}.btn-info.focus,.btn-info:focus{color:#fff;background-color:#31b0d5;border-color:#1b6d85}.btn-info:hover{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info.active,.btn-info:active,.open>.dropdown-toggle.btn-info{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info.active.focus,.btn-info.active:focus,.btn-info.active:hover,.btn-info:active.focus,.btn-info:active:focus,.btn-info:active:hover,.open>.dropdown-toggle.btn-info.focus,.open>.dropdown-toggle.btn-info:focus,.open>.dropdown-toggle.btn-info:hover{color:#fff;background-color:#269abc;border-color:#1b6d85}.btn-info.active,.btn-info:active,.open>.dropdown-toggle.btn-info{background-image:none}.btn-info.disabled.focus,.btn-info.disabled:focus,.btn-info.disabled:hover,.btn-info[disabled].focus,.btn-info[disabled]:focus,.btn-info[disabled]:hover,fieldset[disabled] .btn-info.focus,fieldset[disabled] .btn-info:focus,fieldset[disabled] .btn-info:hover{background-color:#5bc0de;border-color:#46b8da}.btn-info .badge{color:#5bc0de;background-color:#fff}

        .btn-warning{color:#fff;background-color:#f0ad4e;border-color:#eea236}.btn-warning.focus,.btn-warning:focus{color:#fff;background-color:#ec971f;border-color:#985f0d}.btn-warning:hover{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning.active,.btn-warning:active,.open>.dropdown-toggle.btn-warning{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning.active.focus,.btn-warning.active:focus,.btn-warning.active:hover,.btn-warning:active.focus,.btn-warning:active:focus,.btn-warning:active:hover,.open>.dropdown-toggle.btn-warning.focus,.open>.dropdown-toggle.btn-warning:focus,.open>.dropdown-toggle.btn-warning:hover{color:#fff;background-color:#d58512;border-color:#985f0d}.btn-warning.active,.btn-warning:active,.open>.dropdown-toggle.btn-warning{background-image:none}.btn-warning.disabled.focus,.btn-warning.disabled:focus,.btn-warning.disabled:hover,.btn-warning[disabled].focus,.btn-warning[disabled]:focus,.btn-warning[disabled]:hover,fieldset[disabled] .btn-warning.focus,fieldset[disabled] .btn-warning:focus,fieldset[disabled] .btn-warning:hover{background-color:#f0ad4e;border-color:#eea236}.btn-warning .badge{color:#f0ad4e;background-color:#fff}

        .btn-success{color:#fff;background-color:#5cb85c;border-color:#4cae4c}.btn-success.focus,.btn-success:focus{color:#fff;background-color:#449d44;border-color:#255625}.btn-success:hover{color:#fff;background-color:#449d44;border-color:#398439}.btn-success.active,.btn-success:active,.open>.dropdown-toggle.btn-success{color:#fff;background-color:#449d44;border-color:#398439}.btn-success.active.focus,.btn-success.active:focus,.btn-success.active:hover,.btn-success:active.focus,.btn-success:active:focus,.btn-success:active:hover,.open>.dropdown-toggle.btn-success.focus,.open>.dropdown-toggle.btn-success:focus,.open>.dropdown-toggle.btn-success:hover{color:#fff;background-color:#398439;border-color:#255625}.btn-success.active,.btn-success:active,.open>.dropdown-toggle.btn-success{background-image:none}.btn-success.disabled.focus,.btn-success.disabled:focus,.btn-success.disabled:hover,.btn-success[disabled].focus,.btn-success[disabled]:focus,.btn-success[disabled]:hover,fieldset[disabled] .btn-success.focus,fieldset[disabled] .btn-success:focus,fieldset[disabled] .btn-success:hover{background-color:#5cb85c;border-color:#4cae4c}.btn-success .badge{color:#5cb85c;background-color:#fff}

        /* Prevents green disabled button */
        .btn-primary[disabled] {
            background-color: #337ab7;
            opacity: .40;
        }
        /* Manage modal hidden properly */
        .modal {
            display: none;
        }
        /* Increase modal width */
        .custom-modal-50 {
            width: 50%;
            margin-left: -25%;
        }
        .custom-modal-60 {
            width: 60%;
            margin-left: -30%;
        }
        .custom-modal-80 {
            width: 80%;
            margin-left: -40%;
        }

        .modal-big {
          height: 800px;
          max-height: 400%;
          width: 80%;
          margin-left: -40%;
        }

        .modal-guts {

          /* For Splunk 7.0.x */
          margin-top: 30px;

          /* other stuff we already covered */

          /* cover the modal */
          position: absolute;

          width: 90%;
          min-height: 50px;
          max-height: 600px;
          height: 100%;

          /* spacing as needed */
          padding: 20px 50px 20px 20px;

          /* let it scroll */
          overflow: auto;

        }

        /* fix some issues with long modals within Splunk 7.0.x */
        .modal-body {
            max-height: 700px !important;
        }

        /* Fix link input object align */
        .input-linklist {
          display: inline !important;
        }

        /* Fix link input object align for Splunk 6.5 */
        .input-link {
          display: inline !important;
        }

        /* reduce size of the token input panel */
        .input-link label{
          display: none !important;
        }

        .splunk-choice-input-message{
          display: none !important;
        }

        /* Increase the default max-width for links */
        .btn-pill {
          max-width: 600px !important;
        }

        .custom-btn {
            float: left;
            margin-top:15px;
        }

        /*Notification alerts*/

        [class^="boxnotify"] {
          position: fixed;
          bottom: 1em;
          left: 1em;
          z-index: 999999;
        }

        [class^="boxnotify"] p {
          background-color: rgba(0, 0, 0, .7);
          width: 600px;
          border-radius: 5px;
          padding: .7em;
          margin: .5em;
          color: white;
          font-size: 1.6em;
          display: none;
        }

        span.title_yellow {
            background: #ffd700;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_orange {
            background: #ffb347;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_green {
            background: #77dd77;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_red {
            background: #ff6961;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        span.title_grey {
            background: #808080;
            padding: 0.3em 1.5em;
            font-weight: 600;
            position: relative;
            border-radius: 5px;
            margin-left: 5px;
        }

        .imgheader {
           margin-top: 10px;
           margin-bottom: 40px;
        }

        .imgheader img {
            float: left;
            width: 48px;
            height: 48px;
        }

        .imgheader h1 {
            color: lightslategrey;
            text-align: left;
            position: relative;
            top: 9px;
            left: 10px;
        }

        .imgheader h3 {
            position: relative;
            top: 14px;
            left: -10px;
        }

        .imgminiheader img {
            position: relative;
            top: -4px;
        }

        </style>
</head>
<body class="simplexml preload locale-en" data-splunk-version="" data-splunk-product="enterprise">
<!--
BEGIN LAYOUT
This section contains the layout for the dashboard. Splunk uses proprietary
styles in <div> tags, similar to Bootstrap's grid system.
-->
<header>
    <a class="navSkip" href="#navSkip" tabindex="1">Screen reader users, click here to skip the navigation bar</a>
    <div class="header splunk-header">
        <div id="placeholder-splunk-bar">
            <a href="{{SPLUNKWEB_URL_PREFIX}}/app/launcher/home" class="brand" title="splunk &gt; listen to your data">splunk<strong>&gt;</strong></a>
        </div>
        <div id="placeholder-app-bar"></div>
    </div>
    <a id="navSkip"></a>
</header>
<div class="dashboard-body container-fluid main-section-body" data-role="main">
    <div class="dashboard-header clearfix">
        <h2>TrackMe - Data tracking system</h2>
         <p>Monitoring your Splunk data availability made easy</p>
    </div>

    <div style="display: none;" class="fieldset">
    </div>

    <!--
    identity card
    -->

    <!-- Modal drilldown context for identity card -->
    <div id="main_manage_identity_card" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade custom-modal-50" id="manage_identity_card" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_manage_identity_card">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3 style="font-size: 18px;">Identity card for data source: <span style="color: steelblue">$tk_data_name$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div style="margin-top:10px; margin-left: 20px;">

                                    <div class="imgheader">
                                        <img style="float: left; margin: 0px 15px 15px 0px;" src="../../static/app/trackme/icons/identity_card.png"/></span>
                                        <h3>Identity card note:</h3>
                                        <br />
                                    </div>

                                    <div>
                                      $tk_doc_note$
                                    </div>

                                    <div style="margin-bottom: 20px;">
                                        <h3>Link to documentation: </h3><a target="_blank" href="$tk_doc_link$">$tk_doc_link$</a>
                                    </div>
                                </div>

                            </div>
                        </div>
                    <div class="modal-footer">
                        <button type="submit" id="btn_delete_manage_identity_card" class="btn btn-default btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Delete card</button>
                        <button type="submit" id="btn_modify_manage_identity_card" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Update card</button>
                        <button type="submit" id="btn_back_manage_identity_card" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                        <button type="submit" id="btn_close_manage_identity_card" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                    </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window define for identity card -->
    <div class="modal fade custom-modal-60" id="define_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <form>
                                <fieldset>
                                    <legend>Define a link and a note to document this data source</legend>
                                    <p>
                                        <label>Optional: enter the documentation link, this will be made available in the source identity card:</label>
                                        <input type = "text"
                                               id = "input_doc_link"
                                               value = "link to documentation"
                                               style="width: 900px;"
                                               onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;"/>
                                    </p>

                                    <p>
                                        <label>Optional: enter a documentation note:</label>
                                        <textarea
                                                id = "input_doc_note"
                                                rows = "10"
                                                cols = "160" style="width: 900px;"
                                                onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;">documentation note</textarea>
                                    </p>

                                </fieldset>
                            </form>

                            <div style="float: left;">

                                <div class="btn_define_identity_card custom-btn" style="margin-right: 15px;">
                                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Create or update this record </button>
                                </div>

                                <div class="btn_associate_identity_card custom-btn" style="margin-right: 15px;">
                                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Or associate with an existing record </button>
                                </div>

                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_define_identity_card_back" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window define for identity card association -->
    <div class="modal fade custom-modal-80" id="associate_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h3>
                </div>
                <div class="modal-body">
                    <b>Associate with an existing identity card:</b>
                    <br /><br />

                    <div id="rowAssociateIdentityCard" class="dashboard-row dashboard-row3">
                        <div id="panelAssociateIdentityCard" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">

                                        <div class="input input-text" id="FilterIdentityCardTable" style="margin-bottom: 10px;">
                                            <label>Filter:</label>
                                        </div>

                                        <div id="elementIdentityCardTable" class="dashboard-element table" style="width: 100%">
                                            <label>Click on a table entry to associate with an existing identity card:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_associate_identity_card_back" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window association confirmation for identity card -->
    <div class="modal fade" id="confirm_associate_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Please confirm the association of the identity card records?</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_associate_identity_card_confirm_valid" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Confirm association </button>
                    <button type="submit" id="btn_associate_identity_card_confirm_back" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window deletion for identity card -->
    <div class="modal fade" id="delete_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Please confirm the deletion of the identity card records?</h4>
                                <p>If this record is the last associated with the identity card, this identity card will be permanently removed.</p>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_delete_identity_card_confirm" class="btn btn-default btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Delete this record </button>
                    <button type="submit" id="btn_delete_identity_card_back" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window confirmation of association for identity card -->
    <div class="modal fade" id="associate_achieved_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>The identity card record was successfully associated with this source.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window confirmation of deletion for identity card -->
    <div class="modal fade" id="update_achieved_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>The identity card record was successfully created or updated.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window confirmation of deletion for identity card -->
    <div class="modal fade" id="delete_achieved_identity_card" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Documentation identity card </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>The identity card record was successfully deleted.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window for ack -->
    <div class="modal fade custom-modal-80" id="confirm_ack" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Acknowledge active alert </h3>
                </div>

                <div class="modal-body">

                    <div id="rowAckGet" class="dashboard-row dashboard-row3">
                        <div id="panelAckGet" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div>
                                        <h4>Do you want to acknowledge this alert?</h4>

                                        <p>When an active alert is acknowledged, it remains visible in the user interface and monitored, therefore no more
                                        alerts will be generated based on the builtin alerting for that source.
                                        <br /><br />
                                        An acknowledgment is valid for a period of time, and will be disabled automatically once its expiration time has been reached.
                                        <br />
                                        If an active acknowledgment is acknowledged again, its expiration is extended for a new cycle.
                                        <br /><br />
                                        An acknowledgment is automatically disabled when the source flips again to a green state.
                                        <br /><br />
                                        <b>Click on Confirm Ack to acknowledge this alert (if Ack is inactive), or click on the table entry if the Ack is active and you wish to disable it now.</b>
                                        </p>

                                    </div>

                                    <div class="fieldset">

                                        <div id="elementAckGet" class="dashboard-element table" style="width: 100%">
                                            <label>Current Ack status:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                        <div class="input input-dropdown" id="input_ack_duration">
                                            <label>Ack duration:</label>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <div style="margin-right: 15px; float: right;">
                        <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                    </div>
                    <div class="btn_ack_confirm_valid" style="margin-right: 15px; float: right;">
                        <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Confirm Ack </button>
                    </div>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window confirmation of association for identity card -->
    <div class="modal fade" id="ack_achieved" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Acknowledge active alert </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Alert acknowledgment was successfully created.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <div class="modal fade" id="ack_disable_achieved" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Acknowledge active alert </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Alert acknowledgment was successfully disabled.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <div class="modal fade" id="ack_disable_already" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Acknowledge active alert </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Alert acknowledgment is already inactive.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window for ack -->
    <div class="modal fade" id="disable_ack" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Acknowledge active alert </h3>
                </div>

                <div class="modal-body">

                    <div id="rowAckDelete" class="dashboard-row dashboard-row3">
                        <div id="panelAckDelete" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div>
                                        <h4>Do you want to disable this acknowledge ?</h4>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <div style="margin-right: 15px; float: right;">
                        <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                    </div>
                    <div class="btn_ack_disable_valid" style="margin-right: 15px; float: right;">
                        <button type="submit" class="btn btn-default btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Disable Ack </button>
                    </div>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window for logical group association -->
    <div class="modal fade custom-modal-80" id="logical_group" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Logical group </h3>
                </div>
                <div class="modal-body">
                    <b>Entities logical group management</b>
                    <br /><br />

                    <div id="rowAddLogicalGroup" class="dashboard-row dashboard-row" data-depends="$show_add_logical_group$">
                        <div id="panelAddLogicalGroup" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">This entity is not currently associated to a logical group, choose one of the following options:</h3>

                                        <div style="margin-top: 20px;">
                                            <div style="float: left; margin-right: 20px;">
                                                <button type="submit" id="btn_add_logical_group_new" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Create a new group </button>
                                            </div>
                                            <div style="float: left; margin-right: 20px;">
                                                <button type="submit" id="btn_add_logical_group_member" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add to an existing group </button>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowTableLogicalGroup" class="dashboard-row dashboard-row3" data-depends="$show_table_logical_group$">
                        <div id="panelTableLogicalGroup" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">This entity is currently associated with the following logical group, if you wish to remove this
                                            membership, click on the table entry bellow:</h3>
                                    </div>

                                    <div class="fieldset">

                                        <div id="elementLogicalGroupTable" class="dashboard-element table" style="width: 100%">
                                            <label></label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_associate_logical_group_back" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window for logical group association -->
    <div class="modal fade custom-modal-80" id="logical_group_add_member" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Logical group </h3>
                </div>
                <div class="modal-body">
                    <b>Entities logical group management</b>
                    <br /><br />

                    <div id="rowTableLogicalGroupAddMember" class="dashboard-row dashboard-row3">
                        <div id="panelTableLogicalGroupAddMember" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">Click on a logical group in the table bellow to make this entity part of the group.
                                        Optionally use the filter input to search in existing groups.</h3>
                                    </div>

                                    <div class="fieldset">

                                        <div class="input input-text" id="FilterLogicalGroupTable" style="margin-bottom: 10px;">
                                            <label>Filter:</label>
                                        </div>

                                        <div id="elementLogicalGroupTableAddMember" class="dashboard-element table" style="width: 100%">
                                            <label></label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_associate_logical_group_add_member_back" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window for logical group association -->
    <div class="modal fade custom-modal-50" id="logical_group_add_group" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Logical group </h3>
                </div>
                <div class="modal-body">
                    <b>Entities logical group management</b>
                    <br /><br />

                    <div id="rowTableLogicalGroupAddGroup" class="dashboard-row dashboard-row3">
                        <div id="panelTableLogicalGroupAddGroup" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">Create a new logical group, once created the current entity will automatically member of it.
                                            You can then add as many members as you need to form the logical group entity.
                                        </h3>
                                    </div>

                                    <div class="fieldset">
                                        <div class="input input-text" id="InputLogicalGroupName" style="margin-bottom: 10px;">
                                            <label>Enter the logical group name:</label>
                                        </div>
                                    </div>
                                    <div class="fieldset">
                                        <div class="input input-dropdown" id="InputLogicalGroupNamePercent" style="margin-bottom: 10px;">
                                            <label>Minimal percent of members in green state:</label>
                                        </div>
                                        <div style="margin-top: 10px;">
                                            <p>A logical group of 2 members with a minimal 50% green state means one member actively generating data will not trigger alerts.</p>
                                        </div>
                                    </div>

                                    <div class="modal-body" style="margin-top: 20px;">
                                        <button type="submit" id="btn_associate_logical_group_add_group" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Create new logical group </button>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer" style="margin-top: 20px;">
                    <button type="submit" id="btn_associate_logical_group_add_group_back" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window Logical group removal -->
    <div class="modal fade" id="confirm_remove_from_logical_group" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Logical group </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Do you want to remove this entity from the logical group?</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_remove_from_logical_group_confirm_valid" class="btn btn-default btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Remove association </button>
                    <button type="submit" id="btn_remove_from_logical_group_confirm_back" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back </button>
                </div>

            </div>

        </div>
    </div>

    <div class="modal fade" id="logical_group_removal_achieved" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Logical group </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Logical group membership was successfully removed.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal window Logical group removal -->
    <div class="modal fade" id="confirm_add_member_logical_group" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Logical group </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Do you want to add the entity in the logical group?</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_add_logical_group_member_confirm_valid" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Confirm membership </button>
                    <button type="submit" id="btn_add_logical_group_member_confirm_back" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back </button>
                </div>

            </div>

        </div>
    </div>

    <div class="modal fade" id="logical_group_add_member_achieved" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Logical group </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Logical group membership was successfully achieved.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <div class="modal fade" id="logical_group_add_achieved" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Logical group </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <div>
                                <h4>Logical group has been successfully created, and entity associated.</h4>
                            </div>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal drilldown context for Alerts -->
    <div id="main_modal_manage" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade custom-modal-80" id="modal_manage" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3 style="font-size: 18px;">Actions for data source: <span style="color: steelblue">$tk_data_name$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div style="margin-top:10px; margin-left: 20px;">
                                    <div style="float:left;width:33%;">
                                        <p><b>data_index:</b> $tk_data_index$</p>
                                        <p><b>data_sourcetype:</b> $tk_data_sourcetype$</p>
                                        <p><b>lag event / lag ingestion:</b> $tk_data_lag_summary$</p>
                                        <p><b>data_last_time_seen:</b> $tk_data_last_time_seen_human$</p>
                                    </div>
                                    <div style="float:left;width:33%;">
                                        <p><b>data_last_ingest:</b> $tk_data_last_ingest_human$</p>
                                        <p><b>data_max_lag_allowed:</b> $tk_data_max_lag_allowed$</p>
                                        <p><b>data_monitored_state:</b> <span class="$tk_data_monitored_state_class$">$tk_data_monitored_state$</span></p>
                                        <p><b>data_monitoring_level:</b> $tk_data_monitoring_level$</p>
                                    </div>
                                    <div style="float:left;width:33%;">
                                        <p><b>latest_flip_time:</b> $tk_latest_flip_time_human$</p>
                                        <p><b>latest_flip_state:</b> $tk_latest_flip_state$</p>
                                        <p><b>state:</b> <span class="$tk_data_source_state_class$">$tk_data_source_state$</span></p>
                                        <p><b>priority:</b> <span class="$tk_priority_class$">$tk_priority$</span></p>
                                    </div>
                                </div>

                                <div style="margin-left: 10px;">
                                    <div class="imgheader">
                                        <img style="float: left; margin: 0px 15px 15px 0px;" src="../../static/app/trackme/icons/identity_card.png"/>
                                        <h3><a id="doc_link_data_source" data-toggle="modal" data-target="#$tk_doc_modal_target$">$tk_doc_link_main$</a></h3>
                                    </div>
                                </div>

                            </div>
                        </div>

                        <div>
                            <hr width="100%" size="8" align="center">
                        </div>

                        <div id="rowSingleLag" class="dashboard-row dashboard-row1">
                            <div id="panelSingleLag2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementSingleLagPerc95" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                        <div id="elementSingleLagAvg" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartLag" class="dashboard-row dashboard-row1">
                            <div id="panelChartLag2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementChartLag" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowLinkLag" class="dashboard-row dashboard-row1" style="margin-left: 15px;">
                            <div id="panelLinktLag2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="input input-linklist" id="inputLinkTime">
                                            <label>&nbsp;</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="modal-footer">
                            <div style="margin-right: 15px; float: left;">
                                <button type="submit" id="btn_refresh_data_source" role="button" class="btn btn-primary btn-default pull-left"><span class="glyphicon glyphicon-remove"></span>Refresh</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <a class="btn btn-primary" id="btn_search_data_source" target="_blank" href="search_data_source_url" role="button">Search</a>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_modify_data_source" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Modify</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_delete_data_source" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_disable_monitoring" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Disable</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_enable_monitoring" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Enable</button>
                            </div>
                            <div class="btn_ack" style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_ack_data_source" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Acknowledge alert</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Alerts -->
    <div id="main_modal_manage_host" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade custom-modal-80" id="modal_manage_host" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_host">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3 style="font-size: 18px;">Actions for data host: <span style="color: steelblue">$tk_data_host$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div style="margin-top:10px; margin-left: 20px;">
                                    <div style="float:left;width:33%;">
                                        <p><b>lag event / lag ingestion:</b> $tk_data_lag_summary$</p>
                                        <p><b>data_last_time_seen:</b> $tk_data_last_time_seen_human$</p>
                                        <p><b>data_last_ingest:</b> $tk_data_last_ingest_human$</p>
                                    </div>
                                    <div style="float:left;width:33%;">
                                        <p><b>data_max_lag_allowed:</b> $tk_data_max_lag_allowed$</p>
                                        <p><b>data_monitored_state:</b> <span class="$tk_data_monitored_state_class$">$tk_data_monitored_state$</span></p>
                                        <p><b>data_host_state:</b> <span class="$tk_data_host_state_class$">$tk_data_host_state$</span></p>
                                    </div>
                                    <div style="float:left;width:33%;">
                                        <p><b>latest_flip_time:</b> $tk_latest_flip_time_human$</p>
                                        <p><b>latest_flip_state:</b> $tk_latest_flip_state$</p>
                                        <p><b>priority:</b> <span class="$tk_priority_class$">$tk_priority$</span></p>
                                    </div>
                                </div>

                            </div>
                        </div>

                        <div>
                            <hr width="100%" size="8" align="center">
                        </div>

                        <div id="rowSingleLagHost" class="dashboard-row dashboard-row1">
                            <div id="panelSingleLagHost2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementSingleLagHostPerc95" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                        <div id="elementSingleLagHostAvg" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartLagHost" class="dashboard-row dashboard-row1">
                            <div id="panelChartLagHost2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementChartHostIndexes" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="panelChartLagHost3" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementChartHostSourcetypes" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowChartLagHostOverTime" class="dashboard-row dashboard-row1">
                            <div id="panelChartLagHostOverTime2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementChartLagHostOverTime" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowLinkLagHost" class="dashboard-row dashboard-row1" style="margin-left: 15px;">
                            <div id="panelLinktLagHost2" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="input input-linklist" id="inputLinkTimeHost">
                                            <label>&nbsp;</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="modal-footer">
                            <div style="margin-right: 15px; float: left;">
                                <button type="submit" id="btn_refresh_data_host" role="button" class="btn btn-primary btn-default pull-left"><span class="glyphicon glyphicon-remove"></span>Refresh</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <a class="btn btn-primary" id="btn_search_data_host" target="_blank" href="search_data_source_url" role="button">Search</a>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_modify_data_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Modify</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_delete_data_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_disable_monitoring_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Disable</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_enable_monitoring_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Enable</button>
                            </div>
                            <div class="btn_ack" style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_ack_data_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Acknowledge alert</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Alerts -->
    <div id="main_modal_manage_metric_host" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade custom-modal-80" id="modal_manage_metric_host" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_metric_host">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3 style="font-size: 18px;">Actions for metric host: <span style="color: steelblue">$tk_metric_host$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div style="margin-top:10px; margin-left: 20px;">
                                    <div style="float:left;width:33%;">
                                        <p><b>metric_last_lag_seen:</b> $tk_metric_last_lag_seen$</p>
                                        <p><b>metric_last_time_seen:</b> $tk_metric_last_time_seen_human$</p>
                                    </div>
                                    <div style="float:left;width:33%;">
                                        <p><b>metric_monitored_state:</b> <span class="$tk_metric_monitored_state_class$">$tk_metric_monitored_state$</span></p>
                                        <p><b>metric_host_state:</b> <span class="$tk_metric_host_state_class$">$tk_metric_host_state$</span></p>
                                    </div>
                                    <div style="float:left;width:33%;">
                                        <p><b>latest_flip_time:</b> $tk_latest_flip_time_human$</p>
                                        <p><b>latest_flip_state:</b> $tk_latest_flip_state$</p>
                                        <p><b>priority:</b> <span class="$tk_priority_class$">$tk_priority$</span></p>
                                    </div>
                                </div>

                            </div>
                        </div>

                        <div>
                            <hr width="100%" size="8" align="center">
                        </div>

                        <div id="rowHostMetricChart" class="dashboard-row dashboard-row1">
                            <div id="panelHostMetricSingle" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementHostSingleMetricHost" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="panelHostMetricChart" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div id="elementHostChartMetricHost" class="dashboard-element chart" style="width: 100%">
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rowHostMetricTable" class="dashboard-row dashboard-row3">
                            <div id="panelHostMetricTable" class="dashboard-cell" style="width: 100%;">
                                <div class="dashboard-panel clearfix">
                                    <div class="panel-element-row">
                                        <div class="fieldset">
                                            <div id="elementHostTableMetricHost" class="dashboard-element table" style="width: 100%">
                                                <label>Metrics availability table:</label>
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <hr width="100%" size="8" align="center">
                        </div>

                        <div class="modal-footer">
                            <div style="margin-right: 15px; float: left;">
                                <button type="submit" id="btn_refresh_metric_host" role="button" class="btn btn-primary btn-default pull-left"><span class="glyphicon glyphicon-remove"></span>Refresh</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <a class="btn btn-primary" id="btn_search_metric_host_live_report" target="_blank" href="search_metric_source_live_report_url" role="button">Metrics live report</a>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <a class="btn btn-primary" id="btn_search_metric_host" target="_blank" href="search_metric_source_url" role="button">Metrics mcatalog report</a>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_modify_metric_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Modify</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_delete_metric_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_disable_monitoring_metric_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Disable</button>
                            </div>
                            <div style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_enable_monitoring_metric_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Enable</button>
                            </div>
                            <div class="btn_ack" style="margin-right: 15px; float: right;">
                                <button type="submit" id="btn_ack_metric_host" role="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Acknowledge alert</button>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Indexers Queues -->
    <div id="main_modal_queues" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade modal-big" id="modal_queues" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_queues">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3 style="font-size: 18px;">Splunk indexers queues:</h3>
                                    <button type="button" id="btn_ops_index_queue_close" class="close" data-dismiss="modal">&times;</button>
                                </div>
                            </div>
                        </div>
                        <div class="modal-guts">
                            <div id="rowLinkQueues" class="dashboard-row dashboard-row1" style="margin-left: 15px;">
                                <div id="panelLinkQueues" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div class="input input-linklist" id="inputLinkQueuesTime">
                                                <label>&nbsp;</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowChartQueues1" class="dashboard-row dashboard-row1">
                                <div id="panelChartQueues1" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div id="elementChartQueue1" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-head">
                                                    <h3>1 - Splunk Tcpin Queue</h3>
                                                </div>
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowChartQueues2" class="dashboard-row dashboard-row1">
                                <div id="panelChartQueues2" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div id="elementChartQueue2" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-head">
                                                    <h3>2 - Parsing Queue</h3>
                                                </div>
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowChartQueues3" class="dashboard-row dashboard-row1">
                                <div id="panelChartQueues3" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div id="elementChartQueue3" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-head">
                                                    <h3>3 - Aggregation Queue</h3>
                                                </div>
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowChartQueues4" class="dashboard-row dashboard-row1">
                                <div id="panelChartQueues4" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div id="elementChartQueue4" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-head">
                                                    <h3>4 - Typing Queue</h3>
                                                </div>
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowChartQueues5" class="dashboard-row dashboard-row1">
                                <div id="panelChartQueues5" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div id="elementChartQueue5" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-head">
                                                    <h3>5 - Indexing Queue</h3>
                                                </div>
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer" style="margin-top: 700px;">
                            <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Parsing issues -->
    <div id="main_modal_parsing_issues" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade modal-big" id="modal_parsing_issues" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_parsing_issues">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3 style="font-size: 18px;">Splunk indexing time failures and warnings:</h3>
                                    <button type="button" id="btn_ops_parsing_issues_close" class="close" data-dismiss="modal">&times;</button>
                                </div>
                            </div>
                        </div>

                        <div class="modal-guts">
                            <div id="rowLinkParsingIssues" class="dashboard-row dashboard-row1" style="margin-left: 15px;">
                                <div id="panelLinkParsingIssues" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div class="input input-linklist" id="inputLinkParsingIssuesTime">
                                                <label>&nbsp;</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowSingleParsingIssues" class="dashboard-row dashboard-row1">
                                <div id="panelSingleParsingIssues" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div id="elementSingleParsingIssues" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="rowChartParsingIssues" class="dashboard-row dashboard-row1">
                                <div id="panelChartParsingIssues" class="dashboard-cell" style="width: 100%;">
                                    <div class="dashboard-panel clearfix">
                                        <div class="panel-element-row">
                                            <div id="elementChartParsingIssues" class="dashboard-element chart" style="width: 100%">
                                                <div class="panel-body"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer" style="margin-top: 700px;">
                            <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                            <a class="btn btn-primary" id="btn_search_parsing_issues_linebreaking" target="_blank" href="search_data_source_url" role="button">Search line breaking issues</a>
                            <a class="btn btn-primary" id="btn_search_parsing_issues_aggregator" target="_blank" href="search_data_source_url" role="button">Search aggregator mining issues</a>
                            <a class="btn btn-primary" id="btn_search_parsing_issues_dateparser" target="_blank" href="search_data_source_url" role="button">Search date parser issues</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal custom-modal-50 fade" id="modal_time_to_configure" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&amp;times;</button>
                    <h3 style="color: indianred; font-size: 20px;"><span class="glyphicon glyphicon-lock"></span>Oops! It's time for some configuration.</h3>
                </div>
                <div class="modal-body">

                    <img style="float: left; margin: 0px 15px 15px 0px;" src="../../static/app/trackme/icons/sorry_poney.png"/>

                    <p>It looks like this is your first visit here, the collection is currently empty as the tracker reports were not executed yet.<br /><br />
                        <b>The tracker reports are automatically scheduled but you can request an execution immediately by clicking on the button bellow.</b>
                        <br /><br />
                        <b>Make sure the tracker reports are activated and scheduled:</b>
                        <br />
                        <lu>
                            <li>TrackMe - Data sources availability short term tracker</li>
                            <li>TrackMe - Data sources availability long term tracker</li>
                            <li>TrackMe - Data hosts availability short term tracker</li>
                            <li>TrackMe - Data hosts availability long term tracker</li>
                        </lu>

                        <b></b>

                    </p>
                </div>

                <div class="modal-footer" style="margin-top: 300px;">
                    <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                    <button id="btn_modal_update_collection" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Update collection now</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Generic deletion -->
    <div class="modal custom-modal-50 fade" id="modal_entry_deletion" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>KVstore entry deletion</h3>
                </div>
                <div class="modal-body">
                    <p><b>Confirm deletion of this entry?</b><br /><br />
                        You may want to delete a data source entry if the data source has been discontinued, or if the target index or sourcetype was changed.
                        <br /><br />

                        <b>Two options are available:</b>
                        <lu>
                            <li><b>Delete temporary:</b> removes the entity and its settings, shall the data source or host be active in the past 7 days, it will be re-created automatically by the trackers</li>
                            <li><b>Delete permanently:</b> removes the entity and its settings, in addition it prevents the data source or host from being re-created automatically by the trackers</li>
                            <br />
                        </lu>

                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_entry_deletion_temporary" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Delete temporary</button>
                    <button type="submit" id="btn_modal_entry_deletion" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Delete permanently</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Error or failure during KVstore collection update -->
    <div class="modal fade" id="modal_update_collection_failure_return" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>Oops!</h3>
                </div>
                <div class="modal-body">
                    <p>Sorry but it looks like an error occurred while attempting to perform the KVstore collection update.<br /><br />
                        <b>You might not have the permission to write to the collection</b>, or an unexpected failure was encountered.<br /><br />
                        <b>The server returned the following error message:</b>
                    </p>
                    <div class="modal-error-message" style="margin: 10px 0; padding: 10px; border-radius: 3px 3px 3px 3px; color: #D8000C; background-color: #FFBABA;">
                        <p>error return message</p>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window for lag value modification -->

    <!-- data source monitoring -->

    <div class="modal fade custom-modal-50" id="modal_modify_main" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify data source monitoring</h3>
                </div>
                <div class="modal-body">
                    <p>You can modify different parameters regarding the monitoring of this data source:</p>

                    <b>monitoring_wdays: modify the week days rules for monitoring</b>
                    <br />

                    <lu>
                        <li>all_days: monitor the data source every days of the week</li>
                        <li>monday-to-friday: monitor the data source only during working days from Monday to Friday</li>
                        <li>monday-to-saturday: monitor the data source only during working days from Monday to Saturday</li>
                        <li>Or enter the manual mode where you can select each days of the week to be monitored</li>
                    </lu>

                    <br />

                    <b>monitoring_level:</b>
                    <br />

                    <lu>
                        <li>sourcetype: monitor data source availability on a per sourcetype basis</li>
                        <li>index: monitor data source availability on a per index basis, ignoring the sourcetype value</li>
                    </lu>

                    <br />

                    <b>maximal lag value:</b>
                    <br />

                    <lu>
                        <li>the maximal value in seconds of unavailability of the data source before it is declared in red state</li>
                    </lu>

                    <br />

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_modify_cancel" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button id="btn_modal_modify_wdays" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Modify monitoring wdays</button>
                    <button id="btn_modal_modify_level" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Modify monitoring level</button>
                    <button id="btn_modal_modify_lag" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Modify monitoring lagging</button>
                </div>
            </div>
        </div>
    </div>

    <!-- data host monitoring -->

    <div class="modal fade custom-modal-50" id="modal_modify_main_host" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify data host monitoring</h3>
                </div>
                <div class="modal-body">
                    <p>You can modify different parameters regarding the monitoring of this data host:</p>

                    <b>monitoring_wdays: modify the week days rules for monitoring</b>
                    <br />

                    <lu>
                        <li>all_days: monitor the data source every days of the week</li>
                        <li>monday-to-friday: monitor the data source only during working days from Monday to Friday</li>
                        <li>monday-to-saturday: monitor the data source only during working days from Monday to Saturday</li>
                        <li>Or enter the manual mode where you can select each days of the week to be monitored</li>
                    </lu>

                    <br />

                    <b>maximal lag value:</b>
                    <br />

                    <lu>
                        <li>the maximal value in seconds of unavailability of the data host before it is declared in red state</li>
                    </lu>

                    <br />

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_modify_host_cancel" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button id="btn_modal_modify_wdays_host" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Modify monitoring wdays</button>
                    <button id="btn_modal_modify_lag_host" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Modify monitoring lagging</button>
                </div>
            </div>
        </div>
    </div>

    <!--
    Custom lagging
    -->

    <div class="modal fade custom-modal-80" id="modify_custom_lagging" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Lagging classes definition </h3>
                </div>
                <div class="modal-body">
                    <b>Use this interface to define a default lagging value per class:</b>
                    <lu>
                        <li>Per index</li>
                        <li>Per sourcetype</li>
                    </lu>
                    <br />
                    <b>Conflict resolution:</b>
                    <lu>
                        <li><b>For data sources:</b> index based lagging class wins over sourcetype based lagging class</li>
                        <li><b>For data hosts:</b> if multiple lagging class match, the highest lagging value wins</li>
                    </lu>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modify_custom_lagging">
                    </div>

                    <div id="rowCustomLagging1a" class="dashboard-row dashboard-row3">
                        <div id="panelCustomLagging1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-dropdown" id="modal_input_custom_lagging_type" style="margin-bottom: 10px;">
                                            <label>Applies to:</label>
                                        </div>

                                        <div class="input input-text" id="modal_input_custom_lagging_name" style="margin-bottom: 10px;">
                                            <label>Name:</label>
                                        </div>

                                        <div class="input input-text" id="modal_input_custom_lagging_value" style="margin-bottom: 10px;">
                                            <label>Lagging value:</label>
                                        </div>

                                        <br /><br />

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_custom_lagging_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this lagging class</button>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowCustomLagging1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="SingleCustomLagging" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowCustomLaggingTable" class="dashboard-row dashboard-row3">
                        <div id="panelCustomLaggingTable" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_custom_lagging_search" style="margin-bottom: 10px;">
                                            <label>Search for lagging class:</label>
                                        </div>
                                        <div id="tableCustomLagging" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Custom lagging -->
    <div id="main_manage_custom_lagging" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="manage_custom_lagging" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_manage_custom_lagging">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for lagging class: <span style="color: steelblue">$tk_input_custom_lagging_name$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>level:</b> $tk_input_custom_lagging_level$</p>
                                    <p><b>name:</b> $tk_input_custom_lagging_name$</p>
                                    <p><b>value:</b> $tk_input_custom_lagging_value$</p>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_custom_lagging_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_custom_lagging" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for metric SLA policy -->
    <div id="main_manage_metric_sla_policy" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="manage_metric_sla_policy" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_manage_metric_sla_policy">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for metric category: <span style="color: steelblue">$tk_input_metric_policy_metric_category$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>metric_category:</b> $tk_input_metric_policy_metric_category$</p>
                                    <p><b>metric_max_lag_allowed:</b> $tk_input_metric_max_lag_allowed$</p>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_metric_sla_policy_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_metric_sla_policy" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--

    Whitelist management

    -->

    <!-- whitelist data_source -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_source_whitelist" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify index whitelisting</h3>
                </div>
                <div class="modal-body">
                    <b>If no indexes are in whitelist, TrackMe will use all available indexes, otherwise only the indexes in whitelist will be taken in charge</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_source_whitelist">
                    </div>

                    <div id="rowWhiteListDataSource1a" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListDataSource1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">

                                        <div class="input input-linklist" id="inputLinkTimeWhiteListDataSource">
                                            <label>&nbsp;</label>
                                        </div>

                                        <div class="input input-dropdown" id="modal_input_data_source_whitelist" style="margin-bottom: 10px;">
                                            <label>index name:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_source_whitelist_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this index</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowWhiteListDataSource1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleWhiteListDataSource" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowWhiteListDataSourceEmpty" class="dashboard-row dashboard-row" data-rejects="$show_table_data_source_whitelist$">
                        <div id="panelWhiteListDataSourceEmpty" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">All indexes are currently allowed in the data discovery.</h3>
                                        <br /><br />
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowWhiteListDataSource2" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListDataSource2" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_whitelist_search" style="margin-bottom: 10px;">
                                            <label>Search for index name:</label>
                                        </div>

                                        <div id="tableWhiteListDataSource" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_source_whitelist_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- whitelist data_host -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_host_whitelist" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify index whitelisting</h3>
                </div>
                <div class="modal-body">
                    <b>If no indexes are in whitelist, TrackMe will use all available indexes, otherwise only the indexes in whitelist will be taken in charge</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_host_whitelist">
                    </div>

                    <div id="rowWhiteListDataHost1a" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListDataHost1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">

                                        <div class="input input-linklist" id="inputLinkTimeWhiteListDataHost">
                                            <label>&nbsp;</label>
                                        </div>

                                        <div class="input input-dropdown" id="modal_input_data_host_whitelist" style="margin-bottom: 10px;">
                                            <label>index name:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_host_whitelist_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this index</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowWhiteListDataHost1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleWhiteListDataHost" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowWhiteListDataHostEmpty" class="dashboard-row dashboard-row" data-rejects="$show_table_data_host_whitelist$">
                        <div id="panelWhiteListDataHostEmpty" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">All indexes are currently allowed in the data discovery.</h3>
                                        <br /><br />
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowWhiteListDataHost2" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListDataHost2" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_whitelist_search" style="margin-bottom: 10px;">
                                            <label>Search for index name:</label>
                                        </div>

                                        <div id="tableWhiteListDataHost" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_host_whitelist_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- whitelist metric_host -->
    <div class="modal fade custom-modal-50" id="modal_modify_metric_host_whitelist" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify index whitelisting</h3>
                </div>
                <div class="modal-body">
                    <b>If no indexes are in whitelist, TrackMe will use all available indexes, otherwise only the indexes in whitelist will be taken in charge</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_metric_host_whitelist">
                    </div>

                    <div id="rowWhiteListMetricHost1a" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListMetricHost1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">

                                        <div class="input input-linklist" id="inputLinkTimeWhiteListMetricHost">
                                            <label>&nbsp;</label>
                                        </div>

                                        <div class="input input-dropdown" id="modal_input_metric_host_whitelist" style="margin-bottom: 10px;">
                                            <label>index name:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_metric_host_whitelist_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this index</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowWhiteListMetricHost1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleWhiteListMetricHost" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowWhiteListMetricHostEmpty" class="dashboard-row dashboard-row" data-rejects="$show_table_metric_host_whitelist$">
                        <div id="panelWhiteListMetricHostEmpty" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="modal-body">
                                        <h3 style="color: lightslategray;">All indexes are currently allowed in the data discovery.</h3>
                                        <br /><br />
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div id="rowWhiteListMetricHost2" class="dashboard-row dashboard-row3">
                        <div id="panelWhiteListMetricHost2" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_metric_host_whitelist_search" style="margin-bottom: 10px;">
                                            <label>Search for index name:</label>
                                        </div>

                                        <div id="tableWhiteListMetricHost" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_metric_host_whitelist_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!--

    Blacklist management

    -->

    <!-- blacklist host -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_source_blacklist_host" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify host blacklisting</h3>
                </div>
                <div class="modal-body">
                    <b>Hosts that have been blacklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_source_blacklist_host">
                    </div>

                    <lu>
                        <li>TrackMe - Data sources availability short term tracker: tracks data on a frequency over a small time range</li>
                        <li>TrackMe - Data sources availability long term tracker: tracks data on a hourly frequency over a large time range</li>
                    </lu>

                    <br />

                    <div id="rowBlackListDataSourceHost1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceHost1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_host" style="margin-bottom: 10px;">
                                            <label>host name:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_source_blacklist_host_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this host</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListDataSourceHost1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListDataSourceHost" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListDataSourceHost2" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceHost2" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_host_search" style="margin-bottom: 10px;">
                                            <label>Search for host name:</label>
                                        </div>
                                        <div id="tableBlackListDataSourceHost" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_source_blacklist_host_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist index -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_source_blacklist_index" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify index blacklisting</h3>
                </div>
                <div class="modal-body">
                    <b>Indexes that have been blacklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_source_blacklist_index">
                    </div>

                    <lu>
                        <li>TrackMe - Data sources availability short term tracker: tracks data on a frequency over a small time range</li>
                        <li>TrackMe - Data sources availability long term tracker: tracks data on a hourly frequency over a large time range</li>
                    </lu>

                    <br />

                    <b>In addition, indexes that have been blacklisted are excluded from alerting results.</b>

                    <br />

                    <div id="rowBlackListDataSourceIndex1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceIndex1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_index" style="margin-bottom: 10px;">
                                            <label>index name:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_source_blacklist_index_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this index</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListDataSourceIndex1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListDataSourceIndex" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListDataSourceIndex2" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceIndex2" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_index_search" style="margin-bottom: 10px;">
                                            <label>Search for index name:</label>
                                        </div>

                                        <div id="tableBlackListDataSourceIndex" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_source_blacklist_index_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist sourcetype -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_source_blacklist_sourcetype" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify sourcetype blacklisting</h3>
                </div>
                <div class="modal-body">
                    <b>Sourcetypes that have been blacklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_source_blacklist_sourcetype">
                    </div>

                    <lu>
                        <li>TrackMe - Data sources availability short term tracker: tracks data on a frequency over a small time range</li>
                        <li>TrackMe - Data sources availability long term tracker: tracks data on a hourly frequency over a large time range</li>
                    </lu>

                    <br />

                    <b>In addition, sourcetypes that have been blacklisted are excluded from alerting results.</b>

                    <br />

                    <div id="rowBlackListDataSourceSourcetype1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceSourcetype1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_sourcetype" style="margin-bottom: 10px;">
                                            <label>sourcetype name:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_source_blacklist_sourcetype_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this sourcetype</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListDataSourceSourcetype1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListDataSourceSourcetype" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListDataSourceSourcetype2" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataSourceSourcetype2" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_source_blacklist_sourcetype_search" style="margin-bottom: 10px;">
                                            <label>Search for sourcetype name:</label>
                                        </div>

                                        <div id="tableBlackListDataSourceSourcetype" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_source_blacklist_sourcetype_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!--
    blacklist data host
    -->

    <!-- blacklist host -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_host_blacklist_host" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify host blacklisting</h3>
                </div>
                <div class="modal-body">
                    <b>Hosts that have been blacklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_host_blacklist_host">
                    </div>

                    <lu>
                        <li>TrackMe - Data hosts availability short term tracker: tracks data on a frequency over a small time range</li>
                        <li>TrackMe - Data hosts availability long term tracker: tracks data on a hourly frequency over a large time range</li>
                    </lu>

                    <br />

                    <div id="rowBlackListDataHostHost1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostHost1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_blacklist_host" style="margin-bottom: 10px;">
                                            <label>host name:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_host_blacklist_host_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this host</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListDataHostHost1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListDataHostHost" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListDataHostHost2" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostHost2" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_blacklist_host_search" style="margin-bottom: 10px;">
                                            <label>Search for host name:</label>
                                        </div>
                                        <div id="tableBlackListDataHostHost" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_host_blacklist_host_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Added message -->
    <div class="modal fade" id="modal_blacklist_added" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: steelblue;"><span class="glyphicon glyphicon-lock"></span>Black list host updated</h3>
                </div>
                <div class="modal-body">
                    <p><b>The host was successfully added to the blacklist host collection. the host will be permanently excluded from the data sources discovery.</b><br /><br />
                        <br /><br />
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- data source monitoring -->

    <!-- Modal window for data source unified -->
    <div class="modal fade custom-modal-80" id="modal_modify_data_source_unified" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Data source unified update </h3>
                </div>

                <div class="modal-body">

                    <div>

                        <div style="margin-bottom: 10px;">

                            <h4>Data source lagging value:</h4>

                            <div style="margin-left: 15px;">
                                <lu>
                                    <li>The maximal allowed lagging value defines the maximal value in seconds before a data source / host would be considered as red</li>
                                    <li>Override lagging classes allows bypassing any lagging classes configuration that would apply to this data source or host</li>
                                    <li>If a lagging class matches index(es) or sourcetype(es) for this data source or host and the option is unchecked, it will bypass this value unless override is true</li>
                                </lu>
                            </div>

                            <br />

                            <div class="fieldset">
                                <div class="input input-text" id="modal_input_lag">
                                    <label>Maximal allowed lagging value:</label>
                                </div>
                            </div>
                            <div class="fieldset">
                                <div class="input input-dropdown" id="modal_input_lag_override_class">
                                    <label>Override lagging classes:</label>
                                </div>
                            </div>

                            <button id="btn_modal_modify_lag_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply lagging rule</button>

                            <div class="boxnotify" id="boxnotify-unified-data-source">
                            </div>

                        </div>

                        <hr>

                        <div style="margin-bottom: 10px; width: 50%; float:left">

                            <h4>Data source priority:</h4>

                            <p>Define the priority of the data source for granular level of SLA alerting:</p>

                            <p>
                                <span class="title_green">low</span>
                                <span class="title_yellow">medium</span>
                                <span class="title_red">high</span>
                            </p>

                            <div class="fieldset">
                                <div class="input input-text" id="modal_input_priority">
                                    <label></label>
                                </div>
                            </div>

                            <div>
                                <button id="btn_modal_modify_priority_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply priority</button>
                            </div>

                        </div>

                        <div style="margin-bottom: 10px; width: 50%; float:right">

                            <h4>Data source week days monitoring:</h4>

                            <p>Monitor source on a all days basis, apply a builtin rule, or explicitly select week days:</p>

                            <div class="fieldset">
                                <div class="input input-text" id="modal_input_wdays">
                                    <label></label>
                                </div>
                            </div>

                            <div>
                                <button id="btn_modal_modify_monitoring_wdays_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply wdays builtin rule</button>
                                <button id="btn_modal_modify_wdays_no" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Or select days of the week</button>
                            </div>

                        </div>

                        <div style="margin-top: 240px; margin-bottom: 10px;">

                            <hr>

                            <h4>Data source monitoring level:</h4>

                            <p>Choose to monitor the data source based on the index and sourcetype association (default), or based on the latest data available in the index where the data source is stored:</p>

                            <div class="fieldset">
                                <div class="input input-text" id="modal_input_level">
                                    <label></label>
                                </div>
                            </div>

                            <button id="btn_modal_modify_monitoring_level_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply monitoring level rule</button>

                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_close_data_source_unified" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>

            </div>

        </div>
    </div>

    <!-- data host monitoring -->

    <!-- Modal window for data source unified -->
    <div class="modal fade custom-modal-80" id="modal_modify_data_host_unified" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Data host unified update </h3>
                </div>

                <div class="modal-body">

                    <h4>Data host lagging value:</h4>

                    <div style="margin-left: 15px;">
                        <lu>
                            <li>The maximal allowed lagging value defines the maximal value in seconds before a data source / host would be considered as red</li>
                            <li>Override lagging classes allows bypassing any lagging classes configuration that would apply to this data source or host</li>
                            <li>If a lagging class matches index(es) or sourcetype(es) for this data source or host and the option is unchecked, it will bypass this value unless override is true</li>
                        </lu>
                    </div>

                    <br />

                    <div class="fieldset">
                        <div class="input input-text" id="modal_input_lag_host">
                            <label>Maximal allowed lagging value:</label>
                        </div>
                    </div>
                    <div class="fieldset">
                        <div class="input input-dropdown" id="modal_input_lag_override_class_host">
                            <label>Override lagging classes:</label>
                        </div>
                    </div>

                    <button id="btn_modal_modify_lag_confirm_host" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply lagging rule</button>

                    <div class="boxnotify" id="boxnotify-unified-data-host">
                    </div>

                    <hr>

                    <div style="margin-bottom: 10px; width: 50%; float:left">

                        <h4>Data host priority:</h4>

                        <p>Define the priority of the data host for granular level of SLA alerting:</p>

                        <p>
                            <span class="title_green">low</span>
                            <span class="title_yellow">medium</span>
                            <span class="title_red">high</span>
                        </p>

                        <div class="fieldset">
                            <div class="input input-text" id="modal_input_host_priority">
                                <label></label>
                            </div>
                        </div>

                        <div>
                            <button id="btn_modal_modify_priority_host_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply priority</button>
                        </div>

                    </div>

                    <div style="margin-bottom: 10px; width: 50%; float:right">

                        <h4>Associate to a Logical group:</h4>

                        <p>Logical groups are groups of entities that will be considered as an ensemble for monitoring purposes.
                            <br />
                            A typical use case is a couple of active / passive appliances, where only the active member generates data.
                            <br /><br />
                            When associated in a Logical group, the entity status relies on the minimal green percentage configured during the group creation versus
                            the current green percentage of the group. (percentages of members green)
                        </p>

                        <div style="margin-bottom: 20px;" class="btn_logical_group">
                            <button type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Manage in a Logical group </button>
                        </div>

                    </div>

                    <div style="margin-top: 240px; margin-bottom: 10px;">

                        <hr>
                        
                        <h4>Data host week days monitoring:</h4>

                        <p>Monitor source on a all days basis, apply a builtin rule, or explicitly select week days:</p>

                        <div class="fieldset">
                            <div class="input input-text" id="modal_input_wdays_host">
                                <label></label>
                            </div>
                        </div>

                        <div>
                            <button id="btn_modal_modify_monitoring_wdays_host_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply wdays builtin rule</button>
                            <button id="btn_modal_modify_wdays_host_no" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Or select days of the week</button>
                        </div>

                    </div>

                </div>

                <div style="margin-top: 20px;" class="modal-footer">
                    <button type="submit" id="btn_close_data_host_unified" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>

        </div>
    </div>

    <!-- metric host monitoring -->

    <!-- Modal window for data source unified -->
    <div class="modal fade custom-modal-80" id="modal_modify_metric_host_unified" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Metric host unified update </h3>
                </div>

                <div class="modal-body">

                    <div style="margin-bottom: 10px; width: 50%; float: left;">

                        <h4>Metric host priority:</h4>

                        <div class="boxnotify" id="boxnotify-unified-metric-host">
                        </div>

                        <p>Define the priority of the metric host for granular level of SLA alerting:</p>

                        <p>
                            <span class="title_green">low</span>
                            <span class="title_yellow">medium</span>
                            <span class="title_red">high</span>
                        </p>

                        <div class="fieldset">
                            <div class="input input-text" id="modal_input_metric_host_priority">
                                <label></label>
                            </div>
                        </div>

                        <div>
                            <button id="btn_modal_modify_priority_metric_host_confirm" type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Apply priority</button>
                        </div>

                    </div>

                    <div style="margin-bottom: 10px; width: 50%; float: right;">

                        <h4>Associate to a Logical group:</h4>

                        <p>Logical groups are groups of entities that will be considered as an ensemble for monitoring purposes.
                            <br />
                            A typical use case is a couple of active / passive appliances, where only the active member generates data.
                            <br /><br />
                            When associated in a Logical group, the entity status relies on the minimal green percentage configured during the group creation versus
                            the current green percentage of the group. (percentages of members green)
                        </p>

                        <div style="margin-bottom: 20px;" class="btn_logical_group">
                            <button type="submit" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Manage in a Logical group </button>
                        </div>

                    </div>

                </div>

                <div style="margin-top: 260px;" class="modal-footer">
                    <button type="submit" id="btn_close_metric_host_unified" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>

        </div>
    </div>

    <!-- Modal window for monitoring level modification -->
    <div class="modal fade" id="modal_modify_monitoring_wdays_no" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Monitoring week days update </h3>
                </div>
                <div class="modal-body">
                    <p>
                        Select the days of the week where will be applied the monitoring rules.
                        <br /><br />
                        If the data source is not available during a week day that is not selected, no alert will be given.
                        <br /><br />
                    </p>

                    <div class="fieldset">
                        <div class="input input-checkboxgroup" id="modal_input_wdays_no">
                            <label></label>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button id="btn_modal_modify_monitoring_wdays_no_cancel" type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button id="btn_modal_modify_monitoring_wdays_no_confirm" type="submit" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- data host monitoring -->

    <!-- Modal window for monitoring level modification -->
    <div class="modal fade" id="modal_modify_monitoring_wdays_host_no" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Monitoring week days update </h3>
                </div>
                <div class="modal-body">
                    <p>
                        Select the days of the week where will be applied the monitoring rules.
                        <br /><br />
                        If the data source is not available during a week day that is not selected, no alert will be given.
                        <br /><br />
                    </p>

                    <div class="fieldset">
                        <div class="input input-checkboxgroup" id="modal_input_wdays_host_no">
                            <label></label>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button id="btn_modal_modify_monitoring_wdays_host_no_cancel" type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button id="btn_modal_modify_monitoring_wdays_host_no_confirm" type="submit" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!--

    Metrics SLA policies editor

    -->

    <div class="modal fade custom-modal-80" id="modal_metric_sla_policies" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Metrics SLA policies editor </h3>
                </div>
                <div class="modal-body">
                    <b>Use this interface to SLA policies for metric categories:</b>
                    <lu>
                        <li>A metric category is extracted automatically from the first segment of the metric path (ex: cpu for cpu.cpu_idle)</li>
                        <li>A default value is defined as above if the metric category is not listed here</li>
                        <li>Each metric category is taken in consideration individually based on these rules</li>
                    </lu>
                    <br />

                    <div class="boxnotify" id="boxnotify-btn_modify_metric_sla_policies">
                    </div>

                    <div id="rowMetricsPolicies1a" class="dashboard-row dashboard-row3">
                        <div id="panelMetricsPolicies1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">

                                         <div class="input input-dropdown" id="inputMetricPolicySLA_category" style="margin-bottom: 10px;">
                                        <label>metric_category:</label>
                                        </div>

                                        <div class="input input-text" id="inputMetricPolicySLA_value" style="margin-bottom: 10px;">
                                        <label>metric_max_lag_allowed:</label>
                                        </div>

                                        <br /><br />

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_metric_policy_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this metric SLA policy</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowMetricPolicy1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="SingleMetricPolicies" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowMetricPolicyTable" class="dashboard-row dashboard-row3">
                        <div id="panelMetricPolicyTable" class="dashboard-cell" style="width: 100%;">
                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">
                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_metric_policy_search" style="margin-bottom: 10px;">
                                            <label>Search for lagging class:</label>
                                        </div>
                                        <div id="tableMetricPolicies" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!--

    whitelist

    -->

    <!-- whitelist data_source -->

    <!-- Modal drilldown context for WhiteList -->
    <div id="main_modal_manage_data_source_whitelist" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_source_whitelist" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_source_whitelist">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for index in whitelist: <span style="color: steelblue">$tk_data_index$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>data_index:</b> $tk_data_index$</p>
                                    <br />
                                    <b>This index is currently included in the data discovery.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_source_whitelist_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_source_whitelist" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- whitelist metric_host -->

    <!-- Modal drilldown context for WhiteList -->
    <div id="main_modal_manage_metric_host_whitelist" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_metric_host_whitelist" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_metric_host_whitelist">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for index in whitelist: <span style="color: steelblue">$tk_metric_index$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>metric_index:</b> $tk_metric_index$</p>
                                    <br />
                                    <b>This index is currently included in the data discovery.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_metric_host_whitelist_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_metric_host_whitelist" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- whitelist data_host -->

    <!-- Modal drilldown context for WhiteList -->
    <div id="main_modal_manage_data_host_whitelist" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_host_whitelist" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_host_whitelist">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for index in whitelist: <span style="color: steelblue">$tk_data_index$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>data_index:</b> $tk_data_index$</p>
                                    <br />
                                    <b>This index is currently included in the data discovery.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_host_whitelist_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_host_whitelist" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--

    blacklist

    -->

    <!-- blacklist -->

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_data_source_blacklist_host" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_source_blacklist_host" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_source_blacklist_host">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for host in blacklist: <span style="color: steelblue">$tk_data_host$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>data_host:</b> $tk_data_host$</p>
                                    <p><b>data_blacklist_state:</b> $tk_data_blacklist_state$</p>
                                    <br />
                                    <b>This host is currently excluded from data discovery.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_source_blacklist_host_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_source_blacklist_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist -->

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_data_source_blacklist_index" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_source_blacklist_index" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_source_blacklist_index">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for index in blacklist: <span style="color: steelblue">$tk_data_index$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>data_index:</b> $tk_data_index$</p>
                                    <p><b>data_blacklist_state:</b> $tk_data_blacklist_state$</p>
                                    <br />
                                    <b>This index is currently excluded from data discovery and alerting.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_source_blacklist_index_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_source_blacklist_index" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_data_source_blacklist_sourcetype" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_source_blacklist_sourcetype" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_source_blacklist_sourcetype">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for sourcetype in blacklist: <span style="color: steelblue">$tk_data_sourcetype$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>data_sourcetype:</b> $tk_data_sourcetype$</p>
                                    <p><b>data_blacklist_state:</b> $tk_data_blacklist_state$</p>
                                    <br />
                                    <b>This sourcetype is currently excluded from data discovery and alerting.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_source_blacklist_sourcetype_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_source_blacklist_sourcetype" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist -->

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_data_host_blacklist_host" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_host_blacklist_host" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_host_blacklist_host">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for host in blacklist: <span style="color: steelblue">$tk_data_host$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>data_host:</b> $tk_data_host$</p>
                                    <p><b>data_blacklist_state:</b> $tk_data_blacklist_state$</p>
                                    <br />
                                    <b>This host is currently excluded from data discovery.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_host_blacklist_host_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_host_blacklist_host" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- whitelist & blacklist -->

    <!-- Modal main -->
    <div id="main_modal_manage_data_source_blacklists" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal custom-modal-50 fade" id="modal_manage_data_source_blacklists" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_source_blacklists">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Manage whitelists & blacklist for: <span style="color: steelblue">data sources</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div class="modal-body" style="margin-bottom: 10px;">
                                    <span class="title_green">Whitelist</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <b>Whitelist of indexes at data discovery and search time:</b>
                                    <br />
                                    <lu>
                                        <li>By default, trackMe searches for entities in all available indexes</li>
                                        <li>You can restrict at any time the list of indexes allowed by editing the content of the whitelist collections</li>
                                        <li>Indexes whitelisting is applied at discovery and search time, but can require the collection to be reset or previously discovered entities to be removed manually</li>
                                    </lu>
                                </div>

                                <br />

                                <div class="modal-body" style="margin-bottom: 10px;">
                                    <span class="title_red">Blacklist</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <b>Blacklists: use these features to blacklist hosts, indexes or sourcetypes at data discovery and search time.</b>
                                    <br />
                                    <lu>
                                        <li>Hosts that have been blacklisted are excluded from the data discovery</li>
                                        <li>Indexes that have been blacklisted are excluded from the data discovery, and from alerting results at search time</li>
                                        <li>Sourcetypes that have been blacklisted are excluded from the data discovery, and from alerting results at search time</li>
                                    </lu>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <div class="btn_modify_data_source_whitelist custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: whitelist indexes</button>
                            </div>
                            <div class="btn_modify_data_source_blacklist_host custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blacklist hosts</button>
                            </div>
                            <div class="btn_modify_data_source_blacklist_index custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blacklist indexes</button>
                            </div>
                            <div class="btn_modify_data_source_blacklist_sourcetype custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blacklist sourcetypes</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal main -->
    <div id="main_modal_manage_data_host_blacklists" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal custom-modal-50 fade" id="modal_manage_data_host_blacklists" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_host_blacklists">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Manage whitelists & blacklist for: <span style="color: steelblue">data hosts</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div class="modal-body" style="margin-bottom: 10px;">
                                    <span class="title_green">Whitelist</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <b>Whitelist of indexes at data discovery and search time:</b>
                                    <br />
                                    <lu>
                                        <li>By default, trackMe searches for entities in all available indexes</li>
                                        <li>You can restrict at any time the list of indexes allowed by editing the content of the whitelist collections</li>
                                        <li>Indexes whitelisting is applied at discovery and search time, but can require the collection to be reset or previously discovered entities to be removed manually</li>
                                    </lu>
                                </div>

                                <br />

                                <div class="modal-body" style="margin-bottom: 10px;">
                                    <span class="title_red">Blacklist</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <b>Use these features to blacklist hosts, indexes or sourcetypes at data discovery and search time.</b>
                                    <br />
                                    <lu>
                                        <li>Hosts that have been blacklisted are excluded from the data discovery, and from alerting results at search time</li>
                                        <li>Indexes that have been blacklisted are excluded from the data discovery, and from alerting results at search time</li>
                                        <li>Sourcetypes that have been blacklisted are excluded from the data discovery, and from alerting results at search time</li>
                                    </lu>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <div class="btn_modify_data_host_whitelist custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: whitelist indexes</button>
                            </div>
                            <div class="btn_modify_data_host_blacklist_host custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blacklist hosts</button>
                            </div>
                            <div class="btn_modify_data_host_blacklist_index custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blacklist indexes</button>
                            </div>
                            <div class="btn_modify_data_host_blacklist_sourcetype custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blacklist sourcetypes</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal main -->
    <div id="main_modal_manage_metric_host_blacklists" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal custom-modal-50 fade" id="modal_manage_metric_host_blacklists" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_metric_host_blacklists">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Manage whitelists & blacklist for: <span style="color: steelblue">metric hosts</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>

                                <div class="modal-body" style="margin-bottom: 10px;">
                                    <span class="title_green">Whitelist</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <b>Whitelist of indexes at data discovery and search time:</b>
                                    <br />
                                    <lu>
                                        <li>By default, trackMe searches for entities in all available indexes</li>
                                        <li>You can restrict at any time the list of indexes allowed by editing the content of the whitelist collections</li>
                                        <li>Indexes whitelisting is applied at discovery and search time, but can require the collection to be reset or previously discovered entities to be removed manually</li>
                                    </lu>
                                </div>

                                <br />

                                <div class="modal-body" style="margin-bottom: 10px;">
                                    <span class="title_red">Blacklist</span>
                                </div>

                                <div class="modal-body" style="display:grid;">
                                    <b>Blacklist: use this feature to globally exclude one of more type of metrics at data discovery and search time.</b>
                                    <br />
                                    <lu>
                                        <li>So called metric category represents the first part of the metric name, and is extracted while discovering the metrics available</li>
                                        <li>For example, metric_category=cpu would exclude any metric_name=cpu.*</li>
                                        <li>You can add or remove metric categories in blacklist at any time</li>
                                    </lu>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <div class="btn_modify_metric_host_whitelist custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: whitelist indexes</button>
                            </div>
                            <div class="btn_modify_metric_host_blacklist_metric_category custom-btn">
                                <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: blacklist metric_category</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_data_host_blacklist_index" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_host_blacklist_index" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_host_blacklist_index">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for index in blacklist: <span style="color: steelblue">$tk_data_index$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>data_index:</b> $tk_data_index$</p>
                                    <p><b>data_blacklist_state:</b> $tk_data_blacklist_state$</p>
                                    <br />
                                    <b>This index is currently excluded from data discovery and alerting.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_host_blacklist_index_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_host_blacklist_index" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_data_host_blacklist_sourcetype" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_data_host_blacklist_sourcetype" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_data_host_blacklist_sourcetype">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for sourcetype in blacklist: <span style="color: steelblue">$tk_data_sourcetype$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>data_sourcetype:</b> $tk_data_sourcetype$</p>
                                    <p><b>data_blacklist_state:</b> $tk_data_blacklist_state$</p>
                                    <br />
                                    <b>This sourcetype is currently excluded from data discovery and alerting.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_data_host_blacklist_sourcetype_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_data_host_blacklist_sourcetype" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Blacklist -->
    <div id="main_modal_manage_metric_host_blacklist_metric_category" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_metric_host_blacklist_metric_category" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_metric_host_blacklist_metric_category">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for metric categories in blacklist: <span style="color: steelblue">$tk_metric_category$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>metric_category:</b> $tk_metric_category$</p>
                                    <p><b>blacklist_state:</b> $tk_metric_blacklist_state$</p>
                                    <br />
                                    <b>This metric_category is currently excluded from data discovery and alerting.</b>
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" id="btn_delete_metric_host_blacklist_metric_category_cancel" role="button" class="btn btn-default btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Cancel</button>
                            <button type="submit" id="btn_delete_metric_host_blacklist_metric_category" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist index -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_host_blacklist_index" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify index blacklisting</h3>
                </div>
                <div class="modal-body">
                    <b>Indexes that have been blacklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_host_blacklist_index">
                    </div>

                    <lu>
                        <li>TrackMe - Data hosts availability short term tracker: tracks data on a frequency over a small time range</li>
                        <li>TrackMe - Data hosts availability long term tracker: tracks data on a hourly frequency over a large time range</li>
                    </lu>

                    <br />

                    <b>In addition, indexes that have been blacklisted are excluded from alerting results.</b>

                    <br />

                    <div id="rowBlackListDataHostIndex1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostIndex1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_blacklist_index" style="margin-bottom: 10px;">
                                            <label>index name:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_host_blacklist_index_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this index</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListDataHostIndex1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListDataHostIndex" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListDataHostIndex2" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostIndex2" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_blacklist_index_search" style="margin-bottom: 10px;">
                                            <label>Search for index name:</label>
                                        </div>

                                        <div id="tableBlackListDataHostIndex" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_host_blacklist_index_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist sourcetype -->
    <div class="modal fade custom-modal-50" id="modal_modify_data_host_blacklist_sourcetype" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify sourcetype blacklisting</h3>
                </div>
                <div class="modal-body">
                    <b>Sourcetypes that have been blacklisted are excluded from the data discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_data_host_blacklist_sourcetype">
                    </div>

                    <lu>
                        <li>TrackMe - Data hosts availability short term tracker: tracks data on a frequency over a small time range</li>
                        <li>TrackMe - Data hosts availability long term tracker: tracks data on a hourly frequency over a large time range</li>
                    </lu>

                    <br />

                    <b>In addition, sourcetypes that have been blacklisted are excluded from alerting results.</b>

                    <br />

                    <div id="rowBlackListDataHostSourcetype1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostSourcetype1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_blacklist_sourcetype" style="margin-bottom: 10px;">
                                            <label>sourcetype name:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_data_host_blacklist_sourcetype_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this sourcetype</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListDataHostSourcetype1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListDataHostSourcetype" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListDataHostSourcetype2" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListDataHostSourcetype2" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_data_host_blacklist_sourcetype_search" style="margin-bottom: 10px;">
                                            <label>Search for sourcetype name:</label>
                                        </div>

                                        <div id="tableBlackListDataHostSourcetype" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_data_host_blacklist_sourcetype_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- blacklist metric_category -->
    <div class="modal fade custom-modal-50" id="modal_modify_metric_host_blacklist_metric_category" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Modify metric category blacklisting</h3>
                </div>
                <div class="modal-body">
                    <b>metric_category that have been blacklisted are excluded from the metric discovery</b>
                    <br /><br />

                    <div class="boxnotify" id="boxnotify-modal_modify_metric_host_blacklist_metric_category">
                    </div>

                    <lu>
                        <li>TrackMe - metric hosts availability tracker</li>
                    </lu>

                    <br />

                    <div id="rowBlackListMetricHostMetricCategory1a" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListMetricHostMetricCategory1" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">

                                        <div class="input input-linklist" id="inputLinkTimeBlackListMetricHost">
                                            <label>&nbsp;</label>
                                        </div>

                                        <div class="input input-dropdown" id="modal_input_metric_host_blacklist_metric_category" style="margin-bottom: 10px;">
                                            <label>metric category:</label>
                                        </div>

                                        <div style="margin-bottom: 10px;">
                                            <button id="btn_modal_metric_host_blacklist_metric_category_add" type="submit" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Add this metric category</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div id="rowBlackListMetricHostMetricCategory1b" class="dashboard-cell" style="width: 50%;">
                            <div class="dashboard-panel clearfix">

                                <div class="panel-element-row">
                                    <div id="singleBlackListMetricHostMetricCategory" class="dashboard-element single" style="width: 100%">
                                        <div class="panel-body"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div id="rowBlackListMetricHostMetricCategory2" class="dashboard-row dashboard-row3">
                        <div id="panelBlackListMetricHostMetricCategory2" class="dashboard-cell" style="width: 100%;">

                            <div class="dashboard-panel clearfix">
                                <div class="panel-element-row">

                                    <div class="fieldset">
                                        <div class="input input-text" id="modal_input_metric_host_blacklist_metric_category_search" style="margin-bottom: 10px;">
                                            <label>Search for metric category:</label>
                                        </div>

                                        <div id="tableBlackListMetricHostMetricCategory" class="dashboard-element table" style="width: 100%">
                                            <label>Click on the table for interactive actions:</label>
                                            <div class="panel-body"></div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" id="btn_modal_metric_host_blacklist_metric_category_add_cancel" class="btn btn-default btn-primary pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Back</button>
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Generic invalid selection -->
    <div class="modal fade" id="modal_entry_update_invalid" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>KVstore entry selection is invalid</h3>
                </div>
                <div class="modal-body">
                    <p>The selection you have made or the modification you have requested is invalid.<br /><br />
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" id="btn_modal_entry_update_invalid" class="btn btn-primary btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Generic modification -->
    <div class="modal fade" id="modal_entry_modification" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>KVstore entry update</h3>
                </div>
                <div class="modal-body">
                    <p>Confirm modification for this entry?<br /><br />
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_entry_modification" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <div id="row1" class="dashboard-row dashboard-row1">
        <div id="panel1" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="fieldset">
                    <div class="input input-linklist" id="link1">
                        <label>&nbsp;</label>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div id="rowSingleFormsDataSource" class="dashboard-row dashboard-rowSingleFormsDataSource" data-depends="$show_data_source_tracker$">
        <div id="SingleFormsDataSource" class="dashboard-row dashboard-row1" data-original-id="SingleFormsDataSource">
            <div id="SingleFormsDataSourcePanel1" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataSourcePanel1">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataSource" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsDataSourcePanel2" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataSourcePanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataSourceAlerts" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsDataSourcePanelHighPriority" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataSourcePanelHighPriority">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataSourceAlertsHighPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsDataSourcePanel3" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataSourcePanel3">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataSourceDisabled" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowSingleFormsDataHost" class="dashboard-row dashboard-rowSingleFormsDataHost" data-depends="$show_data_host_tracker$">
        <div id="SingleFormsDataHost" class="dashboard-row dashboard-row1" data-original-id="SingleFormsDataHost">
            <div id="SingleFormsDataHostPanel1" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataHostPanel1">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataHost" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsDataHostPanel2" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataHostPanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataHostAlerts" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsDataHostPanelHighPriority" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataHostPanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataHostAlertsHighPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsDataHostPanel3" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsDataHostPanel3">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalDataHostDisabled" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowSingleFormsMetricHost" class="dashboard-row dashboard-rowSingleFormsDataHost" data-depends="$show_metric_host_tracker$">
        <div id="SingleForms<Metric>Host" class="dashboard-row dashboard-row1" data-original-id="SingleFormsMetricHost">
            <div id="SingleFormsMetricHostPanel1" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsMetricHostPanel1">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalMetricHost" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsMetricHostPanel2" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsMetricHostPanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalMetricHostAlerts" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsMetricHostPanelHighPriority" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsMetricHostPanel2">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalMetricHostAlertsHighPriority" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="SingleFormsMetricHostPanel3" class="dashboard-cell" style="width: 25%;" data-original-id="SingleFormsMetricHostPanel3">
                <div class="dashboard-panel clearfix">

                    <div class="panel-element-row">
                        <div id="singleFormTotalMetricHostDisabled" class="dashboard-element single" style="width: 100%">
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row2a" class="dashboard-row dashboard-row2" data-depends="$show_data_source_tracker$">
        <div id="panel2a" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Click on any entry of the table to open interactive actions for the data source:</h2>
                <div class="fieldset">
                    <div class="input input-dropdown" id="SearchModeSelectorDataSources">
                        <label>Search mode:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataName">
                        <label>data_name:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataIndex">
                        <label>data_index:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataSourcetype">
                        <label>data_sourcetype:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataSourceState">
                        <label>filter state:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataMonitoredState">
                        <label>filter monitored_state:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataPriority">
                        <label>filter priority:</label>
                    </div>
                    <div class="input input-dropdown" id="refreshForm">
                        <label>Auto refresh:</label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row2b" class="dashboard-row dashboard-row2" data-depends="$show_data_host_tracker$">
        <div id="panel2b" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Click on any entry of the table to open interactive actions for the host:</h2>
                <div class="fieldset">
                    <div class="input input-dropdown" id="SearchModeSelectorDataHosts">
                        <label>Search mode:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataHostIndexes">
                        <label>data_index:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataHostSourcetypes">
                        <label>data_sourcetype:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataHost">
                        <label>data_host:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataHostState">
                        <label>filter state:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataHostMonitoredState">
                        <label>filter monitored_state:</label>
                    </div>
                    <div class="input input-dropdown" id="inputDataHostPriority">
                        <label>filter priority:</label>
                    </div>
                    <div class="input input-dropdown" id="refreshHostForm">
                        <label>Auto refresh:</label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row2c" class="dashboard-row dashboard-row2" data-depends="$show_metric_host_tracker$">
        <div id="panel2c" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Click on any entry of the table to open interactive actions for the host:</h2>
                <div class="fieldset">
                    <div class="input input-dropdown" id="SearchModeSelectorMetricHosts">
                        <label>Search mode:</label>
                    </div>
                    <div class="input input-dropdown" id="inputMetricHostIndexes">
                        <label>metric_index:</label>
                    </div>
                    <div class="input input-dropdown" id="inputMetricHostCategories">
                        <label>metric_category:</label>
                    </div>
                    <div class="input input-dropdown" id="inputMetricHost">
                        <label>metric_host:</label>
                    </div>
                    <div class="input input-dropdown" id="inputMetricHostState">
                        <label>filter state:</label>
                    </div>
                    <div class="input input-dropdown" id="inputMetricHostMonitoredState">
                        <label>filter monitored_state:</label>
                    </div>
                    <div class="input input-dropdown" id="inputMetricHostPriority">
                        <label>filter priority:</label>
                    </div>
                    <div class="input input-dropdown" id="refreshMetricHostForm">
                        <label>Auto refresh:</label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowDataSourcesBtns" class="dashboard-row dashboard-rowDataSourcesBtns" data-depends="$show_data_source_tracker$">
        <div id="panelDataSourcesBtns" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementBtns" class="dashboard-element html" style="width: 100%">
                        <div class="panel-body html">
                            <div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_modify_data_source_blacklist_main" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: whitelists &amp; blacklists</button>
                                </div>
                                <div class="btn_modify_custom_lagging custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: define lagging classes</button>
                                </div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_run_tracker" style="margin-right: 15px;" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Manage: run short term tracker now</button>
                                </div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_run_tracker_longterm" style="margin-right: 15px;" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Manage: run long term tracker now</button>
                                </div>
                            </div>
                            <div style="float: left;">
                                <div class="btn_ops_index_queue custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ops: Indexers queues</button>
                                </div>
                                <div class="btn_ops_parsing_issues custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ops: Parsing issues</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div id="rowDataMetricHostsBtns" class="dashboard-row dashboard-rowMetricHostsBtns" data-depends="$show_metric_host_tracker$">
        <div id="panelMetricHostsBtns" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementBtnsMetricHosts" class="dashboard-element html" style="width: 100%">
                        <div class="panel-body html">
                            <div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_modify_metric_host_blacklist_main" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: whitelists & blacklists</button>
                                </div>
                                <div class="btn_modify_metric_sla_policies custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: metric SLA policies</button>
                                </div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_run_tracker_metric_host" style="margin-right: 15px;" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Manage: run metric tracker now</button>
                                </div>
                            </div>
                            <div style="float: left;">
                                <div class="btn_ops_index_queue custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ops: Indexers queues</button>
                                </div>
                                <div class="btn_ops_parsing_issues custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ops: Parsing issues</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div id="rowDataSourcesTable" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_data_source_tracker$">
        <div id="panelDataSourcesTable" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementMainTable" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowDataHostsBtns" class="dashboard-row dashboard-rowDataSourcesBtns" data-depends="$show_data_host_tracker$">
        <div id="panelDataHostsBtns" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementBtnsHosts" class="dashboard-element html" style="width: 100%">
                        <div class="panel-body html">
                            <div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_modify_data_host_blacklist_main" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: whitelists &amp; blacklists</button>
                                </div>
                                <div class="btn_modify_custom_lagging custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Manage: define lagging classes</button>
                                </div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_run_tracker_host" style="margin-right: 15px;" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Manage: run short term tracker now</button>
                                </div>
                                <div class="custom-btn">
                                    <button type="submit" id="btn_run_tracker_host_longterm" style="margin-right: 15px;" class="btn btn-default btn-primary"><span class="glyphicon glyphicon-remove"></span> Manage: run long term tracker now</button>
                                </div>
                            </div>
                            <div style="float: left;">
                                <div class="btn_ops_index_queue custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ops: Indexers queues</button>
                                </div>
                                <div class="btn_ops_parsing_issues custom-btn">
                                    <button type="submit" style="margin-right: 15px;" class="btn btn-default btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ops: Parsing issues</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div id="rowDataHostsTable" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_data_host_tracker$">
        <div id="panelDataHostsTable" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementMainTableHost" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowMetricHostsTable" class="dashboard-row dashboard-rowMetricSourcesTable" data-depends="$show_metric_host_tracker$">
        <div id="panelMetricHostsTable" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementMainTableMetricHost" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAuditChangesTop" class="dashboard-row dashboard-row1" data-original-id="rowAuditChangesTop" data-depends="$show_audit_changes$">
        <div id="panelAuditChangesTop1" class="dashboard-cell" style="width: 33.33%;">
            <div class="dashboard-panel clearfix">

                <div class="panel-element-row">
                    <div id="chartAuditChangesTopAction" class="dashboard-element chart" style="width: 100%">
                        <div class="panel-head">
                            <h3>TOP Actions</h3>
                        </div>
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
        <div id="panelAuditChangesTop2" class="dashboard-cell" style="width: 33.33%;">
            <div class="dashboard-panel clearfix">

                <div class="panel-element-row">
                    <div id="chartAuditChangesTopUser" class="dashboard-element chart" style="width: 100%">
                        <div class="panel-head">
                            <h3>TOP Users</h3>
                        </div>
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
        <div id="panelAuditChangesTop3" class="dashboard-cell" style="width: 33.33%;">
            <div class="dashboard-panel clearfix">

                <div class="panel-element-row">
                    <div id="chartAuditChangesTopChangeType" class="dashboard-element chart" style="width: 100%">
                        <div class="panel-head">
                            <h3>TOP Change Types</h3>
                        </div>
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAuditFlipTop" class="dashboard-row dashboard-row1" data-original-id="rowAuditFlipTop" data-depends="$show_audit_flip$">
        <div id="panelAuditFlipChart1" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">
                    <div id="chartAuditFlipTopObject" class="dashboard-element chart" style="width: 100%">
                        <div class="panel-head">
                            <h3>TOP Object</h3>
                        </div>
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
        <div id="panelAuditFlipChart2" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">
                    <div id="chartAuditFlipOverTime" class="dashboard-element chart" style="width: 100%">
                        <div class="panel-head">
                            <h3>Flip over time</h3>
                        </div>
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAuditFlipFilters" class="dashboard-row dashboard-AuditChangesFilters" data-depends="$show_audit_flip$">
        <div id="panelAuditFlipFilters" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Search for alert state flipping:</h2>
                <div class="fieldset">
                    <div class="input input-timerangepicker" id="input_timerange_audit_flip">
                        <label>time period:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditFlipObjectCategory">
                        <label>object_category:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditFlipObject">
                        <label>object:</label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAuditFlipTable" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_audit_flip$">
        <div id="panelAuditFlipTable" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementMainTableAuditFlip" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAuditChangesFilters" class="dashboard-row dashboard-AuditChangesFilters" data-depends="$show_audit_changes$">
        <div id="panelAuditChangesFilters" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Search for audit changes:</h2>
                <div class="fieldset">
                    <div class="input input-timerangepicker" id="input_timerange_audit_changes">
                        <label>time period:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditChangesAction">
                        <label>action:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditChangesUser">
                        <label>user:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditChangesObjectCategory">
                        <label>object_category:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditChangesChangeType">
                        <label>change_type:</label>
                    </div>
                    <div class="input input-dropdown" id="inputAuditChangesObject">
                        <label>object:</label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="rowAuditChangesTable" class="dashboard-row dashboard-rowDataSourcesTable" data-depends="$show_audit_changes$">
        <div id="panelAuditChangesTable" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">

                    <div id="elementMainTableAuditChanges" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

</div>
</div>

<!--
END LAYOUT
-->

<script src="{{SPLUNKWEB_URL_PREFIX}}/config?autoload=1" crossorigin="use-credentials"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/js/i18n.js"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/i18ncatalog?autoload=1"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/build/simplexml/index.js"></script>
<script type="text/javascript">
// <![CDATA[
// <![CDATA[
//
// LIBRARY REQUIREMENTS
//
// In the require function, we include the necessary libraries and modules for
// the HTML dashboard. Then, we pass variable names for these libraries and
// modules as function parameters, in order.
//
// When you add libraries or modules, remember to retain this mapping order
// between the library or module and its function parameter. You can do this by
// adding to the end of these lists, as shown in the commented examples below.
require([
        "splunkjs/mvc",
        "splunkjs/mvc/utils",
        "splunkjs/mvc/tokenutils",
        "underscore",
        "jquery",
        "splunkjs/mvc/simplexml",
        "splunkjs/mvc/layoutview",
        "splunkjs/mvc/simplexml/dashboardview",
        "splunkjs/mvc/simplexml/dashboard/panelref",
        "splunkjs/mvc/simplexml/element/chart",
        "splunkjs/mvc/simplexml/element/event",
        "splunkjs/mvc/simplexml/element/html",
        "splunkjs/mvc/simplexml/element/list",
        "splunkjs/mvc/simplexml/element/map",
        "splunkjs/mvc/simplexml/element/single",
        "splunkjs/mvc/simplexml/element/table",
        "splunkjs/mvc/simplexml/element/visualization",
        "splunkjs/mvc/simpleform/formutils",
        "splunkjs/mvc/simplexml/eventhandler",
        "splunkjs/mvc/simplexml/searcheventhandler",
        "splunkjs/mvc/simpleform/input/dropdown",
        "splunkjs/mvc/simpleform/input/radiogroup",
        "splunkjs/mvc/simpleform/input/linklist",
        "splunkjs/mvc/simpleform/input/multiselect",
        "splunkjs/mvc/simpleform/input/checkboxgroup",
        "splunkjs/mvc/simpleform/input/text",
        "splunkjs/mvc/simpleform/input/timerange",
        "splunkjs/mvc/simpleform/input/submit",
        "splunkjs/mvc/searchmanager",
        "splunkjs/mvc/savedsearchmanager",
        "splunkjs/mvc/postprocessmanager",
        "splunkjs/mvc/simplexml/urltokenmodel"
        // Add comma-separated libraries and modules manually here, for example:
        // ..."splunkjs/mvc/simplexml/urltokenmodel",
        // "splunkjs/mvc/tokenforwarder"
    ],
    function(
        mvc,
        utils,
        TokenUtils,
        _,
        $,
        DashboardController,
        LayoutView,
        Dashboard,
        PanelRef,
        ChartElement,
        EventElement,
        HtmlElement,
        ListElement,
        MapElement,
        SingleElement,
        TableElement,
        VisualizationElement,
        FormUtils,
        EventHandler,
        SearchEventHandler,
        DropdownInput,
        RadioGroupInput,
        LinkListInput,
        MultiSelectInput,
        CheckboxGroupInput,
        TextInput,
        TimeRangeInput,
        SubmitButton,
        SearchManager,
        SavedSearchManager,
        PostProcessManager,
        UrlTokenModel

        // Add comma-separated parameter names here, for example:
        // ...UrlTokenModel,
        // TokenForwarder
    ) {

        var pageLoading = true;

        //
        // FUNCTIONS
        //

        // Returns true if numeric
        function isNumeric(n) {
            return !isNaN(parseFloat(n)) && isFinite(n) && n > 0;
        }

        //
        // TOKENS
        //

        // Create token namespaces
        var urlTokenModel = new UrlTokenModel();
        mvc.Components.registerInstance('url', urlTokenModel);
        var defaultTokenModel = mvc.Components.getInstance('default', {
            create: true
        });
        var submittedTokenModel = mvc.Components.getInstance('submitted', {
            create: true
        });

        urlTokenModel.on('url:navigate', function() {
            defaultTokenModel.set(urlTokenModel.toJSON());
            if (!_.isEmpty(urlTokenModel.toJSON()) && !_.all(urlTokenModel.toJSON(), _.isUndefined)) {
                submitTokens();
            } else {
                submittedTokenModel.clear();
            }
        });

        // Initialize tokens
        defaultTokenModel.set(urlTokenModel.toJSON());

        function submitTokens() {
            // Copy the contents of the defaultTokenModel to the submittedTokenModel and urlTokenModel
            FormUtils.submitForm({
                replaceState: pageLoading
            });
        }

        function setToken(name, value) {
            defaultTokenModel.set(name, value);
            submittedTokenModel.set(name, value);
        }

        function unsetToken(name) {
            defaultTokenModel.unset(name);
            submittedTokenModel.unset(name);
        }

        //
        // VARIOUS
        //

        //console.log("Splunk version is " + $C.VERSION_LABEL);

        //
        // SEARCH MANAGERS
        //

        // whitelist

        // whitelist data_source

        var searchPopulateIndexesForWhiteListDataSource = new SearchManager({
            "id": "searchPopulateIndexesForWhiteListDataSource",
            "earliest_time": "$modalTimeWhiteListDataSource.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTimeWhiteListDataSource.latest$",
            "search": "| `tstats` count where index=* by index | lookup trackme_data_source_monitoring_whitelist_index data_index as index OUTPUT data_index as FOUND | where isnull(FOUND) | sort limit=0 index | fields index",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$",
                "depends": "$start_modify_data_source_whitelist$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist metric_category

        var searchPopulateMetricCategoriesForBlackListMetricHost = new SearchManager({
            "id": "searchPopulateMetricCategoriesForBlackListMetricHost",
            "earliest_time": "$modalTimeBlackListMetricHost.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTimeBlackListMetricHost.latest$",
            "search": "| mcatalog values(metric_name) as metric_name where index=* `trackme_mstats_main_filter` | mvexpand metric_name | rex field=metric_name \"(?<metric_category>[^\.]*)\.{0,1}\"  | stats count by metric_category | fields metric_category | lookup trackme_metric_host_monitoring_blacklist_metric_category metric_category | where isnull(metric_blacklist_state) | sort limit=0 metric_category",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$",
                "depends": "$start_modify_metric_host_blacklist_metric_category$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // whitelist data_host

        var searchPopulateIndexesForWhiteListDataHost = new SearchManager({
            "id": "searchPopulateIndexesForWhiteListDataHost",
            "earliest_time": "$modalTimeWhiteListDataHost.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTimeWhiteListDataHost.latest$",
            "search": "| `tstats` count where index=* by index | lookup trackme_data_host_monitoring_whitelist_index data_index as index OUTPUT data_index as FOUND | where isnull(FOUND) | sort limit=0 index | fields index",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$",
                "depends": "$start_modify_data_host_whitelist$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // whitelist metric_host

        var searchPopulateIndexesForWhiteListMetricHost = new SearchManager({
            "id": "searchPopulateIndexesForWhiteListMetricHost",
            "earliest_time": "$modalTimeWhiteListMetricHost.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$modalTimeWhiteListMetricHost.latest$",
            "search": "| mcatalog values(metric_name) as metric_name where index=* by index | stats values(index) as index | mvexpand index | lookup trackme_metric_host_monitoring_whitelist_index metric_index as index OUTPUT metric_index as FOUND | where isnull(FOUND) | sort limit=0 index | fields index",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$",
                "depends": "$start_modify_metric_host_whitelist$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // data sources monitoring

        var searchDataSourcesMain = new SearchManager({
            "id": "searchDataSourcesMain",
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "refreshType": "delay",
            "refresh": "$refresh$",
            "latest_time": "+5m",
            "search": "$data_source_mainsearch$",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchDataSourcesPostTable = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $data_source_state$ | search $inputDataName$ $inputDataIndex$ $inputDataSourcetype$ $data_monitored_state$ $inputDataPriority$ | fillnull data_last_lag_seen, data_last_ingestion_lag_seen | eval \"lag summary (lag event / lag ingestion)\" = data_last_lag_seen . \" sec / \" . data_last_ingestion_lag_seen . \" sec\" | search `trackme_get_idx_whitelist_searchtime(trackme_data_source_monitoring_whitelist_index, data_index)` | `apply_data_source_blacklists` | rename \"data_last_time_seen (translated)\" as \"last time\", \"data_last_ingest (translated)\" as \"last ingest\", \"data_last_time_seen_idx (translated)\" as \"last time idx\" | eval data_tracker_runtime=now() | lookup local=t trackme_data_source_monitoring data_name OUTPUT data_source_state as data_previous_source_state, data_tracker_runtime as data_previous_tracker_runtime, latest_flip_state, latest_flip_time | `trackme_date_format(\"latest_flip_time\")` | fillnull value=\"N/A\" latest_flip_state, latest_flip_time, \"latest_flip_time (translated)\" | `trackme_get_identity_card(data_name)`",
            "managerid": "searchDataSourcesMain",
            "id": "searchDataSourcesPostTable"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateDataSources = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats values(data_name) as data_name | mvexpand data_name | dedup data_name | sort limit=0 data_name",
            "managerid": "searchDataSourcesMain",
            "id": "searchPopulateDataSources"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateDataSourcesIndexes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats values(data_index) as data_index | mvexpand data_index | dedup data_index | sort limit=0 data_index",
            "managerid": "searchDataSourcesMain",
            "id": "searchPopulateDataSourcesIndexes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateDataSourcesSourcetypes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputDataName$ $inputDataIndex$ | stats values(data_sourcetype) as data_sourcetype | mvexpand data_sourcetype | dedup data_sourcetype | sort limit=0 data_sourcetype",
            "managerid": "searchDataSourcesMain",
            "id": "searchPopulateDataSourcesSourcetypes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Audit Flip
        var searchMainAuditFlip = new SearchManager({
            "id": "searchMainAuditFlip",
            "earliest_time": "$timerange_audit_flip.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$timerange_audit_flip.latest$",
            "search": "| inputlookup trackme_audit_flip | sort limit=0 - time | eval _time=time | fields - time | addinfo | where _time>=info_min_time AND (_time<=info_max_time OR info_max_time=\"+Infinity\") | search $audit_flip_object_category$ $audit_flip_object$ | eval \" \" = \"-->\" | table _time object object_category object_previous_state \" \" object_state result | `trackme_eval_icons_flip`",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_audit_flip$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchMainAuditFlipPopulate = new SearchManager({
            "id": "searchMainAuditFlipPopulate",
            "earliest_time": "$timerange_audit_flip.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$timerange_audit_flip.latest$",
            "search": "| inputlookup trackme_audit_flip | sort limit=0 - time | eval _time=time | addinfo | where _time>=info_min_time AND (_time<=info_max_time OR info_max_time=\"+Infinity\") | stats count by object_category, object",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_audit_flip$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditFlipObjectCategory = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count by object_category | sort limit=0 object_category",
            "managerid": "searchMainAuditFlipPopulate",
            "id": "searchAuditFlipObjectCategory"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditFlipObject = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $audit_flip_object_category$ | stats count by object | sort limit=0 object",
            "managerid": "searchMainAuditFlipPopulate",
            "id": "searchAuditFlipObject"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditFlipTopObject = new PostProcessManager({
            "tokenDependencies": {},
            "search": "top object",
            "managerid": "searchMainAuditFlip",
            "id": "searchAuditFlipTopObject"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditFlipOverTime = new PostProcessManager({
            "tokenDependencies": {},
            "search": "timechart limit=40 useother=t minspan=1h bins=1000 count by object",
            "managerid": "searchMainAuditFlip",
            "id": "searchAuditFlipOverTime"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Audit Changes
        var searchMainAuditChanges = new SearchManager({
            "id": "searchMainAuditChanges",
            "earliest_time": "$timerange_audit_changes.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$timerange_audit_changes.latest$",
            "search": "| inputlookup trackme_audit_changes | sort limit=0 - time | eval _time=time/1000 | fields - time | addinfo | where _time>=info_min_time AND (_time<=info_max_time OR info_max_time=\"+Infinity\") | search $audit_changes_action$ $audit_changes_object_category$ $audit_changes_change_type$ $audit_changes_user$ $audit_changes_object$ | table _time user action change_type object_category object object_attrs",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchMainAuditChangesPopulate = new SearchManager({
            "id": "searchMainAuditChangesPopulate",
            "earliest_time": "$timerange_audit_changes.earliest$",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "$timerange_audit_changes.latest$",
            "search": "| inputlookup trackme_audit_changes | sort limit=0 - time | eval _time=time/1000 | addinfo | where _time>=info_min_time AND (_time<=info_max_time OR info_max_time=\"+Infinity\")",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesAction = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count by action | sort limit=0 action",
            "managerid": "searchMainAuditChangesPopulate",
            "id": "searchAuditChangesAction"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesUser = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $audit_changes_action$ | stats count by user | sort limit=0 user",
            "managerid": "searchMainAuditChangesPopulate",
            "id": "searchAuditChangesUser"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesObjectCategory = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $audit_changes_action$ $audit_changes_user$ | stats count by object_category | sort limit=0 object_category",
            "managerid": "searchMainAuditChangesPopulate",
            "id": "searchAuditChangesObjectCategory"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesChangeType = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $audit_changes_action$ $audit_changes_user$ $audit_changes_object_category$ | stats count by change_type | sort limit=0 change_type",
            "managerid": "searchMainAuditChangesPopulate",
            "id": "searchAuditChangesChangeType"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesObject = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $audit_changes_action$ $audit_changes_user$ $audit_changes_object_category$ $audit_changes_change_type$ | stats count by object | sort limit=0 object",
            "managerid": "searchMainAuditChangesPopulate",
            "id": "searchAuditChangesObject"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesTopAction = new PostProcessManager({
            "tokenDependencies": {},
            "search": "top action",
            "managerid": "searchMainAuditChanges",
            "id": "searchAuditChangesTopAction"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesTopUser = new PostProcessManager({
            "tokenDependencies": {},
            "search": "top user",
            "managerid": "searchMainAuditChanges",
            "id": "searchAuditChangesTopUser"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAuditChangesTopChangeType = new PostProcessManager({
            "tokenDependencies": {},
            "search": "top change_type",
            "managerid": "searchMainAuditChanges",
            "id": "searchAuditChangesTopChangeType"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // metric hosts monitoring
        var searchMetricHostsMain = new SearchManager({
            "id": "searchMetricHostsMain",
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "refreshType": "delay",
            "refresh": "$refresh$",
            "latest_time": "now",
            "search": "$metric_host_mainsearch$",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchMainTableMetricHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputMetricHostIndexes$ $inputMetricHostCategories$ $inputMetricHost$ $inputMetricHostPriority$ $metric_host_state$ $metric_monitored_state$",
            "managerid": "searchMetricHostsMain",
            "id": "searchMainTableMetricHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateMetricHostsIndexes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats values(metric_index) as metric_index | mvexpand metric_index | dedup metric_index | sort limit=0 metric_index",
            "managerid": "searchMetricHostsMain",
            "id": "searchPopulateMetricHostsIndexes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateMetricHosts = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count by metric_host | sort limit=0 metric_host",
            "managerid": "searchMetricHostsMain",
            "id": "searchPopulateMetricHosts"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateMetricHostsCategories = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats values(metric_category) as metric_category | mvexpand metric_category | dedup metric_category | search NOT [ | inputlookup trackme_metric_lagging_definition | table metric_category ] | sort limit=0 metric_category",
            "managerid": "searchMetricHostsMain",
            "id": "searchPopulateMetricHostsCategories"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchHostTableMetricHost = new SearchManager({
            "id": "searchHostTableMetricHost",
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "refreshType": "delay",
            "refresh": "$refresh$",
            "latest_time": "now",
            "search": "| savedsearch \"trackMe - metric per host table report\" host=\"$tk_metric_host$\"",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$",
                "depends": "$tk_metric_host$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchHostSingleMetricHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count as count_metric_category, count(eval(metric_host_state=\"green\")) as count_green, count(eval(metric_host_state!=\"green\")) as count_non_green | eval summary=\" metric categories: \" . count_metric_category .  \", \" . \"green state: \" . count_green . \", \" . \"red state: \" . count_non_green | fields summary",
            "managerid": "searchHostTableMetricHost",
            "id": "searchHostSingleMetricHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchHostChartMetricHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "top metric_host_state",
            "managerid": "searchHostTableMetricHost",
            "id": "searchHostChartMetricHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // hosts monitoring

        var searchDataHostsMain = new SearchManager({
            "id": "searchDataHostsMain",
            "earliest_time": "-5m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "refreshType": "delay",
            "refresh": "$refresh$",
            "latest_time": "+5m",
            "search": "$data_host_mainsearch$",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchMainTableHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputDataHost$ $data_host_state$ $data_monitored_state$ $inputDataHostIndexes$ $inputDataHostSourcetypes$ $inputDataHostPriority$ | fillnull data_last_lag_seen, data_last_ingestion_lag_seen | eval \"lag summary (lag event / lag ingestion)\" = data_last_lag_seen . \" sec / \" . data_last_ingestion_lag_seen . \" sec\"",
            "managerid": "searchDataHostsMain",
            "id": "searchMainTableHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateDataHostsIndexes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "makemv data_index delim=\",\" | stats values(data_index) as data_index | mvexpand data_index | dedup data_index | sort limit=0 data_index",
            "managerid": "searchDataHostsMain",
            "id": "searchPopulateDataHostsIndexes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateDataHostsSourcetypes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "makemv data_index delim=\",\" | makemv data_sourcetype delim=\",\" | search $inputDataHostIndexes$ | stats values(data_sourcetype) as data_sourcetype | mvexpand data_sourcetype | dedup data_sourcetype | sort limit=0 data_sourcetype",
            "managerid": "searchDataHostsMain",
            "id": "searchPopulateDataHostsSourcetypes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchPopulateDataHosts = new PostProcessManager({
            "tokenDependencies": {},
            "search": "makemv data_index delim=\",\" | makemv data_sourcetype delim=\",\" | search $inputDataHostIndexes$ $inputDataHostSourcetypes$ | stats values(data_host) as data_host | mvexpand data_host | dedup data_host | sort limit=0 data_host",
            "managerid": "searchDataHostsMain",
            "id": "searchPopulateDataHosts"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleNoDataSources = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count by data_name | sort limit=0 data_name",
            "managerid": "searchDataSourcesMain",
            "id": "searchSingleNoDataSources"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleNoDataIndexes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count by data_index | sort limit=0 data_index",
            "managerid": "searchDataSourcesMain",
            "id": "searchSingleNoDataIndexes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleNoDataSourcetypes = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count by data_sourcetype | sort limit=0 data_sourcetype",
            "managerid": "searchDataSourcesMain",
            "id": "searchSingleNoDataSourcetypes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleNoDataHosts = new PostProcessManager({
            "tokenDependencies": {},
            "search": "stats count by data_host | sort limit=0 data_host",
            "managerid": "searchDataHostsMain",
            "id": "searchSingleNoDataHosts"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataSource1 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputDataName$ $inputDataIndex$ $inputDataSourcetype$ | stats count",
            "managerid": "searchDataSourcesMain",
            "id": "searchSingleDataSource1"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataSource2 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputDataName$ $inputDataIndex$ $inputDataSourcetype$ | where data_source_state=\"red\" | where NOT data_monitored_state=\"disabled\" | stats count",
            "managerid": "searchDataSourcesPostTable",
            "id": "searchSingleDataSource2"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataSourceHighPriority = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputDataName$ $inputDataIndex$ $inputDataSourcetype$ | where data_source_state=\"red\" AND priority=\"high\" | where NOT data_monitored_state=\"disabled\" | stats count",
            "managerid": "searchDataSourcesPostTable",
            "id": "searchSingleDataSourceHighPriority"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataSource3 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputDataName$ $inputDataIndex$ $inputDataSourcetype$ | where data_monitored_state=\"disabled\" | stats count",
            "managerid": "searchDataSourcesMain",
            "id": "searchSingleDataSource3"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataHost1 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "makemv data_index delim=\",\" | makemv data_sourcetype delim=\",\" | search $inputDataHostIndexes$ $inputDataHostSourcetypes$ | stats dc(data_host) as count",
            "managerid": "searchDataHostsMain",
            "id": "searchSingleDataHost1"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataHost2 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "makemv data_index delim=\",\" | makemv data_sourcetype delim=\",\" | search $inputDataHostIndexes$ $inputDataHostSourcetypes$ | where data_host_state=\"red\" | where NOT data_monitored_state=\"disabled\" | stats count",
            "managerid": "searchMainTableHost",
            "id": "searchSingleDataHost2"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataHost3 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "makemv data_index delim=\",\" | makemv data_sourcetype delim=\",\" | search $inputDataHostIndexes$ $inputDataHostSourcetypes$ | where data_monitored_state=\"disabled\" | stats count",
            "managerid": "searchDataHostsMain",
            "id": "searchSingleDataHost3"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleDataHostHighPriority = new PostProcessManager({
            "tokenDependencies": {},
            "search": "makemv data_index delim=\",\" | makemv data_sourcetype delim=\",\" | search $inputDataHostIndexes$ $inputDataHostSourcetypes$ | where data_host_state=\"red\" AND priority=\"high\" | where NOT data_monitored_state=\"disabled\" | stats count",
            "managerid": "searchMainTableHost",
            "id": "searchSingleDataHostHighPriority"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleMetricHost1 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputMetricHostIndexes$ $inputMetricHostCategories$ | stats dc(metric_host) as count",
            "managerid": "searchMetricHostsMain",
            "id": "searchSingleMetricHost1"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleMetricHost2 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputMetricHostIndexes$ $inputMetricHostCategories$ | where metric_host_state=\"red\" | where NOT metric_monitored_state=\"disabled\" | stats count",
            "managerid": "searchMainTableMetricHost",
            "id": "searchSingleMetricHost2"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleMetricHostHighPriority = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputMetricHostIndexes$ $inputMetricHostCategories$ | where metric_host_state=\"red\" AND priority=\"high\" | where NOT metric_monitored_state=\"disabled\" | stats count",
            "managerid": "searchMainTableMetricHost",
            "id": "searchSingleMetricHostHighPriority"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleMetricHost3 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "search $inputMetricHostIndexes$ $inputMetricHostCategories$ | where metric_monitored_state=\"disabled\" | stats count",
            "managerid": "searchMetricHostsMain",
            "id": "searchSingleMetricHost3"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchChartLag = new SearchManager({
            "id": "searchChartLag",
            "sample_ratio": 1,
            "search": "| `tstats` count max(_indextime) as indextime where index=\"$tk_data_index$\" sourcetype=\"$tk_data_sourcetype$\" by _time, index, sourcetype, host span=1s | eval delta=(indextime-_time) | timechart span=$modalTime.span$ sum(count) as events_count, avg(delta) as avg_lag_sec",
            "status_buckets": 0,
            "earliest_time": "$modalTime.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTime.latest$",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // data source monitoring

        var searchSingleLag = new SearchManager({
            "id": "searchSingleLag",
            "sample_ratio": 1,
            "search": "| `tstats` count latest(_indextime) as indextime where index=\"$tk_data_index$\" sourcetype=\"$tk_data_sourcetype$\" by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | stats perc95(delta) as perc95_lag, avg(delta) as avg_lag",
            "status_buckets": 0,
            "earliest_time": "$modalTime.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTime.latest$",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagPerc95 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields perc95_lag",
            "managerid": "searchSingleLag",
            "id": "searchSingleLagPerc95"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagAvg = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields avg_lag",
            "managerid": "searchSingleLag",
            "id": "searchSingleLagAvg"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // data host monitoring

        var searchSingleLagHost = new SearchManager({
            "id": "searchSingleLagHost",
            "sample_ratio": 1,
            "search": "| tstats count latest(_indextime) as indextime where index=* host=\"$tk_data_host$\" `trackme_tstats_main_filter` `trackme_get_idx_whitelist(trackme_data_host_monitoring_whitelist_index, data_index)` `apply_data_host_blacklists_data_retrieve` by _time, index, sourcetype, host span=1s | eval delta=(indextime-_time) | stats perc95(delta) as perc95_lag, avg(delta) as avg_lag",
            "status_buckets": 0,
            "earliest_time": "$modalTimeHost.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTimeHost.latest$",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagHostPerc95 = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields perc95_lag",
            "managerid": "searchSingleLagHost",
            "id": "searchSingleLagHostPerc95"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleLagHostAvg = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| fields avg_lag",
            "managerid": "searchSingleLagHost",
            "id": "searchSingleLagHostAvg"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchChartHostBaseSearch = new SearchManager({
            "id": "searchChartHostBaseSearch",
            "earliest_time": "$modalTimeHost.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTimeHost.latest$",
            "sample_ratio": 1,
            "search": "| tstats count where index=* host=\"$tk_data_host$\" `trackme_tstats_main_filter` `trackme_get_idx_whitelist(trackme_data_host_monitoring_whitelist_index, data_index)` `apply_data_host_blacklists_data_retrieve` by index, sourcetype",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchChartHostIndexes = new PostProcessManager({
            "tokenDependencies": {},
            "managerid": "searchChartHostBaseSearch",
            "search": "stats sum(count) as count by index | sort - count",
            "id": "searchChartHostIndexes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchChartHostSourcetypes = new PostProcessManager({
            "tokenDependencies": {},
            "managerid": "searchChartHostBaseSearch",
            "search": "stats sum(count) as count by sourcetype | sort - count",
            "id": "searchChartHostSourcetypes"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchChartLagHostOverTime = new SearchManager({
            "id": "searchChartLagHostOverTime",
            "earliest_time": "$modalTimeHost.earliest$",
            "cancelOnUnload": true,
            "latest_time": "$modalTimeHost.latest$",
            "sample_ratio": 1,
            "search": "| tstats count max(_indextime) as indextime where index=* host=\"$tk_data_host$\" `trackme_tstats_main_filter` `trackme_get_idx_whitelist(trackme_data_host_monitoring_whitelist_index, data_index)` `apply_data_host_blacklists_data_retrieve` by _time, index, sourcetype span=1s | eval delta=(indextime-_time) | timechart span=$modalTimeHost.span$ sum(count) as events_count, avg(delta) as avg_lag_sec",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Metric SLA policies

        var searchMetricPolicies = new SearchManager({
            "id": "searchMetricPolicies",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_metric_lagging_definition | eval keyid=_key",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_metric_sla_policies$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchMetricPolicies",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_metric_policies"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_metric_policies",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleMetricPolicies = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchMetricPolicies",
            "id": "searchSingleMetricPolicies"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Custom lagging

        var searchCustomLagging = new SearchManager({
            "id": "searchCustomLagging",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_custom_lagging_definition | eval keyid=_key | search name=$tk_input_custom_lagging_search$",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_custom_lagging$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchCustomLagging",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_custom_lagging"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_custom_lagging",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleCustomLagging = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchCustomLagging",
            "id": "searchSingleCustomLagging"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // whitelist

        // whitelist data_source

        var searchWhiteListDataSource = new SearchManager({
            "id": "searchWhiteListDataSource",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_source_monitoring_whitelist_index | eval keyid=_key | search data_index=\"$form.tk_input_data_source_whitelist_search$\" | sort limit=0 data_index",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$",
                "depends": "$start_modify_data_source_whitelist$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchWhiteListDataSource",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_source_whitelist"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_source_whitelist",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleWhiteListDataSource = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchWhiteListDataSource",
            "id": "searchSingleWhiteListDataSource"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // whitelist metric_host

        var searchWhiteListMetricHost = new SearchManager({
            "id": "searchWhiteListMetricHost",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_metric_host_monitoring_whitelist_index | eval keyid=_key | search metric_index=\"$form.tk_input_metric_host_whitelist_search$\" | sort limit=0 metric_index",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$",
                "depends": "$start_modify_metric_host_whitelist$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchWhiteListMetricHost",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_metric_host_whitelist"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_metric_host_whitelist",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleWhiteListMetricHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchWhiteListMetricHost",
            "id": "searchSingleWhiteListMetricHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // whitelist data_host

        var searchWhiteListDataHost = new SearchManager({
            "id": "searchWhiteListDataHost",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_host_monitoring_whitelist_index | eval keyid=_key | search data_index=\"$form.tk_input_data_host_whitelist_search$\" | sort limit=0 data_index",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$",
                "depends": "$start_modify_data_host_whitelist$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchWhiteListDataHost",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_host_whitelist"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_host_whitelist",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleWhiteListDataHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchWhiteListDataHost",
            "id": "searchSingleWhiteListDataHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist

        // blacklist host

        var searchBlackListDataSourceHost = new SearchManager({
            "id": "searchBlackListDataSourceHost",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_source_monitoring_blacklist_host | eval keyid=_key | search data_host=\"$form.tk_input_data_source_blacklist_host_search$\"",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$",
                "depends": "$start_modify_data_source_blacklist_host$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListDataSourceHost",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_source_blacklist_host"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_source_blacklist_host",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleBlackListDataSourceHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListDataSourceHost",
            "id": "searchSingleBlackListDataSourceHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist index

        var searchBlackListDataSourceIndex = new SearchManager({
            "id": "searchBlackListDataSourceIndex",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_source_monitoring_blacklist_index | eval keyid=_key | search data_index=\"$form.tk_input_data_source_blacklist_index_search$\"",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_data_source_blacklist_index$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListDataSourceIndex",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_source_blacklist_index"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_source_blacklist_index",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleBlackListDataSourceIndex = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListDataSourceIndex",
            "id": "searchSingleBlackListDataSourceIndex"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist sourcetype

        var searchBlackListDataSourceSourcetype = new SearchManager({
            "id": "searchBlackListDataSourceSourcetype",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_source_monitoring_blacklist_sourcetype | eval keyid=_key | search data_sourcetype=\"$form.tk_input_data_source_blacklist_sourcetype_search$\"",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_data_source_blacklist_sourcetype$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListDataSourceSourcetype",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_source_blacklist_sourcetype"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_source_blacklist_sourcetype",
                        "value": "True"
                    }]
                }
            ]
        });

        // blacklist host

        var searchBlackListDataHostHost = new SearchManager({
            "id": "searchBlackListDataHostHost",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_host_monitoring_blacklist_host | eval keyid=_key | search data_host=\"$form.tk_input_data_host_blacklist_host_search$\"",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_data_host_blacklist_host$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListDataHostHost",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_host_blacklist_host"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_host_blacklist_host",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleBlackListDataHostHost = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListDataHostHost",
            "id": "searchSingleBlackListDataHostHost"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist index

        var searchBlackListDataHostIndex = new SearchManager({
            "id": "searchBlackListDataHostIndex",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_host_monitoring_blacklist_index | eval keyid=_key | search data_index=\"$form.tk_input_data_host_blacklist_index_search$\"",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_data_host_blacklist_index$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListDataHostIndex",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_host_blacklist_index"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_host_blacklist_index",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleBlackListDataHostIndex = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListDataHostIndex",
            "id": "searchSingleBlackListDataHostIndex"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // blacklist sourcetype

        var searchBlackListDataHostSourcetype = new SearchManager({
            "id": "searchBlackListDataHostSourcetype",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_data_host_monitoring_blacklist_sourcetype | eval keyid=_key | search data_sourcetype=\"$form.tk_input_data_host_blacklist_sourcetype_search$\"",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_data_host_blacklist_sourcetype$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListDataHostSourcetype",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_data_host_blacklist_sourcetype"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_data_host_blacklist_sourcetype",
                        "value": "True"
                    }]
                }
            ]
        });

        // blacklist metric_category

        var searchBlackListMetricHostMetricCategory = new SearchManager({
            "id": "searchBlackListMetricHostMetricCategory",
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "sample_ratio": null,
            "latest_time": "now",
            "search": "| inputlookup trackme_metric_host_monitoring_blacklist_metric_category | eval keyid=_key | search metric_category=\"$form.tk_input_metric_host_blacklist_metric_category_search$\"",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
                "depends": "$start_modify_metric_host_blacklist_metric_category$",
            },
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchBlackListMetricHostMetricCategory",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "unset",
                        "token": "show_table_metric_host_blacklist_metric_category"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_metric_host_blacklist_metric_category",
                        "value": "True"
                    }]
                }
            ]
        });

        var searchSingleBlackListDataSourceSourcetype = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListDataSourceSourcetype",
            "id": "searchSingleBlackListDataSourceSourcetype"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleBlackListDataHostSourcetype = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListDataHostSourcetype",
            "id": "searchSingleBlackListDataHostSourcetype"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchSingleBlackListMetricHostMetricCategory = new PostProcessManager({
            "tokenDependencies": {},
            "search": "| stats count",
            "managerid": "searchBlackListMetricHostMetricCategory",
            "id": "searchSingleBlackListMetricHostMetricCategory"
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Indexer queues
        var searchQueue1 = new SearchManager({
            "id": "searchQueue1",
            "tokenDependencies": {
                "depends": "$tk_start_indexers_queues_searches$"
            },
            "sample_ratio": 1,
            "earliest_time": "$inputLinkQueuesTime.earliest$",
            "search": "(index=_internal `trackme_idx_filter` source=*metrics.log sourcetype=splunkd group=queue name IN(\"splunktcpin\")) | eval nhost=replace(host,\"\\\\..*\",\"\")  | eval ingest_pipe=if(isnotnull(ingest_pipe),ingest_pipe,\"none\")  | search ingest_pipe=* | eval max=coalesce(max_size_kb, max_size) | eval curr=coalesce(current_size_kb, current_size) | eval fill_perc=round(((curr / max) * 100), 2) | timechart span=$inputLinkQueuesTime.span$ max(fill_perc) as avg_fill by nhost useother=false limit=0",
            "latest_time": "$inputLinkQueuesTime.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchQueue2 = new SearchManager({
            "id": "searchQueue2",
            "tokenDependencies": {
                "depends": "$tk_start_indexers_queues_searches$"
            },
            "sample_ratio": 1,
            "earliest_time": "$inputLinkQueuesTime.earliest$",
            "search": "(index=_internal `trackme_idx_filter` source=*metrics.log sourcetype=splunkd group=queue name IN(\"parsingqueue\")) | eval nhost=replace(host,\"\\\\..*\",\"\")  | eval ingest_pipe=if(isnotnull(ingest_pipe),ingest_pipe,\"none\")  | search ingest_pipe=* | eval max=coalesce(max_size_kb, max_size) | eval curr=coalesce(current_size_kb, current_size) | eval fill_perc=round(((curr / max) * 100), 2) | timechart span=$inputLinkQueuesTime.span$ max(fill_perc) as avg_fill by nhost useother=false limit=0",
            "latest_time": "$inputLinkQueuesTime.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchQueue3 = new SearchManager({
            "id": "searchQueue3",
            "tokenDependencies": {
                "depends": "$tk_start_indexers_queues_searches$"
            },
            "sample_ratio": 1,
            "earliest_time": "$inputLinkQueuesTime.earliest$",
            "search": "(index=_internal `trackme_idx_filter` source=*metrics.log sourcetype=splunkd group=queue name IN(\"aggqueue\")) | eval nhost=replace(host,\"\\\\..*\",\"\")  | eval ingest_pipe=if(isnotnull(ingest_pipe),ingest_pipe,\"none\")  | search ingest_pipe=* | eval max=coalesce(max_size_kb, max_size) | eval curr=coalesce(current_size_kb, current_size) | eval fill_perc=round(((curr / max) * 100), 2) | timechart span=$inputLinkQueuesTime.span$ max(fill_perc) as avg_fill by nhost useother=false limit=0",
            "latest_time": "$inputLinkQueuesTime.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchQueue4 = new SearchManager({
            "id": "searchQueue4",
            "tokenDependencies": {
                "depends": "$tk_start_indexers_queues_searches$"
            },
            "sample_ratio": 1,
            "earliest_time": "$inputLinkQueuesTime.earliest$",
            "search": "(index=_internal `trackme_idx_filter` source=*metrics.log sourcetype=splunkd group=queue name IN(\"typingqueue\")) | eval nhost=replace(host,\"\\\\..*\",\"\")  | eval ingest_pipe=if(isnotnull(ingest_pipe),ingest_pipe,\"none\")  | search ingest_pipe=* | eval max=coalesce(max_size_kb, max_size) | eval curr=coalesce(current_size_kb, current_size) | eval fill_perc=round(((curr / max) * 100), 2) | timechart span=$inputLinkQueuesTime.span$ max(fill_perc) as avg_fill by nhost useother=false limit=0",
            "latest_time": "$inputLinkQueuesTime.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchQueue5 = new SearchManager({
            "id": "searchQueue5",
            "tokenDependencies": {
                "depends": "$tk_start_indexers_queues_searches$"
            },
            "sample_ratio": 1,
            "earliest_time": "$inputLinkQueuesTime.earliest$",
            "search": "(index=_internal `trackme_idx_filter` source=*metrics.log sourcetype=splunkd group=queue name IN(\"indexqueue\")) | eval nhost=replace(host,\"\\\\..*\",\"\")  | eval ingest_pipe=if(isnotnull(ingest_pipe),ingest_pipe,\"none\")  | search ingest_pipe=* | eval max=coalesce(max_size_kb, max_size) | eval curr=coalesce(current_size_kb, current_size) | eval fill_perc=round(((curr / max) * 100), 2) | timechart span=$inputLinkQueuesTime.span$ max(fill_perc) as avg_fill by nhost useother=false limit=0",
            "latest_time": "$inputLinkQueuesTime.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Parsing issues
        var searchParsingIssuesChart = new SearchManager({
            "id": "searchParsingIssuesChart",
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "sample_ratio": 1,
            "earliest_time": "$inputLinkParsingIssuesTime.earliest$",
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=LineBreakingProcessor OR component=AggregatorMiningProcessor OR component=DateParserVerbose | timechart span=$inputLinkParsingIssuesTime.span$ count by component",
            "latest_time": "$inputLinkParsingIssuesTime.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchParsingIssuesSingle = new SearchManager({
            "id": "searchParsingIssuesSingle",
            "tokenDependencies": {
                "depends": "$tk_start_parsing_issues_searches$"
            },
            "sample_ratio": 1,
            "earliest_time": "$inputLinkParsingIssuesTime.earliest$",
            "search": "index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=LineBreakingProcessor OR component=AggregatorMiningProcessor OR component=DateParserVerbose | top limit=0 component | eval percent=round(percent, 2) | eval summary=component . \": \" . percent . \" %\" | fields summary | stats values(summary) as summary",
            "latest_time": "$inputLinkParsingIssuesTime.latest$",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Identity card

        var searchIdentityCardTable = new SearchManager({
            "id": "searchIdentityCardTable",
            "tokenDependencies": {
                "depends": "$tk_start_associate_identity_card$"
            },
            "sample_ratio": 1,
            "search": "| inputlookup trackme_sources_knowledge | eval keyid=_key | search object=*$FilterIdentityCardTable$* OR doc_link=*$FilterIdentityCardTable$ OR doc_note=*$FilterIdentityCardTable$* | table keyid, object, doc_link, doc_note",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Logical group

        var searchLogicalGroupTable = new SearchManager({
            "id": "searchLogicalGroupTable",
            "tokenDependencies": {
                "depends": "$tk_start_logical_member_get$"
            },
            "sample_ratio": 1,
            "search": "| inputlookup trackme_logical_group | eval keyid=_key | search object_group_members=\"$input_object$\" | eval object_group_mtime=strftime(object_group_mtime, \"%c\") | table keyid, object_group_name, object_group_members, object_group_min_green_percent, object_group_mtime",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "searchLogicalGroupTable",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'job.resultCount' == 0",
                    actions: [{
                        "type": "set",
                        "token": "show_add_logical_group",
                        "value": "True"
                    },
                    {
                        "type": "unset",
                        "token": "show_table_logical_group"
                    }]
                },
                {
                    attr: "any",
                    value: "*",
                    actions: [{
                        "type": "set",
                        "token": "show_table_logical_group",
                        "value": "True"
                    },
                    {
                        "type": "unset",
                        "token": "show_add_logical_group"
                    }
                    ]
                }
            ]
        });

        // Logical group add member

        var searchLogicalGroupTableAddMember = new SearchManager({
            "id": "searchLogicalGroupTableAddMember",
            "tokenDependencies": {
                "depends": "$tk_start_logical_member_add$"
            },
            "sample_ratio": 1,
            "search": "| inputlookup trackme_logical_group | eval keyid=_key | search object_group_name=*$FilterLogicalGroupTable$* OR object_group_members=*$FilterLogicalGroupTable$* | eval object_group_mtime=strftime(object_group_mtime, \"%c\") | table keyid, object_group_name, object_group_members, object_group_min_green_percent, object_group_mtime",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Ack

        var searchAckGet = new SearchManager({
            "id": "searchAckGet",
            "tokenDependencies": {
                "depends": "$tk_start_ack_get$"
            },
            "sample_ratio": 1,
            "search": "| `trackme_ack_get(\"$input_object$\", \"$input_object_category$\")`",
            "cancelOnUnload": true,
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var searchAckDuration = new SearchManager({
            "id": "searchAckDuration",
            "tokenDependencies": {
                "depends": "$tk_start_ack_get$"
            },
            "earliest_time": "-5m",
            "latest_time": "now",
            "sample_ratio": null,
            "search": "| makeresults | eval duration=`trackme_ack_default_duration` | eval label=\"default\" | eval label=tostring(duration, \"duration\"), priority=1 | fields - _time | append [ | makeresults | eval duration=2*24*60*60 | eval label=\"default\" | eval label=tostring(duration, \"duration\"), priority=2 | fields - _time ] | append [ | makeresults | eval duration=7*24*60*60 | eval label=\"default\" | eval label=tostring(duration, \"duration\"), priority=3 | fields - _time ] | append [ | makeresults | eval duration=15*24*60*60 | eval label=\"default\" | eval label=tostring(duration, \"duration\"), priority=4 | fields - _time ] | append [ | makeresults | eval duration=30*24*60*60 | eval label=\"default\" | eval label=tostring(duration, \"duration\"), priority=5 | fields - _time ] | sort priority | fields duration, label",
            "status_buckets": 0,
            "cancelOnUnload": true,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {
            },
            "runWhenTimeIsUndefined": false
        }, {tokens: true});

        // whitelist

        // whitelist data_source
        // input link selection for modal window
        var inputLinkTimeWhiteListDataSource = new LinkListInput({
            "id": "inputLinkTimeWhiteListDataSource",
            "choices": [{
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.LinkTimeWhiteListDataSource$",
            "el": $('#inputLinkTimeWhiteListDataSource')
        }, {
            tokens: true
        }).render();

        inputLinkTimeWhiteListDataSource.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkTimeWhiteListDataSource.on("valueChange", function(e) {
            if (e.value === "24h") {
                EventHandler.setToken("modalTimeWhiteListDataSource.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataSource.latest", "now", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTimeWhiteListDataSource.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataSource.latest", "now", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTimeWhiteListDataSource.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataSource.latest", "now", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTimeWhiteListDataSource.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataSource.latest", "now", {}, e.data);
            }
        });

        // whitelist data_host
        // input link selection for modal window
        var inputLinkTimeWhiteListDataHost = new LinkListInput({
            "id": "inputLinkTimeWhiteListDataHost",
            "choices": [
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.LinkTimeWhiteListDataHost$",
            "el": $('#inputLinkTimeWhiteListDataHost')
        }, {
            tokens: true
        }).render();

        inputLinkTimeWhiteListDataHost.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkTimeWhiteListDataHost.on("valueChange", function(e) {
            if (e.value === "24h") {
                EventHandler.setToken("modalTimeWhiteListDataHost.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataHost.latest", "now", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTimeWhiteListDataHost.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataHost.latest", "now", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTimeWhiteListDataHost.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataHost.latest", "now", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTimeWhiteListDataHost.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListDataHost.latest", "now", {}, e.data);
            }
        });

        // whitelist metric_host
        // input link selection for modal window
        var inputLinkTimeWhiteListMetricHost = new LinkListInput({
            "id": "inputLinkTimeWhiteListMetricHost",
            "choices": [
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.LinkTimeWhiteListMetricHost$",
            "el": $('#inputLinkTimeWhiteListMetricHost')
        }, {
            tokens: true
        }).render();

        inputLinkTimeWhiteListMetricHost.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkTimeWhiteListMetricHost.on("valueChange", function(e) {
            if (e.value === "24h") {
                EventHandler.setToken("modalTimeWhiteListMetricHost.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListMetricHost.latest", "now", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTimeWhiteListMetricHost.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListMetricHost.latest", "now", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTimeWhiteListMetricHost.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListMetricHost.latest", "now", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTimeWhiteListMetricHost.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTimeWhiteListMetricHost.latest", "now", {}, e.data);
            }
        });

        // blacklist metric_host
        // input link selection for modal window
        var inputLinkTimeBlackListMetricHost = new LinkListInput({
            "id": "inputLinkTimeBlackListMetricHost",
            "choices": [
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.LinkTimeBlackListMetricHost$",
            "el": $('#inputLinkTimeBlackListMetricHost')
        }, {
            tokens: true
        }).render();

        inputLinkTimeBlackListMetricHost.on("change", function(newValue) {
            FormUtils.handleValueChange(inputLinkTimeBlackListMetricHost);
        });

        inputLinkTimeBlackListMetricHost.on("valueChange", function(e) {
            if (e.value === "24h") {
                EventHandler.setToken("modalTimeBlackListMetricHost.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTimeBlackListMetricHost.latest", "now", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTimeBlackListMetricHost.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTimeBlackListMetricHost.latest", "now", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTimeBlackListMetricHost.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTimeBlackListMetricHost.latest", "now", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTimeBlackListMetricHost.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTimeBlackListMetricHost.latest", "now", {}, e.data);
            }
        });

        // data source monitoring

        // input link selection for modal window
        var inputLinkTime = new LinkListInput({
            "id": "inputLinkTime",
            "choices": [{
                    "value": "60m",
                    "label": "60m"
                },
                {
                    "value": "4h",
                    "label": "4h"
                },
                {
                    "value": "12h",
                    "label": "12h"
                },
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "48h",
                    "label": "48h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.modalActionTime$",
            "el": $('#inputLinkTime')
        }, {
            tokens: true
        }).render();

        inputLinkTime.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkTime.on("valueChange", function(e) {
            if (e.value === "60m") {
                EventHandler.setToken("modalTime.earliest", "-60m", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "1m", {}, e.data);
            } else if (e.value === "4h") {
                EventHandler.setToken("modalTime.earliest", "-4h", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "5m", {}, e.data);
            } else if (e.value === "12h") {
                EventHandler.setToken("modalTime.earliest", "-12h", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "10m", {}, e.data);
            } else if (e.value === "24h") {
                EventHandler.setToken("modalTime.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "15m", {}, e.data);
            } else if (e.value === "48h") {
                EventHandler.setToken("modalTime.earliest", "-48h", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "30m", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTime.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "1h", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTime.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "4h", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTime.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTime.latest", "now", {}, e.data);
                EventHandler.setToken("modalTime.span", "12h", {}, e.data);
            }
        });

        // data source monitoring

        // input link selection for modal window
        var inputLinkTimeHost = new LinkListInput({
            "id": "inputLinkTimeHost",
            "choices": [{
                    "value": "60m",
                    "label": "60m"
                },
                {
                    "value": "4h",
                    "label": "4h"
                },
                {
                    "value": "12h",
                    "label": "12h"
                },
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "48h",
                    "label": "48h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                },
                {
                    "value": "90d",
                    "label": "90d"
                }
            ],
            "default": "24h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "24h",
            "value": "$form.modalActionTimeHost$",
            "el": $('#inputLinkTimeHost')
        }, {
            tokens: true
        }).render();

        inputLinkTimeHost.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkTimeHost.on("valueChange", function(e) {
            if (e.value === "60m") {
                EventHandler.setToken("modalTimeHost.earliest", "-60m", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "1m", {}, e.data);
            } else if (e.value === "4h") {
                EventHandler.setToken("modalTimeHost.earliest", "-4h", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "5m", {}, e.data);
            } else if (e.value === "12h") {
                EventHandler.setToken("modalTimeHost.earliest", "-12h", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "10m", {}, e.data);
            } else if (e.value === "24h") {
                EventHandler.setToken("modalTimeHost.earliest", "-24h", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "15m", {}, e.data);
            } else if (e.value === "48h") {
                EventHandler.setToken("modalTimeHost.earliest", "-48h", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "30m", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("modalTimeHost.earliest", "-7d", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "1h", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("modalTimeHost.earliest", "-30d", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "4h", {}, e.data);
            } else if (e.value === "90d") {
                EventHandler.setToken("modalTimeHost.earliest", "-90d", {}, e.data);
                EventHandler.setToken("modalTimeHost.latest", "now", {}, e.data);
                EventHandler.setToken("modalTimeHost.span", "12h", {}, e.data);
            }
        });

        // input link selection for modal window
        var inputLinkQueuesTime = new LinkListInput({
            "id": "inputLinkQueuesTime",
            "choices": [{
                    "value": "4h",
                    "label": "4h"
                },
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                }
            ],
            "default": "4h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "4h",
            "value": "$form.inputLinkQueuesTime$",
            "el": $('#inputLinkQueuesTime')
        }, {
            tokens: true
        }).render();

        inputLinkQueuesTime.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkQueuesTime.on("valueChange", function(e) {
            if (e.value === "4h") {
                EventHandler.setToken("inputLinkQueuesTime.earliest", "-4h", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.span", "5m", {}, e.data);
            } else if (e.value === "24h") {
                EventHandler.setToken("inputLinkQueuesTime.earliest", "-24h", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.span", "15m", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("inputLinkQueuesTime.earliest", "-7d", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.span", "30m", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("inputLinkQueuesTime.earliest", "-30d", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkQueuesTime.span", "4h", {}, e.data);
            }
        });

        // input link selection for modal window
        var inputLinkParsingIssuesTime = new LinkListInput({
            "id": "inputLinkParsingIssuesTime",
            "choices": [{
                    "value": "4h",
                    "label": "4h"
                },
                {
                    "value": "24h",
                    "label": "24h"
                },
                {
                    "value": "7d",
                    "label": "7d"
                },
                {
                    "value": "30d",
                    "label": "30d"
                }
            ],
            "default": "4h",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "4h",
            "value": "$form.inputLinkParsingIssuesTime$",
            "el": $('#inputLinkParsingIssuesTime')
        }, {
            tokens: true
        }).render();

        inputLinkParsingIssuesTime.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        inputLinkParsingIssuesTime.on("valueChange", function(e) {
            if (e.value === "4h") {
                EventHandler.setToken("inputLinkParsingIssuesTime.earliest", "-4h", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.span", "5m", {}, e.data);
            } else if (e.value === "24h") {
                EventHandler.setToken("inputLinkParsingIssuesTime.earliest", "-24h", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.span", "15m", {}, e.data);
            } else if (e.value === "7d") {
                EventHandler.setToken("inputLinkParsingIssuesTime.earliest", "-7d", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.span", "30m", {}, e.data);
            } else if (e.value === "30d") {
                EventHandler.setToken("inputLinkParsingIssuesTime.earliest", "-30d", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.latest", "now", {}, e.data);
                EventHandler.setToken("inputLinkParsingIssuesTime.span", "4h", {}, e.data);
            }
        });

        // data source monitoring

        // input lag

        var modal_input_lag = new TextInput({
            "id": "modal_input_lag",
            "searchWhenChanged": true,
            "value": "$form.tk_input_lag$",
            "el": $('#modal_input_lag')
        }, {
            tokens: true
        }).render();

        modal_input_lag.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_lag);
        });

        var modal_input_lag_override_class = new DropdownInput({
            "id": "modal_input_lag_override_class",
            "choices": [{
                    "label": "true",
                    "value": "true"
                },
                {
                    "label": "false",
                    "value": "false"
                }
            ],
            "searchWhenChanged": true,
            "default": "true",
            "showClearButton": true,
            "initialValue": "true",
            "selectFirstChoice": false,
            "value": "$form.modal_input_lag_override_class$",
            "el": $('#modal_input_lag_override_class')
        }, {
            tokens: true
        }).render();

        modal_input_lag_override_class.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_lag_override_class);
        });

        var modal_input_lag_override_class_host = new DropdownInput({
            "id": "modal_input_lag_override_class_host",
            "choices": [{
                    "label": "true",
                    "value": "true"
                },
                {
                    "label": "false",
                    "value": "false"
                }
            ],
            "searchWhenChanged": true,
            "default": "true",
            "showClearButton": true,
            "initialValue": "true",
            "selectFirstChoice": false,
            "value": "$form.modal_input_lag_override_class_host$",
            "el": $('#modal_input_lag_override_class_host')
        }, {
            tokens: true
        }).render();

        modal_input_lag_override_class_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_lag_override_class_host);
        });

        // Custom lagging

        var modal_input_custom_lagging_type = new DropdownInput({
            "id": "modal_input_custom_lagging_type",
            "choices": [{
                    "label": "sourcetype",
                    "value": "sourcetype"
                },
                {
                    "label": "index",
                    "value": "index"
                }
            ],
            "searchWhenChanged": true,
            "default": "sourcetype",
            "showClearButton": true,
            "initialValue": "sourcetype",
            "selectFirstChoice": false,
            "value": "$form.tk_input_custom_lagging_type$",
            "el": $('#modal_input_custom_lagging_type')
        }, {
            tokens: true
        }).render();

        modal_input_custom_lagging_type.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_lagging_type);
        });

        var modal_input_custom_lagging_name = new TextInput({
            "id": "modal_input_custom_lagging_name",
            "searchWhenChanged": true,
            "value": "$form.tk_input_custom_lagging_name$",
            "el": $('#modal_input_custom_lagging_name')
        }, {
            tokens: true
        }).render();

        modal_input_custom_lagging_name.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_lagging_name);
        });

        var modal_input_custom_lagging_value = new TextInput({
            "id": "modal_input_custom_lagging_value",
            "searchWhenChanged": true,
            "value": "$form.tk_input_custom_lagging_value$",
            "el": $('#modal_input_custom_lagging_value')
        }, {
            tokens: true
        }).render();

        modal_input_custom_lagging_value.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_lagging_value);
        });

        // data host monitoring

        // input lag

        var modal_input_lag_host = new TextInput({
            "id": "modal_input_lag_host",
            "searchWhenChanged": true,
            "value": "$form.tk_input_lag_host$",
            "el": $('#modal_input_lag_host')
        }, {
            tokens: true
        }).render();

        modal_input_lag_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_lag_host);
        });

        // metric host priority

        var modal_input_metric_host_priority = new DropdownInput({
            "id": "modal_input_metric_host_priority",
            "choices": [{
                    "label": "low",
                    "value": "low"
                },
                {
                    "label": "medium",
                    "value": "medium"
                },
                {
                    "label": "high",
                    "value": "high"
                }
            ],
            "searchWhenChanged": true,
            "default": "medium",
            "showClearButton": true,
            "initialValue": "medium",
            "selectFirstChoice": false,
            "value": "$form.tk_input_metric_host_priority$",
            "el": $('#modal_input_metric_host_priority')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_priority.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_priority);
        });

        // data host priority

        var modal_input_host_priority = new DropdownInput({
            "id": "modal_input_host_priority",
            "choices": [{
                    "label": "low",
                    "value": "low"
                },
                {
                    "label": "medium",
                    "value": "medium"
                },
                {
                    "label": "high",
                    "value": "high"
                }
            ],
            "searchWhenChanged": true,
            "default": "medium",
            "showClearButton": true,
            "initialValue": "medium",
            "selectFirstChoice": false,
            "value": "$form.tk_input_host_priority$",
            "el": $('#modal_input_host_priority')
        }, {
            tokens: true
        }).render();

        modal_input_host_priority.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_host_priority);
        });

        var modal_input_level = new DropdownInput({
            "id": "modal_input_level",
            "choices": [{
                    "label": "sourcetype",
                    "value": "sourcetype"
                },
                {
                    "label": "index",
                    "value": "index"
                }
            ],
            "searchWhenChanged": true,
            "default": "sourcetype",
            "showClearButton": true,
            "initialValue": "sourcetype",
            "selectFirstChoice": false,
            "value": "$form.tk_input_level$",
            "el": $('#modal_input_level')
        }, {
            tokens: true
        }).render();

        modal_input_level.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_level);
        });

        // data source priority

        var modal_input_priority = new DropdownInput({
            "id": "modal_input_priority",
            "choices": [{
                    "label": "low",
                    "value": "low"
                },
                {
                    "label": "medium",
                    "value": "medium"
                },
                {
                    "label": "high",
                    "value": "high"
                }
            ],
            "searchWhenChanged": true,
            "default": "medium",
            "showClearButton": true,
            "initialValue": "medium",
            "selectFirstChoice": false,
            "value": "$form.tk_input_priority$",
            "el": $('#modal_input_priority')
        }, {
            tokens: true
        }).render();

        modal_input_priority.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_priority);
        });

        // data source monitoring

        var modal_input_wdays = new DropdownInput({
            "id": "modal_input_wdays",
            "choices": [{
                    "label": "manual:all_days",
                    "value": "manual:all_days"
                },
                {
                    "label": "manual:monday-to-friday",
                    "value": "manual:monday-to-friday"
                },
                {
                    "label": "manual:monday-to-saturday",
                    "value": "manual:monday-to-saturday"
                }
            ],
            "searchWhenChanged": true,
            "default": "manual:all_days",
            "showClearButton": true,
            "initialValue": "all_days",
            "selectFirstChoice": false,
            "value": "$form.tk_input_wdays$",
            "el": $('#modal_input_wdays')
        }, {
            tokens: true
        }).render();

        modal_input_wdays.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_wdays);
        });

        modal_input_wdays.on("valueChange", function(e) {
            if (e.value === "manual:enter_days_numbers") {
                EventHandler.setToken("show_manual_wdays", "true", {}, e.data);
            } else {
                EventHandler.unsetToken("show_manual_wdays");
            }
        });

        var modal_input_wdays_no = new CheckboxGroupInput({
            "id": "modal_input_wdays_no",
            "choices": [{
                    "label": "Monday",
                    "value": "1"
                },
                {
                    "label": "Tuesday",
                    "value": "2"
                },
                {
                    "label": "Wednesday",
                    "value": "3"
                },
                {
                    "label": "Thursday",
                    "value": "4"
                },
                {
                    "label": "Friday",
                    "value": "5"
                },
                {
                    "label": "Saturday",
                    "value": "6"
                },
                {
                    "label": "Sunday",
                    "value": "0"
                }
            ],
            "prefix": "manual:",
            "searchWhenChanged": true,
            "default": ["1", "2", "3", "4", "5", "6", "0"],
            "delimiter": ",",
            "value": "$form.tk_input_wdays_no$",
            "el": $('#modal_input_wdays_no')
        }, {
            tokens: true
        }).render();

        modal_input_wdays_no.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_wdays_no);
        });

        // data host monitoring

        var modal_input_wdays_host = new DropdownInput({
            "id": "modal_input_wdays_host",
            "choices": [{
                    "label": "manual:all_days",
                    "value": "manual:all_days"
                },
                {
                    "label": "manual:monday-to-friday",
                    "value": "manual:monday-to-friday"
                },
                {
                    "label": "manual:monday-to-saturday",
                    "value": "manual:monday-to-saturday"
                }
            ],
            "searchWhenChanged": true,
            "default": "manual:all_days",
            "showClearButton": true,
            "initialValue": "all_days",
            "selectFirstChoice": false,
            "value": "$form.tk_input_wdays_host$",
            "el": $('#modal_input_wdays_host')
        }, {
            tokens: true
        }).render();

        modal_input_wdays_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_wdays_host);
        });

        modal_input_wdays_host.on("valueChange", function(e) {
            if (e.value === "manual:enter_days_numbers") {
                EventHandler.setToken("show_manual_wdays_host", "true", {}, e.data);
            } else {
                EventHandler.unsetToken("show_manual_wdays_host");
            }
        });

        var modal_input_wdays_host_no = new CheckboxGroupInput({
            "id": "modal_input_wdays_host_no",
            "choices": [{
                    "label": "Monday",
                    "value": "1"
                },
                {
                    "label": "Tuesday",
                    "value": "2"
                },
                {
                    "label": "Wednesday",
                    "value": "3"
                },
                {
                    "label": "Thursday",
                    "value": "4"
                },
                {
                    "label": "Friday",
                    "value": "5"
                },
                {
                    "label": "Saturday",
                    "value": "6"
                },
                {
                    "label": "Sunday",
                    "value": "0"
                }
            ],
            "prefix": "manual:",
            "searchWhenChanged": true,
            "default": ["1", "2", "3", "4", "5", "6", "0"],
            "delimiter": ",",
            "value": "$form.tk_input_wdays_host_no$",
            "el": $('#modal_input_wdays_host_no')
        }, {
            tokens: true
        }).render();

        modal_input_wdays_host_no.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_wdays_host_no);
        });

        // metric host monitoring

        // whitelist

        // whitelist data_source

        var modal_input_data_source_whitelist = new DropdownInput({
            "id": "modal_input_data_source_whitelist",
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "index",
            "selectFirstChoice": false,
            "valueField": "index",
            "value": "$form.tk_input_whitelist_data_source$",
            "managerid": "searchPopulateIndexesForWhiteListDataSource",
            "el": $('#modal_input_data_source_whitelist')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_whitelist.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_whitelist);
        });

        var modal_input_data_source_whitelist_search = new TextInput({
            "id": "modal_input_data_source_whitelist_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_whitelist_search$",
            "el": $('#modal_input_data_source_whitelist_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_whitelist_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_whitelist_search);
        });

        // whitelist metric_host

        var modal_input_metric_host_whitelist = new DropdownInput({
            "id": "modal_input_metric_host_whitelist",
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "index",
            "selectFirstChoice": false,
            "valueField": "index",
            "value": "$form.tk_input_whitelist_metric_host$",
            "managerid": "searchPopulateIndexesForWhiteListMetricHost",
            "el": $('#modal_input_metric_host_whitelist')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_whitelist.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_whitelist);
        });

        var modal_input_metric_host_whitelist_search = new TextInput({
            "id": "modal_input_metric_host_whitelist_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_metric_host_whitelist_search$",
            "el": $('#modal_input_metric_host_whitelist_search')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_whitelist_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_whitelist_search);
        });

        // whitelist data_host

        var modal_input_data_host_whitelist = new DropdownInput({
            "id": "modal_input_data_host_whitelist",
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "index",
            "selectFirstChoice": false,
            "valueField": "index",
            "value": "$form.tk_input_whitelist_data_host$",
            "managerid": "searchPopulateIndexesForWhiteListDataHost",
            "el": $('#modal_input_data_host_whitelist')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_whitelist.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_whitelist);
        });

        var modal_input_data_host_whitelist_search = new TextInput({
            "id": "modal_input_data_host_whitelist_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_whitelist_search$",
            "el": $('#modal_input_data_host_whitelist_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_whitelist_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_whitelist_search);
        });

        // blacklist data source

        // blacklist host

        var modal_input_data_source_blacklist_host = new TextInput({
            "id": "modal_input_data_source_blacklist_host",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_blacklist_host$",
            "el": $('#modal_input_data_source_blacklist_host')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_host);
        });

        var modal_input_data_source_blacklist_host_search = new TextInput({
            "id": "modal_input_data_source_blacklist_host_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_blacklist_host_search$",
            "el": $('#modal_input_data_source_blacklist_host_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_host_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_host_search);
        });

        // blacklist index

        var modal_input_data_source_blacklist_index = new TextInput({
            "id": "modal_input_data_source_blacklist_index",
            "searchWhenChanged": true,
            "value": "$form.tk_input_blacklist_index$",
            "el": $('#modal_input_data_source_blacklist_index')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_index.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_index);
        });

        var modal_input_data_source_blacklist_index_search = new TextInput({
            "id": "modal_input_data_source_blacklist_index_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_blacklist_index_search$",
            "el": $('#modal_input_data_source_blacklist_index_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_index_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_index_search);
        });

        // Identify card
        var FilterIdentityCardTable = new TextInput({
            "id": "FilterIdentityCardTable",
            "searchWhenChanged": true,
            "default": "*",
            "value": "$form.FilterIdentityCardTable$",
            "el": $('#FilterIdentityCardTable')
        }, {
            tokens: true
        }).render();

        FilterIdentityCardTable.on("change", function(newValue) {
            FormUtils.handleValueChange(FilterIdentityCardTable);
        });

        // Logical group
        var FilterLogicalGroupTable = new TextInput({
            "id": "FilterLogicalGroupTable",
            "searchWhenChanged": true,
            "default": "*",
            "value": "$form.FilterLogicalGroupTable$",
            "el": $('#FilterLogicalGroupTable')
        }, {
            tokens: true
        }).render();

        FilterLogicalGroupTable.on("change", function(newValue) {
            FormUtils.handleValueChange(FilterLogicalGroupTable);
        });

        // Logical group add
        var InputLogicalGroupName = new TextInput({
            "id": "InputLogicalGroupName",
            "searchWhenChanged": true,
            "value": "$form.InputLogicalGroupName$",
            "el": $('#InputLogicalGroupName')
        }, {
            tokens: true
        }).render();

        InputLogicalGroupName.on("change", function(newValue) {
            FormUtils.handleValueChange(InputLogicalGroupName);
        });

        var InputLogicalGroupNamePercent = new DropdownInput({
            "id": "InputLogicalGroupNamePercent",
            "choices": [{
                    "label": "50%",
                    "value": "50"
                },
                {
                    "label": "33.33%",
                    "value": "33.33"
                },
                {
                    "label": "25%",
                    "value": "25"
                },
                {
                    "label": "12.5%",
                    "value": "12.5"
                }
            ],
            "searchWhenChanged": true,
            "default": "50",
            "showClearButton": true,
            "initialValue": "50",
            "selectFirstChoice": false,
            "value": "$form.InputLogicalGroupNamePercent$",
            "el": $('#InputLogicalGroupNamePercent')
        }, {
            tokens: true
        }).render();

        InputLogicalGroupNamePercent.on("change", function(newValue) {
            FormUtils.handleValueChange(InputLogicalGroupNamePercent);
        });

        // blacklist sourcetype

        var modal_input_data_source_blacklist_sourcetype = new TextInput({
            "id": "modal_input_data_source_blacklist_sourcetype",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_blacklist_sourcetype$",
            "el": $('#modal_input_data_source_blacklist_sourcetype')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_sourcetype.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_sourcetype);
        });

        var modal_input_data_source_blacklist_sourcetype_search = new TextInput({
            "id": "modal_input_data_source_blacklist_sourcetype_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_source_blacklist_sourcetype_search$",
            "el": $('#modal_input_data_source_blacklist_sourcetype_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_source_blacklist_sourcetype_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_source_blacklist_sourcetype_search);
        });

        // blacklist data host

        // blacklist host

        var modal_input_data_host_blacklist_host = new TextInput({
            "id": "modal_input_data_host_blacklist_host",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_blacklist_host$",
            "el": $('#modal_input_data_host_blacklist_host')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_blacklist_host.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_blacklist_host);
        });

        var modal_input_data_host_blacklist_host_search = new TextInput({
            "id": "modal_input_data_host_blacklist_host_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_blacklist_host_search$",
            "el": $('#modal_input_data_host_blacklist_host_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_blacklist_host_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_blacklist_host_search);
        });

        // blacklist index

        var modal_input_data_host_blacklist_index = new TextInput({
            "id": "modal_input_data_host_blacklist_index",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_blacklist_index$",
            "el": $('#modal_input_data_host_blacklist_index')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_blacklist_index.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_blacklist_index);
        });

        var modal_input_data_host_blacklist_index_search = new TextInput({
            "id": "modal_input_data_host_blacklist_index_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_blacklist_index_search$",
            "el": $('#modal_input_data_host_blacklist_index_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_blacklist_index_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_blacklist_index_search);
        });

        // blacklist sourcetype

        var modal_input_data_host_blacklist_sourcetype = new TextInput({
            "id": "modal_input_data_host_blacklist_sourcetype",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_blacklist_sourcetype$",
            "el": $('#modal_input_data_host_blacklist_sourcetype')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_blacklist_sourcetype.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_blacklist_sourcetype);
        });

        var modal_input_data_host_blacklist_sourcetype_search = new TextInput({
            "id": "modal_input_data_host_blacklist_sourcetype_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_data_host_blacklist_sourcetype_search$",
            "el": $('#modal_input_data_host_blacklist_sourcetype_search')
        }, {
            tokens: true
        }).render();

        modal_input_data_host_blacklist_sourcetype_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_data_host_blacklist_sourcetype_search);
        });

        // blacklist metric_category

        var modal_input_metric_host_blacklist_metric_category = new DropdownInput({
            "id": "modal_input_metric_host_blacklist_metric_category",
            "tokenDependencies": {
                "depends": "$start_modify_metric_host_blacklist_metric_category$"
            },
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "metric_category",
            "selectFirstChoice": false,
            "valueField": "metric_category",
            "value": "$form.tk_input_metric_host_blacklist_metric_category$",
            "managerid": "searchPopulateMetricCategoriesForBlackListMetricHost",
            "el": $('#modal_input_metric_host_blacklist_metric_category')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_blacklist_metric_category.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_blacklist_metric_category);
        });

        var modal_input_metric_host_blacklist_metric_category_search = new TextInput({
            "id": "modal_input_metric_host_blacklist_metric_category_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_metric_host_blacklist_metric_category_search$",
            "el": $('#modal_input_metric_host_blacklist_metric_category_search')
        }, {
            tokens: true
        }).render();

        modal_input_metric_host_blacklist_metric_category_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_metric_host_blacklist_metric_category_search);
        });

        // Custom lagging

        var modal_input_custom_lagging_search = new TextInput({
            "id": "modal_input_custom_lagging_search",
            "default": "*",
            "searchWhenChanged": true,
            "value": "$form.tk_input_custom_lagging_search$",
            "el": $('#modal_input_custom_lagging_search')
        }, {
            tokens: true
        }).render();

        modal_input_custom_lagging_search.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_custom_lagging_search);
        });

        //
        // SPLUNK LAYOUT
        //

        $('header').remove();
        new LayoutView({
                "hideChrome": false,
                "hideAppBar": false,
                "hideSplunkBar": false,
                "hideFooter": false
            })
            .render()
            .getContainerElement()
            .appendChild($('.dashboard-body')[0]);

        //
        // DASHBOARD EDITOR
        //

        new Dashboard({
            id: 'dashboard',
            el: $('.dashboard-body'),
            showTitle: true,
            editable: false
        }, {
            tokens: true
        }).render();


        //
        // VIEWS: VISUALIZATION ELEMENTS
        //

        var singleFormTotalDataSource = new SingleElement({
            "id": "singleFormTotalDataSource",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0x779ecb\"]",
            "underLabel": "DATA SOURCES",
            "managerid": "searchSingleDataSource1",
            "el": $('#singleFormTotalDataSource')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataSource.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_source_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataSourceAlerts = new SingleElement({
            "id": "singleFormTotalDataSourceAlerts",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0xffb347\"]",
            "underLabel": "ANY PRIORITY DATA SOURCES IN ALERT",
            "managerid": "searchSingleDataSource2",
            "el": $('#singleFormTotalDataSourceAlerts')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataSourceAlerts.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.inputDataPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_source_state", TokenUtils.replaceTokenNames("red", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataSourceAlertsHighPriority = new SingleElement({
            "id": "singleFormTotalDataSourceAlertsHighPriority",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0xff6961\"]",
            "underLabel": "HIGH PRIORITY DATA SOURCES IN ALERT",
            "managerid": "searchSingleDataSourceHighPriority",
            "el": $('#singleFormTotalDataSourceAlertsHighPriority')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataSourceAlertsHighPriority.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_source_state", TokenUtils.replaceTokenNames("red", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataPriority", TokenUtils.replaceTokenNames("high", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataSourceDisabled = new SingleElement({
            "id": "singleFormTotalDataSourceDisabled",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0x779ecb\"]",
            "underLabel": "DATA SOURCES NOT MONITORED",
            "managerid": "searchSingleDataSource3",
            "el": $('#singleFormTotalDataSourceDisabled')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataSourceDisabled.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("disabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_source_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataHost = new SingleElement({
            "id": "singleFormTotalDataHost",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0x779ecb\"]",
            "underLabel": "DATA HOSTS",
            "managerid": "searchSingleDataHost1",
            "el": $('#singleFormTotalDataHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_host_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataHostPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataHostAlerts = new SingleElement({
            "id": "singleFormTotalDataHostAlerts",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0xffb347\"]",
            "underLabel": "ANY PRIORITY DATA HOSTS IN ALERT",
            "managerid": "searchSingleDataHost2",
            "el": $('#singleFormTotalDataHostAlerts')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataHostAlerts.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.inputDataHostPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_host_state", TokenUtils.replaceTokenNames("red", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataHostAlertsHighPriority = new SingleElement({
            "id": "singleFormTotalDataHostAlertsHighPriority",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0xff6961\"]",
            "underLabel": "HIGH PRIORITY DATA HOSTS IN ALERT",
            "managerid": "searchSingleDataHostHighPriority",
            "el": $('#singleFormTotalDataHostAlertsHighPriority')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataHostAlertsHighPriority.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_host_state", TokenUtils.replaceTokenNames("red", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataHostPriority", TokenUtils.replaceTokenNames("high", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalDataHostDisabled = new SingleElement({
            "id": "singleFormTotalDataHostDisabled",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0x779ecb\"]",
            "underLabel": "DATA HOSTS NOT MONITORED",
            "managerid": "searchSingleDataHost3",
            "el": $('#singleFormTotalDataHostDisabled')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalDataHostDisabled.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.data_monitored_state", TokenUtils.replaceTokenNames("disabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.data_host_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputDataHostPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalMetricHost = new SingleElement({
            "id": "singleFormTotalMetricHost",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0x779ecb\"]",
            "underLabel": "METRIC HOSTS",
            "managerid": "searchSingleMetricHost1",
            "el": $('#singleFormTotalMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalMetricHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.metric_host_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputMetricHostPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.metric_monitored_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalMetricHostAlerts = new SingleElement({
            "id": "singleFormTotalMetricHostAlerts",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0xffb347\"]",
            "underLabel": "ANY PRIORITY METRIC HOSTS IN ALERT",
            "managerid": "searchSingleMetricHost2",
            "el": $('#singleFormTotalMetricHostAlerts')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalMetricHostAlerts.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.inputMetricHostPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.metric_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.metric_host_state", TokenUtils.replaceTokenNames("red", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalMetricHostAlertsHighPriority = new SingleElement({
            "id": "singleFormTotalMetricHostAlertsHighPriority",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0xff6961\"]",
            "underLabel": "HIGH PRIORITY METRIC HOSTS IN ALERT",
            "managerid": "searchSingleMetricHostHighPriority",
            "el": $('#singleFormTotalMetricHostAlertsHighPriority')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalMetricHostAlertsHighPriority.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.metric_host_state", TokenUtils.replaceTokenNames("red", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.metric_monitored_state", TokenUtils.replaceTokenNames("enabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputMetricHostPriority", TokenUtils.replaceTokenNames("high", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        var singleFormTotalMetricHostDisabled = new SingleElement({
            "id": "singleFormTotalMetricHostDisabled",
            "showTrendIndicator": "1",
            "unitPosition": "after",
            "useThousandSeparators": "1",
            "numberPrecision": "0",
            "colorBy": "value",
            "colorMode": "block",
            "drilldown": "all",
            "showSparkline": "1",
            "trellis.scales.shared": "1",
            "useColors": "1",
            "trendDisplayMode": "absolute",
            "trellis.enabled": "0",
            "trendColorInterpretation": "standard",
            "trellis.size": "medium",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x779ecb\",\"0x779ecb\"]",
            "underLabel": "METRIC HOSTS NOT MONITORED",
            "managerid": "searchSingleMetricHost3",
            "el": $('#singleFormTotalMetricHostDisabled')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        singleFormTotalMetricHostDisabled.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.metric_monitored_state", TokenUtils.replaceTokenNames("disabled", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.metric_host_state", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.inputMetricHostPriority", TokenUtils.replaceTokenNames("*", _.extend(submittedTokenModel.toJSON(), e.data)));
            }
        });

        // whitelist

        // whitelist data_source

        var singleWhiteListDataSource = new SingleElement({
            "id": "singleWhiteListDataSource",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "index(es) in whitelist currently",
            "managerid": "searchSingleWhiteListDataSource",
            "el": $('#singleWhiteListDataSource')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // whitelist metric_host

        var singleWhiteListMetricHost = new SingleElement({
            "id": "singleWhiteListMetricHost",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "index(es) in whitelist currently",
            "managerid": "searchSingleWhiteListMetricHost",
            "el": $('#singleWhiteListMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // whitelist data_host

        var singleWhiteListDataHost = new SingleElement({
            "id": "singleWhiteListDataHost",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "index(es) in whitelist currently",
            "managerid": "searchSingleWhiteListDataHost",
            "el": $('#singleWhiteListDataHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListDataSourceHost = new SingleElement({
            "id": "singleBlackListDataSourceHost",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "host(s) in blacklist currently",
            "managerid": "searchSingleBlackListDataSourceHost",
            "el": $('#singleBlackListDataSourceHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListDataSourceIndex = new SingleElement({
            "id": "singleBlackListDataSourceIndex",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "index(es) in blacklist currently",
            "managerid": "searchSingleBlackListDataSourceIndex",
            "el": $('#singleBlackListDataSourceIndex')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListDataSourceSourcetype = new SingleElement({
            "id": "singleBlackListDataSourceSourcetype",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "sourcetype(s) in blacklist currently",
            "managerid": "searchSingleBlackListDataSourceSourcetype",
            "el": $('#singleBlackListDataSourceSourcetype')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListDataHostHost = new SingleElement({
            "id": "singleBlackListDataHostHost",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "host(s) in blacklist currently",
            "managerid": "searchSingleBlackListDataHostHost",
            "el": $('#singleBlackListDataHostHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListDataHostIndex = new SingleElement({
            "id": "singleBlackListDataHostIndex",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "index(es) in blacklist currently",
            "managerid": "searchSingleBlackListDataHostIndex",
            "el": $('#singleBlackListDataHostIndex')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var singleBlackListDataHostSourcetype = new SingleElement({
            "id": "singleBlackListDataHostSourcetype",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "sourcetype(s) in blacklist currently",
            "managerid": "searchSingleBlackListDataHostSourcetype",
            "el": $('#singleBlackListDataHostSourcetype')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // blacklist metric_category
        var singleBlackListMetricHostMetricCategory = new SingleElement({
            "id": "singleBlackListMetricHostMetricCategory",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "metric categorie(s) in blacklist currently",
            "managerid": "searchSingleBlackListMetricHostMetricCategory",
            "el": $('#singleBlackListMetricHostMetricCategory')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // metric sla policies
        var SingleMetricPolicies = new SingleElement({
            "id": "SingleMetricPolicies",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "metric policies",
            "managerid": "searchSingleMetricPolicies",
            "el": $('#SingleMetricPolicies')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Custom lagging
        var SingleCustomLagging = new SingleElement({
            "id": "SingleCustomLagging",
            "trendDisplayMode": "absolute",
            "drilldown": "none",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "numberPrecision": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "trellis.size": "medium",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "current lagging class(es)",
            "managerid": "searchSingleCustomLagging",
            "el": $('#SingleCustomLagging')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementMainTable = new TableElement({
            "id": "elementMainTable",
            "count": 100,
            "drilldown": "row",
            "fields": "data_name, data_index, data_sourcetype, \"last time\", \"last ingest\", priority, state, \"lag summary (lag event / lag ingestion)\", \"last time idx\", data_last_lag_seen_idx, data_max_lag_allowed, monitoring, data_monitoring_level, data_monitoring_wdays",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchDataSourcesPostTable",
            "el": $('#elementMainTable')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementMainTable.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                // clean any previously set main token, used for variable purposes
                unsetToken("tk_data_host");
                unsetToken("tk_metric_host");

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_name", TokenUtils.replaceTokenNames("$row.data_name$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_index", TokenUtils.replaceTokenNames("$row.data_index$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_sourcetype", TokenUtils.replaceTokenNames("$row.data_sourcetype$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_lag_seen", TokenUtils.replaceTokenNames("$row.data_last_lag_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_ingestion_lag_seen", TokenUtils.replaceTokenNames("$row.data_last_ingestion_lag_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_lag_summary", TokenUtils.replaceTokenNames("$row.lag summary (lag event / lag ingestion)$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_lag_seen_idx", TokenUtils.replaceTokenNames("$row.data_last_lag_seen_idx$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_eventcount", TokenUtils.replaceTokenNames("$row.data_eventcount$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_first_time_seen", TokenUtils.replaceTokenNames("$row.data_first_time_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_time_seen", TokenUtils.replaceTokenNames("$row.data_last_time_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_time_seen_human", TokenUtils.replaceTokenNames("$row.last time$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_ingest", TokenUtils.replaceTokenNames("$row.data_last_ingest$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_ingest_human", TokenUtils.replaceTokenNames("$row.last ingest$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_time_seen_idx", TokenUtils.replaceTokenNames("$row.data_last_time_seen_idx$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_time_seen_idx_human", TokenUtils.replaceTokenNames("$row.data_last_time_seen_idx (translated)$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_max_lag_allowed", TokenUtils.replaceTokenNames("$row.data_max_lag_allowed$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_monitored_state", TokenUtils.replaceTokenNames("$row.data_monitored_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_monitoring_level", TokenUtils.replaceTokenNames("$row.data_monitoring_level$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_monitoring_wdays", TokenUtils.replaceTokenNames("$row.data_monitoring_wdays$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_override_lagging_class", TokenUtils.replaceTokenNames("$row.data_override_lagging_class$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_source_state", TokenUtils.replaceTokenNames("$row.data_source_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_tracker_runtime", TokenUtils.replaceTokenNames("$row.data_tracker_runtime$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_previous_source_state", TokenUtils.replaceTokenNames("$row.data_previous_source_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_previous_tracker_runtime", TokenUtils.replaceTokenNames("$row.data_previous_tracker_runtime$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_state", TokenUtils.replaceTokenNames("$row.latest_flip_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_time", TokenUtils.replaceTokenNames("$row.latest_flip_time$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_time_human", TokenUtils.replaceTokenNames("$row.latest_flip_time (translated)$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_priority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // doc href
                setToken("tk_doc_link", TokenUtils.replaceTokenNames("$row.doc_link$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_doc_note", TokenUtils.replaceTokenNames("$row.doc_note$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pref-fill current lagging input
                setToken("form.tk_input_lag", TokenUtils.replaceTokenNames("$row.data_max_lag_allowed$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pref-fill current wdays input
                setToken("form.tk_input_wdays", TokenUtils.replaceTokenNames("$row.data_monitoring_wdays$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pre-fill current monitoring level
                setToken("form.tk_input_level", TokenUtils.replaceTokenNames("$row.data_monitoring_level$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pre-fill current priority
                setToken("form.tk_input_priority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
                var tk_data_index = tokens.get("tk_data_index");
                var tk_data_sourcetype = tokens.get("tk_data_sourcetype");

                // href docs
                var tk_doc_link = tokens.get("tk_doc_link");
                var tk_doc_note = tokens.get("tk_doc_note");

                // If the documentation reference has not been set, define the href format
                if (tk_doc_link == "null") {
                    setToken("tk_doc_link_main", TokenUtils.replaceTokenNames("No identity documentation has been defined, click here to define a documentation reference", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_doc_modal_target", TokenUtils.replaceTokenNames("define_identity_card", _.extend(submittedTokenModel.toJSON(), e.data)));
                    // replace the textinput for modification requests
                    document.getElementById("input_doc_link").value = "link to documentation";
                } else {
                    setToken("tk_doc_link_main", TokenUtils.replaceTokenNames("Click here to access data source identity card", _.extend(submittedTokenModel.toJSON(), e.data)));
                    setToken("tk_doc_modal_target", TokenUtils.replaceTokenNames("manage_identity_card", _.extend(submittedTokenModel.toJSON(), e.data)));
                    // replace the textinput for modification requests
                    document.getElementById("input_doc_link").value = tk_doc_link;
                }

                if (tk_doc_note == "null") {
                    setToken("tk_doc_link", TokenUtils.replaceTokenNames("No documentation defined.", _.extend(submittedTokenModel.toJSON(), e.data)));
                    // replace the textarea for modification requests
                    document.getElementById("input_doc_note").value = "documentation note";
                } else {
                    // replace the textarea for modification requests
                    document.getElementById("input_doc_note").value = tk_doc_note;
                }

                // Define the history search
                var search_data_source = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + '//app/trackme/search' + "?q=search%20index%3D\"" + encodeURI(tk_data_index) + "\"" + " sourcetype%3D\"" + encodeURI(tk_data_sourcetype) + "\""

                // state
                var tk_data_source_state = tokens.get("tk_data_source_state");

                // priority
                var tk_priority = tokens.get("tk_priority");

                // Define the URL target
                document.getElementById("btn_search_data_source").href = search_data_source;

                // Dynamically manage buttons states
                if (tk_data_monitored_state == "enabled") {
                    document.getElementById('btn_enable_monitoring').disabled = true;
                    document.getElementById('btn_disable_monitoring').disabled = false;
                    setToken("tk_data_monitored_state_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else {
                    document.getElementById('btn_enable_monitoring').disabled = false;
                    document.getElementById('btn_disable_monitoring').disabled = true;
                    setToken("tk_data_monitored_state_class", TokenUtils.replaceTokenNames("title_grey", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Dynamically manage Ack button
                if (tk_data_source_state == "red") {
                    document.getElementById('btn_ack_data_source').disabled = false;
                } else {
                    document.getElementById('btn_ack_data_source').disabled = true;
                }

                // Dynamically manage state color
                if (tk_data_source_state == "green") {
                    setToken("tk_data_source_state_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_data_source_state == "orange") {
                    setToken("tk_data_source_state_class", TokenUtils.replaceTokenNames("title_orange", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_data_source_state == "red") {
                    setToken("tk_data_source_state_class", TokenUtils.replaceTokenNames("title_red", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Dynamically manage priority color
                if (tk_priority == "low") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_priority == "medium") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_yellow", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_priority == "high") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_red", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Enable modal context
                $("#modal_manage").modal();

            }
        });

        // Ack
        var elementAckGet = new TableElement({
            "id": "elementAckGet",
            "count": 100,
            "drilldown": "row",
            "fields": "object, object_category, ack_mtime, ack_expiration, ack_state",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchAckGet",
            "el": $('#elementAckGet')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementAckGet.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("input_object", TokenUtils.replaceTokenNames("$row.object$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("input_object_category", TokenUtils.replaceTokenNames("$row.object_category$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("ack_expiration", TokenUtils.replaceTokenNames("$row.ack_expiration$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("ack_state", TokenUtils.replaceTokenNames("$row.ack_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // check if already inactive
                var ack_state = tokens.get("ack_state");

                if (ack_state === "inactive") {
                    // Enable modal context
                    $("#ack_disable_already").modal();
                }
                else {
                    // Enable modal context
                    $("#disable_ack").modal();
                }

            }
        });

        // Identity card
        var elementIdentityCardTable = new TableElement({
            "id": "elementIdentityCardTable",
            "count": 100,
            "drilldown": "row",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchIdentityCardTable",
            "el": $('#elementIdentityCardTable')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementIdentityCardTable.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_object", TokenUtils.replaceTokenNames("$row.object$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_doc_link", TokenUtils.replaceTokenNames("$row.doc_link$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_doc_note", TokenUtils.replaceTokenNames("$row.doc_note$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // Enable modal context
                $("#confirm_associate_identity_card").modal();

            }
        });

        // Logical group
        var elementLogicalGroupTable = new TableElement({
            "id": "elementLogicalGroupTable",
            "count": 100,
            "drilldown": "row",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchLogicalGroupTable",
            "el": $('#elementLogicalGroupTable')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementLogicalGroupTable.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                // Enable modal context
                $("#confirm_remove_from_logical_group").modal();

            }
        });

        // Logical group add member
        var elementLogicalGroupTableAddMember = new TableElement({
            "id": "elementLogicalGroupTableAddMember",
            "count": 100,
            "drilldown": "row",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchLogicalGroupTableAddMember",
            "el": $('#elementLogicalGroupTableAddMember')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementLogicalGroupTableAddMember.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_object_group_name", TokenUtils.replaceTokenNames("$row.object_group_name$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // Enable modal context
                $("#confirm_add_member_logical_group").modal();

            }
        });

        // Audit Flip
        var elementMainTableAuditFlip = new TableElement({
            "id": "elementMainTableAuditFlip",
            "count": 100,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainAuditFlip",
            "el": $('#elementMainTableAuditFlip')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditFlipOverTime = new ChartElement({
            "id": "chartAuditFlipOverTime",
            "charting.chart.stackMode": "stacked",
            "charting.chart": "column",
            "charting.drilldown": "all",
            "resizable": true,
            "managerid": "searchAuditFlipOverTime",
            "el": $('#chartAuditFlipOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditFlipTopObject = new ChartElement({
            "id": "chartAuditFlipTopObject",
            "charting.chart": "pie",
            "charting.drilldown": "all",
            "resizable": true,
            "managerid": "searchAuditFlipTopObject",
            "el": $('#chartAuditFlipTopObject')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Audit Changes
        var elementMainTableAuditChanges = new TableElement({
            "id": "elementMainTableAuditChanges",
            "count": 100,
            "drilldown": "none",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainAuditChanges",
            "el": $('#elementMainTableAuditChanges')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditChangesTopAction = new ChartElement({
            "id": "chartAuditChangesTopAction",
            "charting.chart": "pie",
            "charting.drilldown": "all",
            "resizable": true,
            "managerid": "searchAuditChangesTopAction",
            "el": $('#chartAuditChangesTopAction')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditChangesTopUser = new ChartElement({
            "id": "chartAuditChangesUser",
            "charting.chart": "pie",
            "charting.drilldown": "all",
            "resizable": true,
            "managerid": "searchAuditChangesTopUser",
            "el": $('#chartAuditChangesTopUser')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var chartAuditChangesTopChangeType = new ChartElement({
            "id": "chartAuditChangesTopChangeType",
            "charting.chart": "pie",
            "charting.drilldown": "all",
            "resizable": true,
            "managerid": "searchAuditChangesTopChangeType",
            "el": $('#chartAuditChangesTopChangeType')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // data host monitoring

        var elementMainTableHost = new TableElement({
            "id": "elementMainTableHost",
            "count": 100,
            "drilldown": "row",
            "fields": "data_host, data_index, data_sourcetype, \"last time\", \"last ingest\", priority, state, \"lag summary (lag event / lag ingestion)\", data_max_lag_allowed, monitoring, data_monitoring_wdays",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainTableHost",
            "el": $('#elementMainTableHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementMainTableHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                // clean any previously set main token, used for variable purposes
                unsetToken("tk_data_name");
                unsetToken("tk_metric_host");

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_host", TokenUtils.replaceTokenNames("$row.data_host$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_index", TokenUtils.replaceTokenNames("$row.data_index_raw$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_sourcetype", TokenUtils.replaceTokenNames("$row.data_sourcetype_raw$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_lag_seen", TokenUtils.replaceTokenNames("$row.data_last_lag_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_lag_summary", TokenUtils.replaceTokenNames("$row.lag summary (lag event / lag ingestion)$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_eventcount", TokenUtils.replaceTokenNames("$row.data_eventcount$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_first_time_seen", TokenUtils.replaceTokenNames("$row.data_first_time_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_time_seen", TokenUtils.replaceTokenNames("$row.data_last_time_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_time_seen_human", TokenUtils.replaceTokenNames("$row.last time$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_ingest", TokenUtils.replaceTokenNames("$row.data_last_ingest$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_last_ingest_human", TokenUtils.replaceTokenNames("$row.last ingest$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_max_lag_allowed", TokenUtils.replaceTokenNames("$row.data_max_lag_allowed$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_monitored_state", TokenUtils.replaceTokenNames("$row.data_monitored_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_monitoring_wdays", TokenUtils.replaceTokenNames("$row.data_monitoring_wdays$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_override_lagging_class", TokenUtils.replaceTokenNames("$row.data_override_lagging_class$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_host_state", TokenUtils.replaceTokenNames("$row.data_host_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_tracker_runtime", TokenUtils.replaceTokenNames("$row.data_tracker_runtime$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_previous_host_state", TokenUtils.replaceTokenNames("$row.data_previous_host_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_previous_tracker_runtime", TokenUtils.replaceTokenNames("$row.data_previous_tracker_runtime$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_state", TokenUtils.replaceTokenNames("$row.latest_flip_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_time", TokenUtils.replaceTokenNames("$row.latest_flip_time$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_time_human", TokenUtils.replaceTokenNames("$row.latest_flip_time (translated)$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_priority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pref-fill current lagging input
                setToken("form.tk_input_lag_host", TokenUtils.replaceTokenNames("$row.data_max_lag_allowed$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pref-fill current wdays input
                setToken("form.tk_input_wdays_host", TokenUtils.replaceTokenNames("$row.data_monitoring_wdays$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pre-fill current priority
                setToken("form.tk_input_host_priority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
                var tk_data_host = tokens.get("tk_data_host");

                // state
                var tk_data_host_state = tokens.get("tk_data_host_state");

                // priority
                var tk_priority = tokens.get("tk_priority");

                // Define the history search
                var search_data_host = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + '//app/trackme/search' + "?q=search%20index%3D\"*\" " + "host=\"" + encodeURI(tk_data_host) + "\""

                // Define the URL target
                document.getElementById("btn_search_data_host").href = search_data_host;

                // Dynamically manage buttons states
                if (tk_data_monitored_state == "enabled") {
                    document.getElementById('btn_enable_monitoring_host').disabled = true;
                    document.getElementById('btn_disable_monitoring_host').disabled = false;
                    setToken("tk_data_monitored_state_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else {
                    document.getElementById('btn_enable_monitoring_host').disabled = false;
                    document.getElementById('btn_disable_monitoring_host').disabled = true;
                    setToken("tk_data_monitored_state_class", TokenUtils.replaceTokenNames("title_grey", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Dynamically manage Ack button
                if (tk_data_host_state == "red") {
                    document.getElementById('btn_ack_data_host').disabled = false;
                } else {
                    document.getElementById('btn_ack_data_host').disabled = true;
                }

                // Dynamically manage state color
                if (tk_data_host_state == "green") {
                    setToken("tk_data_host_state_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_data_host_state == "orange") {
                    setToken("tk_data_host_state_class", TokenUtils.replaceTokenNames("title_orange", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_data_host_state == "red") {
                    setToken("tk_data_host_state_class", TokenUtils.replaceTokenNames("title_red", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Dynamically manage priority color
                if (tk_priority == "low") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_priority == "medium") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_yellow", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_priority == "high") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_red", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Enable modal context
                $("#modal_manage_host").modal();

            }
        });

        // Metric host monitoring

        var elementMainTableMetricHost = new TableElement({
            "id": "elementMainTableMetricHost",
            "count": 100,
            "drilldown": "row",
            "fields": "metric_host, metric_index, metric_category, metric_details_human, \"last time\", priority, state, monitoring",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMainTableMetricHost",
            "el": $('#elementMainTableMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        elementMainTableMetricHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                // clean any previously set main token, used for variable purposes
                unsetToken("tk_data_name");
                unsetToken("tk_data_host");

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_host", TokenUtils.replaceTokenNames("$row.metric_host$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_index", TokenUtils.replaceTokenNames("$row.metric_index_raw$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_category", TokenUtils.replaceTokenNames("$row.metric_category_raw$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_last_time_seen", TokenUtils.replaceTokenNames("$row.metric_last_time_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_last_time_seen_human", TokenUtils.replaceTokenNames("$row.last time$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_last_lag_seen", TokenUtils.replaceTokenNames("$row.metric_last_lag_seen$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_details", TokenUtils.replaceTokenNames("$row.metric_details_raw$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_monitored_state", TokenUtils.replaceTokenNames("$row.metric_monitored_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_host_state", TokenUtils.replaceTokenNames("$row.metric_host_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_tracker_runtime", TokenUtils.replaceTokenNames("$row.metric_tracker_runtime$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_previous_host_state", TokenUtils.replaceTokenNames("$row.metric_previous_host_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_previous_tracker_runtime", TokenUtils.replaceTokenNames("$row.metric_previous_tracker_runtime$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_state", TokenUtils.replaceTokenNames("$row.latest_flip_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_time", TokenUtils.replaceTokenNames("$row.latest_flip_time$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_latest_flip_time_human", TokenUtils.replaceTokenNames("$row.latest_flip_time (translated)$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_priority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // pre-fill current priority
                setToken("form.tk_input_metric_host_priority", TokenUtils.replaceTokenNames("$row.priority$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // logical group
                setToken("tk_object_group_name", TokenUtils.replaceTokenNames("$row.object_group_name$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_object_group_state", TokenUtils.replaceTokenNames("$row.object_group_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_object_group_green_percent", TokenUtils.replaceTokenNames("$row.object_group_green_percent$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_object_group_min_green_percent", TokenUtils.replaceTokenNames("$row.object_group_min_green_percent$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_metric_monitored_state = tokens.get("tk_metric_monitored_state");
                var tk_metric_host = tokens.get("tk_metric_host");

                // state
                var tk_metric_host_state = tokens.get("tk_metric_host_state");

                // priority
                var tk_priority = tokens.get("tk_priority");

                // Define the history search

                var search_metric_host = '| mcatalog values(metric_name) as metric_name, values(_dims) where index=* host=\"' + tk_metric_host + '\" by host'
                search_metric_host = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + '//app/trackme/search' + "?q=" + encodeURI(search_metric_host) + '&earliest=-15m&latest=now'

                // Define the URL target
                document.getElementById("btn_search_metric_host").href = search_metric_host;

                var search_metric_host_live_report = '| savedsearch \"trackMe - metric host live report\" host=\"' + tk_metric_host + '"'
                search_metric_host_live_report = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + '//app/trackme/search' + "?q=" + encodeURI(search_metric_host_live_report) + '&earliest=-15m&latest=now'

                // Define the URL target
                document.getElementById("btn_search_metric_host_live_report").href = search_metric_host_live_report;

                // Dynamically manage buttons states
                if (tk_metric_monitored_state == "enabled") {
                    document.getElementById('btn_enable_monitoring_metric_host').disabled = true;
                    document.getElementById('btn_disable_monitoring_metric_host').disabled = false;
                    setToken("tk_metric_monitored_state_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else {
                    document.getElementById('btn_enable_monitoring_metric_host').disabled = false;
                    document.getElementById('btn_disable_monitoring_metric_host').disabled = true;
                    setToken("tk_metric_monitored_state_class", TokenUtils.replaceTokenNames("title_grey", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Dynamically manage Ack button
                if (tk_metric_host_state == "red") {
                    document.getElementById('btn_ack_metric_host').disabled = false;
                } else {
                    document.getElementById('btn_ack_metric_host').disabled = true;
                }

                // Dynamically manage state color
                if (tk_metric_host_state == "green") {
                    setToken("tk_metric_host_state_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_metric_host_state == "orange") {
                    setToken("tk_metric_host_state_class", TokenUtils.replaceTokenNames("title_orange", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_metric_host_state == "red") {
                    setToken("tk_metric_host_state_class", TokenUtils.replaceTokenNames("title_red", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Dynamically manage priority color
                if (tk_priority == "low") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_green", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_priority == "medium") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_yellow", _.extend(submittedTokenModel.toJSON(), e.data)));
                } else if (tk_priority == "high") {
                    setToken("tk_priority_class", TokenUtils.replaceTokenNames("title_red", _.extend(submittedTokenModel.toJSON(), e.data)));
                }

                // Enable modal context
                $("#modal_manage_metric_host").modal();

            }
        });

        var elementHostTableMetricHost = new TableElement({
            "id": "elementHostTableMetricHost",
            "count": 8,
            "drilldown": "none",
            "fields": "metric_category, metric_last_time, metric_max_lag_allowed, metric_current_lag_sec, state",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchHostTableMetricHost",
            "el": $('#elementHostTableMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementHostChartMetricHost = new ChartElement({
            "id": "elementHostChartMetricHost",
            "charting.chart": "pie",
            "charting.drilldown": "all",
            "charting.fieldColors": "{\"red\": 0xff6961, \"orange\": 0xffb347, \"green\": 0x77dd77}",
            "height": "180",
            "resizable": true,
            "managerid": "searchHostChartMetricHost",
            "el": $('#elementHostChartMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Metric SLA policies

        var tableMetricPolicies = new TableElement({
            "id": "tableMetricPolicies",
            "tokenDependencies": {
                "depends": "$show_table_metric_policies$"
            },
            "count": 10,
            "drilldown": "row",
            "fields": "metric_category, metric_max_lag_allowed",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchMetricPolicies",
            "el": $('#tableMetricPolicies')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableMetricPolicies.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_input_metric_policy_metric_category", TokenUtils.replaceTokenNames("$row.metric_category$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_input_metric_max_lag_allowed", TokenUtils.replaceTokenNames("$row.metric_max_lag_allowed$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_input_metric_policy_metric_category = tokens.get("tk_input_metric_policy_metric_category");
                var tk_input_metric_max_lag_allowed = tokens.get("tk_input_metric_max_lag_allowed");

                // Enable modal context
                $("#modal_metric_sla_policies").modal('hide');
                $("#manage_metric_sla_policy").modal();

            }
        });

        var elementHostSingleMetricHost = new SingleElement({
            "id": "elementHostSingleMetricHost",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "height": "80",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "SUMMARY",
            "managerid": "searchHostSingleMetricHost",
            "el": $('#elementHostSingleMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Custom lagging

        var tableCustomLagging = new TableElement({
            "id": "tableCustomLagging",
            "tokenDependencies": {
                "depends": "$show_table_custom_lagging$"
            },
            "count": 10,
            "drilldown": "row",
            "fields": "level, name, value",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchCustomLagging",
            "el": $('#tableCustomLagging')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableCustomLagging.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_input_custom_lagging_level", TokenUtils.replaceTokenNames("$row.level$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_input_custom_lagging_name", TokenUtils.replaceTokenNames("$row.name$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_input_custom_lagging_value", TokenUtils.replaceTokenNames("$row.value$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // Enable modal context
                $("#modify_custom_lagging").modal('hide');
                $("#manage_custom_lagging").modal();

            }
        });

        // whitelist

        // whitelist data_source

        var tableWhiteListDataSource = new TableElement({
            "id": "tableWhiteListDataSource",
            "tokenDependencies": {
                "depends": "$show_table_data_source_whitelist$",
            },
            "count": 10,
            "drilldown": "row",
            "fields": "data_index",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchWhiteListDataSource",
            "el": $('#tableWhiteListDataSource')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableWhiteListDataSource.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_index", TokenUtils.replaceTokenNames("$row.data_index$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_index = tokens.get("tk_data_index");

                // Enable modal context
                $("#modal_modify_data_source_whitelist").modal('hide');
                $("#modal_manage_data_source_whitelist").modal();

            }
        });

        // whitelist data_host

        var tableWhiteListDataHost = new TableElement({
            "id": "tableWhiteListDataHost",
            "tokenDependencies": {
                "depends": "$show_table_data_host_whitelist$",
            },
            "count": 10,
            "drilldown": "row",
            "fields": "data_index",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchWhiteListDataHost",
            "el": $('#tableWhiteListDataHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableWhiteListDataHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_index", TokenUtils.replaceTokenNames("$row.data_index$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_index = tokens.get("tk_data_index");

                // Enable modal context
                $("#modal_modify_data_host_whitelist").modal('hide');
                $("#modal_manage_data_host_whitelist").modal();

            }
        });

        // whitelist metric_host

        var tableWhiteListMetricHost = new TableElement({
            "id": "tableWhiteListMetricHost",
            "tokenDependencies": {
                "depends": "$show_table_metric_host_whitelist$",
            },
            "count": 10,
            "drilldown": "row",
            "fields": "metric_index",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchWhiteListMetricHost",
            "el": $('#tableWhiteListMetricHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableWhiteListMetricHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_index", TokenUtils.replaceTokenNames("$row.metric_index$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_metric_index = tokens.get("tk_metric_index");

                // Enable modal context
                $("#modal_modify_metric_host_whitelist").modal('hide');
                $("#modal_manage_metric_host_whitelist").modal();

            }
        });

        // blacklist

        var tableBlackListDataSourceHost = new TableElement({
            "id": "tableBlackListDataSourceHost",
            "tokenDependencies": {
                "depends": "$show_table_data_source_blacklist_host$"
            },
            "count": 10,
            "drilldown": "row",
            "fields": "data_host, data_blacklist_state",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListDataSourceHost",
            "el": $('#tableBlackListDataSourceHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableBlackListDataSourceHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_host", TokenUtils.replaceTokenNames("$row.data_host$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_blacklist_state", TokenUtils.replaceTokenNames("$row.data_blacklist_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_host = tokens.get("tk_data_host");
                var tk_data_blacklist_state = tokens.get("tk_data_blacklist_state");

                // Enable modal context
                $("#modal_modify_data_source_blacklist_host").modal('hide');
                $("#modal_manage_data_source_blacklist_host").modal();

            }
        });

        var tableBlackListDataSourceIndex = new TableElement({
            "id": "tableBlackListDataSourceIndex",
            "tokenDependencies": {
                "depends": "$show_table_data_source_blacklist_index$",
            },
            "count": 10,
            "drilldown": "row",
            "fields": "data_index, data_blacklist_state",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListDataSourceIndex",
            "el": $('#tableBlackListDataSourceIndex')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableBlackListDataSourceIndex.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_index", TokenUtils.replaceTokenNames("$row.data_index$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_blacklist_state", TokenUtils.replaceTokenNames("$row.data_blacklist_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_index = tokens.get("tk_data_index");
                var tk_data_blacklist_state = tokens.get("tk_data_blacklist_state");

                // Enable modal context
                $("#modal_modify_data_source_blacklist_index").modal('hide');
                $("#modal_manage_data_source_blacklist_index").modal();

            }
        });

        var tableBlackListDataSourceSourcetype = new TableElement({
            "id": "tableBlackListDataSourceSourcetype",
            "tokenDependencies": {
                "depends": "$show_table_data_source_blacklist_sourcetype$"
            },
            "count": 10,
            "drilldown": "row",
            "fields": "data_sourcetype, data_blacklist_state",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListDataSourceSourcetype",
            "el": $('#tableBlackListDataSourceSourcetype')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableBlackListDataSourceSourcetype.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_sourcetype", TokenUtils.replaceTokenNames("$row.data_sourcetype$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_blacklist_state", TokenUtils.replaceTokenNames("$row.data_blacklist_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
                var tk_data_blacklist_state = tokens.get("tk_data_blacklist_state");

                // Enable modal context
                $("#modal_modify_data_source_blacklist_sourcetype").modal('hide');
                $("#modal_manage_data_source_blacklist_sourcetype").modal();

            }
        });

        var tableBlackListDataHostHost = new TableElement({
            "id": "tableBlackListDataHostHost",
            "tokenDependencies": {
                "depends": "$show_table_data_host_blacklist_host$"
            },
            "count": 10,
            "drilldown": "row",
            "fields": "data_host, data_blacklist_state",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListDataHostHost",
            "el": $('#tableBlackListDataHostHost')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableBlackListDataHostHost.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_host", TokenUtils.replaceTokenNames("$row.data_host$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_blacklist_state", TokenUtils.replaceTokenNames("$row.data_blacklist_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_host = tokens.get("tk_data_host");
                var tk_data_blacklist_state = tokens.get("tk_data_blacklist_state");

                // Enable modal context
                $("#modal_modify_data_host_blacklist_host").modal('hide');
                $("#modal_manage_data_host_blacklist_host").modal();

            }
        });

        var tableBlackListDataHostIndex = new TableElement({
            "id": "tableBlackListDataHostIndex",
            "tokenDependencies": {
                "depends": "$show_table_data_host_blacklist_index$"
            },
            "count": 10,
            "drilldown": "row",
            "fields": "data_index, data_blacklist_state",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListDataHostIndex",
            "el": $('#tableBlackListDataHostIndex')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableBlackListDataHostIndex.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_index", TokenUtils.replaceTokenNames("$row.data_index$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_blacklist_state", TokenUtils.replaceTokenNames("$row.data_blacklist_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_index = tokens.get("tk_data_index");
                var tk_data_blacklist_state = tokens.get("tk_data_blacklist_state");

                // Enable modal context
                $("#modal_modify_data_host_blacklist_index").modal('hide');
                $("#modal_manage_data_host_blacklist_index").modal();

            }
        });

        var tableBlackListDataHostSourcetype = new TableElement({
            "id": "tableBlackListDataHostSourcetype",
            "tokenDependencies": {
                "depends": "$show_table_data_host_blacklist_sourcetype$"
            },
            "count": 10,
            "drilldown": "row",
            "fields": "data_sourcetype, data_blacklist_state",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListDataHostSourcetype",
            "el": $('#tableBlackListDataHostSourcetype')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableBlackListDataHostSourcetype.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_sourcetype", TokenUtils.replaceTokenNames("$row.data_sourcetype$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_data_blacklist_state", TokenUtils.replaceTokenNames("$row.data_blacklist_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
                var tk_data_blacklist_state = tokens.get("tk_data_blacklist_state");

                // Enable modal context
                $("#modal_modify_data_host_blacklist_sourcetype").modal('hide');
                $("#modal_manage_data_host_blacklist_sourcetype").modal();

            }
        });

        var tableBlackListMetricHostMetricCategory = new TableElement({
            "id": "tableBlackListMetricHostMetricCategory",
            "tokenDependencies": {
                "depends": "$show_table_metric_host_blacklist_metric_category$"
            },
            "count": 10,
            "drilldown": "row",
            "fields": "metric_category, metric_blacklist_state",
            "refresh.display": "none",
            "wrap": "false",
            "managerid": "searchBlackListMetricHostMetricCategory",
            "el": $('#tableBlackListMetricHostMetricCategory')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        tableBlackListMetricHostMetricCategory.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_category", TokenUtils.replaceTokenNames("$row.metric_category$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_metric_blacklist_state", TokenUtils.replaceTokenNames("$row.metric_blacklist_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_metric_category = tokens.get("tk_metric_category");
                var tk_metric_blacklist_state = tokens.get("tk_metric_blacklist_state");

                // Enable modal context
                $("#modal_modify_metric_host_blacklist_metric_category").modal('hide');
                $("#modal_manage_metric_host_blacklist_metric_category").modal();

            }
        });

        // modal window chart
        var elementChartLag = new ChartElement({
            "id": "elementChartLag",
            "charting.axisX.abbreviation": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.axisTitleY.text": "Events count",
            "refresh.display": "progressbar",
            "charting.chart.nullValueMode": "gaps",
            "charting.axisTitleX.visibility": "collapsed",
            "charting.axisTitleY2.text": "lag in seconds",
            "charting.axisX.scale": "linear",
            "charting.drilldown": "none",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.chart.overlayFields": "avg_lag_sec",
            "charting.chart.showDataLabels": "none",
            "charting.axisTitleY2.visibility": "visible",
            "charting.axisY2.enabled": "1",
            "charting.axisY2.scale": "inherit",
            "trellis.scales.shared": "1",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart.bubbleSizeBy": "area",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.chart.style": "shiny",
            "charting.axisY.scale": "linear",
            "charting.layout.splitSeries": "0",
            "charting.fieldColors": "{\"events_count\": 0xaec6cf, \"avg_lag_sec\": 0x8b0000}",
            "resizable": true,
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.lineWidth": "2",
            "charting.axisTitleY.visibility": "visible",
            "charting.chart.stackMode": "default",
            "charting.legend.placement": "right",
            "trellis.size": "medium",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisY2.abbreviation": "none",
            "charting.chart": "column",
            "charting.axisY.abbreviation": "none",
            "trellis.enabled": "0",
            "managerid": "searchChartLag",
            "el": $('#elementChartLag')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // data source monitoring

        // modal Single Lag
        var elementSingleLagPerc95 = new SingleElement({
            "id": "elementSingleLagPerc95",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "sec",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "PERCENTILE 95 DATA SOURCE LAG",
            "managerid": "searchSingleLagPerc95",
            "el": $('#elementSingleLagPerc95')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSingleLagAvg = new SingleElement({
            "id": "elementSingleLagAvg",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "sec",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "AVERAGE DATA SOURCE LAG",
            "managerid": "searchSingleLagAvg",
            "el": $('#elementSingleLagAvg')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // data host monitoring

        // modal window chart
        var elementChartLagHostOverTime = new ChartElement({
            "id": "elementChartLagHostOverTime",
            "charting.axisX.abbreviation": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.axisTitleY.text": "Events count",
            "refresh.display": "progressbar",
            "charting.chart.nullValueMode": "gaps",
            "charting.axisTitleX.visibility": "collapsed",
            "charting.axisTitleY2.text": "lag in seconds",
            "charting.axisX.scale": "linear",
            "charting.drilldown": "none",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.chart.overlayFields": "avg_lag_sec",
            "charting.chart.showDataLabels": "none",
            "charting.axisTitleY2.visibility": "visible",
            "charting.axisY2.enabled": "1",
            "charting.axisY2.scale": "inherit",
            "trellis.scales.shared": "1",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart.bubbleSizeBy": "area",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.chart.style": "shiny",
            "charting.axisY.scale": "linear",
            "charting.layout.splitSeries": "0",
            "resizable": true,
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.lineWidth": "2",
            "charting.axisTitleY.visibility": "visible",
            "charting.chart.stackMode": "default",
            "charting.legend.placement": "right",
            "trellis.size": "medium",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisY2.abbreviation": "none",
            "charting.chart": "column",
            "charting.axisY.abbreviation": "none",
            "charting.fieldColors": "{\"events_count\": 0xaec6cf, \"avg_lag_sec\": 0x8b0000}",
            "trellis.enabled": "0",
            "height": "200",
            "managerid": "searchChartLagHostOverTime",
            "el": $('#elementChartLagHostOverTime')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // modal Single Lag
        var elementSingleLagHostPerc95 = new SingleElement({
            "id": "elementSingleLagHostPerc95",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "height": "80",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "sec",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "PERCENTILE 95 DATA HOST LAG",
            "managerid": "searchSingleLagHostPerc95",
            "el": $('#elementSingleLagHostPerc95')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementSingleLagHostAvg = new SingleElement({
            "id": "elementSingleLagHostAvg",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "height": "80",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "sec",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "AVERAGE DATA HOST LAG",
            "managerid": "searchSingleLagHostAvg",
            "el": $('#elementSingleLagHostAvg')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementChartHostIndexes = new ChartElement({
            "id": "elementChartHostIndexes",
            "charting.drilldown": "all",
            "resizable": true,
            "charting.chart": "pie",
            "height": "180",
            "managerid": "searchChartHostIndexes",
            "el": $('#elementChartHostIndexes')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementChartHostSourcetypes = new ChartElement({
            "id": "elementChartHostSourcetypes",
            "charting.drilldown": "all",
            "resizable": true,
            "charting.chart": "pie",
            "height": "180",
            "managerid": "searchChartHostSourcetypes",
            "el": $('#elementChartHostSourcetypes')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Ops: Indexer Queues
        var elementChartQueue1 = new ChartElement({
            "id": "elementChartQueue1",
            "charting.chart.nullValueMode": "gaps",
            "resizable": true,
            "trellis.enabled": "0",
            "charting.axisTitleX.visibility": "collapsed",
            "refresh.display": "progressbar",
            "charting.chart.stackMode": "stacked",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisY.abbreviation": "none",
            "charting.legend.placement": "bottom",
            "charting.axisY2.abbreviation": "none",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.chart.showDataLabels": "none",
            "charting.axisY2.enabled": "0",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.style": "shiny",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart": "line",
            "charting.axisX.scale": "linear",
            "trellis.scales.shared": "1",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "height": "350",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.drilldown": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "trellis.size": "medium",
            "charting.axisY.scale": "linear",
            "charting.chart.bubbleSizeBy": "area",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisX.abbreviation": "none",
            "charting.layout.splitSeries": "0",
            "charting.lineWidth": "2",
            "charting.axisY2.scale": "inherit",
            "managerid": "searchQueue1",
            "el": $('#elementChartQueue1')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var elementChartQueue2 = new ChartElement({
            "id": "elementChartQueue2",
            "charting.chart.nullValueMode": "gaps",
            "resizable": true,
            "trellis.enabled": "0",
            "charting.axisTitleX.visibility": "collapsed",
            "refresh.display": "progressbar",
            "charting.chart.stackMode": "stacked",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisY.abbreviation": "none",
            "charting.legend.placement": "bottom",
            "charting.axisY2.abbreviation": "none",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.chart.showDataLabels": "none",
            "charting.axisY2.enabled": "0",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.style": "shiny",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart": "line",
            "charting.axisX.scale": "linear",
            "trellis.scales.shared": "1",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "height": "350",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.drilldown": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "trellis.size": "medium",
            "charting.axisY.scale": "linear",
            "charting.chart.bubbleSizeBy": "area",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisX.abbreviation": "none",
            "charting.layout.splitSeries": "0",
            "charting.lineWidth": "2",
            "charting.axisY2.scale": "inherit",
            "managerid": "searchQueue2",
            "el": $('#elementChartQueue2')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();


        var elementChartQueue3 = new ChartElement({
            "id": "elementChartQueue3",
            "charting.chart.nullValueMode": "gaps",
            "resizable": true,
            "trellis.enabled": "0",
            "charting.axisTitleX.visibility": "collapsed",
            "refresh.display": "progressbar",
            "charting.chart.stackMode": "stacked",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisY.abbreviation": "none",
            "charting.legend.placement": "bottom",
            "charting.axisY2.abbreviation": "none",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.chart.showDataLabels": "none",
            "charting.axisY2.enabled": "0",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.style": "shiny",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart": "line",
            "charting.axisX.scale": "linear",
            "trellis.scales.shared": "1",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "height": "350",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.drilldown": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "trellis.size": "medium",
            "charting.axisY.scale": "linear",
            "charting.chart.bubbleSizeBy": "area",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisX.abbreviation": "none",
            "charting.layout.splitSeries": "0",
            "charting.lineWidth": "2",
            "charting.axisY2.scale": "inherit",
            "managerid": "searchQueue3",
            "el": $('#elementChartQueue3')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();


        var elementChartQueue4 = new ChartElement({
            "id": "elementChartQueue4",
            "charting.chart.nullValueMode": "gaps",
            "resizable": true,
            "trellis.enabled": "0",
            "charting.axisTitleX.visibility": "collapsed",
            "refresh.display": "progressbar",
            "charting.chart.stackMode": "stacked",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisY.abbreviation": "none",
            "charting.legend.placement": "bottom",
            "charting.axisY2.abbreviation": "none",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.chart.showDataLabels": "none",
            "charting.axisY2.enabled": "0",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.style": "shiny",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart": "line",
            "charting.axisX.scale": "linear",
            "trellis.scales.shared": "1",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "height": "350",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.drilldown": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "trellis.size": "medium",
            "charting.axisY.scale": "linear",
            "charting.chart.bubbleSizeBy": "area",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisX.abbreviation": "none",
            "charting.layout.splitSeries": "0",
            "charting.lineWidth": "2",
            "charting.axisY2.scale": "inherit",
            "managerid": "searchQueue4",
            "el": $('#elementChartQueue4')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();


        var elementChartQueue5 = new ChartElement({
            "id": "elementChartQueue5",
            "charting.chart.nullValueMode": "gaps",
            "resizable": true,
            "trellis.enabled": "0",
            "charting.axisTitleX.visibility": "collapsed",
            "refresh.display": "progressbar",
            "charting.chart.stackMode": "stacked",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisY.abbreviation": "none",
            "charting.legend.placement": "bottom",
            "charting.axisY2.abbreviation": "none",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.chart.showDataLabels": "none",
            "charting.axisY2.enabled": "0",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.style": "shiny",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart": "line",
            "charting.axisX.scale": "linear",
            "trellis.scales.shared": "1",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "height": "350",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.drilldown": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "trellis.size": "medium",
            "charting.axisY.scale": "linear",
            "charting.chart.bubbleSizeBy": "area",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisX.abbreviation": "none",
            "charting.layout.splitSeries": "0",
            "charting.lineWidth": "2",
            "charting.axisY2.scale": "inherit",
            "managerid": "searchQueue5",
            "el": $('#elementChartQueue5')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Ops: Parsing Issues
        var elementChartParsingIssues = new ChartElement({
            "id": "elementChartParsingIssues",
            "charting.chart.nullValueMode": "gaps",
            "resizable": true,
            "trellis.enabled": "0",
            "charting.axisTitleX.visibility": "collapsed",
            "refresh.display": "progressbar",
            "charting.chart.stackMode": "stacked",
            "charting.axisLabelsX.majorLabelStyle.overflowMode": "ellipsisNone",
            "charting.axisY.abbreviation": "none",
            "charting.legend.placement": "bottom",
            "charting.axisY2.abbreviation": "none",
            "charting.legend.labelStyle.overflowMode": "ellipsisMiddle",
            "charting.chart.showDataLabels": "none",
            "charting.axisY2.enabled": "0",
            "charting.chart.sliceCollapsingThreshold": "0.01",
            "charting.chart.style": "shiny",
            "charting.layout.splitSeries.allowIndependentYRanges": "0",
            "charting.chart": "column",
            "charting.axisX.scale": "linear",
            "trellis.scales.shared": "1",
            "charting.axisTitleY.visibility": "visible",
            "charting.axisTitleY2.visibility": "visible",
            "height": "350",
            "charting.chart.bubbleMinimumSize": "10",
            "charting.drilldown": "none",
            "charting.legend.mode": "standard",
            "charting.chart.bubbleMaximumSize": "50",
            "trellis.size": "medium",
            "charting.axisY.scale": "linear",
            "charting.chart.bubbleSizeBy": "area",
            "charting.axisLabelsX.majorLabelStyle.rotation": "0",
            "charting.axisX.abbreviation": "none",
            "charting.layout.splitSeries": "0",
            "charting.lineWidth": "2",
            "charting.axisY2.scale": "inherit",
            "managerid": "searchParsingIssuesChart",
            "el": $('#elementChartParsingIssues')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // modal Single Lag
        var elementSingleParsingIssues = new SingleElement({
            "id": "elementSingleParsingIssues",
            "trendDisplayMode": "absolute",
            "numberPrecision": "0.00",
            "drilldown": "none",
            "trellis.size": "medium",
            "trendColorInterpretation": "standard",
            "useColors": "0",
            "colorBy": "value",
            "showTrendIndicator": "1",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "unit": "",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "colorMode": "none",
            "rangeValues": "[0,30,70,100]",
            "unitPosition": "after",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "underLabel": "SUMMARY",
            "managerid": "searchParsingIssuesSingle",
            "el": $('#elementSingleParsingIssues')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Manage html dynamic panels

        var body_modal_manage = new HtmlElement({
            "id": "body_modal_manage",
            "useTokens": true,
            "el": $('#body_modal_manage')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var body_modal_manage_host = new HtmlElement({
            "id": "body_modal_manage_host",
            "useTokens": true,
            "el": $('#body_modal_manage_host')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // metric host

        var body_modal_manage_metric_host = new HtmlElement({
            "id": "body_modal_manage_metric_host",
            "useTokens": true,
            "el": $('#body_modal_manage_metric_host')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Metric SLA policies
        var body_manage_metric_sla_policy = new HtmlElement({
            "id": "body_manage_metric_sla_policy",
            "useTokens": true,
            "el": $('#body_manage_metric_sla_policy')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // Custom lagging
        var body_manage_custom_lagging = new HtmlElement({
            "id": "body_manage_custom_lagging",
            "useTokens": true,
            "el": $('#body_manage_custom_lagging')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        // data source identity card
        var body_manage_identity_card = new HtmlElement({
            "id": "body_manage_identity_card",
            "useTokens": true,
            "el": $('#body_manage_identity_card')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_manage_custom_lagging.contentLoaded());

        // whitelist

        // whitelist data_source

        var body_modal_manage_data_source_whitelist = new HtmlElement({
            "id": "body_modal_manage_data_source_whitelist",
            "useTokens": true,
            "el": $('#body_modal_manage_data_source_whitelist')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_data_source_whitelist.contentLoaded());

        // whitelist metric_host

        var body_modal_manage_metric_host_whitelist = new HtmlElement({
            "id": "body_modal_manage_metric_host_whitelist",
            "useTokens": true,
            "el": $('#body_modal_manage_metric_host_whitelist')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_metric_host_whitelist.contentLoaded());

        // whitelist data_host

        var body_modal_manage_data_host_whitelist = new HtmlElement({
            "id": "body_modal_manage_data_host_whitelist",
            "useTokens": true,
            "el": $('#body_modal_manage_data_host_whitelist')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_data_host_whitelist.contentLoaded());

        // blacklist

        // blacklist host

        var body_modal_manage_data_source_blacklist_host = new HtmlElement({
            "id": "body_modal_manage_data_source_blacklist_host",
            "useTokens": true,
            "el": $('#body_modal_manage_data_source_blacklist_host')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_data_source_blacklist_host.contentLoaded());

        var body_modal_manage_data_host_blacklist_host = new HtmlElement({
            "id": "body_modal_manage_data_host_blacklist_host",
            "useTokens": true,
            "el": $('#body_modal_manage_data_host_blacklist_host')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_data_host_blacklist_host.contentLoaded());

        // blacklist index

        var body_modal_manage_data_source_blacklist_index = new HtmlElement({
            "id": "body_modal_manage_data_source_blacklist_index",
            "useTokens": true,
            "el": $('#body_modal_manage_data_source_blacklist_index')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_data_source_blacklist_index.contentLoaded());

        var body_modal_manage_data_host_blacklist_index = new HtmlElement({
            "id": "body_modal_manage_data_host_blacklist_index",
            "useTokens": true,
            "el": $('#body_modal_manage_data_host_blacklist_index')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_data_host_blacklist_index.contentLoaded());

        // blacklist host

        var body_modal_manage_data_source_blacklist_sourcetype = new HtmlElement({
            "id": "body_modal_manage_data_source_blacklist_sourcetype",
            "useTokens": true,
            "el": $('#body_modal_manage_data_source_blacklist_sourcetype')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_data_source_blacklist_sourcetype.contentLoaded());

        var body_modal_manage_data_host_blacklist_sourcetype = new HtmlElement({
            "id": "body_modal_manage_data_host_blacklist_sourcetype",
            "useTokens": true,
            "el": $('#body_modal_manage_data_host_blacklist_sourcetype')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_data_host_blacklist_sourcetype.contentLoaded());

        var body_modal_manage_metric_host_blacklist_metric_category = new HtmlElement({
            "id": "body_modal_manage_metric_host_blacklist_metric_category",
            "useTokens": true,
            "el": $('#body_modal_manage_metric_host_blacklist_metric_category')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_metric_host_blacklist_metric_category.contentLoaded());

        //
        // VIEWS: FORM INPUTS
        //

        var SearchModeSelectorDataSources = new DropdownInput({
            "id": "SearchModeSelectorDataSources",
            "choices": [
                {"label": "Collection based", "value": "collection_based"},
                {"label": "Search based", "value": "search_based"}
            ],
            "default": "collection_based",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "showClearButton": true,
            "initialValue": "collection_based",
            "value": "$form.SearchModeSelectorDataSources$",
            "el": $('#SearchModeSelectorDataSources')
        }, {tokens: true}).render();

        SearchModeSelectorDataSources.on("change", function(newValue) {
            FormUtils.handleValueChange(SearchModeSelectorDataSources);
        });

        SearchModeSelectorDataSources.on("valueChange", function(e) {
            if (e.value === "search_based") {
                EventHandler.setToken("data_source_mainsearch", "| `tstats` max(_indextime) as current_data_last_ingest, min(_time) as current_data_first_time_seen, max(_time) as current_data_last_time_seen, count as current_data_eventcount where index=* sourcetype=* `trackme_tstats_main_filter` `trackme_get_idx_whitelist(trackme_data_source_monitoring_whitelist_index, data_index)` `apply_data_source_blacklists_data_retrieve` by index, sourcetype\n| rename index as data_index, sourcetype as data_sourcetype\n| lookup trackme_data_source_monitoring data_index, data_sourcetype OUTPUT data_name | append [ | inputlookup trackme_data_source_monitoring | eval keyid=_key | search `trackme_get_idx_whitelist_searchtime(trackme_data_source_monitoring_whitelist_index, data_index)` ] | stats first(*) as \"*\" by data_name, data_index, data_sourcetype | eval data_last_ingest=if(isnotnull(current_data_last_ingest), current_data_last_ingest, data_last_ingest), data_last_ingestion_lag_seen=if(isnotnull(current_data_last_ingestion_lag_seen), round(current_data_last_ingestion_lag_seen, 0), round(data_last_ingestion_lag_seen, 0)), data_first_time_seen=if(isnotnull(current_data_first_time_seen), current_data_first_time_seen, data_first_time_seen), data_last_time_seen=if(isnotnull(current_data_last_time_seen), current_data_last_time_seen, data_last_time_seen) | eval current_data_eventcount=if(isnotnull(current_data_eventcount), current_data_eventcount, data_eventcount) | fields - current_* | eventstats max(data_last_time_seen) as data_last_time_seen_idx, min(data_last_lag_seen) as data_last_lag_seen_idx by data_index | `trackme_eval_data_source_state` | `trackme_default_priority` | `trackme_date_format(data_last_time_seen)` | `trackme_date_format(data_last_time_seen_idx)` | `trackme_date_format(data_last_ingest)` | fillnull value=\"red\" data_source_state | sort 0 data_source | `trackme_eval_icons`", {}, e.data);
            } else if (e.value === "collection_based") {
                EventHandler.setToken("data_source_mainsearch", "| inputlookup trackme_data_source_monitoring\n| eval keyid=_key\n| `apply_data_source_blacklists`\n| search `trackme_get_idx_whitelist_searchtime(trackme_data_source_monitoring_whitelist_index, data_index)`\n| `trackme_eval_data_source_state` | `trackme_default_priority` | `trackme_date_format(data_last_time_seen)` | `trackme_date_format(data_last_time_seen_idx)` | `trackme_date_format(data_last_ingest)` | fillnull value=\"red\" data_source_state | sort 0 data_source | `trackme_eval_icons`", {}, e.data);
            }
        });

        var SearchModeSelectorDataHosts = new DropdownInput({
            "id": "SearchModeSelectorDataHosts",
            "choices": [
                {"label": "Collection based", "value": "collection_based"},
                {"label": "Search based", "value": "search_based"}
            ],
            "default": "collection_based",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "showClearButton": true,
            "initialValue": "collection_based",
            "value": "$form.SearchModeSelectorDataHosts$",
            "el": $('#SearchModeSelectorDataHosts')
        }, {tokens: true}).render();

        SearchModeSelectorDataHosts.on("change", function(newValue) {
            FormUtils.handleValueChange(SearchModeSelectorDataHosts);
        });

        SearchModeSelectorDataHosts.on("valueChange", function(e) {
            if (e.value === "search_based") {
                EventHandler.setToken("data_host_mainsearch", "| `tstats` max(_indextime) as current_data_last_ingest, min(_time) as current_data_first_time_seen, max(_time) as current_data_last_time_seen count as current_data_eventcount values(sourcetype) as sourcetype where index=* sourcetype=* host=* host!=\"\" `trackme_tstats_main_filter` `trackme_get_idx_whitelist(trackme_data_host_monitoring_whitelist_index, data_index)` `apply_data_host_blacklists_data_retrieve` by index, host\n| eval current_data_last_ingestion_lag_seen=current_data_last_ingest-current_data_last_time_seen\n| stats max(current_data_last_ingest) as current_data_last_ingest, min(current_data_first_time_seen) as current_data_first_time_seen, max(current_data_last_time_seen) as current_data_last_time_seen, avg(current_data_last_ingestion_lag_seen) as current_data_last_ingestion_lag_seen, sum(current_data_eventcount) as current_data_eventcount, values(index) as index, values(sourcetype) as sourcetype by host\n| rename index as data_index, host as data_host, sourcetype as data_sourcetype\n| eval data_host=upper(data_host)\n| lookup trackme_host_monitoring data_host\n| append [ | inputlookup trackme_host_monitoring | eval keyid=_key | eval data_host=upper(data_host) ]\n| stats values(data_index) as data_index, values(data_sourcetype) as data_sourcetype, first(*) as \"*\" by data_host\n| eval data_last_ingest=if(isnotnull(current_data_last_ingest), current_data_last_ingest, data_last_ingest), data_first_time_seen=if(isnotnull(current_data_first_time_seen), current_data_first_time_seen, data_first_time_seen), data_last_time_seen=if(isnotnull(current_data_last_time_seen), current_data_last_time_seen, data_last_time_seen)\n| eval data_last_ingestion_lag_seen=if(isnotnull(current_data_last_ingestion_lag_seen), round(current_data_last_ingestion_lag_seen, 0), round(data_last_ingestion_lag_seen, 0))\n| eval current_data_eventcount=if(isnotnull(current_data_eventcount), current_data_eventcount, data_eventcount)\n| fields - current_*\n| `trackme_eval_data_host_state`\n| `trackme_default_priority`\n| `trackme_data_host_group_lookup`\n| `trackme_date_format(data_last_time_seen)`\n| `trackme_date_format(data_last_time_seen_idx)`\n| `trackme_date_format(data_last_ingest)`\n| fillnull value=\"red\" data_host_state\n| sort 0 data_host\n| `trackme_eval_icons_host`\n| `apply_data_host_blacklists`\n| rename \"data_last_ingest (translated)\" as \"last ingest\", \"data_last_time_seen (translated)\" as \"last time\"\n| eval data_index_raw=data_index, data_sourcetype_raw=data_sourcetype\n| makemv data_index delim=\",\"\n| makemv data_sourcetype delim=\",\"\n| eval data_tracker_runtime=now()\n| lookup local=t trackme_host_monitoring data_host OUTPUT data_host_state as data_previous_host_state, data_tracker_runtime as data_previous_tracker_runtime, latest_flip_state, latest_flip_time\n| `trackme_date_format(\"latest_flip_time\")`\n| fillnull value=\"N/A\" latest_flip_state, latest_flip_time, \"latest_flip_time (translated)\"\n| search `trackme_get_idx_whitelist_searchtime(trackme_data_host_monitoring_whitelist_index, data_index)`", {}, e.data);
            } else if (e.value === "collection_based") {
                EventHandler.setToken("data_host_mainsearch", "| inputlookup trackme_host_monitoring\n| eval keyid=_key\n| sort limit=0 - data_last_time_seen\n| dedup data_host\n| eval data_index_raw=data_index, data_sourcetype_raw=data_sourcetype\n| makemv delim=\",\" data_index\n| makemv delim=\",\" data_sourcetype\n| `apply_data_host_blacklists`\n| search `trackme_get_idx_whitelist_searchtime(trackme_data_host_monitoring_whitelist_index, data_index)`\n| `trackme_eval_data_host_state`\n| `trackme_default_priority`\n| `trackme_data_host_group_lookup`\n| `trackme_date_format(data_last_time_seen)`\n| `trackme_date_format(data_last_time_seen_idx)`\n| `trackme_date_format(data_last_ingest)`\n| `trackme_eval_icons_host`\n| rename \"data_last_ingest (translated)\" as \"last ingest\", \"data_last_time_seen (translated)\" as \"last time\"\n| lookup local=t trackme_host_monitoring data_host OUTPUT data_host_state as data_previous_host_state, data_tracker_runtime as data_previous_tracker_runtime, latest_flip_state, latest_flip_time\n | `trackme_date_format(\"latest_flip_time\")`\n| fillnull value=\"N/A\" latest_flip_state, latest_flip_time, \"latest_flip_time (translated)\"\n| sort limit=0 data_host", {}, e.data);
            }
        });

        var SearchModeSelectorMetricHosts = new DropdownInput({
            "id": "SearchModeSelectorMetricHosts",
            "choices": [
                {"label": "Collection based", "value": "collection_based"},
                {"label": "Search based", "value": "search_based"}
            ],
            "default": "collection_based",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "showClearButton": true,
            "initialValue": "collection_based",
            "value": "$form.SearchModeSelectorMetricHosts$",
            "el": $('#SearchModeSelectorMetricHosts')
        }, {tokens: true}).render();

        SearchModeSelectorMetricHosts.on("change", function(newValue) {
            FormUtils.handleValueChange(SearchModeSelectorMetricHosts);
        });

        SearchModeSelectorMetricHosts.on("valueChange", function(e) {
            if (e.value === "search_based") {
                EventHandler.setToken("metric_host_mainsearch", "| savedsearch \"trackMe - metric host table report\" | `trackme_eval_icons_metric_host` | eval metric_index_raw=metric_index, metric_category_raw=metric_category, metric_details_raw=metric_details | lookup local=t trackme_metric_host_monitoring metric_host OUTPUT metric_host_state as metric_previous_host_state, metric_tracker_runtime as metric_previous_tracker_runtime, latest_flip_state, latest_flip_time | where isnotnull(metric_previous_tracker_runtime) | `trackme_date_format(\"latest_flip_time\")` | fillnull value=\"N/A\" latest_flip_state, latest_flip_time, \"latest_flip_time (translated)\"", {}, e.data);
            } else if (e.value === "collection_based") {
                EventHandler.setToken("metric_host_mainsearch", "| savedsearch \"TrackMe - metric hosts collection based table report\"\n| `trackme_date_format(\"metric_last_time_seen\")`\n| rename \"metric_last_time_seen (translated)\" as \"last time\"\n| `trackme_eval_metric_host_state`\n| `trackme_metric_host_group_lookup`\n|`trackme_eval_icons_metric_host`\n|`trackme_date_format(\"latest_flip_time\")`\n| fillnull value=\"N/A\" latest_flip_state, latest_flip_time, \"latest_flip_time (translated)\"", {}, e.data);
            }
        });

        var link1 = new LinkListInput({
            "id": "link1",
            "choices": [{
                    "value": "show_data_source_tracker",
                    "label": "DATA SOURCES AVAILABILITY TRACKING"
                },
                {
                    "value": "show_data_host_tracker",
                    "label": "DATA HOSTS AVAILABILITY TRACKING"
                },
                {
                    "value": "show_metric_host_tracker",
                    "label": "METRIC HOSTS AVAILABILITY TRACKING"
                },
                {
                    "value": "show_audit_flip",
                    "label": "INVESTIGATE STATUS FLIPPING"
                },
                {
                    "value": "show_audit_changes",
                    "label": "INVESTIGATE AUDIT CHANGES"
                }
            ],
            "default": "show_data_source_tracker",
            "selectFirstChoice": false,
            "searchWhenChanged": true,
            "value": "$form.tk_main_link$",
            "el": $('#link1')
        }, {
            tokens: true
        }).render();

        link1.on("change", function(newValue) {
            FormUtils.handleValueChange(link1);
        });

        link1.on("valueChange", function(e) {
            if (e.value === "show_data_source_tracker") {
                EventHandler.setToken("show_data_source_tracker", "true", {}, e.data);
                EventHandler.unsetToken("show_data_host_tracker");
                EventHandler.unsetToken("show_audit_flip");
                EventHandler.unsetToken("show_audit_changes");
                EventHandler.unsetToken("show_metric_host_tracker");
            } else if (e.value === "show_data_host_tracker") {
                EventHandler.setToken("show_data_host_tracker", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_tracker");
                EventHandler.unsetToken("show_audit_flip");
                EventHandler.unsetToken("show_audit_changes");
                EventHandler.unsetToken("show_metric_host_tracker");
            } else if (e.value === "show_metric_host_tracker") {
                EventHandler.setToken("show_metric_host_tracker", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_tracker");
                EventHandler.unsetToken("show_data_host_tracker");
                EventHandler.unsetToken("show_audit_flip");
                EventHandler.unsetToken("show_audit_changes");
            } else if (e.value === "show_audit_flip") {
                EventHandler.setToken("show_audit_flip", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_tracker");
                EventHandler.unsetToken("show_data_host_tracker");
                EventHandler.unsetToken("show_audit_changes");
                EventHandler.unsetToken("show_metric_host_tracker");
            } else if (e.value === "show_audit_changes") {
                EventHandler.setToken("show_audit_changes", "true", {}, e.data);
                EventHandler.unsetToken("show_data_source_tracker");
                EventHandler.unsetToken("show_data_host_tracker");
                EventHandler.unsetToken("show_audit_flip");
                EventHandler.unsetToken("show_metric_host_tracker");
            }
        });

        var input1 = new TimeRangeInput({
            "id": "input1",
            "searchWhenChanged": true,
            "default": {
                "latest_time": "now",
                "earliest_time": "-24h@h"
            },
            "earliest_time": "$form.time.earliest$",
            "latest_time": "$form.time.latest$",
            "el": $('#input1')
        }, {
            tokens: true
        }).render();

        input1.on("change", function(newValue) {
            FormUtils.handleValueChange(input1);
        });

        // Audit Flip

        var input_timerange_audit_flip = new TimeRangeInput({
            "id": "input_timerange_audit_flip",
            "searchWhenChanged": true,
            "default": {"latest_time": "now", "earliest_time": "-24h"},
            "earliest_time": "$form.timerange_audit_flip.earliest$",
            "latest_time": "$form.timerange_audit_flip.latest$",
            "el": $('#input_timerange_audit_flip')
        }, {tokens: true}).render();

        input_timerange_audit_flip.on("change", function(newValue) {
            FormUtils.handleValueChange(input_timerange_audit_flip);
        });

        var inputAuditFlipObjectCategory = new DropdownInput({
            "id": "inputAuditFlipObjectCategory",
            "tokenDependencies": {
                "depends": "$show_audit_flip$"
            },
            "choices": [{
                "label": "ANY",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "object_category",
            "prefix": "object_category=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "object_category",
            "value": "$form.audit_flip_object_category$",
            "managerid": "searchAuditFlipObjectCategory",
            "el": $('#inputAuditFlipObjectCategory')
        }, {
            tokens: true
        }).render();

        inputAuditFlipObjectCategory.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditFlipObjectCategory);
        });

        var inputAuditFlipObject = new DropdownInput({
            "id": "inputAuditFlipObject",
            "tokenDependencies": {
                "depends": "$show_audit_flip$"
            },
            "choices": [{
                "label": "ANY",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "object",
            "prefix": "object=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "object",
            "value": "$form.audit_flip_object$",
            "managerid": "searchAuditFlipObject",
            "el": $('#inputAuditFlipObject')
        }, {
            tokens: true
        }).render();

        inputAuditFlipObject.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditFlipObject);
        });

        // Ack
        var input_ack_duration = new DropdownInput({
            "id": "input_ack_duration",
            "choices": [],
            "searchWhenChanged": true,
            "labelField": "label",
            "valueField": "duration",
            "selectFirstChoice": true,
            "showClearButton": true,
            "value": "$form.input_ack_duration$",
            "managerid": "searchAckDuration",
            "el": $('#input_ack_duration')
        }, {tokens: true}).render();

        input_ack_duration.on("change", function(newValue) {
            FormUtils.handleValueChange(input_ack_duration);
        });

        DashboardController.onReady(function() {
            if (!submittedTokenModel.has('earliest') && !submittedTokenModel.has('latest')) {
                submittedTokenModel.set({ earliest: '0', latest: '' });
            }
        });

        // Audit Changes

        var input_timerange_audit_changes = new TimeRangeInput({
            "id": "input_timerange_audit_changes",
            "searchWhenChanged": true,
            "default": {"latest_time": "now", "earliest_time": "-24h"},
            "earliest_time": "$form.timerange_audit_changes.earliest$",
            "latest_time": "$form.timerange_audit_changes.latest$",
            "el": $('#input_timerange_audit_changes')
        }, {tokens: true}).render();

        input_timerange_audit_changes.on("change", function(newValue) {
            FormUtils.handleValueChange(input_timerange_audit_changes);
        });

        var inputAuditChangesAction = new DropdownInput({
            "id": "inputAuditChangesAction",
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "choices": [{
                "label": "ANY",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "action",
            "prefix": "action=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "action",
            "value": "$form.audit_changes_action$",
            "managerid": "searchAuditChangesAction",
            "el": $('#inputAuditChangesAction')
        }, {
            tokens: true
        }).render();

        inputAuditChangesAction.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditChangesAction);
        });

        var inputAuditChangesObjectCategory = new DropdownInput({
            "id": "inputAuditChangesObjectCategory",
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "choices": [{
                "label": "ANY",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "object_category",
            "prefix": "object_category=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "object_category",
            "value": "$form.audit_changes_object_category$",
            "managerid": "searchAuditChangesObjectCategory",
            "el": $('#inputAuditChangesObjectCategory')
        }, {
            tokens: true
        }).render();

        inputAuditChangesObjectCategory.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditChangesObjectCategory);
        });

        var inputAuditChangesChangeType = new DropdownInput({
            "id": "inputAuditChangesChangeType",
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "choices": [{
                "label": "ANY",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "change_type",
            "prefix": "change_type=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "change_type",
            "value": "$form.audit_changes_change_type$",
            "managerid": "searchAuditChangesChangeType",
            "el": $('#inputAuditChangesChangeType')
        }, {
            tokens: true
        }).render();

        inputAuditChangesChangeType.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditChangesChangeType);
        });

        var inputAuditChangesUser = new DropdownInput({
            "id": "inputAuditChangesUser",
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "choices": [{
                "label": "ANY",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "user",
            "prefix": "user=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "user",
            "value": "$form.audit_changes_user$",
            "managerid": "searchAuditChangesUser",
            "el": $('#inputAuditChangesUser')
        }, {
            tokens: true
        }).render();

        inputAuditChangesUser.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditChangesUser);
        });

        var inputAuditChangesObject = new DropdownInput({
            "id": "inputAuditChangesObject",
            "tokenDependencies": {
                "depends": "$show_audit_changes$"
            },
            "choices": [{
                "label": "ANY",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "object",
            "prefix": "object=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "object",
            "value": "$form.audit_changes_object$",
            "managerid": "searchAuditChangesObject",
            "el": $('#inputAuditChangesObject')
        }, {
            tokens: true
        }).render();

        inputAuditChangesObject.on("change", function(newValue) {
            FormUtils.handleValueChange(inputAuditChangesObject);
        });

        //

        var inputDataName = new DropdownInput({
            "id": "inputDataName",
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "choices": [{
                "label": "ANY",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "data_name",
            "prefix": "data_name=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "data_name",
            "value": "$form.inputDataName$",
            "managerid": "searchPopulateDataSources",
            "el": $('#inputDataName')
        }, {
            tokens: true
        }).render();

        inputDataName.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataName);
        });

        var inputDataIndex = new DropdownInput({
            "id": "inputDataIndex",
            "tokenDependencies": {
                "depends": "$show_data_source_tracker$"
            },
            "choices": [{
                "label": "ANY",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "data_index",
            "prefix": "data_index=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "data_index",
            "value": "$form.inputDataIndex$",
            "managerid": "searchPopulateDataSourcesIndexes",
            "el": $('#inputDataIndex')
        }, {
            tokens: true
        }).render();

        inputDataIndex.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataIndex);
        });

        var inputDataSourcetype = new DropdownInput({
            "id": "inputDataSourcetype",
            "choices": [{
                "label": "ANY",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "data_sourcetype",
            "prefix": "data_sourcetype=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "data_sourcetype",
            "value": "$form.inputDataSourcetype$",
            "managerid": "searchPopulateDataSourcesSourcetypes",
            "el": $('#inputDataSourcetype')
        }, {
            tokens: true
        }).render();

        inputDataSourcetype.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourcetype);
        });

        // metric host monitoring

        var inputMetricHostIndexes = new DropdownInput({
            "id": "inputMetricHostIndexes",
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "choices": [{
                "label": "ANY",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "metric_index",
            "prefix": "metric_index=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "metric_index",
            "value": "$form.inputMetricHostIndexes$",
            "managerid": "searchPopulateMetricHostsIndexes",
            "el": $('#inputMetricHostIndexes')
        }, {
            tokens: true
        }).render();

        inputMetricHostIndexes.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHostIndexes);
        });

        var inputMetricHostCategories = new DropdownInput({
            "id": "inputMetricHostCategories",
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "choices": [{
                "label": "ANY",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "metric_category",
            "prefix": "metric_category=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "metric_category",
            "value": "$form.inputMetricHostCategories$",
            "managerid": "searchPopulateMetricHostsCategories",
            "el": $('#inputMetricHostCategories')
        }, {
            tokens: true
        }).render();

        inputMetricHostCategories.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHostCategories);
        });

        var inputMetricHost = new DropdownInput({
            "id": "inputMetricHost",
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "choices": [{
                "label": "ANY",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "metric_host",
            "prefix": "metric_host=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "metric_host",
            "value": "$form.inputMetricHost$",
            "managerid": "searchPopulateMetricHosts",
            "el": $('#inputMetricHost')
        }, {
            tokens: true
        }).render();

        inputMetricHost.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHost);
        });

        var inputMetricHostState = new DropdownInput({
            "id": "inputMetricHostState",
            "choices": [{
                    "label": "Any",
                    "value": "*"
                },
                {
                    "label": "Green",
                    "value": "Green"
                },
                {
                    "label": "Orange",
                    "value": "Orange"
                },
                {
                    "label": "Red",
                    "value": "Red"
                }
            ],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "prefix": "metric_host_state=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "value": "$form.metric_host_state$",
            "el": $('#inputMetricHostState')
        }, {
            tokens: true
        }).render();

        inputMetricHostState.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHostState);
        });

        var inputMetricHostMonitoredState = new DropdownInput({
            "id": "inputMetricHostMonitoredState",
            "choices": [{
                    "label": "Any",
                    "value": "*"
                },
                {
                    "label": "Enabled",
                    "value": "enabled"
                },
                {
                    "label": "Disabled",
                    "value": "disabled"
                }
            ],
            "searchWhenChanged": true,
            "default": "enabled",
            "showClearButton": true,
            "prefix": "metric_monitored_state=\"",
            "suffix": "\"",
            "initialValue": "enabled",
            "selectFirstChoice": false,
            "value": "$form.metric_monitored_state$",
            "el": $('#inputMetricHostMonitoredState')
        }, {
            tokens: true
        }).render();

        inputMetricHostMonitoredState.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHostMonitoredState);
        });

        var refreshMetricHostForm = new DropdownInput({
            "id": "refreshMetricHostForm",
            "choices": [{
                    "value": "60",
                    "label": "1 min"
                },
                {
                    "value": "120",
                    "label": "2 min"
                },
                {
                    "value": "300",
                    "label": "5 min"
                },
                {
                    "value": "none",
                    "label": "none"
                }
            ],
            "selectFirstChoice": false,
            "default": "300",
            "showClearButton": true,
            "initialValue": "300",
            "searchWhenChanged": true,
            "value": "$refresh$",
            "el": $('#refreshMetricHostForm')
        }, {
            tokens: true
        }).render();

        refreshMetricHostForm.on("change", function(newValue) {
            FormUtils.handleValueChange(refreshMetricHostForm);
        });

        var inputMetricPolicySLA_category = new DropdownInput({
            "id": "inputMetricPolicySLA_category",
            "tokenDependencies": {
                "depends": "$show_metric_host_tracker$"
            },
            "searchWhenChanged": true,
            "showClearButton": true,
            "labelField": "metric_category",
            "selectFirstChoice": false,
            "valueField": "metric_category",
            "value": "$form.tk_input_metric_policy_metric_category$",
            "managerid": "searchPopulateMetricHostsCategories",
            "el": $('#inputMetricPolicySLA_category')
        }, {
            tokens: true
        }).render();

        inputMetricPolicySLA_category.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricPolicySLA_category);
        });

        var inputMetricPolicySLA_value = new TextInput({
            "id": "inputMetricPolicySLA_value",
            "searchWhenChanged": true,
            "value": "$form.tk_input_metric_policy_metric_value$",
            "el": $('#inputMetricPolicySLA_value')
        }, {
            tokens: true
        }).render();

        inputMetricPolicySLA_value.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricPolicySLA_value);
        });

        var inputDataHostIndexes = new DropdownInput({
            "id": "inputDataHostIndexes",
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "choices": [{
                "label": "ANY",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "data_index",
            "prefix": "data_index=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "data_index",
            "value": "$form.inputDataHostIndexes$",
            "managerid": "searchPopulateDataHostsIndexes",
            "el": $('#inputDataHostIndexes')
        }, {
            tokens: true
        }).render();

        inputDataHostIndexes.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostIndexes);
        });

        var inputDataHostSourcetypes = new DropdownInput({
            "id": "inputDataHostSourcetypes",
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "choices": [{
                "label": "ANY",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "data_sourcetype",
            "prefix": "data_sourcetype=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "data_sourcetype",
            "value": "$form.inputDataHostSourcetypes$",
            "managerid": "searchPopulateDataHostsSourcetypes",
            "el": $('#inputDataHostSourcetypes')
        }, {
            tokens: true
        }).render();

        inputDataHostSourcetypes.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostSourcetypes);
        });

        var inputDataHost = new DropdownInput({
            "id": "inputDataHost",
            "tokenDependencies": {
                "depends": "$show_data_host_tracker$"
            },
            "choices": [{
                "label": "ANY",
                "value": "*"
            }],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "labelField": "data_host",
            "prefix": "data_host=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "valueField": "data_host",
            "value": "$form.inputDataHost$",
            "managerid": "searchPopulateDataHosts",
            "el": $('#inputDataHost')
        }, {
            tokens: true
        }).render();

        inputDataHost.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHost);
        });

        var inputDataSourceState = new DropdownInput({
            "id": "inputDataSourceState",
            "choices": [{
                    "label": "Any",
                    "value": "*"
                },
                {
                    "label": "Green",
                    "value": "Green"
                },
                {
                    "label": "Orange",
                    "value": "Orange"
                },
                {
                    "label": "Red",
                    "value": "Red"
                }
            ],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "prefix": "data_source_state=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "value": "$form.data_source_state$",
            "el": $('#inputDataSourceState')
        }, {
            tokens: true
        }).render();

        inputDataSourceState.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataSourceState);
        });

        var inputDataHostState = new DropdownInput({
            "id": "inputDataHostState",
            "choices": [{
                    "label": "Any",
                    "value": "*"
                },
                {
                    "label": "Green",
                    "value": "Green"
                },
                {
                    "label": "Orange",
                    "value": "Orange"
                },
                {
                    "label": "Red",
                    "value": "Red"
                }
            ],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "prefix": "data_host_state=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "value": "$form.data_host_state$",
            "el": $('#inputDataHostState')
        }, {
            tokens: true
        }).render();

        inputDataHostState.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostState);
        });

        var inputDataMonitoredState = new DropdownInput({
            "id": "inputDataMonitoredState",
            "choices": [{
                    "label": "Any",
                    "value": "*"
                },
                {
                    "label": "Enabled",
                    "value": "enabled"
                },
                {
                    "label": "Disabled",
                    "value": "disabled"
                }
            ],
            "searchWhenChanged": true,
            "default": "enabled",
            "showClearButton": true,
            "prefix": "data_monitored_state=\"",
            "suffix": "\"",
            "initialValue": "enabled",
            "selectFirstChoice": false,
            "value": "$form.data_monitored_state$",
            "el": $('#inputDataMonitoredState')
        }, {
            tokens: true
        }).render();

        inputDataMonitoredState.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataMonitoredState);
        });

        var inputDataPriority = new DropdownInput({
            "id": "inputDataPriority",
            "choices": [{
                    "label": "Any",
                    "value": "*"
                },
                {
                    "label": "low",
                    "value": "low"
                },
                {
                    "label": "medium",
                    "value": "medium"
                },
                {
                    "label": "high",
                    "value": "high"
                }
            ],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "prefix": "priority=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "value": "$form.inputDataPriority$",
            "el": $('#inputDataPriority')
        }, {
            tokens: true
        }).render();

        inputDataPriority.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataPriority);
        });

        var inputDataHostMonitoredState = new DropdownInput({
            "id": "inputDataHostMonitoredState",
            "choices": [{
                    "label": "Any",
                    "value": "*"
                },
                {
                    "label": "Enabled",
                    "value": "enabled"
                },
                {
                    "label": "Disabled",
                    "value": "disabled"
                }
            ],
            "searchWhenChanged": true,
            "default": "enabled",
            "showClearButton": true,
            "prefix": "data_monitored_state=\"",
            "suffix": "\"",
            "initialValue": "enabled",
            "selectFirstChoice": false,
            "value": "$form.data_monitored_state$",
            "el": $('#inputDataHostMonitoredState')
        }, {
            tokens: true
        }).render();

        inputDataHostMonitoredState.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostMonitoredState);
        });

        var inputDataHostPriority = new DropdownInput({
            "id": "inputDataHostPriority",
            "choices": [{
                    "label": "Any",
                    "value": "*"
                },
                {
                    "label": "low",
                    "value": "low"
                },
                {
                    "label": "medium",
                    "value": "medium"
                },
                {
                    "label": "high",
                    "value": "high"
                }
            ],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "prefix": "priority=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "value": "$form.inputDataHostPriority$",
            "el": $('#inputDataHostPriority')
        }, {
            tokens: true
        }).render();

        inputDataHostPriority.on("change", function(newValue) {
            FormUtils.handleValueChange(inputDataHostPriority);
        });

        var inputMetricHostPriority = new DropdownInput({
            "id": "inputMetricHostPriority",
            "choices": [{
                    "label": "Any",
                    "value": "*"
                },
                {
                    "label": "low",
                    "value": "low"
                },
                {
                    "label": "medium",
                    "value": "medium"
                },
                {
                    "label": "high",
                    "value": "high"
                }
            ],
            "searchWhenChanged": true,
            "default": "*",
            "showClearButton": true,
            "prefix": "priority=\"",
            "suffix": "\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "value": "$form.inputMetricHostPriority$",
            "el": $('#inputMetricHostPriority')
        }, {
            tokens: true
        }).render();

        inputMetricHostPriority.on("change", function(newValue) {
            FormUtils.handleValueChange(inputMetricHostPriority);
        });

        var refreshForm = new DropdownInput({
            "id": "refreshForm",
            "choices": [{
                    "value": "60",
                    "label": "1 min"
                },
                {
                    "value": "120",
                    "label": "2 min"
                },
                {
                    "value": "300",
                    "label": "5 min"
                },
                {
                    "value": "3600",
                    "label": "none"
                }
            ],
            "selectFirstChoice": false,
            "default": "300",
            "showClearButton": true,
            "initialValue": "300",
            "searchWhenChanged": true,
            "value": "$refresh$",
            "el": $('#refreshForm')
        }, {
            tokens: true
        }).render();

        refreshForm.on("change", function(newValue) {
            FormUtils.handleValueChange(refreshForm);
        });

        var refreshHostForm = new DropdownInput({
            "id": "refreshHostForm",
            "choices": [{
                    "value": "60",
                    "label": "1 min"
                },
                {
                    "value": "120",
                    "label": "2 min"
                },
                {
                    "value": "300",
                    "label": "5 min"
                },
                {
                    "value": "3600",
                    "label": "none"
                }
            ],
            "selectFirstChoice": false,
            "default": "300",
            "showClearButton": true,
            "initialValue": "300",
            "searchWhenChanged": true,
            "value": "$refresh$",
            "el": $('#refreshHostForm')
        }, {
            tokens: true
        }).render();

        refreshForm.on("change", function(newValue) {
            FormUtils.handleValueChange(refreshForm);
        });

        //
        // SERVICE OBJECT
        //

        // Create a service object using the Splunk SDK for JavaScript
        // to send REST requests
        var service = mvc.createService({
            owner: "nobody"
        });

        //
        // BEGIN OPERATIONS
        //

        // Audit changes
        var tokens = mvc.Components.get("default");
        var currentUser = Splunk.util.getConfigValue("USERNAME");
        tokens.set("currentUser", currentUser);
        var auditendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_audit_changes/"

        //
        // Verify if data collection is empty or ready
        //

        // Search everything and return the first 100 results
        var searchQuery = "| inputlookup trackme_data_source_monitoring | inputlookup append=t trackme_host_monitoring | inputlookup append=t trackme_metric_host_monitoring";

        // Set the search parameters
        var searchParams = {
            exec_mode: "blocking",
            earliest_time: "-60m",
            latest_time: "now"
        };

        // Create the search, wait for it to finish, and get back a job
        service.search(
            searchQuery,
            searchParams,
            function(err, job) {
                // Get the job from the server to display more info
                job.fetch(function(err) {
                    var resultCount = job.properties().resultCount;
                    if (resultCount == 0) {
                        //console.log("Detected collection empty");
                        // Show input modal
                        $("#modal_time_to_configure").modal();
                    }
                });
            }
        );

        // enable monitoring

        $("#btn_enable_monitoring").click(function(mode) {

            // Hide main modal
            $("#modal_manage").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_last_lag_seen_idx = tokens.get("tk_data_last_lag_seen_idx");
            var tk_data_last_time_seen_idx = tokens.get("tk_data_last_time_seen_idx");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_level = tokens.get("tk_data_monitoring_level");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_source_state = tokens.get("tk_data_source_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_source_state = tokens.get("tk_data_previous_source_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_data_monitored_state = "enabled";
            var tk_priority = tokens.get("tk_priority");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring/" + tk_keyid;

            // Create a dictionary to store the field names and values
            var record = {
                "data_name": tk_data_name,
                "data_index": tk_data_index,
                "data_sourcetype": tk_data_sourcetype,
                "data_last_lag_seen": tk_data_last_lag_seen,
                "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                "data_eventcount": tk_data_eventcount,
                "data_first_time_seen": tk_data_first_time_seen,
                "data_last_time_seen": tk_data_last_time_seen,
                "data_last_ingest": tk_data_last_ingest,
                "data_last_lag_seen_idx": tk_data_last_lag_seen_idx,
                "data_last_time_seen_idx": tk_data_last_time_seen_idx,
                "data_max_lag_allowed": tk_data_max_lag_allowed,
                "data_monitored_state": tk_data_monitored_state,
                "data_monitoring_level": tk_data_monitoring_level,
                "data_monitoring_wdays": tk_data_monitoring_wdays,
                "data_override_lagging_class": tk_data_override_lagging_class,
                "data_source_state": tk_data_source_state,
                "data_tracker_runtime": tk_data_tracker_runtime,
                "data_previous_source_state": tk_data_previous_source_state,
                "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                "priority": tk_priority
            };

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            searchDataSourcesMain.startSearch();

                            // Audit success change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "success",
                                "user": currentUser,
                                "change_type": "enable monitoring",
                                "object": tk_data_name,
                                "object_category": "data_source",
                                "object_attrs": JSON.stringify(record),
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit failed change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "enable monitoring",
                                "object": tk_data_name,
                                "object_category": "data_source",
                                "object_attrs": JSON.stringify(record),
                                "result": message
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        $("#btn_enable_monitoring_host").click(function(mode) {

            // Hide main modal
            $("#modal_manage_host").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_host_state = tokens.get("tk_data_host_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_host_state = tokens.get("tk_data_previous_host_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_latest_flip_state = tokens.get("tk_latest_flip_state");
            var tk_priority = tokens.get("tk_priority");
            var tk_data_monitored_state = "enabled";

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_host_monitoring/" + tk_keyid;

            // Create a dictionary to store the field names and values
            var record = {
                "data_host": tk_data_host,
                "data_index": tk_data_index,
                "data_sourcetype": tk_data_sourcetype,
                "data_last_lag_seen": tk_data_last_lag_seen,
                "data_eventcount": tk_data_eventcount,
                "data_first_time_seen": tk_data_first_time_seen,
                "data_last_time_seen": tk_data_last_time_seen,
                "data_last_ingest": tk_data_last_ingest,
                "data_max_lag_allowed": tk_data_max_lag_allowed,
                "data_monitored_state": tk_data_monitored_state,
                "data_monitoring_wdays": tk_data_monitoring_wdays,
                "data_override_lagging_class": tk_data_override_lagging_class,
                "data_host_state": tk_data_host_state,
                "data_tracker_runtime": tk_data_tracker_runtime,
                "data_previous_host_state": tk_data_previous_host_state,
                "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                "priority": tk_priority
            };

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            searchDataHostsMain.startSearch();

                            // Audit success change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "success",
                                "user": currentUser,
                                "change_type": "enable monitoring",
                                "object": tk_data_host,
                                "object_category": "data_host",
                                "object_attrs": JSON.stringify(record),
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "disable monitoring",
                                "object": tk_data_host,
                                "object_category": "data_host",
                                "object_attrs": JSON.stringify(record),
                                "result": message
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        // refresh data_source
        $("#btn_refresh_data_source").click(function(mode) {
            searchSingleLag.startSearch();
            searchChartLag.startSearch();
        });

        // refresh data_host
        $("#btn_refresh_data_host").click(function(mode) {
            searchSingleLagHost.startSearch();
            searchChartHostBaseSearch.startSearch();
            searchChartLagHostOverTime.startSearch();
        });

        // refresh metric_host
        $("#btn_refresh_metric_host").click(function(mode) {
            searchHostTableMetricHost.startSearch();
        });

        $("#btn_enable_monitoring_metric_host").click(function(mode) {

            // Hide main modal
            $("#modal_manage_metric_host").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_metric_host = tokens.get("tk_metric_host");
            var tk_metric_index = tokens.get("tk_metric_index");
            var tk_metric_category = tokens.get("tk_metric_category");
            var tk_metric_details = tokens.get("tk_metric_details");
            var tk_metric_last_lag_seen = tokens.get("tk_metric_last_lag_seen");
            var tk_metric_last_time_seen = tokens.get("tk_metric_last_time_seen");
            var tk_metric_host_state = tokens.get("tk_metric_host_state");
            var tk_metric_tracker_runtime = tokens.get("tk_metric_tracker_runtime");
            var tk_metric_previous_host_state = tokens.get("tk_metric_previous_host_state");
            var tk_metric_previous_tracker_runtime = tokens.get("tk_metric_previous_tracker_runtime");
            var tk_metric_monitored_state = "enabled";
            var tk_priority = tokens.get("tk_priority");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring/" + tk_keyid;

            // Create a dictionary to store the field names and values
            var record = {
                "metric_host": tk_metric_host,
                "metric_index": tk_metric_index,
                "metric_category": tk_metric_category,
                "metric_details": tk_metric_details,
                "metric_last_lag_seen": tk_metric_last_lag_seen,
                "metric_last_time_seen": tk_metric_last_time_seen,
                "metric_monitored_state": tk_metric_monitored_state,
                "metric_host_state": tk_metric_host_state,
                "metric_tracker_runtime": tk_metric_tracker_runtime,
                "metric_previous_host_state": tk_metric_previous_host_state,
                "metric_previous_tracker_runtime": tk_metric_previous_tracker_runtime,
                "priority": tk_priority
            };

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            searchMetricHostsMain.startSearch();

                            // Audit success change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "success",
                                "user": currentUser,
                                "change_type": "enable monitoring",
                                "object": tk_metric_host,
                                "object_category": "metric_host",
                                "object_attrs": JSON.stringify(record)
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "enable monitoring",
                                "object": tk_metric_host,
                                "object_category": "metric_host",
                                "object_attrs": JSON.stringify(record),
                                "result": message
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        // cancel button: returns to selected
        $("#btn_close_metric_host_unified").click(function() {
            submitTokens();

            // Show modal
            $("#modal_manage_metric_host").modal();

        });

        // metric host priority
        $("#btn_modal_modify_priority_metric_host_confirm").click(function() {

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_metric_host = tokens.get("tk_metric_host");
            var tk_metric_index = tokens.get("tk_metric_index");
            var tk_metric_category = tokens.get("tk_metric_category");
            var tk_metric_details = tokens.get("tk_metric_details");
            var tk_metric_last_lag_seen = tokens.get("tk_metric_last_lag_seen");
            var tk_metric_last_time_seen = tokens.get("tk_metric_last_time_seen");
            var tk_metric_host_state = tokens.get("tk_metric_host_state");
            var tk_metric_tracker_runtime = tokens.get("tk_metric_tracker_runtime");
            var tk_metric_previous_host_state = tokens.get("tk_metric_previous_host_state");
            var tk_metric_previous_tracker_runtime = tokens.get("tk_metric_previous_tracker_runtime");
            var tk_metric_monitored_state = "enabled";
            var tk_priority = tokens.get("tk_priority");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring/" + tk_keyid;

            var tk_origin_priority = tk_priority;
            var tk_new_priority = tokens.get("tk_input_metric_host_priority");

            if (!tk_new_priority || !tk_new_priority.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
	                "metric_host": tk_metric_host,
	                "metric_index": tk_metric_index,
	                "metric_category": tk_metric_category,
	                "metric_details": tk_metric_details,
	                "metric_last_lag_seen": tk_metric_last_lag_seen,
	                "metric_last_time_seen": tk_metric_last_time_seen,
	                "metric_monitored_state": tk_metric_monitored_state,
	                "metric_host_state": tk_metric_host_state,
	                "metric_tracker_runtime": tk_metric_tracker_runtime,
	                "metric_previous_host_state": tk_metric_previous_host_state,
	                "metric_previous_tracker_runtime": tk_metric_previous_tracker_runtime,
	                "priority": tk_new_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchMetricHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "modify priority",
                            "object": tk_metric_host,
                            "object_category": "metric_host",
                            "object_attrs": "priority changed from:" + tk_origin_priority + " to:" + tk_new_priority
                        };

                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "modify priority",
                            "object": tk_metric_host,
                            "object_category": "metric_host",
                            "object_attrs": "priority changed from:" + tk_origin_priority + " to:" + tk_new_priority,
                            "result": message
                        };

                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        // disable monitoring

        $("#btn_disable_monitoring").click(function(mode) {

            // Hide main modal
            $("#modal_manage").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_last_lag_seen_idx = tokens.get("tk_data_last_lag_seen_idx");
            var tk_data_last_time_seen_idx = tokens.get("tk_data_last_time_seen_idx");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_level = tokens.get("tk_data_monitoring_level");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_source_state = tokens.get("tk_data_source_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_source_state = tokens.get("tk_data_previous_source_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_data_monitored_state = "disabled";
            var tk_priority = tokens.get("tk_priority");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring/" + tk_keyid;

            // Create a dictionary to store the field names and values
            var record = {
                "data_name": tk_data_name,
                "data_index": tk_data_index,
                "data_sourcetype": tk_data_sourcetype,
                "data_last_lag_seen": tk_data_last_lag_seen,
                "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                "data_eventcount": tk_data_eventcount,
                "data_first_time_seen": tk_data_first_time_seen,
                "data_last_time_seen": tk_data_last_time_seen,
                "data_last_ingest": tk_data_last_ingest,
                "data_last_lag_seen_idx": tk_data_last_lag_seen_idx,
                "data_last_time_seen_idx": tk_data_last_time_seen_idx,
                "data_max_lag_allowed": tk_data_max_lag_allowed,
                "data_monitored_state": tk_data_monitored_state,
                "data_monitoring_level": tk_data_monitoring_level,
                "data_monitoring_wdays": tk_data_monitoring_wdays,
                "data_override_lagging_class": tk_data_override_lagging_class,
                "data_source_state": tk_data_source_state,
                "data_tracker_runtime": tk_data_tracker_runtime,
                "data_previous_source_state": tk_data_previous_source_state,
                "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                "priority": tk_priority
            };

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            searchDataSourcesMain.startSearch();

                            // Audit success change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "success",
                                "user": currentUser,
                                "change_type": "disable monitoring",
                                "object": tk_data_name,
                                "object_category": "data_source",
                                "object_attrs": JSON.stringify(record)
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "disable monitoring",
                                "object": tk_data_name,
                                "object_category": "data_source",
                                "object_attrs": JSON.stringify(record),
                                "result": message
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        $("#btn_disable_monitoring_host").click(function(mode) {

            // Hide main modal
            $("#modal_manage_host").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_host_state = tokens.get("tk_data_host_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_host_state = tokens.get("tk_data_previous_host_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_data_monitored_state = "disabled";
            var tk_priority = tokens.get("tk_priority");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_host_monitoring/" + tk_keyid;

            // Create a dictionary to store the field names and values
            var record = {
                "data_host": tk_data_host,
                "data_index": tk_data_index,
                "data_sourcetype": tk_data_sourcetype,
                "data_last_lag_seen": tk_data_last_lag_seen,
                "data_eventcount": tk_data_eventcount,
                "data_first_time_seen": tk_data_first_time_seen,
                "data_last_time_seen": tk_data_last_time_seen,
                "data_last_ingest": tk_data_last_ingest,
                "data_max_lag_allowed": tk_data_max_lag_allowed,
                "data_monitored_state": tk_data_monitored_state,
                "data_monitoring_wdays": tk_data_monitoring_wdays,
                "data_override_lagging_class": tk_data_override_lagging_class,
                "data_host_state": tk_data_host_state,
                "data_tracker_runtime": tk_data_tracker_runtime,
                "data_previous_host_state": tk_data_previous_host_state,
                "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                "priority": tk_priority
            };

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            searchDataHostsMain.startSearch();

                            // Audit success change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "success",
                                "user": currentUser,
                                "change_type": "disable monitoring",
                                "object": tk_data_host,
                                "object_category": "data_host",
                                "object_attrs": JSON.stringify(record)
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "disable monitoring",
                                "object": tk_data_host,
                                "object_category": "data_host",
                                "object_attrs": JSON.stringify(record),
                                "result": message
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        $("#btn_disable_monitoring_metric_host").click(function(mode) {

            // Hide main modal
            $("#modal_manage_metric_host").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_metric_host = tokens.get("tk_metric_host");
            var tk_metric_index = tokens.get("tk_metric_index");
            var tk_metric_category = tokens.get("tk_metric_category");
            var tk_metric_details = tokens.get("tk_metric_details");
            var tk_metric_last_lag_seen = tokens.get("tk_metric_last_lag_seen");
            var tk_metric_last_time_seen = tokens.get("tk_metric_last_time_seen");
            var tk_metric_host_state = tokens.get("tk_metric_host_state");
            var tk_metric_tracker_runtime = tokens.get("tk_metric_tracker_runtime");
            var tk_metric_previous_host_state = tokens.get("tk_metric_previous_host_state");
            var tk_metric_previous_tracker_runtime = tokens.get("tk_metric_previous_tracker_runtime");
            var tk_metric_monitored_state = "disabled";
            var tk_priority = tokens.get("tk_priority");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring/" + tk_keyid;

            // Create a dictionary to store the field names and values
            var record = {
                "metric_host": tk_metric_host,
                "metric_index": tk_metric_index,
                "metric_category": tk_metric_category,
                "metric_details": tk_metric_details,
                "metric_last_lag_seen": tk_metric_last_lag_seen,
                "metric_last_time_seen": tk_metric_last_time_seen,
                "metric_monitored_state": tk_metric_monitored_state,
                "metric_host_state": tk_metric_host_state,
                "metric_tracker_runtime": tk_metric_tracker_runtime,
                "metric_previous_host_state": tk_metric_previous_host_state,
                "metric_previous_tracker_runtime": tk_metric_previous_tracker_runtime,
                "priority": tk_priority
            };

            //console.log(record);

            if (!tk_keyid || !tk_keyid.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            searchMetricHostsMain.startSearch();

                            // Audit success change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "success",
                                "user": currentUser,
                                "change_type": "disable monitoring",
                                "object": tk_metric_host,
                                "object_category": "metric_host",
                                "object_attrs": JSON.stringify(record)
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "disable monitoring",
                                "object": tk_metric_host,
                                "object_category": "metric_host",
                                "object_attrs": JSON.stringify(record),
                                "result": message
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        //
        // DELETE BUTTON
        //

        $("#btn_delete_metric_host").click(function() {

            // Hide main modal
            $("#modal_manage_metric_host").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_metric_host = tokens.get("tk_metric_host");
            var tk_metric_index = tokens.get("tk_metric_index");
            var tk_metric_category = tokens.get("tk_metric_category");
            var tk_metric_details = tokens.get("tk_metric_details");
            var tk_metric_last_lag_seen = tokens.get("tk_metric_last_lag_seen");
            var tk_metric_last_time_seen = tokens.get("tk_metric_last_time_seen");
            var tk_metric_host_state = tokens.get("tk_metric_host_state");
            var tk_metric_tracker_runtime = tokens.get("tk_metric_tracker_runtime");
            var tk_metric_previous_host_state = tokens.get("tk_metric_previous_host_state");
            var tk_metric_previous_tracker_runtime = tokens.get("tk_metric_previous_tracker_runtime");
            var tk_metric_monitored_state = "disabled";
            var tk_priority = tokens.get("tk_priority");

            // Create a dictionary to store the field names and values
            var record = {
                "metric_host": tk_metric_host,
                "metric_index": tk_metric_index,
                "metric_category": tk_metric_category,
                "metric_details": tk_metric_details,
                "metric_last_lag_seen": tk_metric_last_lag_seen,
                "metric_last_time_seen": tk_metric_last_time_seen,
                "metric_monitored_state": tk_metric_monitored_state,
                "metric_host_state": tk_metric_host_state,
                "metric_tracker_runtime": tk_metric_tracker_runtime,
                "metric_previous_host_state": tk_metric_previous_host_state,
                "metric_previous_tracker_runtime": tk_metric_previous_tracker_runtime,
                "priority": tk_priority
            };

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring/" + tk_keyid;

            if (tk_keyid && tk_keyid.length) {

                $("#modal_entry_deletion").modal()

                $("#btn_modal_entry_deletion_temporary").unbind('click').click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "DELETE",
                        async: true,
                        contentType: "application/json",
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            searchMetricHostsMain.startSearch();

                            // Audit success change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "success",
                                "user": currentUser,
                                "change_type": "delete temporary",
                                "object": tk_metric_host,
                                "object_category": "metric_host",
                                "object_attrs": JSON.stringify(record)
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                            // house cleaning
                            myendpoint_URl = undefined;
                            delete(myendpoint_URl);
                            tk_keyid = undefined;
                            delete(tk_keyid);
                            return;
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "delete",
                                "object": tk_metric_host,
                                "object_category": "metric_host",
                                "object_attrs": JSON.stringify(record),
                                "result": message
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }

                    });

                });

                $("#btn_modal_entry_deletion").unbind('click').click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "DELETE",
                        async: true,
                        contentType: "application/json",
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            searchMetricHostsMain.startSearch();

                            // Audit success change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "success",
                                "user": currentUser,
                                "change_type": "delete permanent",
                                "object": tk_metric_host,
                                "object_category": "metric_host",
                                "object_attrs": JSON.stringify(record)
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                            // house cleaning
                            myendpoint_URl = undefined;
                            delete(myendpoint_URl);
                            tk_keyid = undefined;
                            delete(tk_keyid);
                            return;
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "delete",
                                "object": tk_metric_host,
                                "object_category": "metric_host",
                                "object_attrs": JSON.stringify(record),
                                "result": message
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }

                    });

                });

            }

        });

        // delete entry

        $("#btn_delete_data_source").click(function() {

            // Hide main modal
            $("#modal_manage").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_last_lag_seen_idx = tokens.get("tk_data_last_lag_seen_idx");
            var tk_data_last_time_seen_idx = tokens.get("tk_data_last_time_seen_idx");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_monitoring_level = tokens.get("tk_data_monitoring_level");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_priority = tokens.get("tk_priority");

            // Create a dictionary to store the field names and values
            var record = {
                "data_name": tk_data_name,
                "data_index": tk_data_index,
                "data_sourcetype": tk_data_sourcetype,
                "data_last_lag_seen": tk_data_last_lag_seen,
                "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                "data_eventcount": tk_data_eventcount,
                "data_first_time_seen": tk_data_first_time_seen,
                "data_last_time_seen": tk_data_last_time_seen,
                "data_last_ingest": tk_data_last_ingest,
                "data_last_lag_seen_idx": tk_data_last_lag_seen_idx,
                "data_last_time_seen_idx": tk_data_last_time_seen_idx,
                "data_max_lag_allowed": tk_data_max_lag_allowed,
                "data_monitored_state": tk_data_monitored_state,
                "data_monitoring_level": tk_data_monitoring_level,
                "data_monitoring_wdays": tk_data_monitoring_wdays,
                "data_override_lagging_class": tk_data_override_lagging_class,
                "priority": tk_priority
            };

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring/" + tk_keyid;

            if (tk_keyid && tk_keyid.length) {

                $("#modal_entry_deletion").modal()

                // Delete temporary: change_type will be set to temporary
                $("#btn_modal_entry_deletion_temporary").unbind('click').click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "DELETE",
                        async: true,
                        contentType: "application/json",
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            searchDataSourcesMain.startSearch();

                            // Audit success change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "success",
                                "user": currentUser,
                                "change_type": "delete temporary",
                                "object": tk_data_name,
                                "object_category": "data_source",
                                "object_attrs": JSON.stringify(record)
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                            // house cleaning
                            myendpoint_URl = undefined;
                            delete(myendpoint_URl);
                            tk_keyid = undefined;
                            delete(tk_keyid);
                            return;
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "delete temporary",
                                "object": tk_data_name,
                                "object_category": "data_source",
                                "object_attrs": JSON.stringify(record),
                                "result": message
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }

                    });

                });

                // Delete temporary: change_type will be set to permanent
                $("#btn_modal_entry_deletion").unbind('click').click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "DELETE",
                        async: true,
                        contentType: "application/json",
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            searchDataSourcesMain.startSearch();

                            // Audit success change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "success",
                                "user": currentUser,
                                "change_type": "delete permanent",
                                "object": tk_data_name,
                                "object_category": "data_source",
                                "object_attrs": JSON.stringify(record)
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                            // house cleaning
                            myendpoint_URl = undefined;
                            delete(myendpoint_URl);
                            tk_keyid = undefined;
                            delete(tk_keyid);
                            return;
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "delete permanent",
                                "object": tk_data_name,
                                "object_category": "data_source",
                                "object_attrs": JSON.stringify(record),
                                "result": message
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }

                    });

                });

            }

        });

        $("#btn_delete_data_host").click(function() {

            // Hide main modal
            $("#modal_manage_host").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_priority = tokens.get("tk_priority");

            // Create a dictionary to store the field names and values
            var record = {
                "data_host": tk_data_host,
                "data_index": tk_data_index,
                "data_sourcetype": tk_data_sourcetype,
                "data_last_lag_seen": tk_data_last_lag_seen,
                "data_eventcount": tk_data_eventcount,
                "data_first_time_seen": tk_data_first_time_seen,
                "data_last_time_seen": tk_data_last_time_seen,
                "data_last_ingest": tk_data_last_ingest,
                "data_max_lag_allowed": tk_data_max_lag_allowed,
                "data_monitored_state": tk_data_monitored_state,
                "data_monitoring_wdays": tk_data_monitoring_wdays,
                "data_override_lagging_class": tk_data_override_lagging_class,
                "priority": tk_priority
            };

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_host_monitoring/" + tk_keyid;

            if (tk_keyid && tk_keyid.length) {

                $("#modal_entry_deletion").modal()

                $("#btn_modal_entry_deletion_temporary").unbind('click').click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "DELETE",
                        async: true,
                        contentType: "application/json",
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            searchDataHostsMain.startSearch();

                            // Audit success change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "success",
                                "user": currentUser,
                                "change_type": "delete temporary",
                                "object": tk_data_host,
                                "object_category": "data_host",
                                "object_attrs": JSON.stringify(record)
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                            // house cleaning
                            myendpoint_URl = undefined;
                            delete(myendpoint_URl);
                            tk_keyid = undefined;
                            delete(tk_keyid);
                            return;
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "delete",
                                "object": tk_data_name,
                                "object_category": "data_source",
                                "object_attrs": JSON.stringify(record),
                                "result": message
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }

                    });

                });

                $("#btn_modal_entry_deletion").unbind('click').click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "DELETE",
                        async: true,
                        contentType: "application/json",
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            searchDataHostsMain.startSearch();

                            // Audit success change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "success",
                                "user": currentUser,
                                "change_type": "delete permanent",
                                "object": tk_data_host,
                                "object_category": "data_host",
                                "object_attrs": JSON.stringify(record)
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                            // house cleaning
                            myendpoint_URl = undefined;
                            delete(myendpoint_URl);
                            tk_keyid = undefined;
                            delete(tk_keyid);
                            return;
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;

                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "delete",
                                "object": tk_data_name,
                                "object_category": "data_source",
                                "object_attrs": JSON.stringify(record),
                                "result": message
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }

                    });

                });

            }

        });

        // metrics sla policy

        // add policy

        $("#btn_modal_metric_policy_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_metric_policy_metric_category = tokens.get("tk_input_metric_policy_metric_category");
            var tk_input_metric_policy_metric_value = tokens.get("tk_input_metric_policy_metric_value");

            // Define the query
            var searchQuery = "| inputlookup trackme_metric_lagging_definition | append [ | makeresults | eval metric_category=\"" + tk_input_metric_policy_metric_category + "\", metric_max_lag_allowed=\"" + tk_input_metric_policy_metric_value + "\" ] | dedup metric_category | sort limit=0 metric_category | outputlookup trackme_metric_lagging_definition";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_metric_policy_metric_category && tk_input_metric_policy_metric_category.length && tk_input_metric_policy_metric_value && tk_input_metric_policy_metric_value.length && isNumeric(tk_input_metric_policy_metric_value)) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {
                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "create metric sla policy",
                                "object": tk_input_metric_policy_metric_category,
                                "object_category": "metric_sla_policy",
                                "object_attrs": "SLA policy was created for metric_category:" + tk_input_metric_policy_metric_category + ", metric_max_lag_allowed:" + tk_input_metric_policy_metric_value
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                }
                            });
                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    unsetToken("form.tk_input_metric_policy_metric_category");
                                    searchMetricHostsMain.startSearch();
                                    searchMetricPolicies.startSearch();

                                    // Audit success change
                                    var time = (new Date).getTime();
                                    var audit_record = {
                                        "time": time,
                                        "action": "success",
                                        "user": currentUser,
                                        "change_type": "create metric sla policy",
                                        "object": tk_input_metric_policy_metric_category,
                                        "object_category": "metric_sla_policy",
                                        "object_attrs": "SLA policy was created for metric_category:" + tk_input_metric_policy_metric_category + ", metric_max_lag_allowed:" + tk_input_metric_policy_metric_value
                                    };
                                    $.ajax({
                                        url: auditendpoint_URl,
                                        type: "POST",
                                        async: true,
                                        contentType: "application/json",
                                        data: JSON.stringify(audit_record),
                                        success: function(returneddata) {
                                            // notify
                                            notification('Modification has been registered successfully.', 2000)
                                        }
                                    });

                                    $("#modal_metric_sla_policies").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete policy

        $("#btn_delete_metric_sla_policy").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_metric_policy_metric_category = tokens.get("tk_input_metric_policy_metric_category");
            var tk_input_metric_policy_metric_value = tokens.get("tk_input_metric_policy_metric_value");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_lagging_definition/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#manage_metric_sla_policy").modal('hide');

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "delete metric sla policy",
                            "object": tk_input_metric_policy_metric_category,
                            "object_category": "metric_host",
                            "object_attrs": "SLA policy was removed for metric_category:" + tk_input_metric_policy_metric_category + ", metric_max_lag_allowed:" + tk_input_metric_policy_metric_value,
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        unsetToken("form.tk_input_metric_policy_metric_category");
                        searchMetricHostsMain.startSearch();
                        searchMetricPolicies.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_metric_sla_policies").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "delete metric sla policy",
                            "object": tk_input_metric_policy_metric_category,
                            "object_category": "metric_host",
                            "object_attrs": "SLA policy was removed for metric_category:" + tk_input_metric_policy_metric_category + ", metric_max_lag_allowed:" + tk_input_metric_policy_metric_value,
                            "result": message
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // Hide main modal
                        $("#manage_metric_sla_policy").modal('hide');
                        $("#modal_metric_sla_policies").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // Custom lagging

        $("#btn_modal_custom_lagging_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_custom_lagging_type = tokens.get("tk_input_custom_lagging_type");
            var tk_input_custom_lagging_name = tokens.get("tk_input_custom_lagging_name");
            var tk_input_custom_lagging_value = tokens.get("tk_input_custom_lagging_value");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_custom_lagging_definition";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_custom_lagging_definition | append [ | makeresults | eval level=\"" + tk_input_custom_lagging_type + "\", name=\"" + tk_input_custom_lagging_name + "\", value=\"" + tk_input_custom_lagging_value + "\" ] | dedup level, name, value | sort limit=0 level, name | outputlookup trackme_custom_lagging_definition";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_custom_lagging_name && tk_input_custom_lagging_name.length && tk_input_custom_lagging_value && tk_input_custom_lagging_value.length && isNumeric(tk_input_custom_lagging_value)) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {
                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "create lagging class",
                                "object": tk_input_custom_lagging_name,
                                "object_category": "lagging_class",
                                "object_attrs": "type:" + tk_input_custom_lagging_type + ", name:" + tk_input_custom_lagging_name + ", value:" + tk_input_custom_lagging_value
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                }
                            });
                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchCustomLagging.startSearch();

                                    // Audit success change
                                    var time = (new Date).getTime();
                                    var audit_record = {
                                        "time": time,
                                        "action": "success",
                                        "user": currentUser,
                                        "change_type": "create lagging class",
                                        "object": tk_input_custom_lagging_name,
                                        "object_category": "lagging_class",
                                        "object_attrs": "type:" + tk_input_custom_lagging_type + ", name:" + tk_input_custom_lagging_name + ", value:" + tk_input_custom_lagging_value
                                    };
                                    $.ajax({
                                        url: auditendpoint_URl,
                                        type: "POST",
                                        async: true,
                                        contentType: "application/json",
                                        data: JSON.stringify(audit_record),
                                        success: function(returneddata) {
                                            // notify
                                            notification('Modification has been registered successfully.', 2000)
                                        }
                                    });

                                    $("#modify_custom_lagging").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete lagging class

        $("#btn_delete_custom_lagging").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_custom_lagging_definition/" + tk_keyid;

            // Get tokens
            var tk_input_custom_lagging_type = tokens.get("tk_input_custom_lagging_type");
            var tk_input_custom_lagging_name = tokens.get("tk_input_custom_lagging_name");
            var tk_input_custom_lagging_value = tokens.get("tk_input_custom_lagging_value");

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#manage_custom_lagging").modal('hide');

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchCustomLagging.startSearch();

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "delete lagging class",
                            "object": tk_input_custom_lagging_name,
                            "object_category": "lagging_class",
                            "object_attrs": "type:" + tk_input_custom_lagging_type + ", name:" + tk_input_custom_lagging_name + ", value:" + tk_input_custom_lagging_value
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                // notify
                                notification('Modification has been registered successfully.', 2000)
                            }
                        });

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modify_custom_lagging").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "delete lagging class",
                            "object": tk_input_custom_lagging_name,
                            "object_category": "lagging_class",
                            "object_attrs": "type:" + tk_input_custom_lagging_type + ", name:" + tk_input_custom_lagging_name + ", value:" + tk_input_custom_lagging_value
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // Hide main modal
                        $("#modify_custom_lagging").modal('hide');
                        $("#manage_custom_lagging").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // whitelist

        // add entry from whitelist

        $("#btn_modal_data_source_whitelist_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_whitelist_data_source = tokens.get("tk_input_whitelist_data_source");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_whitelist_index";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_data_source_monitoring_whitelist_index | append [ | makeresults | eval data_index=\"" + tk_input_whitelist_data_source + "\"] | dedup data_index | sort limit=0 data_index | outputlookup trackme_data_source_monitoring_whitelist_index";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_whitelist_data_source && tk_input_whitelist_data_source.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "add whitelist index",
                                "object": tk_input_whitelist_data_source,
                                "object_category": "data_source",
                                "object_attrs": "index:" + tk_input_whitelist_data_source
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchWhiteListDataSource.startSearch();
                                    searchSingleWhiteListDataSource.startSearch();
                                    searchDataSourcesMain.startSearch();
                                    searchPopulateIndexesForWhiteListDataSource.startSearch();
                                    unsetToken("form.tk_input_whitelist_data_source");

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit success change
                                    var time = (new Date).getTime();
                                    var audit_record = {
                                        "time": time,
                                        "action": "success",
                                        "user": currentUser,
                                        "change_type": "add whitelist index",
                                        "object": tk_input_whitelist_data_source,
                                        "object_category": "data_source",
                                        "object_attrs": "index:" + tk_input_whitelist_data_source
                                    };
                                    $.ajax({
                                        url: auditendpoint_URl,
                                        type: "POST",
                                        async: true,
                                        contentType: "application/json",
                                        data: JSON.stringify(audit_record),
                                        success: function(returneddata) {
                                            //console.log("Updated!", returneddata)
                                            // Run the search again to update the table
                                        }
                                    });

                                    $("#modal_modify_data_source_whitelist").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from whitelist

        $("#btn_delete_data_source_whitelist").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // Get
            var tk_data_index = tokens.get("tk_data_index");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_whitelist_index/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_data_source_whitelist").modal('hide');

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchWhiteListDataSource.startSearch();
                        searchSingleWhiteListDataSource.startSearch();
                        searchDataSourcesMain.startSearch();
                        searchPopulateIndexesForWhiteListDataSource.startSearch();
                        unsetToken("form.tk_input_whitelist_data_source");

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "delete whitelist index",
                            "object": tk_data_index,
                            "object_category": "data_source",
                            "object_attrs": "index:" + tk_data_index
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_data_source_whitelist").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "delete whitelist index",
                            "object": tk_data_index,
                            "object_category": "data_source",
                            "object_attrs": "index:" + tk_data_index,
                            "result": message
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // Hide main modal
                        $("#modal_manage_data_source_whitelist").modal('hide');
                        $("#modal_modify_data_source_whitelist").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // add entry from whitelist

        $("#btn_modal_metric_host_whitelist_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_whitelist_metric_host = tokens.get("tk_input_whitelist_metric_host");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring_whitelist_index";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_metric_host_monitoring_whitelist_index | append [ | makeresults | eval metric_index=\"" + tk_input_whitelist_metric_host + "\"] | dedup metric_index | sort limit=0 metric_index | outputlookup trackme_metric_host_monitoring_whitelist_index";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_whitelist_metric_host && tk_input_whitelist_metric_host.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "add whitelist index",
                                "object": tk_input_whitelist_metric_host,
                                "object_category": "metric_host",
                                "object_attrs": "index:" + tk_input_whitelist_metric_host
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchPopulateIndexesForWhiteListMetricHost.startSearch();
                                    searchWhiteListMetricHost.startSearch();
                                    searchSingleWhiteListMetricHost.startSearch();
                                    searchMetricHostsMain.startSearch();
                                    unsetToken("form.tk_input_whitelist_metric_host");

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit success change
                                    var time = (new Date).getTime();
                                    var audit_record = {
                                        "time": time,
                                        "action": "success",
                                        "user": currentUser,
                                        "change_type": "add whitelist index",
                                        "object": tk_input_whitelist_metric_host,
                                        "object_category": "metric_host",
                                        "object_attrs": "index:" + tk_input_whitelist_metric_host
                                    };
                                    $.ajax({
                                        url: auditendpoint_URl,
                                        type: "POST",
                                        async: true,
                                        contentType: "application/json",
                                        data: JSON.stringify(audit_record),
                                        success: function(returneddata) {
                                            //console.log("Updated!", returneddata)
                                            // Run the search again to update the table
                                        }
                                    });

                                    $("#modal_modify_metric_host_whitelist").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from whitelist

        $("#btn_delete_metric_host_whitelist").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // Get
            var tk_metric_index = tokens.get("tk_metric_index");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring_whitelist_index/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_metric_host_whitelist").modal('hide');

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchPopulateIndexesForWhiteListMetricHost.startSearch();
                        searchWhiteListMetricHost.startSearch();
                        searchSingleWhiteListMetricHost.startSearch();
                        searchMetricHostsMain.startSearch();
                        unsetToken("form.tk_input_whitelist_metric_host");

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "delete whitelist index",
                            "object": tk_metric_index,
                            "object_category": "metric_host",
                            "object_attrs": "index:" + tk_metric_index
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_metric_host_whitelist").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "delete whitelist index",
                            "object": tk_metric_index,
                            "object_category": "metric_host",
                            "object_attrs": "index:" + tk_metric_index,
                            "result": message
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // Hide main modal
                        $("#modal_manage_metric_host_whitelist").modal('hide');
                        $("#modal_modify_metric_host_whitelist").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // add entry from whitelist

        $("#btn_modal_data_host_whitelist_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_whitelist_data_host = tokens.get("tk_input_whitelist_data_host");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_whitelist_index";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_data_host_monitoring_whitelist_index | append [ | makeresults | eval data_index=\"" + tk_input_whitelist_data_host + "\"] | dedup data_index | sort limit=0 data_index | outputlookup trackme_data_host_monitoring_whitelist_index";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_whitelist_data_host && tk_input_whitelist_data_host.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "add whitelist index",
                                "object": tk_input_whitelist_data_host,
                                "object_category": "data_host",
                                "object_attrs": "index:" + tk_input_whitelist_data_host
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchWhiteListDataHost.startSearch();
                                    searchSingleWhiteListDataHost.startSearch();
                                    searchDataHostsMain.startSearch();
                                    searchPopulateIndexesForWhiteListDataHost.startSearch();
                                    unsetToken("form.tk_input_whitelist_data_host");

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit success change
                                    var time = (new Date).getTime();
                                    var audit_record = {
                                        "time": time,
                                        "action": "success",
                                        "user": currentUser,
                                        "change_type": "add whitelist index",
                                        "object": tk_input_whitelist_data_host,
                                        "object_category": "data_host",
                                        "object_attrs": "index:" + tk_input_whitelist_data_host
                                    };
                                    $.ajax({
                                        url: auditendpoint_URl,
                                        type: "POST",
                                        async: true,
                                        contentType: "application/json",
                                        data: JSON.stringify(audit_record),
                                        success: function(returneddata) {
                                            //console.log("Updated!", returneddata)
                                            // Run the search again to update the table
                                        }
                                    });

                                    $("#modal_modify_data_host_whitelist").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from whitelist

        $("#btn_delete_data_host_whitelist").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // Get
            var tk_data_index_host = tokens.get("tk_data_index_host");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_whitelist_index/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_data_host_whitelist").modal('hide');

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchWhiteListDataHost.startSearch();
                        searchSingleWhiteListDataHost.startSearch();
                        searchDataHostsMain.startSearch();
                        searchPopulateIndexesForWhiteListDataHost.startSearch();
                        unsetToken("form.tk_input_whitelist_data_host");

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "delete whitelist index",
                            "object": tk_data_index_host,
                            "object_category": "data_host",
                            "object_attrs": "index:" + tk_data_index_host
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_data_host_whitelist").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "delete whitelist index",
                            "object": tk_data_index_host,
                            "object_category": "data_host",
                            "object_attrs": "index:" + tk_data_index_host,
                            "result": message
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // Hide main modal
                        $("#modal_manage_data_host_whitelist").modal('hide');
                        $("#modal_modify_data_host_whitelist").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // blacklist

        // host blacklist

        // add entry from blacklist

        $("#btn_modal_data_source_blacklist_host_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_host = tokens.get("tk_input_data_source_blacklist_host");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_host";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_data_source_monitoring_blacklist_host | append [ | makeresults | eval data_host=\"" + tk_input_blacklist_host + "\", data_blacklist_state=\"true\" ] | dedup data_host | sort limit=0 data_host | outputlookup trackme_data_source_monitoring_blacklist_host";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_host && tk_input_blacklist_host.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "add blacklist host",
                                "object": tk_input_blacklist_host,
                                "object_category": "data_source",
                                "object_attrs": "host:" + tk_input_blacklist_host
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataSourceHost.startSearch();
                                    searchSingleBlackListDataSourceHost.startSearch();
                                    searchDataSourcesMain.startSearch();
                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit success change
                                    var time = (new Date).getTime();
                                    var audit_record = {
                                        "time": time,
                                        "action": "success",
                                        "user": currentUser,
                                        "change_type": "add blacklist host",
                                        "object": tk_input_blacklist_host,
                                        "object_category": "data_source",
                                        "object_attrs": "host:" + tk_input_blacklist_host
                                    };
                                    $.ajax({
                                        url: auditendpoint_URl,
                                        type: "POST",
                                        async: true,
                                        contentType: "application/json",
                                        data: JSON.stringify(audit_record),
                                        success: function(returneddata) {
                                            //console.log("Updated!", returneddata)
                                            // Run the search again to update the table
                                        }
                                    });

                                    $("#modal_modify_data_source_blacklist_host").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_delete_data_source_blacklist_host").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // Get
            var tk_data_host = tokens.get("tk_data_host");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_host/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_data_source_blacklist_host").modal('hide');

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchBlackListDataSourceHost.startSearch();
                        searchSingleBlackListDataSourceHost.startSearch();
                        searchDataSourcesMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "delete blacklist host",
                            "object": tk_data_host,
                            "object_category": "data_source",
                            "object_attrs": "host:" + tk_data_host
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_data_source_blacklist_host").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "delete blacklist host",
                            "object": tk_data_host,
                            "object_category": "data_source",
                            "object_attrs": "host:" + tk_data_host,
                            "result": message
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // Hide main modal
                        $("#modal_manage_data_source_blacklist_host").modal('hide');
                        $("#modal_modify_data_source_blacklist_host").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // add entry from blacklist

        $("#btn_modal_data_host_blacklist_host_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_host = tokens.get("tk_input_data_host_blacklist_host");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_blacklist_host";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_data_host_monitoring_blacklist_host | append [ | makeresults | eval data_host=\"" + tk_input_blacklist_host + "\", data_blacklist_state=\"true\" ] | dedup data_host | sort limit=0 data_host | outputlookup trackme_data_host_monitoring_blacklist_host";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_host && tk_input_blacklist_host.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {

                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "add blacklist host",
                                "object": tk_input_blacklist_host,
                                "object_category": "data_host",
                                "object_attrs": "host:" + tk_input_blacklist_host
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });

                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataHostHost.startSearch();
                                    searchSingleBlackListDataHostHost.startSearch();
                                    searchDataHostsMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit success change
                                    var time = (new Date).getTime();
                                    var audit_record = {
                                        "time": time,
                                        "action": "success",
                                        "user": currentUser,
                                        "change_type": "add blacklist host",
                                        "object": tk_input_blacklist_host,
                                        "object_category": "data_host",
                                        "object_attrs": "host:" + tk_input_blacklist_host
                                    };
                                    $.ajax({
                                        url: auditendpoint_URl,
                                        type: "POST",
                                        async: true,
                                        contentType: "application/json",
                                        data: JSON.stringify(audit_record),
                                        success: function(returneddata) {
                                            //console.log("Updated!", returneddata)
                                            // Run the search again to update the table
                                        }
                                    });

                                    $("#modal_modify_data_host_blacklist_host").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_delete_data_host_blacklist_host").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // Get
            var tk_data_host = tokens.get("tk_data_host");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_blacklist_host/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_data_host_blacklist_host").modal('hide');

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchBlackListDataHostHost.startSearch();
                        searchSingleBlackListDataHostHost.startSearch();
                        searchDataHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "delete blacklist host",
                            "object": tk_data_host,
                            "object_category": "data_host",
                            "object_attrs": "host:" + tk_data_host
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_data_host_blacklist_host").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "delete blacklist host",
                            "object": tk_data_host,
                            "object_category": "data_host",
                            "object_attrs": "host:" + tk_data_host,
                            "result": message
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // Hide main modal
                        $("#modal_manage_data_host_blacklist_host").modal('hide');
                        $("#modal_modify_data_host_blacklist_host").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // index blacklist

        // add entry from blacklist

        $("#btn_modal_data_source_blacklist_index_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_index = tokens.get("tk_input_blacklist_index");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_index";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_data_source_monitoring_blacklist_index | append [ | makeresults | eval data_index=\"" + tk_input_blacklist_index + "\", data_blacklist_state=\"true\" ] | dedup data_index | sort limit=0 data_index | outputlookup trackme_data_source_monitoring_blacklist_index";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_index && tk_input_blacklist_index.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {
                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "add blacklist index",
                                "object": tk_input_blacklist_index,
                                "object_category": "data_source",
                                "object_attrs": "index:" + tk_input_blacklist_index
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });
                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataSourceIndex.startSearch();
                                    searchSingleBlackListDataSourceIndex.startSearch();
                                    searchDataSourcesMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit success change
                                    var time = (new Date).getTime();
                                    var audit_record = {
                                        "time": time,
                                        "action": "success",
                                        "user": currentUser,
                                        "change_type": "add blacklist index",
                                        "object": tk_input_blacklist_index,
                                        "object_category": "data_source",
                                        "object_attrs": "index:" + tk_input_blacklist_index
                                    };
                                    $.ajax({
                                        url: auditendpoint_URl,
                                        type: "POST",
                                        async: true,
                                        contentType: "application/json",
                                        data: JSON.stringify(audit_record),
                                        success: function(returneddata) {
                                            //console.log("Updated!", returneddata)
                                            // Run the search again to update the table
                                        }
                                    });

                                    $("#modal_modify_data_source_blacklist_index").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_delete_data_source_blacklist_index").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // Get
            var tk_data_index = tokens.get("tk_data_index");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_index/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_data_source_blacklist_index").modal('hide');

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchBlackListDataSourceIndex.startSearch();
                        searchSingleBlackListDataSourceIndex.startSearch();
                        searchDataSourcesMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "delete blacklist index",
                            "object": tk_data_index,
                            "object_category": "data_source",
                            "object_attrs": "index:" + tk_data_index
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_data_source_blacklist_index").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "delete blacklist index",
                            "object": tk_data_index,
                            "object_category": "data_source",
                            "object_attrs": "index:" + tk_data_index,
                            "result": message
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // Hide main modal
                        $("#modal_manage_data_source_blacklist_index").modal('hide');
                        $("#modal_modify_data_source_blacklist_index").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // add entry from blacklist

        $("#btn_modal_data_host_blacklist_index_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_index = tokens.get("tk_input_data_host_blacklist_index");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_index";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_data_host_monitoring_blacklist_index | append [ | makeresults | eval data_index=\"" + tk_input_blacklist_index + "\", data_blacklist_state=\"true\" ] | dedup data_index | sort limit=0 data_index | outputlookup trackme_data_host_monitoring_blacklist_index";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_index && tk_input_blacklist_index.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {
                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "add blacklist index",
                                "object": tk_input_blacklist_index,
                                "object_category": "data_host",
                                "object_attrs": "index:" + tk_input_blacklist_index
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });
                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataHostIndex.startSearch();
                                    searchSingleBlackListDataHostIndex.startSearch();
                                    searchDataHostsMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit success change
                                    var time = (new Date).getTime();
                                    var audit_record = {
                                        "time": time,
                                        "action": "success",
                                        "user": currentUser,
                                        "change_type": "add blacklist index",
                                        "object": tk_input_blacklist_index,
                                        "object_category": "data_host",
                                        "object_attrs": "index:" + tk_input_blacklist_index
                                    };
                                    $.ajax({
                                        url: auditendpoint_URl,
                                        type: "POST",
                                        async: true,
                                        contentType: "application/json",
                                        data: JSON.stringify(audit_record),
                                        success: function(returneddata) {
                                            //console.log("Updated!", returneddata)
                                            // Run the search again to update the table
                                        }
                                    });

                                    $("#modal_modify_data_host_blacklist_index").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_delete_data_host_blacklist_index").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_data_index = tokens.get("tk_data_index");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_blacklist_index/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_data_host_blacklist_index").modal('hide');

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchBlackListDataHostIndex.startSearch();
                        searchSingleBlackListDataHostIndex.startSearch();
                        searchDataHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "delete blacklist index",
                            "object": tk_data_index,
                            "object_category": "data_host",
                            "object_attrs": "index:" + tk_data_index
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_data_host_blacklist_index").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "delete blacklist index",
                            "object": tk_data_index,
                            "object_category": "data_source",
                            "object_attrs": "index:" + tk_data_index,
                            "result": message
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // Hide main modal
                        $("#modal_manage_data_host_blacklist_index").modal('hide');
                        $("#modal_modify_data_host_blacklist_index").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // sourcetype blacklist

        $("#btn_modal_data_source_blacklist_sourcetype_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_sourcetype = tokens.get("tk_input_data_source_blacklist_sourcetype");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_sourcetype";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_data_source_monitoring_blacklist_sourcetype | append [ | makeresults | eval data_sourcetype=\"" + tk_input_blacklist_sourcetype + "\", data_blacklist_state=\"true\" ] | dedup data_sourcetype | sort limit=0 data_sourcetype | outputlookup trackme_data_source_monitoring_blacklist_sourcetype";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_sourcetype && tk_input_blacklist_sourcetype.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {
                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "add blacklist sourcetype",
                                "object": tk_input_blacklist_sourcetype,
                                "object_category": "data_source",
                                "object_attrs": "sourcetype:" + tk_input_blacklist_sourcetype
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });
                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataSourceSourcetype.startSearch();
                                    searchSingleBlackListDataSourceSourcetype.startSearch();
                                    searchDataSourcesMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit success change
                                    var time = (new Date).getTime();
                                    var audit_record = {
                                        "time": time,
                                        "action": "success",
                                        "user": currentUser,
                                        "change_type": "add blacklist sourcetype",
                                        "object": tk_input_blacklist_sourcetype,
                                        "object_category": "data_source",
                                        "object_attrs": "sourcetype:" + tk_input_blacklist_sourcetype
                                    };
                                    $.ajax({
                                        url: auditendpoint_URl,
                                        type: "POST",
                                        async: true,
                                        contentType: "application/json",
                                        data: JSON.stringify(audit_record),
                                        success: function(returneddata) {
                                            //console.log("Updated!", returneddata)
                                            // Run the search again to update the table
                                        }
                                    });

                                    $("#modal_modify_data_source_blacklist_sourcetype").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_delete_data_source_blacklist_sourcetype").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // Get
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring_blacklist_sourcetype/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_data_source_blacklist_sourcetype").modal('hide');

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchBlackListDataSourceSourcetype.startSearch();
                        searchSingleBlackListDataSourceSourcetype.startSearch();
                        searchDataSourcesMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "delete blacklist sourcetype",
                            "object": tk_data_sourcetype,
                            "object_category": "data_source",
                            "object_attrs": "sourcetype:" + tk_data_sourcetype
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_data_source_blacklist_sourcetype").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "delete blacklist sourcetype",
                            "object": tk_data_sourcetype,
                            "object_category": "data_source",
                            "object_attrs": "sourcetype:" + tk_data_sourcetype,
                            "result": message
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // Hide main modal
                        $("#modal_manage_data_source_blacklist_sourcetype").modal('hide');
                        $("#modal_modify_data_source_blacklist_sourcetype").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // sourcetype blacklist

        $("#btn_modal_data_host_blacklist_sourcetype_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_sourcetype = tokens.get("tk_input_data_host_blacklist_sourcetype");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_blacklist_sourcetype";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_data_host_monitoring_blacklist_sourcetype | append [ | makeresults | eval data_sourcetype=\"" + tk_input_blacklist_sourcetype + "\", data_blacklist_state=\"true\" ] | dedup data_sourcetype | sort limit=0 data_sourcetype | outputlookup trackme_data_host_monitoring_blacklist_sourcetype";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_sourcetype && tk_input_blacklist_sourcetype.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {
                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "add blacklist sourcetype",
                                "object": tk_input_blacklist_sourcetype,
                                "object_category": "data_host",
                                "object_attrs": "sourcetype:" + tk_input_blacklist_sourcetype
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });
                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListDataHostSourcetype.startSearch();
                                    searchSingleBlackListDataHostSourcetype.startSearch();
                                    searchDataHostsMain.startSearch();

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit success change
                                    var time = (new Date).getTime();
                                    var audit_record = {
                                        "time": time,
                                        "action": "success",
                                        "user": currentUser,
                                        "change_type": "add blacklist sourcetype",
                                        "object": tk_input_blacklist_sourcetype,
                                        "object_category": "data_host",
                                        "object_attrs": "sourcetype:" + tk_input_blacklist_sourcetype
                                    };
                                    $.ajax({
                                        url: auditendpoint_URl,
                                        type: "POST",
                                        async: true,
                                        contentType: "application/json",
                                        data: JSON.stringify(audit_record),
                                        success: function(returneddata) {
                                            //console.log("Updated!", returneddata)
                                            // Run the search again to update the table
                                        }
                                    });

                                    $("#modal_modify_data_host_blacklist_sourcetype").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_delete_data_host_blacklist_sourcetype").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_host_monitoring_blacklist_sourcetype/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_data_host_blacklist_sourcetype").modal('hide');

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "delete blacklist sourcetype",
                            "object": tk_data_sourcetype,
                            "object_category": "data_host",
                            "object_attrs": "sourcetype:" + tk_data_sourcetype
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchBlackListDataHostSourcetype.startSearch();
                        searchSingleBlackListDataHostSourcetype.startSearch();
                        searchDataHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_data_host_blacklist_sourcetype").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "delete blacklist sourcetype",
                            "object": tk_data_sourcetype,
                            "object_category": "data_host",
                            "object_attrs": "sourcetype:" + tk_data_sourcetype,
                            "result": message
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // Hide main modal
                        $("#modal_manage_data_host_blacklist_sourcetype").modal('hide');
                        $("#modal_modify_data_host_blacklist_sourcetype").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // metric_category blacklist

        $("#btn_modal_metric_host_blacklist_metric_category_add").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_input_blacklist_metric_category = tokens.get("tk_input_metric_host_blacklist_metric_category");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring_blacklist_metric_category";

            //console.log("Endpoint URL is: " + myendpoint_URl);

            // Define the query
            var searchQuery = "| inputlookup trackme_metric_host_monitoring_blacklist_metric_category | append [ | makeresults | eval metric_category=\"" + tk_input_blacklist_metric_category + "\", metric_blacklist_state=\"true\" ] | dedup metric_category | sort limit=0 metric_category | outputlookup trackme_metric_host_monitoring_blacklist_metric_category";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-60m",
                latest_time: "now"
            };

            if (tk_input_blacklist_metric_category && tk_input_blacklist_metric_category.length) {

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        function audit_failure() {
                            // Audit failure change
                            var time = (new Date).getTime();
                            var audit_record = {
                                "time": time,
                                "action": "failure",
                                "user": currentUser,
                                "change_type": "add blacklist metric_category",
                                "object": tk_input_blacklist_metric_category,
                                "object_category": "metric_category",
                                "object_attrs": "metric_category:" + tk_input_blacklist_metric_category
                            };
                            $.ajax({
                                url: auditendpoint_URl,
                                type: "POST",
                                async: true,
                                contentType: "application/json",
                                data: JSON.stringify(audit_record),
                                success: function(returneddata) {
                                    //console.log("Updated!", returneddata)
                                    // Run the search again to update the table
                                }
                            });
                        }

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            audit_failure();
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    // Once the job is done, update all searches
                                    searchBlackListMetricHostMetricCategory.startSearch();
                                    searchPopulateMetricCategoriesForBlackListMetricHost.startSearch();
                                    searchMetricHostsMain.startSearch();
                                    unsetToken("form.tk_input_metric_host_blacklist_metric_category");

                                    // notify
                                    notification('Modification has been registered successfully.', 2000)

                                    // Audit success change
                                    var time = (new Date).getTime();
                                    var audit_record = {
                                        "time": time,
                                        "action": "success",
                                        "user": currentUser,
                                        "change_type": "add blacklist metric_category",
                                        "object": tk_input_blacklist_metric_category,
                                        "object_category": "metric_category",
                                        "object_attrs": "metric_category:" + tk_input_blacklist_metric_category
                                    };
                                    $.ajax({
                                        url: auditendpoint_URl,
                                        type: "POST",
                                        async: true,
                                        contentType: "application/json",
                                        data: JSON.stringify(audit_record),
                                        success: function(returneddata) {
                                            //console.log("Updated!", returneddata)
                                            // Run the search again to update the table
                                        }
                                    });

                                    $("#modal_modify_metric_host_blacklist_metric_category").modal();
                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    audit_failure();
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    audit_failure();
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

                // house cleaning
                myendpoint_URl = undefined;
                delete(myendpoint_URl);
                return;

            } else {
                $("#modal_entry_update_invalid").modal()
                return;
            }

        });

        // delete entry from blacklist

        $("#btn_delete_metric_host_blacklist_metric_category").click(function() {

            //console.log("Button was pressed");

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_keyid = tokens.get("tk_keyid");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tk_metric_category = tokens.get("tk_metric_category");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_metric_host_monitoring_blacklist_metric_category/" + tk_keyid;

            //console.log("Endpoint URL is: " + myendpoint_URl);

            if (tk_keyid && tk_keyid.length) {

                $.ajax({
                    url: myendpoint_URl,
                    type: "DELETE",
                    async: true,
                    contentType: "application/json",
                    success: function(returneddata) {

                        // Hide main modal
                        $("#modal_manage_metric_host_blacklist_metric_category").modal('hide');

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "delete blacklist metric_category",
                            "object": tk_metric_category,
                            "object_category": "metric_category",
                            "object_attrs": "metric_category:" + tk_metric_category
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchBlackListMetricHostMetricCategory.startSearch();
                        searchPopulateMetricCategoriesForBlackListMetricHost.startSearch();
                        searchMetricHostsMain.startSearch();
                        unsetToken("form.tk_input_metric_host_blacklist_metric_category");

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);

                        // Return to modal
                        $("#modal_modify_metric_host_blacklist_metric_category").modal();
                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "delete blacklist metric_category",
                            "object": tk_metric_category,
                            "object_category": "metric_category",
                            "object_attrs": "metric_category:" + tk_metric_category,
                            "result": message
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // Hide main modal
                        $("#modal_manage_metric_host_blacklist_metric_category").modal('hide');
                        $("#modal_modify_metric_host_blacklist_metric_category").modal('hide');
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }

                });

            }

        });

        // data sources monitoring

        $("#btn_modal_modify_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_manage").modal();

        });

        // data hosts monitoring

        $("#btn_modal_modify_host_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_manage_host").modal();

        });

        //
        // Custom lagging classes
        //

        $('.btn_modify_custom_lagging').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_custom_lagging", "true");
                // Show input modal
                $("#modify_custom_lagging").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_custom_lagging_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modify_custom_lagging").modal();

        });

        //
        // Metrics SLA policies in-modal editor
        //

        $('.btn_modify_metric_sla_policies').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_metric_sla_policies", "true");
                // Show input modal
                $("#modal_metric_sla_policies").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_metric_sla_policy_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_metric_sla_policies").modal();

        });

        //
        // whitelisting data source
        //

        $('.btn_modify_data_source_whitelist').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_source_whitelist", "true");
                // Show input modal
                $("#modal_modify_data_source_whitelist").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_source_whitelist_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_source_whitelist").modal();

        });

        //
        // whitelisting data host
        //

        $('.btn_modify_data_host_whitelist').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_host_whitelist", "true");
                // Show input modal
                $("#modal_modify_data_host_whitelist").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_host_whitelist_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_host_whitelist").modal();

        });

        //
        // whitelisting metric host
        //

        $('.btn_modify_metric_host_whitelist').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_metric_host_whitelist", "true");
                // Show input modal
                $("#modal_modify_metric_host_whitelist").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_metric_host_whitelist_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_metric_host_whitelist").modal();

        });

        //
        // blacklisting data source
        //

        // host blacklist

        $('.btn_modify_data_source_blacklist_host').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_source_blacklist_host", "true");
                // Show input modal
                $("#modal_modify_data_source_blacklist_host").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_source_blacklist_host_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_source_blacklist_host").modal();

        });

        // indexe blacklist

        $('.btn_modify_data_source_blacklist_index').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_source_blacklist_index", "true");
                // Show input modal
                $("#modal_modify_data_source_blacklist_index").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_source_blacklist_index_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_source_blacklist_index").modal();

        });

        // sourcetype blacklist

        $('.btn_modify_data_source_blacklist_sourcetype').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_source_blacklist_sourcetype", "true");
                // Show input modal
                $("#modal_modify_data_source_blacklist_sourcetype").modal();
            });

        });

        // blacklisting data host

        // host blacklist

        $('.btn_modify_data_host_blacklist_host').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_host_blacklist_host", "true");
                // Show input modal
                $("#modal_modify_data_host_blacklist_host").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_host_blacklist_host_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_host_blacklist_host").modal();

        });

        // indexe blacklist

        $('.btn_modify_data_host_blacklist_index').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_host_blacklist_index", "true");
                // Show input modal
                $("#modal_modify_data_host_blacklist_index").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_host_blacklist_index_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_host_blacklist_index").modal();

        });

        // sourcetype blacklist

        $('.btn_modify_data_host_blacklist_sourcetype').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_data_host_blacklist_sourcetype", "true");
                // Show input modal
                $("#modal_modify_data_host_blacklist_sourcetype").modal();
            });

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_host_blacklist_sourcetype_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_host_blacklist_sourcetype").modal();

        });

        // Return to bootstrap modal when clicking on cancel
        $("#btn_delete_data_source_blacklist_sourcetype_cancel").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_data_source_blacklist_sourcetype").modal();

        });

        // metric_host blacklist
        $('.btn_modify_metric_host_blacklist_metric_category').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("start_modify_metric_host_blacklist_metric_category", "true");
                // Show input modal
                $("#modal_modify_metric_host_blacklist_metric_category").modal();
            });

        });

        // Ops: Indexer queues
        $('.btn_ops_index_queue').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("tk_start_indexers_queues_searches", "true");

                // Show input modal
                $("#modal_queues").modal();
            });

        });

        // Unset token when bootstrap modal is closed properly
        $("#btn_ops_index_queue_close").click(function() {
            submitTokens();

            unsetToken("tk_start_indexers_queues_searches");

        });

        // Ops: Parsing issues

        $('.btn_ops_parsing_issues').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();
                setToken("tk_start_parsing_issues_searches", "true");

                // Manage search button URLs

                // Define the history search
                var search_parsing_issues_linebreaking = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + '//app/trackme/search' + "?q=search%20" + encodeURI("index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=LineBreakingProcessor")

                // Define the URL target
                document.getElementById("btn_search_parsing_issues_linebreaking").href = search_parsing_issues_linebreaking;

                // Define the history search
                var search_parsing_issues_aggregator = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + '//app/trackme/search' + "?q=search%20" + encodeURI("index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=AggregatorMiningProcessor")

                // Define the URL target
                document.getElementById("btn_search_parsing_issues_aggregator").href = search_parsing_issues_aggregator;

                // Define the history search
                var search_parsing_issues_dateparser = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + '//app/trackme/search' + "?q=search%20" + encodeURI("index=_internal sourcetype=splunkd error OR warn `trackme_idx_filter` component=DateParserVerbose")

                // Define the URL target
                document.getElementById("btn_search_parsing_issues_dateparser").href = search_parsing_issues_dateparser;

                // Show input modal
                $("#modal_parsing_issues").modal();
            });

        });

        // Unset token when bootstrap modal is closed properly
        $("#btn_ops_parsing_issues_close").click(function() {
            submitTokens();

            unsetToken("tk_start_parsing_issues_searches");

        });

        //
        // RUN TRACKERS
        //

        //
        // UPDATE COLLECTION
        //

        // Call this function when the Update collection button is clicked

        $("#btn_run_tracker").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            //console.log("Start collection update");

            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - Data sources availability short term tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-4h",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Running the data sources short term tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                // Once the job is done, update all searches
                                searchDataSourcesMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        $("#btn_run_tracker_host").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            //console.log("Start collection update");

            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - hosts availability short term tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-4h",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Running the host short term tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                // Once the job is done, update all searches
                                searchDataHostsMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        // Call this function when the Update collection button is clicked

        $("#btn_run_tracker_longterm").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");


            //console.log("Start collection update");

            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - Data sources availability long term tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-48h",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Running the data sources long term tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                // Once the job is done, update all searches
                                searchDataSourcesMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        $("#btn_run_tracker_host_longterm").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");


            //console.log("Start collection update");

            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - hosts availability long term tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-48h",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Running the host long term tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                // Once the job is done, update all searches
                                searchDataHostsMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        // metric host

        $("#btn_run_tracker_metric_host").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            //console.log("Start collection update");

            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - metric hosts availability tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-5m",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Running the metric tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                // Once the job is done, update all searches
                                searchMetricHostsMain.startSearch();

                                $("#loadingGray").remove()
                                $("#modal_update_collection_done").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        // Would be called at very first run if main page is opened before the first tracker ran

        $("#btn_modal_update_collection").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            //console.log("Start collection update");

            // Define the query
            var searchQuery = "| savedsearch \"TrackMe - Data sources availability long term tracker\"";

            // Set the search parameters--specify a time range
            var searchParams = {
                earliest_time: "-48h",
                latest_time: "now"
            };

            // Run a normal search that immediately returns the job's SID
            service.search(
                searchQuery,
                searchParams,
                function(err, job) {

                    $("#loadingGray").remove()
                    $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Running the data sources tracker...</p></div><div id="spinner"></div></div>')

                    require(["jquery",
                            "/static/app/trackme/spin.js"
                        ],
                        function($,
                            Spinner
                        ) {
                            new Spinner({
                                lines: 12,
                                position: "relative"
                            }).spin(document.getElementById('spinner'));
                        })

                    // Shall the search fail before we can get properties
                    if (job == null) {
                        let errorStr = "Unknown Error!";
                        if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                            errorStr = err.data.messages[0]['text'];
                        } else if (err && err.data && err.data.messages) {
                            errorStr = JSON.stringify(err.data.messages);
                        }
                        $("#loadingGray").remove()
                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                        $("#modal_update_collection_failure_return").modal()
                    } else {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                // Once the job is done, update all searches
                                searchDataSourcesMain.startSearch();

                                // Run second job!

                                // Define the query
                                var searchQuery = "| savedsearch \"TrackMe - hosts availability long term tracker\"";

                                // Set the search parameters--specify a time range
                                var searchParams = {
                                    earliest_time: "-48h",
                                    latest_time: "now"
                                };

                                // Run a normal search that immediately returns the job's SID
                                service.search(
                                    searchQuery,
                                    searchParams,
                                    function(err, job) {

                                        $("#loadingGray").remove()
                                        $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Running the data hosts tracker...</p></div><div id="spinner"></div></div>')

                                        require(["jquery",
                                                "/static/app/trackme/spin.js"
                                            ],
                                            function($,
                                                Spinner
                                            ) {
                                                new Spinner({
                                                    lines: 12,
                                                    position: "relative"
                                                }).spin(document.getElementById('spinner'));
                                            })

                                        // Shall the search fail before we can get properties
                                        if (job == null) {
                                            let errorStr = "Unknown Error!";
                                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                                errorStr = err.data.messages[0]['text'];
                                            } else if (err && err.data && err.data.messages) {
                                                errorStr = JSON.stringify(err.data.messages);
                                            }
                                            $("#loadingGray").remove()
                                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                            $("#modal_update_collection_failure_return").modal()
                                        } else {

                                            // Poll the status of the search job
                                            job.track({
                                                period: 200
                                            }, {
                                                done: function(job) {
                                                    //console.log("Done!");

                                                    // Once the job is done, update all searches
                                                    searchDataHostsMain.startSearch();

                                                    $("#loadingGray").remove()
                                                    $("#modal_update_collection_done").modal()

                                                },
                                                failed: function(properties) {
                                                    let errorStr = "Unknown Error!";
                                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                                        errorStr = properties._properties.messages[0]['text'];
                                                    } else if (properties && properties._properties && properties._properties.messages) {
                                                        errorStr = JSON.stringify(properties._properties.messages);
                                                    }
                                                    $("#loadingGray").remove()
                                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                                    $("#modal_update_collection_failure_return").modal()
                                                },
                                                error: function(err) {
                                                    done(err);
                                                    $("#loadingGray").remove()
                                                    $("#modal_update_collection_failure").modal()
                                                }
                                            });
                                        }
                                    }
                                );
                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure").modal()
                            }
                        });
                    }
                }
            );

        });

        // Show main

        // for data sources

        $("#btn_modify_data_source_blacklist_main").click(function() {
            // Show input modal
            $("#modal_manage_data_source_blacklists").modal();
        });

        // Cancel buttons

        $("#btn_modal_data_source_whitelist_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_source_blacklists").modal();
        });

        $("#btn_modal_data_source_blacklist_host_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_source_blacklists").modal();
        });

        $("#btn_modal_data_source_blacklist_index_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_source_blacklists").modal();
        });

        $("#btn_modal_data_source_blacklist_sourcetype_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_source_blacklists").modal();
        });

        // for data hosts

        // for data sources

        $("#btn_modify_data_host_blacklist_main").click(function() {
            // Show input modal
            $("#modal_manage_data_host_blacklists").modal();
        });

        // for metric indexes
        $("#btn_modify_metric_host_blacklist_main").click(function() {
            // Show input modal
            $("#modal_manage_metric_host_blacklists").modal();
        });

        // Cancel buttons

        $("#btn_modal_data_host_whitelist_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_host_blacklists").modal();
        });

        $("#btn_modal_data_host_blacklist_index_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_host_blacklists").modal();
        });

        $("#btn_modal_data_host_blacklist_sourcetype_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_host_blacklists").modal();
        });

        $("#btn_modal_data_host_blacklist_host_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_data_host_blacklists").modal();
        });

        $("#btn_modal_metric_host_whitelist_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_metric_host_blacklists").modal();
        });

        $("#btn_modal_metric_host_blacklist_metric_category_add_cancel").click(function() {
            // Show input modal
            $("#modal_manage_metric_host_blacklists").modal();
        });

        //
        // MODIFY BUTTON
        //

        // data source monitoring

        $("#btn_modify_data_source").click(function() {
            submitTokens();

            // Hide main modal
            $("#modal_manage").modal('hide');

            // Show input modal
            $("#modal_modify_data_source_unified").modal();

        });

        // cancel button: returns to selected
        $("#btn_close_data_source_unified").click(function() {
            submitTokens();

            // Show modal
            $("#modal_manage").modal();

        });

        $("#btn_modal_modify_wdays").click(function() {
            submitTokens();

            // Show input modal
            $("#modal_modify_monitoring_wdays").modal();

        });

        $("#btn_modal_modify_monitoring_wdays_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_last_lag_seen_idx = tokens.get("tk_data_last_lag_seen_idx");
            var tk_data_last_time_seen_idx = tokens.get("tk_data_last_time_seen_idx");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_monitoring_level = tokens.get("tk_data_monitoring_level");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_source_state = tokens.get("tk_data_source_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_source_state = tokens.get("tk_data_previous_source_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_priority = tokens.get("tk_priority");

            //console.log("Value of modal_input_grace_period is: " + tk_kafka_infra_grace_period);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring/" + tk_keyid;

            var tk_origin_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitoring_wdays = tokens.get("tk_input_wdays");

            if (!tk_data_monitoring_wdays || !tk_data_monitoring_wdays.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "data_name": tk_data_name,
                    "data_index": tk_data_index,
                    "data_sourcetype": tk_data_sourcetype,
                    "data_last_lag_seen": tk_data_last_lag_seen,
                    "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                    "data_eventcount": tk_data_eventcount,
                    "data_first_time_seen": tk_data_first_time_seen,
                    "data_last_time_seen": tk_data_last_time_seen,
                    "data_last_ingest": tk_data_last_ingest,
                    "data_last_lag_seen_idx": tk_data_last_lag_seen_idx,
                    "data_last_time_seen_idx": tk_data_last_time_seen_idx,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_monitored_state": tk_data_monitored_state,
                    "data_monitoring_level": tk_data_monitoring_level,
                    "data_monitoring_wdays": tk_data_monitoring_wdays,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "data_source_state": tk_data_source_state,
                    "data_tracker_runtime": tk_data_tracker_runtime,
                    "data_previous_source_state": tk_data_previous_source_state,
                    "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                    "priority": tk_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchDataSourcesMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "modify week days monitoring",
                            "object": tk_data_name,
                            "object_category": "data_source",
                            "object_attrs": "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays
                        };

                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);

                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "modify week days monitoring",
                            "object": tk_data_name,
                            "object_category": "data_source",
                            "object_attrs": "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays,
                            "result": message
                        };

                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }

        });

        // priority
        $("#btn_modal_modify_priority_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_last_lag_seen_idx = tokens.get("tk_data_last_lag_seen_idx");
            var tk_data_last_time_seen_idx = tokens.get("tk_data_last_time_seen_idx");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_monitoring_level = tokens.get("tk_data_monitoring_level");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_source_state = tokens.get("tk_data_source_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_source_state = tokens.get("tk_data_previous_source_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_priority = tokens.get("tk_priority");

            //console.log("Value of modal_input_grace_period is: " + tk_kafka_infra_grace_period);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring/" + tk_keyid;

            var tk_origin_priority = tk_priority;
            var tk_new_priority = tokens.get("tk_input_priority");

            if (!tk_new_priority || !tk_new_priority.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "data_name": tk_data_name,
                    "data_index": tk_data_index,
                    "data_sourcetype": tk_data_sourcetype,
                    "data_last_lag_seen": tk_data_last_lag_seen,
                    "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                    "data_eventcount": tk_data_eventcount,
                    "data_first_time_seen": tk_data_first_time_seen,
                    "data_last_time_seen": tk_data_last_time_seen,
                    "data_last_ingest": tk_data_last_ingest,
                    "data_last_lag_seen_idx": tk_data_last_lag_seen_idx,
                    "data_last_time_seen_idx": tk_data_last_time_seen_idx,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_monitored_state": tk_data_monitored_state,
                    "data_monitoring_level": tk_data_monitoring_level,
                    "data_monitoring_wdays": tk_data_monitoring_wdays,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "data_source_state": tk_data_source_state,
                    "data_tracker_runtime": tk_data_tracker_runtime,
                    "data_previous_source_state": tk_data_previous_source_state,
                    "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                    "priority": tk_new_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchDataSourcesMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "modify priority",
                            "object": tk_data_name,
                            "object_category": "data_source",
                            "object_attrs": "priority changed from:" + tk_origin_priority + " to:" + tk_new_priority
                        };

                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);

                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "modify priority",
                            "object": tk_data_name,
                            "object_category": "data_source",
                            "object_attrs": "priority changed from:" + tk_origin_priority + " to:" + tk_new_priority,
                            "result": message
                        };

                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }

        });

        $("#btn_modal_modify_wdays_no").click(function() {

            // Show input modal
            $("#modal_modify_monitoring_wdays_no").modal();

        });

        $("#btn_modal_modify_monitoring_wdays_no_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_last_lag_seen_idx = tokens.get("tk_data_last_lag_seen_idx");
            var tk_data_last_time_seen_idx = tokens.get("tk_data_last_time_seen_idx");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_monitoring_level = tokens.get("tk_data_monitoring_level");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_source_state = tokens.get("tk_data_source_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_source_state = tokens.get("tk_data_previous_source_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_priority = tokens.get("tk_priority");

            //console.log("Value of modal_input_grace_period is: " + tk_kafka_infra_grace_period);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring/" + tk_keyid;

            var tk_origin_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitoring_wdays_no = tokens.get("tk_input_wdays_no");

            if (!tk_data_monitoring_wdays_no || !tk_data_monitoring_wdays_no.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "data_name": tk_data_name,
                    "data_index": tk_data_index,
                    "data_sourcetype": tk_data_sourcetype,
                    "data_last_lag_seen": tk_data_last_lag_seen,
                    "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                    "data_eventcount": tk_data_eventcount,
                    "data_first_time_seen": tk_data_first_time_seen,
                    "data_last_time_seen": tk_data_last_time_seen,
                    "data_last_ingest": tk_data_last_ingest,
                    "data_last_lag_seen_idx": tk_data_last_lag_seen_idx,
                    "data_last_time_seen_idx": tk_data_last_time_seen_idx,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_monitored_state": tk_data_monitored_state,
                    "data_monitoring_level": tk_data_monitoring_level,
                    "data_monitoring_wdays": tk_data_monitoring_wdays_no,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "data_source_state": tk_data_source_state,
                    "data_tracker_runtime": tk_data_tracker_runtime,
                    "data_previous_source_state": tk_data_previous_source_state,
                    "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                    "priority": tk_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchDataSourcesMain.startSearch();

                        $("#modal_modify_data_source_unified").modal();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "modify week days monitoring",
                            "object": tk_data_name,
                            "object_category": "data_source",
                            "object_attrs": "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays_no
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "modify week days monitoring",
                            "object": tk_data_name,
                            "object_category": "data_source",
                            "object_attrs": "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays_no,
                            "result": message
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        // cancel: returns to unified modal
        $("#btn_modal_modify_monitoring_wdays_no_cancel").click(function() {

            // Show input modal
            $("#modal_modify_data_source_unified").modal();

        });

        //
        // Modify monitoring level
        //

        $("#btn_modal_modify_level").click(function() {

            // Show input modal
            $("#modal_modify_monitoring_level").modal();

        });

        $("#btn_modal_modify_monitoring_level_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_last_lag_seen_idx = tokens.get("tk_data_last_lag_seen_idx");
            var tk_data_last_time_seen_idx = tokens.get("tk_data_last_time_seen_idx");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_monitoring_level = tokens.get("tk_data_monitoring_level");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_source_state = tokens.get("tk_data_source_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_source_state = tokens.get("tk_data_previous_source_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_priority = tokens.get("tk_priority");

            //console.log("Value of modal_input_grace_period is: " + tk_kafka_infra_grace_period);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring/" + tk_keyid;

            var tk_data_monitoring_level = tokens.get("tk_input_level");
            var tk_origin_data_monitoring_level = tokens.get("tk_data_monitoring_level");

            if (!tk_data_monitoring_level || !tk_data_monitoring_level.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "data_name": tk_data_name,
                    "data_index": tk_data_index,
                    "data_sourcetype": tk_data_sourcetype,
                    "data_last_lag_seen": tk_data_last_lag_seen,
                    "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                    "data_eventcount": tk_data_eventcount,
                    "data_first_time_seen": tk_data_first_time_seen,
                    "data_last_time_seen": tk_data_last_time_seen,
                    "data_last_ingest": tk_data_last_ingest,
                    "data_last_lag_seen_idx": tk_data_last_lag_seen_idx,
                    "data_last_time_seen_idx": tk_data_last_time_seen_idx,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_monitored_state": tk_data_monitored_state,
                    "data_monitoring_level": tk_data_monitoring_level,
                    "data_monitoring_wdays": tk_data_monitoring_wdays,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "data_source_state": tk_data_source_state,
                    "data_tracker_runtime": tk_data_tracker_runtime,
                    "data_previous_source_state": tk_data_previous_source_state,
                    "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                    "priority": tk_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchDataSourcesMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "modify monitoring level",
                            "object": tk_data_name,
                            "object_category": "data_source",
                            "object_attrs": "data_monitoring_level changed from:" + tk_origin_data_monitoring_level + " to:" + tk_data_monitoring_level
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "modify monitoring level",
                            "object": tk_data_name,
                            "object_category": "data_source",
                            "object_attrs": "data_monitoring_level changed from:" + tk_origin_data_monitoring_level + " to:" + tk_data_monitoring_level,
                            "result": message
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        //
        // Modify lag
        //

        $("#btn_modal_modify_lag").click(function() {

            // Show input modal
            $("#modal_modify_lag").modal();

        });

        $("#btn_modal_modify_lag_confirm").click(function() {

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_name = tokens.get("tk_data_name");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_last_ingestion_lag_seen = tokens.get("tk_data_last_ingestion_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_last_lag_seen_idx = tokens.get("tk_data_last_lag_seen_idx");
            var tk_data_last_time_seen_idx = tokens.get("tk_data_last_time_seen_idx");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_monitoring_level = tokens.get("tk_data_monitoring_level");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_source_state = tokens.get("tk_data_source_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_source_state = tokens.get("tk_data_previous_source_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_priority = tokens.get("tk_priority");

            //console.log("Value of modal_input_grace_period is: " + tk_kafka_infra_grace_period);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_data_source_monitoring/" + tk_keyid;

            var tk_data_max_lag_allowed = tokens.get("tk_input_lag");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class");

            if (!tk_data_max_lag_allowed || !tk_data_max_lag_allowed.length || !isNumeric(tk_data_max_lag_allowed)) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "data_name": tk_data_name,
                    "data_index": tk_data_index,
                    "data_sourcetype": tk_data_sourcetype,
                    "data_last_lag_seen": tk_data_last_lag_seen,
                    "data_last_ingestion_lag_seen": tk_data_last_ingestion_lag_seen,
                    "data_eventcount": tk_data_eventcount,
                    "data_first_time_seen": tk_data_first_time_seen,
                    "data_last_time_seen": tk_data_last_time_seen,
                    "data_last_ingest": tk_data_last_ingest,
                    "data_last_lag_seen_idx": tk_data_last_lag_seen_idx,
                    "data_last_time_seen_idx": tk_data_last_time_seen_idx,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_monitored_state": tk_data_monitored_state,
                    "data_monitoring_level": tk_data_monitoring_level,
                    "data_monitoring_wdays": tk_data_monitoring_wdays,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "data_source_state": tk_data_source_state,
                    "data_tracker_runtime": tk_data_tracker_runtime,
                    "data_previous_source_state": tk_data_previous_source_state,
                    "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                    "priority": tk_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchDataSourcesMain.startSearch();
                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "modify monitoring lag",
                            "object": tk_data_name,
                            "object_category": "data_source",
                            "object_attrs": "data_max_lag_allowed changed from:" + tk_origin_data_max_lag_allowed + " to:" + tk_data_max_lag_allowed + " with data_override_lagging_class:" + tk_data_override_lagging_class
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "modify monitoring lag",
                            "object": tk_data_name,
                            "object_category": "data_source",
                            "object_attrs": "data_max_lag_allowed changed from:" + tk_origin_data_max_lag_allowed + " to:" + tk_data_max_lag_allowed + " with data_override_lagging_class:" + tk_data_override_lagging_class,
                            "result": message
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        // metric host monitoring

        $("#btn_modify_metric_host").click(function() {

            // Hide main modal
            $("#modal_manage_metrichost").modal('hide');

            // Show input modal
            $("#modal_modify_metric_host_unified").modal();

        });

        // data host monitoring

        $("#btn_modify_data_host").click(function() {

            // Hide main modal
            $("#modal_manage_host").modal('hide');

            // Show input modal
            $("#modal_modify_data_host_unified").modal();

        });

        // cancel button: returns to selected
        $("#btn_close_data_host_unified").click(function() {
            submitTokens();

            // Show modal
            $("#modal_manage_host").modal();

        });

        //
        // Modify monitoring wdays
        //

        $("#btn_modal_modify_wdays_host").click(function() {

            // Show input modal
            $("#modal_modify_monitoring_wdays_host").modal();

        });

        $("#btn_modal_modify_monitoring_wdays_host_confirm").click(function() {

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_host_state = tokens.get("tk_data_host_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_host_state = tokens.get("tk_data_previous_host_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_priority = tokens.get("tk_priority");

            //console.log("Value of modal_input_grace_period is: " + tk_kafka_infra_grace_period);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_host_monitoring/" + tk_keyid;

            var tk_origin_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitoring_wdays = tokens.get("tk_input_wdays_host");

            if (!tk_data_monitoring_wdays || !tk_data_monitoring_wdays.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "data_host": tk_data_host,
                    "data_index": tk_data_index,
                    "data_sourcetype": tk_data_sourcetype,
                    "data_last_lag_seen": tk_data_last_lag_seen,
                    "data_eventcount": tk_data_eventcount,
                    "data_first_time_seen": tk_data_first_time_seen,
                    "data_last_time_seen": tk_data_last_time_seen,
                    "data_last_ingest": tk_data_last_ingest,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_monitored_state": tk_data_monitored_state,
                    "data_monitoring_wdays": tk_data_monitoring_wdays,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "data_host_state": tk_data_host_state,
                    "data_tracker_runtime": tk_data_tracker_runtime,
                    "data_previous_host_state": tk_data_previous_host_state,
                    "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                    "priority": tk_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchDataHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "modify week days monitoring",
                            "object": tk_data_host,
                            "object_category": "data_host",
                            "object_attrs": "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays
                        };

                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "modify week days monitoring",
                            "object": tk_data_host,
                            "object_category": "data_host",
                            "object_attrs": "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays,
                            "result": message
                        };

                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        // host priority
        $("#btn_modal_modify_priority_host_confirm").click(function() {

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_host_state = tokens.get("tk_data_host_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_host_state = tokens.get("tk_data_previous_host_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_priority = tokens.get("tk_priority");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_host_monitoring/" + tk_keyid;

            var tk_origin_priority = tk_priority;
            var tk_new_priority = tokens.get("tk_input_host_priority");

            if (!tk_new_priority || !tk_new_priority.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "data_host": tk_data_host,
                    "data_index": tk_data_index,
                    "data_sourcetype": tk_data_sourcetype,
                    "data_last_lag_seen": tk_data_last_lag_seen,
                    "data_eventcount": tk_data_eventcount,
                    "data_first_time_seen": tk_data_first_time_seen,
                    "data_last_time_seen": tk_data_last_time_seen,
                    "data_last_ingest": tk_data_last_ingest,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_monitored_state": tk_data_monitored_state,
                    "data_monitoring_wdays": tk_data_monitoring_wdays,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "data_host_state": tk_data_host_state,
                    "data_tracker_runtime": tk_data_tracker_runtime,
                    "data_previous_host_state": tk_data_previous_host_state,
                    "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                    "priority": tk_new_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchDataHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "modify priority",
                            "object": tk_data_host,
                            "object_category": "data_host",
                            "object_attrs": "priority changed from:" + tk_origin_priority + " to:" + tk_new_priority
                        };

                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "modify priority",
                            "object": tk_data_host,
                            "object_category": "data_host",
                            "object_attrs": "priority changed from:" + tk_origin_priority + " to:" + tk_new_priority,
                            "result": message
                        };

                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        $("#btn_modal_modify_wdays_host_no").click(function() {

            // Show input modal
            $("#modal_modify_monitoring_wdays_host_no").modal();

        });

        // Week days

        $("#btn_modal_modify_monitoring_wdays_host_no_confirm").click(function() {

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_host_state = tokens.get("tk_data_host_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_host_state = tokens.get("tk_data_previous_host_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_priority = tokens.get("tk_priority");

            //console.log("Value of modal_input_grace_period is: " + tk_kafka_infra_grace_period);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_host_monitoring/" + tk_keyid;

            var tk_origin_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitoring_wdays_no = tokens.get("tk_input_wdays_host_no");

            if (!tk_data_monitoring_wdays_no || !tk_data_monitoring_wdays_no.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "data_host": tk_data_host,
                    "data_index": tk_data_index,
                    "data_sourcetype": tk_data_sourcetype,
                    "data_last_lag_seen": tk_data_last_lag_seen,
                    "data_eventcount": tk_data_eventcount,
                    "data_first_time_seen": tk_data_first_time_seen,
                    "data_last_time_seen": tk_data_last_time_seen,
                    "data_last_ingest": tk_data_last_ingest,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_monitored_state": tk_data_monitored_state,
                    "data_monitoring_wdays": tk_data_monitoring_wdays_no,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "data_host_state": tk_data_host_state,
                    "data_tracker_runtime": tk_data_tracker_runtime,
                    "data_previous_host_state": tk_data_previous_host_state,
                    "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                    "priority": tk_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchDataHostsMain.startSearch();

                        $("#modal_modify_data_source_unified").modal();

                        // notify
                        //console.log("Notify")
                        notification('Modification has been registered successfully.', 2000)

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "modify week days monitoring",
                            "object": tk_data_host,
                            "object_category": "data_host",
                            "object_attrs": "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays_no
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "modify week days monitoring",
                            "object": tk_data_host,
                            "object_category": "data_host",
                            "object_attrs": "data_monitoring_wdays changed from:" + tk_origin_data_monitoring_wdays + " to:" + tk_data_monitoring_wdays_no,
                            "result": message
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        // cancel: returns to unified modal
        $("#btn_modal_modify_monitoring_wdays_host_no_cancel").click(function() {

            // Show input modal
            $("#modal_modify_data_host_unified").modal();

        });

        //
        // data source id
        //


        //
        // Modify lag
        //

        $("#btn_modal_modify_lag_host").click(function() {

            // Show input modal
            $("#modal_modify_lag_host").modal();

        });

        $("#btn_modal_modify_lag_confirm_host").click(function() {

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var tk_keyid = tokens.get("tk_keyid");
            var tk_data_host = tokens.get("tk_data_host");
            var tk_data_index = tokens.get("tk_data_index");
            var tk_data_sourcetype = tokens.get("tk_data_sourcetype");
            var tk_data_last_lag_seen = tokens.get("tk_data_last_lag_seen");
            var tk_data_eventcount = tokens.get("tk_data_eventcount");
            var tk_data_first_time_seen = tokens.get("tk_data_first_time_seen");
            var tk_data_last_time_seen = tokens.get("tk_data_last_time_seen");
            var tk_data_last_ingest = tokens.get("tk_data_last_ingest");
            var tk_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_monitoring_wdays = tokens.get("tk_data_monitoring_wdays");
            var tk_data_monitored_state = tokens.get("tk_data_monitored_state");
            var tk_data_override_lagging_class = tokens.get("tk_data_override_lagging_class");
            var tk_data_host_state = tokens.get("tk_data_host_state");
            var tk_data_tracker_runtime = tokens.get("tk_data_tracker_runtime");
            var tk_data_previous_host_state = tokens.get("tk_data_previous_host_state");
            var tk_data_previous_tracker_runtime = tokens.get("tk_data_previous_tracker_runtime");
            var tk_priority = tokens.get("tk_priority");

            //console.log("Value of modal_input_grace_period is: " + tk_kafka_infra_grace_period);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/trackme/storage/collections/data/kv_trackme_host_monitoring/" + tk_keyid;

            var tk_data_max_lag_allowed = tokens.get("tk_input_lag_host");
            var tk_origin_data_max_lag_allowed = tokens.get("tk_data_max_lag_allowed");
            var tk_data_override_lagging_class = tokens.get("modal_input_lag_override_class_host");

            if (!tk_data_max_lag_allowed || !tk_data_max_lag_allowed.length || !isNumeric(tk_data_max_lag_allowed)) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                // Create a dictionary to store the field names and values
                var record = {
                    "data_host": tk_data_host,
                    "data_index": tk_data_index,
                    "data_sourcetype": tk_data_sourcetype,
                    "data_last_lag_seen": tk_data_last_lag_seen,
                    "data_eventcount": tk_data_eventcount,
                    "data_first_time_seen": tk_data_first_time_seen,
                    "data_last_time_seen": tk_data_last_time_seen,
                    "data_last_ingest": tk_data_last_ingest,
                    "data_max_lag_allowed": tk_data_max_lag_allowed,
                    "data_monitored_state": tk_data_monitored_state,
                    "data_monitoring_wdays": tk_data_monitoring_wdays,
                    "data_override_lagging_class": tk_data_override_lagging_class,
                    "data_host_state": tk_data_host_state,
                    "data_tracker_runtime": tk_data_tracker_runtime,
                    "data_previous_host_state": tk_data_previous_host_state,
                    "data_previous_tracker_runtime": tk_data_previous_tracker_runtime,
                    "priority": tk_priority
                };

                $.ajax({
                    url: myendpoint_URl,
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(record),
                    success: function(returneddata) {
                        //console.log("Updated!", returneddata)
                        // Run the search again to update the table
                        searchDataHostsMain.startSearch();

                        // notify
                        notification('Modification has been registered successfully.', 2000)

                        // Audit success change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "success",
                            "user": currentUser,
                            "change_type": "modify monitoring lag",
                            "object": tk_data_host,
                            "object_category": "data_source",
                            "object_attrs": "data_max_lag_allowed changed from:" + tk_origin_data_max_lag_allowed + " to:" + tk_data_max_lag_allowed + " with data_override_lagging_class:" + tk_data_override_lagging_class
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        // house cleaning
                        myendpoint_URl = undefined;
                        delete(myendpoint_URl);
                        tk_keyid = undefined;
                        delete(tk_keyid);
                        return;

                    },
                    error: function(xhr, textStatus, error) {
                        message = "Error Updating!" + xhr + textStatus + error;

                        // Audit failure change
                        var time = (new Date).getTime();
                        var audit_record = {
                            "time": time,
                            "action": "failure",
                            "user": currentUser,
                            "change_type": "modify monitoring lag",
                            "object": tk_data_host,
                            "object_category": "data_source",
                            "object_attrs": "data_max_lag_allowed changed from:" + tk_origin_data_max_lag_allowed + " to:" + tk_data_max_lag_allowed + " with data_override_lagging_class:" + tk_data_override_lagging_class,
                            "result": message
                        };
                        $.ajax({
                            url: auditendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(audit_record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                            }
                        });

                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                        $("#modal_update_collection_failure_return").modal()
                    }
                });

            }
        });

        // data source identity documentation

        // back button
        $("#btn_back_manage_identity_card").click(function() {
            // Show input modal
            $("#modal_manage").modal();
        });

        $("#btn_close_define_identity_card").click(function() {
            // Show input modal
            $("#modal_manage").modal();
        });

        // update button
        $("#btn_modify_manage_identity_card").click(function() {
            // Show input modal
            $("#define_identity_card").modal();
        });

        // delete button
        $("#btn_delete_manage_identity_card").click(function() {
            // Show deletion modal
            $("#delete_identity_card").modal();
        });

        // identity card

        $('.btn_define_identity_card').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // Retrieve input values

                var input_doc_object = tokens.get("tk_data_name");
                var input_doc_note = document.getElementById("input_doc_note").value;
                var input_doc_link = document.getElementById("input_doc_link").value;

                //console.log("link is: " + input_doc_link);
                //console.log("note is: " + input_doc_note);

                // Define the query
                var searchQuery = "| inputlookup trackme_sources_knowledge | where object!=\"" + input_doc_object + "\" | append [ | makeresults | eval object=\"" + input_doc_object + "\", doc_link=\"" +  input_doc_link + "\", doc_note=\"" +  input_doc_note + "\" ] | dedup object | sort limit=0 object | outputlookup trackme_sources_knowledge";

                //console.log(searchQuery);

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                if (input_doc_link === "link to documentation" && input_doc_note === "documentation note") {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

                else if (input_doc_link && input_doc_link.length) {

                    // Run a blocking search and get back a job
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            function audit_failure() {

                                // Audit failure change
                                var time = (new Date).getTime();
                                var audit_record = {
                                    "time": time,
                                    "action": "failure",
                                    "user": currentUser,
                                    "change_type": "create or update identity card",
                                    "object": input_doc_object,
                                    "object_category": "data_source",
                                    "object_attrs": "object:" + input_doc_object + ", doc_link:" + input_doc_link + ", doc_note:" + input_doc_note
                                };
                                $.ajax({
                                    url: auditendpoint_URl,
                                    type: "POST",
                                    async: true,
                                    contentType: "application/json",
                                    data: JSON.stringify(audit_record),
                                    success: function(returneddata) {
                                        //console.log("Updated!", returneddata)
                                        // Run the search again to update the table
                                        searchDataSourcesMain.startSearch();
                                    }
                                });

                            }

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {
                                        // Run the search again to update the table
                                        searchDataSourcesMain.startSearch();
                                        $("#update_achieved_identity_card").modal()

                                        // Audit success change
                                        var time = (new Date).getTime();
                                        var audit_record = {
                                            "time": time,
                                            "action": "success",
                                            "user": currentUser,
                                            "change_type": "create or update identity card",
                                            "object": input_doc_object,
                                            "object_category": "data_source",
                                            "object_attrs": "object:" + input_doc_object + ", doc_link:" + input_doc_link + ", doc_note:" + input_doc_note
                                        };
                                        $.ajax({
                                            url: auditendpoint_URl,
                                            type: "POST",
                                            async: true,
                                            contentType: "application/json",
                                            data: JSON.stringify(audit_record),
                                            success: function(returneddata) {
                                            }
                                        });

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        audit_failure();
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        audit_failure();
                                        $("#modal_update_collection_failure_flush").modal()
                                    }
                                });

                            }

                        }
                    );

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

            });

        });

        // back
        $("#btn_define_identity_card_back").click(function() {
            // Show modal
            $("#modal_manage").modal();
        });

        // delete button
        $("#btn_delete_identity_card_confirm").click(function() {

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // Retrieve input values

                var input_doc_object = tokens.get("tk_data_name");
                var input_doc_note = document.getElementById("input_doc_note").value;
                var input_doc_link = document.getElementById("input_doc_link").value;

                //console.log("link is: " + input_doc_link);
                //console.log("note is: " + input_doc_note);

                // Define the query
                var searchQuery = "| inputlookup trackme_sources_knowledge | eval keyid=_key | mvexpand object | where object!=\"" + input_doc_object + "\" | stats values(*) as \"*\" by keyid | sort limit=0 keyid | fields - keyid | outputlookup trackme_sources_knowledge";

                //console.log(searchQuery);

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                if (input_doc_link && input_doc_link.length) {

                    // Run a blocking search and get back a job
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            function audit_failure() {

                                // Audit failure change
                                var time = (new Date).getTime();
                                var audit_record = {
                                    "time": time,
                                    "action": "failure",
                                    "user": currentUser,
                                    "change_type": "delete identity card",
                                    "object": input_doc_object,
                                    "object_category": "data_source",
                                    "object_attrs": "object:" + input_doc_object + ", doc_link:" + input_doc_link + ", doc_note:" + input_doc_note
                                };
                                $.ajax({
                                    url: auditendpoint_URl,
                                    type: "POST",
                                    async: true,
                                    contentType: "application/json",
                                    data: JSON.stringify(audit_record),
                                    success: function(returneddata) {
                                        //console.log("Updated!", returneddata)
                                        // Run the search again to update the table
                                        searchDataSourcesMain.startSearch();
                                    }
                                });

                            }

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {
                                        // Run the search again to update the table
                                        searchDataSourcesMain.startSearch();
                                        // show deleted modal
                                        $("#delete_achieved_identity_card").modal()

                                        // Audit success change
                                        var time = (new Date).getTime();
                                        var audit_record = {
                                            "time": time,
                                            "action": "success",
                                            "user": currentUser,
                                            "change_type": "delete identity card",
                                            "object": input_doc_object,
                                            "object_category": "data_source",
                                            "object_attrs": "object:" + input_doc_object + ", doc_link:" + input_doc_link + ", doc_note:" + input_doc_note
                                        };
                                        $.ajax({
                                            url: auditendpoint_URl,
                                            type: "POST",
                                            async: true,
                                            contentType: "application/json",
                                            data: JSON.stringify(audit_record),
                                            success: function(returneddata) {
                                            }
                                        });

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        audit_failure();
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        audit_failure();
                                        $("#modal_update_collection_failure_flush").modal()
                                    }
                                });

                            }

                        }
                    );

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

        });

        // back button
        $("#btn_delete_identity_card_back").click(function() {
            // Show modal
            $("#define_identity_card").modal();
        });

        // associate identity card button

        $('.btn_associate_identity_card').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // if the token exists already, restart the search, otherwise allow the search to start
                var tk_start_associate_identity_card = tokens.get("tk_start_associate_identity_card");

                if (tk_start_associate_identity_card && tk_start_associate_identity_card.length) {
                    searchIdentityCardTable.startSearch();
                } else
                {
                    setToken("tk_start_associate_identity_card", "true");
                }

                // Show modal
                $("#associate_identity_card").modal();

            });

        });

        // confirm button
        $("#btn_associate_identity_card_confirm_valid").click(function() {

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // Retrieve input values

                var input_doc_keyid = tokens.get("tk_keyid");
                var input_doc_new_object = tokens.get("tk_data_name");
                var input_doc_origin_object = tokens.get("tk_object");
                var input_doc_link = tokens.get("tk_doc_link");
                var input_doc_note = tokens.get("tk_doc_note");

                //console.log("key is: " + input_doc_keyid);
                //console.log("new_object is: " + input_doc_new_object);
                //console.log("origin_object is: " + input_doc_origin_object);

                // Define the query
                var searchQuery = "| inputlookup trackme_sources_knowledge | eval keyid=_key | mvexpand object | append [ | makeresults | eval keyid=\"" + input_doc_keyid + "\", object=\"" + input_doc_new_object + "\" ] | stats values(*) as \"*\" by keyid | outputlookup append=t trackme_sources_knowledge key_field=keyid";

                //console.log(searchQuery);

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                if (input_doc_keyid && input_doc_keyid.length) {

                    // Run a blocking search and get back a job
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            function audit_failure() {

                                // Audit failure change
                                var time = (new Date).getTime();
                                var audit_record = {
                                    "time": time,
                                    "action": "failure",
                                    "user": currentUser,
                                    "change_type": "associate identity card",
                                    "object": input_doc_new_object,
                                    "object_category": "data_source",
                                    "object_attrs": "object:" + input_doc_new_object + " was associated with identity card keyid: " + input_doc_keyid + ", doc_link:" + input_doc_link + ", doc_note:" + input_doc_note
                                };
                                $.ajax({
                                    url: auditendpoint_URl,
                                    type: "POST",
                                    async: true,
                                    contentType: "application/json",
                                    data: JSON.stringify(audit_record),
                                    success: function(returneddata) {
                                        //console.log("Updated!", returneddata)
                                        // Run the search again to update the table
                                        searchDataSourcesMain.startSearch();
                                    }
                                });

                            }

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {
                                        // Run the search again to update the table
                                        searchDataSourcesMain.startSearch();
                                        // show deleted modal
                                        $("#associate_achieved_identity_card").modal()

                                        // Audit success change
                                        var time = (new Date).getTime();
                                        var audit_record = {
                                            "time": time,
                                            "action": "success",
                                            "user": currentUser,
                                            "change_type": "associate identity card",
                                            "object": input_doc_new_object,
                                            "object_category": "data_source",
                                            "object_attrs": "object:" + input_doc_new_object + " was associated with identity card keyid: " + input_doc_keyid + ", doc_link:" + input_doc_link + ", doc_note:" + input_doc_note
                                        };
                                        $.ajax({
                                            url: auditendpoint_URl,
                                            type: "POST",
                                            async: true,
                                            contentType: "application/json",
                                            data: JSON.stringify(audit_record),
                                            success: function(returneddata) {
                                            }
                                        });

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        audit_failure();
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        audit_failure();
                                        $("#modal_update_collection_failure_flush").modal()
                                    }
                                });

                            }

                        }
                    );

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

        });

        // back button
        $("#btn_associate_identity_card_back").click(function() {
            // Show modal
            $("#define_identity_card").modal();
        });

        // back button
        $("#btn_associate_identity_card_confirm_back").click(function() {
            // Show modal
            $("#associate_identity_card").modal();
        });

        // Acknowledgment

        $('.btn_ack').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_name = tokens.get("tk_data_name");
                var tk_data_host = tokens.get("tk_data_host");
                var tk_metric_host = tokens.get("tk_metric_host");

                //console.log("tk_data_name is " + tk_data_name);
                //console.log("tk_data_host is " + tk_data_host);
                //console.log("tk_metric_host is " + tk_metric_host);

                if (tk_data_name !== undefined) {
                    setToken("input_object", tk_data_name);
                    setToken("input_object_category", "data_source");
                } else if (tk_data_host !== undefined) {
                    setToken("input_object", tk_data_host);
                    setToken("input_object_category", "data_host");
                } else if (tk_metric_host !== undefined) {
                    setToken("input_object", tk_metric_host);
                    setToken("input_object_category", "metric_host");
                }

                var input_object = tokens.get("input_object");
                var input_object_category = tokens.get("input_object_category");

                //console.log("input_object is: " + input_object);
                //console.log("input_object_category is: " + input_object_category);

                // if the token exists already, restart the search, otherwise allow the search to start
                var tk_start_ack_get = tokens.get("tk_start_ack_get");

                if (tk_start_ack_get && tk_start_ack_get.length) {
                    searchAckGet.startSearch();
                } else
                {
                    setToken("tk_start_ack_get", "true");
                }

                // Show modal
                $("#confirm_ack").modal();

            });

        });

        // Add ack

        $('.btn_ack_confirm_valid').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // Retrieve input values

                var input_object = tokens.get("input_object");
                var input_object_category = tokens.get("input_object_category");
                var input_ack_duration = tokens.get("input_ack_duration");

                //console.log("input_object is: " + input_object);
                //console.log("input_object_category is: " + input_object_category);
                //console.log("input_ack_duration is: "+ input_ack_duration);

                // Define the query
                var searchQuery = "| `trackme_ack_add(\"" + input_object + "\", \"" +  input_object_category + "\", \"" +  input_ack_duration + "\")`";

                //console.log(searchQuery);

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                if (input_object && input_object.length && input_ack_duration && input_ack_duration.length) {

                    // Run a blocking search and get back a job
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            function audit_failure() {

                                // Audit failure change
                                var time = (new Date).getTime();
                                var audit_record = {
                                    "time": time,
                                    "action": "failure",
                                    "user": currentUser,
                                    "change_type": "ack enable",
                                    "object": input_object,
                                    "object_category": input_object_category,
                                    "object_attrs": "object:" + input_object + " has been acknowledged for a period of " + input_ack_duration + " seconds, no more alerts will be generated until the acknowledge is expired."
                                };
                                $.ajax({
                                    url: auditendpoint_URl,
                                    type: "POST",
                                    async: true,
                                    contentType: "application/json",
                                    data: JSON.stringify(audit_record),
                                    success: function(returneddata) {
                                        //console.log("Updated!", returneddata)
                                    }
                                });

                            }

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {
                                        // show deleted modal
                                        $("#ack_achieved").modal()

                                        // Audit success change
                                        var time = (new Date).getTime();
                                        var audit_record = {
		                                    "time": time,
		                                    "action": "success",
		                                    "user": currentUser,
		                                    "change_type": "ack enable",
		                                    "object": input_object,
		                                    "object_category": input_object_category,
		                                    "object_attrs": "object:" + input_object + " has been acknowledged for a period of " + input_ack_duration + " seconds, no more alerts will be generated until the acknowledge is expired."
                                        };
                                        $.ajax({
                                            url: auditendpoint_URl,
                                            type: "POST",
                                            async: true,
                                            contentType: "application/json",
                                            data: JSON.stringify(audit_record),
                                            success: function(returneddata) {
                                            }
                                        });

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        audit_failure();
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        audit_failure();
                                        $("#modal_update_collection_failure_flush").modal()
                                    }
                                });

                            }

                        }
                    );

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

            });

        });

        // Disable ack

        $('.btn_ack_disable_valid').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // Retrieve input values

                var keyid = tokens.get("keyid");
                var input_object = tokens.get("input_object");
                var input_object_category = tokens.get("input_object_category");
                var ack_expiration = tokens.get("ack_expiration");
                var ack_state = tokens.get("ack_state");

                // Define the query
                var searchQuery = "| `trackme_ack_disable(\"" + keyid + "\")`";

                //console.log(keyid);
                //console.log(searchQuery);

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                if (ack_state === "inactive") {
                    // show modal
                    $("#ack_disable_already").modal()
                }

                else if (input_object && input_object.length) {

                    // Run a blocking search and get back a job
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            function audit_failure() {

                                // Audit failure change
                                var time = (new Date).getTime();
                                var audit_record = {
                                    "time": time,
                                    "action": "failure",
                                    "user": currentUser,
                                    "change_type": "ack disable",
                                    "object": input_object,
                                    "object_category": input_object_category,
                                    "object_attrs": "object:" + input_object + " acknowledge has been disabled (ack_expiration was: " + ack_expiration + "), alerts will be generated depending on state and rules. "
                                };
                                $.ajax({
                                    url: auditendpoint_URl,
                                    type: "POST",
                                    async: true,
                                    contentType: "application/json",
                                    data: JSON.stringify(audit_record),
                                    success: function(returneddata) {
                                        //console.log("Updated!", returneddata)
                                    }
                                });

                            }

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {
                                        // show disabled modal
                                        $("#ack_disable_achieved").modal()

                                        // Audit success change
                                        var time = (new Date).getTime();
                                        var audit_record = {
		                                    "time": time,
		                                    "action": "success",
		                                    "user": currentUser,
		                                    "change_type": "ack disable",
		                                    "object": input_object,
		                                    "object_category": input_object_category,
		                                    "object_attrs": "object:" + input_object + " acknowledge has been disabled (ack_expiration was: " + ack_expiration + "), alerts will be generated depending on state and rules. "
                                        };
                                        $.ajax({
                                            url: auditendpoint_URl,
                                            type: "POST",
                                            async: true,
                                            contentType: "application/json",
                                            data: JSON.stringify(audit_record),
                                            success: function(returneddata) {
                                            }
                                        });

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        audit_failure();
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        audit_failure();
                                        $("#modal_update_collection_failure_flush").modal()
                                    }
                                });

                            }

                        }
                    );

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

            });

        });

        // Logical group

        // show modal
        $('.btn_logical_group').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // if the token exists already, restart the search, otherwise allow the search to start
                var tk_start_logical_member_get = tokens.get("tk_start_logical_member_get");

                if (tk_start_logical_member_get && tk_start_logical_member_get.length) {
                    searchLogicalGroupTable.startSearch();
                } else
                {
                    setToken("tk_start_logical_member_get", "true");
                }

                var tk_data_name = tokens.get("tk_data_name");
                var tk_data_host = tokens.get("tk_data_host");
                var tk_metric_host = tokens.get("tk_metric_host");

                //console.log("tk_data_name is " + tk_data_name);
                //console.log("tk_data_host is " + tk_data_host);
                //console.log("tk_metric_host is " + tk_metric_host);

                if (tk_data_name !== undefined) {
                    setToken("input_object", tk_data_name);
                    setToken("input_object_category", "data_source");
                } else if (tk_data_host !== undefined) {
                    setToken("input_object", tk_data_host);
                    setToken("input_object_category", "data_host");
                } else if (tk_metric_host !== undefined) {
                    setToken("input_object", tk_metric_host);
                    setToken("input_object_category", "metric_host");
                }

                // show modal
                $("#logical_group").modal()

            });

        });

        // back
        $("#btn_associate_logical_group_back").click(function() {

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // retrieve token
                var input_object_category = tokens.get("input_object_category");

                // conditional modal target
                if (input_object_category === "data_source") {
                    //console.log("Clicked back");
                    $("#modal_modify_data_source_unified").modal()
                }
                else if (input_object_category === "data_host") {
                    //console.log("Clicked back");
                    $("#modal_modify_data_host_unified").modal()
                }
                else if (input_object_category === "metric_host") {
                    //console.log("Clicked back");
                    $("#modal_modify_metric_host_unified").modal()
                }

        });

        // back delete
        $("#confirm_remove_from_logical_group").click(function() {
                $("#logical_group").modal()
        });

        //
        $('.btn_logical_group_valid').each(function() {
            var $btn_group = $(this);
            $btn_group.find('button').on('click', function() {
                var $btn = $(this);

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_data_name = tokens.get("tk_data_name");
                var tk_data_host = tokens.get("tk_data_host");
                var tk_metric_host = tokens.get("tk_metric_host");

                if (tk_data_name !== undefined) {
                    setToken("input_object", tk_data_name);
                    setToken("input_object_category", "data_source");
                } else if (tk_data_host !== undefined) {
                    setToken("input_object", tk_data_host);
                    setToken("input_object_category", "data_host");
                } else if (tk_metric_host !== undefined) {
                    setToken("input_object", tk_metric_host);
                    setToken("input_object_category", "metric_host");
                }


            });

        });

        // Remove from logical group
        $("#btn_remove_from_logical_group_confirm_valid").click(function() {

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var input_object = tokens.get("input_object");
                var input_object_category = tokens.get("input_object_category");

                //console.log("Proceeding to removal of " + input_object);

                // Define the query
                var searchQuery = "| inputlookup trackme_logical_group | mvexpand object_group_members | where object_group_members!=\"" + input_object + "\" | stats values(*) as \"*\" by object_group_name | outputlookup trackme_logical_group";

                //console.log(keyid);
                //console.log(searchQuery);

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                if (input_object && input_object.length) {

                    // Run a blocking search and get back a job
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            function audit_failure() {

                                // Audit failure change
                                var time = (new Date).getTime();
                                var audit_record = {
                                    "time": time,
                                    "action": "failure",
                                    "user": currentUser,
                                    "change_type": "Logical group removal",
                                    "object": input_object,
                                    "object_category": input_object_category,
                                    "object_attrs": "object:" + input_object + " has been removed from Logical group. "
                                };
                                $.ajax({
                                    url: auditendpoint_URl,
                                    type: "POST",
                                    async: true,
                                    contentType: "application/json",
                                    data: JSON.stringify(audit_record),
                                    success: function(returneddata) {
                                        //console.log("Updated!", returneddata)
                                    }
                                });

                            }

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {
                                        // show disabled modal
                                        $("#logical_group_removal_achieved").modal()

                                        if (input_object_category === "data_source") {
                                            searchDataSourcesMain.startSearch();
                                        }
                                        else if (input_object_category === "data_host") {
                                            searchDataHostsMain.startSearch();
                                        }
                                        else if (input_object_category === "metric_host") {
                                            searchMetricHostsMain.startSearch();
                                        }

                                        // Audit success change
                                        var time = (new Date).getTime();
                                        var audit_record = {
		                                    "time": time,
		                                    "action": "success",
		                                    "user": currentUser,
		                                    "change_type": "Logical group removal",
		                                    "object": input_object,
		                                    "object_category": input_object_category,
		                                    "object_attrs": "object:" + input_object + " has been removed from Logical group. "
                                        };
                                        $.ajax({
                                            url: auditendpoint_URl,
                                            type: "POST",
                                            async: true,
                                            contentType: "application/json",
                                            data: JSON.stringify(audit_record),
                                            success: function(returneddata) {
                                            }
                                        });

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        audit_failure();
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        audit_failure();
                                        $("#modal_update_collection_failure_flush").modal()
                                    }
                                });

                            }

                        }
                    );

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

        });

        // Add logical group member
        $("#btn_add_logical_group_member").click(function() {

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // if the token exists already, restart the search, otherwise allow the search to start
                var tk_start_logical_member_add = tokens.get("tk_start_logical_member_add");
                
                if (tk_start_logical_member_add && tk_start_logical_member_add.length) {
                    searchLogicalGroupTableAddMember.startSearch();
                } else
                {
                    setToken("tk_start_logical_member_add", "true");
                }

                $("#logical_group_add_member").modal()
        });

        // Add logical group member
        $("#btn_add_logical_group_member_confirm_valid").click(function() {

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var input_object = tokens.get("input_object");
                var input_object_category = tokens.get("input_object_category");

                // keyid is used to add to group
                var tk_keyid = tokens.get("tk_keyid");

                // from click
                var tk_object_group_name = tokens.get("tk_object_group_name");

                // Define the query
                var searchQuery = "| inputlookup trackme_logical_group | eval keyid=_key | mvexpand object_group_members | append [ | makeresults | eval keyid=\"" + tk_keyid + "\", object_group_members=\"" + input_object + "\", object_group_name=\"" + tk_object_group_name + "\", object_group_mtime=now() ] | stats values(object_group_members) as object_group_members, first(object_group_name) as object_group_name, first(object_group_min_green_percent) as object_group_min_green_percent, max(object_group_mtime) as object_group_mtime by keyid | outputlookup trackme_logical_group append=t key_field=keyid";
                //console.log(searchQuery);

                //console.log(keyid);
                //console.log(searchQuery);

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                if (input_object && input_object.length) {

                    // Run a blocking search and get back a job
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            function audit_failure() {

                                // Audit failure change
                                var time = (new Date).getTime();
                                var audit_record = {
                                    "time": time,
                                    "action": "failure",
                                    "user": currentUser,
                                    "change_type": "Logical group add membership",
                                    "object": input_object,
                                    "object_category": input_object_category,
                                    "object_attrs": "object:" + input_object + " has been added to the logical group " + tk_object_group_name + "."
                                };
                                $.ajax({
                                    url: auditendpoint_URl,
                                    type: "POST",
                                    async: true,
                                    contentType: "application/json",
                                    data: JSON.stringify(audit_record),
                                    success: function(returneddata) {
                                        //console.log("Updated!", returneddata)
                                    }
                                });

                            }

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {
                                        // show disabled modal
                                        $("#logical_group_add_member_achieved").modal()

                                        if (input_object_category === "data_source") {
                                            searchDataSourcesMain.startSearch();
                                        }
                                        else if (input_object_category === "data_host") {
                                            searchDataHostsMain.startSearch();
                                        }
                                        else if (input_object_category === "metric_host") {
                                            searchMetricHostsMain.startSearch();
                                        }

                                        // Audit success change
                                        var time = (new Date).getTime();
                                        var audit_record = {
		                                    "time": time,
		                                    "action": "success",
		                                    "user": currentUser,
		                                    "change_type": "Logical group add membership",
		                                    "object": input_object,
		                                    "object_category": input_object_category,
		                                    "object_attrs": "object:" + input_object + " has been added to the logical group " + tk_object_group_name + "."
                                        };
                                        $.ajax({
                                            url: auditendpoint_URl,
                                            type: "POST",
                                            async: true,
                                            contentType: "application/json",
                                            data: JSON.stringify(audit_record),
                                            success: function(returneddata) {
                                            }
                                        });

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        audit_failure();
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        audit_failure();
                                        $("#modal_update_collection_failure_flush").modal()
                                    }
                                });

                            }

                        }
                    );

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }

        });

        // Add logical group member
        $("#btn_add_logical_group_new").click(function() {
                $("#logical_group_add_group").modal()
        });

        // back
        $("#btn_associate_logical_group_add_member_back").click(function() {
                $("#logical_group").modal()
        });

        // back
        $("#btn_associate_logical_group_add_group_back").click(function() {
                $("#logical_group").modal()
        });

        // back
        $("#btn_add_logical_group_member_confirm_back").click(function() {
                $("#logical_group").modal()
        });

        // Add logical group
        $("#btn_associate_logical_group_add_group").click(function() {

                // create token that will free the search for table populate
                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var input_object = tokens.get("input_object");
                var input_object_category = tokens.get("input_object_category");

                // from input
                var tk_object_group_name = tokens.get("InputLogicalGroupName");
                var tk_object_group_green_percent = tokens.get("InputLogicalGroupNamePercent");

                // Define the query
                var searchQuery = "| makeresults | eval object_group_name=\"" + tk_object_group_name + "\", object_group_members=\"" + input_object + "\", object_group_min_green_percent=\"" +  tk_object_group_green_percent + "\", object_group_mtime=now() | append [ | inputlookup trackme_logical_group ] | outputlookup trackme_logical_group";
                //console.log(searchQuery);

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                if (tk_object_group_name && tk_object_group_name.length) {

                    // Run a blocking search and get back a job
                    service.search(
                        searchQuery,
                        searchParams,
                        function(err, job) {

                            function audit_failure() {

                                // Audit failure change
                                var time = (new Date).getTime();
                                var audit_record = {
                                    "time": time,
                                    "action": "failure",
                                    "user": currentUser,
                                    "change_type": "Logical group add",
                                    "object": tk_object_group_name,
                                    "object_category": input_object_category,
                                    "object_attrs": "new logical group " + tk_object_group_name + " has been created for object:" + input_object + " with a minimal logical group green percentage of " + tk_object_group_green_percent + "."
                                };
                                $.ajax({
                                    url: auditendpoint_URl,
                                    type: "POST",
                                    async: true,
                                    contentType: "application/json",
                                    data: JSON.stringify(audit_record),
                                    success: function(returneddata) {
                                        //console.log("Updated!", returneddata)
                                    }
                                });

                            }

                            // Shall the search fail before we can get properties
                            if (job == null) {
                                let errorStr = "Unknown Error!";
                                if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                    errorStr = err.data.messages[0]['text'];
                                } else if (err && err.data && err.data.messages) {
                                    errorStr = JSON.stringify(err.data.messages);
                                }
                                audit_failure();
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            } else {

                                // Poll the status of the search job
                                job.track({
                                    period: 200
                                }, {
                                    done: function(job) {
                                        // show disabled modal
                                        $("#logical_group_add_achieved").modal()

                                        if (input_object_category === "data_source") {
                                            searchDataSourcesMain.startSearch();
                                        }
                                        else if (input_object_category === "data_host") {
                                            searchDataHostsMain.startSearch();
                                        }
                                        else if (input_object_category === "metric_host") {
                                            searchMetricHostsMain.startSearch();
                                        }

                                        // Audit success change
                                        var time = (new Date).getTime();
                                        var audit_record = {
		                                    "time": time,
		                                    "action": "success",
		                                    "user": currentUser,
		                                    "change_type": "Logical group add",
		                                    "object": tk_object_group_name,
		                                    "object_category": input_object_category,
		                                    "object_attrs": "new logical group " + tk_object_group_name + " has been created for object:" + input_object + " with a minimal logical group green percentage of " + tk_object_group_green_percent + "."
                                        };
                                        $.ajax({
                                            url: auditendpoint_URl,
                                            type: "POST",
                                            async: true,
                                            contentType: "application/json",
                                            data: JSON.stringify(audit_record),
                                            success: function(returneddata) {
                                            }
                                        });

                                    },
                                    failed: function(properties) {
                                        let errorStr = "Unknown Error!";
                                        if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                            errorStr = properties._properties.messages[0]['text'];
                                        } else if (properties && properties._properties && properties._properties.messages) {
                                            errorStr = JSON.stringify(properties._properties.messages);
                                        }
                                        audit_failure();
                                        $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                        $("#modal_update_collection_failure_return").modal()
                                    },
                                    error: function(err) {
                                        done(err);
                                        audit_failure();
                                        $("#modal_update_collection_failure_flush").modal()
                                    }
                                });

                            }

                        }
                    );

                    // house cleaning
                    myendpoint_URl = undefined;
                    delete(myendpoint_URl);
                    return;

                } else {
                    $("#modal_entry_update_invalid").modal()
                    return;
                }


        });

        // END

        DashboardController.onReady(function() {
            if (!submittedTokenModel.has('earliest') && !submittedTokenModel.has('latest')) {
                submittedTokenModel.set({
                    earliest: '0',
                    latest: ''
                });
            }
        });

        // Initialize time tokens to default
        if (!defaultTokenModel.has('earliest') && !defaultTokenModel.has('latest')) {
            defaultTokenModel.set({
                earliest: '0',
                latest: ''
            });
        }

        if (!_.isEmpty(urlTokenModel.toJSON())) {
            submitTokens();
        }

        //
        // DASHBOARD READY
        //

        DashboardController.ready();
        pageLoading = false;

    }
);
// ]]>
</script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/trackme/table.js" type="text/javascript"></script>
<script>
$(".btn").mouseup(function(){
    $(this).blur();
})
</script>
<script>
$('.modal').on('show.bs.modal', function () {
    $('.modal').not($(this)).each(function () {
        $(this).modal('hide');
    });
});
</script>
<script>
function notification(s, time) {

  $("<p>" + s + "</p>").appendTo('#boxnotify-unified-data-source').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-unified-data-host').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-unified-metric-host').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_source_whitelist').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_host_whitelist').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_metric_host_whitelist').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_source_blacklist_host').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_source_blacklist_index').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_source_blacklist_sourcetype').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_host_blacklist_host').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_host_blacklist_index').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_data_host_blacklist_sourcetype').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modal_modify_metric_host_blacklist_metric_category').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

  $("<p>" + s + "</p>").appendTo('#boxnotify-modify_custom_lagging').fadeTo(time, 1, function() {
    $(this).fadeTo(1000, 0, function() {
      $(this).remove()
    });
  });

}
</script>
</body>
</html>